cscope 15 $HOME/ssdsimnew/compressed_Mapping_table/compressed-table -q 0000002631 0000617681
	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/avlTree.c

1 
	~"avlTªe.h
"

13 
	$avlTªeHigh
(
TREE_NODE
 *
pNode
) {

14 
lh
 = 0, 
rh
 = 0;

15 i‡(!
pNode
)

18 
lh
 = 
	`avlTªeHigh
(
pNode
->
À·_chûd
);

19 
rh
 = 
	`avlTªeHigh
(
pNode
->
right_chûd
);

21  (1 + ((
lh
 > 
rh
) ?Üh :Ñh));

22 
	}
}

39 
	$avlTªeCheck
(
tAVLTªe
 *
pTªe
, 
TREE_NODE
 *
pNode
) {

40 
lh
 = 0, 
rh
 = 0;

41 
TREE_NODE
 *
åì_roŸ
 = 
AVL_NULL
;

43 i‡(!
pTªe
 || !
pNode
)

46 
lh
 = 
	`avlTªeHigh
(
pNode
->
À·_chûd
);

47 
rh
 = 
	`avlTªeHigh
(
pNode
->
right_chûd
);

48 i‡(
pNode
->
bf
 !
lh
 - 
rh
)

52 i‡(
pNode
->
À·_chûd
 && ((*
pTªe
->
keyCom∑ª
)(pNode,ÖNode->left_child)) >= 0)

56 i‡(
pNode
->
right_chûd
 && ((*
pTªe
->
keyCom∑ª
)(pNode,ÖNode->right_child)) <= 0)

60 
åì_roŸ
 = 
pNode
->tree_root;

61 i‡(!
åì_roŸ
 && (
pTªe
->
pTªeHódî
 !
pNode
))

64 i‡(
åì_roŸ
) {

69 i‡((
åì_roŸ
->
À·_chûd
 !
pNode
 &&Åªe_roŸ->
right_chûd
 !=ÖNode) ||

70 (
åì_roŸ
->
À·_chûd
 =
pNode
 &&Åªe_roŸ->
right_chûd
 ==ÖNode))

78 i‡((
pNode
->
À·_chûd
 &&ÖNode->À·_chûd->
åì_roŸ
 !=ÖNode) ||

79 (
pNode
->
right_chûd
 &&ÖNode->right_chûd->
åì_roŸ
 !=ÖNode))

82 i‡(
pNode
->
À·_chûd
 && !
	`avlTªeCheck
(
pTªe
,ÖNode->left_child))

85 i‡(
pNode
->
right_chûd
 && !
	`avlTªeCheck
(
pTªe
,ÖNode->right_child))

89 
	}
}

117 
	$R_RŸ©e
(
TREE_NODE
 **
µNode
) {

118 
TREE_NODE
 *
l_chûd
 = 
AVL_NULL
;

119 
TREE_NODE
 *
pNode
 = (TREE_NODE *Ë(*
µNode
);

121 
l_chûd
 = 
pNode
->
À·_chûd
;

122 
pNode
->
À·_chûd
 = 
l_chûd
->
right_chûd
;

123 i‡(
l_chûd
->
right_chûd
)

124 
l_chûd
->
right_chûd
->
åì_roŸ
 = 
pNode
;

125 
l_chûd
->
right_chûd
 = 
pNode
;

126 
l_chûd
->
åì_roŸ
 = 
pNode
->tree_root;

127 
pNode
->
åì_roŸ
 = 
l_chûd
;

128 (*
µNode
Ë
l_chûd
;

129 
	}
}

150 
	$L_RŸ©e
(
TREE_NODE
 **
µNode
) {

151 
TREE_NODE
 *
r_chûd
 = 
AVL_NULL
;

152 
TREE_NODE
 *
pNode
 = (TREE_NODE *Ë(*
µNode
);

154 
r_chûd
 = 
pNode
->
right_chûd
;

155 
pNode
->
right_chûd
 = 
r_chûd
->
À·_chûd
;

156 i‡(
r_chûd
->
À·_chûd
)

157 
r_chûd
->
À·_chûd
->
åì_roŸ
 = 
pNode
;

158 
r_chûd
->
À·_chûd
 = 
pNode
;

159 
r_chûd
->
åì_roŸ
 = 
pNode
->tree_root;

160 
pNode
->
åì_roŸ
 = 
r_chûd
;

161 (*
µNode
Ë
r_chûd
;

162 
	}
}

173 
	$Le·BÆ™˚
(
TREE_NODE
 **
µNode
) {

174 
TREE_NODE
 *
À·_chûd
 = 
AVL_NULL
;

175 
TREE_NODE
 *
right_chûd
 = 
AVL_NULL
;

176 
TREE_NODE
 *
åì_roŸ
 = 
AVL_NULL
;

177 
TREE_NODE
 *
pNode
 = (TREE_NODE *Ë(*
µNode
);

179 
åì_roŸ
 = 
pNode
->tree_root;

180 
À·_chûd
 = 
pNode
->left_child;

181 
À·_chûd
->
bf
) {

182 
LH_FACTOR
:

183 
pNode
->
bf
 = 
À·_chûd
->b‡
EH_FACTOR
;

184 
	`R_RŸ©e
(
µNode
);

186 
RH_FACTOR
:

188 
right_chûd
 = 
À·_chûd
->right_child;

189 
right_chûd
->
bf
) {

190 
LH_FACTOR
:

191 
pNode
->
bf
 = 
RH_FACTOR
;

192 
À·_chûd
->
bf
 = 
EH_FACTOR
;

194 
EH_FACTOR
:

195 
pNode
->
bf
 = 
À·_chûd
->b‡
EH_FACTOR
;

197 
RH_FACTOR
:

198 
pNode
->
bf
 = 
EH_FACTOR
;

199 
À·_chûd
->
bf
 = 
LH_FACTOR
;

202 
right_chûd
->
bf
 = 
EH_FACTOR
;

203 
	`L_RŸ©e
(&
pNode
->
À·_chûd
);

204 
	`R_RŸ©e
(
µNode
);

206 
EH_FACTOR
:

207 
pNode
->
bf
 = 
LH_FACTOR
;

208 
À·_chûd
->
bf
 = 
RH_FACTOR
;

209 
	`R_RŸ©e
(
µNode
);

212 (*
µNode
)->
åì_roŸ
 =Åree_root;

213 i‡(
åì_roŸ
 &&Åªe_roŸ->
À·_chûd
 =
pNode
)

214 
åì_roŸ
->
À·_chûd
 = *
µNode
;

215 i‡(
åì_roŸ
 &&Åªe_roŸ->
right_chûd
 =
pNode
)

216 
åì_roŸ
->
right_chûd
 = *
µNode
;

217 
	}
}

228 
	$RightBÆ™˚
(
TREE_NODE
 **
µNode
) {

229 
TREE_NODE
 *
À·_chûd
 = 
AVL_NULL
;

230 
TREE_NODE
 *
right_chûd
 = 
AVL_NULL
;

231 
TREE_NODE
 *
åì_roŸ
 = 
AVL_NULL
;

232 
TREE_NODE
 *
pNode
 = (TREE_NODE *Ë(*
µNode
);

234 
åì_roŸ
 = 
pNode
->tree_root;

235 
right_chûd
 = 
pNode
->right_child;

236 
right_chûd
->
bf
) {

237 
RH_FACTOR
:

238 
pNode
->
bf
 = 
right_chûd
->b‡
EH_FACTOR
;

239 
	`L_RŸ©e
(
µNode
);

241 
LH_FACTOR
:

242 
À·_chûd
 = 
right_chûd
->left_child;

243 
À·_chûd
->
bf
) {

244 
RH_FACTOR
:

245 
pNode
->
bf
 = 
LH_FACTOR
;

246 
right_chûd
->
bf
 = 
EH_FACTOR
;

248 
EH_FACTOR
:

249 
pNode
->
bf
 = 
right_chûd
->b‡
EH_FACTOR
;

251 
LH_FACTOR
:

252 
pNode
->
bf
 = 
EH_FACTOR
;

253 
right_chûd
->
bf
 = 
RH_FACTOR
;

256 
À·_chûd
->
bf
 = 
EH_FACTOR
;

257 
	`R_RŸ©e
(&
pNode
->
right_chûd
);

258 
	`L_RŸ©e
(
µNode
);

260 
EH_FACTOR
:

261 
pNode
->
bf
 = 
RH_FACTOR
;

262 
right_chûd
->
bf
 = 
LH_FACTOR
;

263 
	`L_RŸ©e
(
µNode
);

266 (*
µNode
)->
åì_roŸ
 =Åree_root;

267 i‡(
åì_roŸ
 &&Åªe_roŸ->
À·_chûd
 =
pNode
)

268 
åì_roŸ
->
À·_chûd
 = *
µNode
;

269 i‡(
åì_roŸ
 &&Åªe_roŸ->
right_chûd
 =
pNode
)

270 
åì_roŸ
->
right_chûd
 = *
µNode
;

271 
	}
}

294 
	gavlDñBÆ™˚


296 
tAVLTªe
 *
	gpTªe
,

297 
TREE_NODE
 *
	gpNode
,

298 
	gL_R_MINUS


300 
TREE_NODE
 *
	gåì_roŸ
 = 
AVL_NULL
;

302 
	gåì_roŸ
 = 
pNode
->
åì_roŸ
;

303 i‡(
	gL_R_MINUS
 =
LEFT_MINUS
) {

304 
pNode
->
bf
) {

305 
EH_FACTOR
:

306 
pNode
->
bf
 = 
RH_FACTOR
;

308 
	gRH_FACTOR
:

309 
RightBÆ™˚
(&
pNode
);

310 i‡(!
	gåì_roŸ
)

311 
	gpTªe
->
	gpTªeHódî
 = 
pNode
;

312 i‡(
	gpNode
->
	gåì_roŸ
 &&ÖNode->
	gbf
 =
EH_FACTOR
) {

313 i‡(
pNode
->
åì_roŸ
->
À·_chûd
 ==ÖNode)

314 
avlDñBÆ™˚
(
pTªe
, 
pNode
->
åì_roŸ
, 
LEFT_MINUS
);

316 
avlDñBÆ™˚
(
pTªe
, 
pNode
->
åì_roŸ
, 
RIGHT_MINUS
);

319 
	gLH_FACTOR
:

320 
pNode
->
bf
 = 
EH_FACTOR
;

321 i‡(
	gpNode
->
	gåì_roŸ
 &&ÖNode->
	gbf
 =
EH_FACTOR
) {

322 i‡(
pNode
->
åì_roŸ
->
À·_chûd
 ==ÖNode)

323 
avlDñBÆ™˚
(
pTªe
, 
pNode
->
åì_roŸ
, 
LEFT_MINUS
);

325 
avlDñBÆ™˚
(
pTªe
, 
pNode
->
åì_roŸ
, 
RIGHT_MINUS
);

331 i‡(
	gL_R_MINUS
 =
RIGHT_MINUS
) {

332 
pNode
->
bf
) {

333 
EH_FACTOR
:

334 
pNode
->
bf
 = 
LH_FACTOR
;

336 
	gLH_FACTOR
:

337 
Le·BÆ™˚
(&
pNode
);

338 i‡(!
	gåì_roŸ
)

339 
	gpTªe
->
	gpTªeHódî
 = 
pNode
;

340 i‡(
	gpNode
->
	gåì_roŸ
 &&ÖNode->
	gbf
 =
EH_FACTOR
) {

341 i‡(
pNode
->
åì_roŸ
->
À·_chûd
 ==ÖNode)

342 
avlDñBÆ™˚
(
pTªe
, 
pNode
->
åì_roŸ
, 
LEFT_MINUS
);

344 
avlDñBÆ™˚
(
pTªe
, 
pNode
->
åì_roŸ
, 
RIGHT_MINUS
);

347 
	gRH_FACTOR
:

348 
pNode
->
bf
 = 
EH_FACTOR
;

349 i‡(
	gpNode
->
	gåì_roŸ
 &&ÖNode->
	gbf
 =
EH_FACTOR
) {

350 i‡(
pNode
->
åì_roŸ
->
À·_chûd
 ==ÖNode)

351 
avlDñBÆ™˚
(
pTªe
, 
pNode
->
åì_roŸ
, 
LEFT_MINUS
);

353 
avlDñBÆ™˚
(
pTªe
, 
pNode
->
åì_roŸ
, 
RIGHT_MINUS
);

375 
	gAVL_TREE_LOCK


377 
tAVLTªe
 *
	gpTªe
,

378 
	gtimeout


380 i‡(!
	gpTªe


381 #i‡
OS
 == 3 || OS == 4

382 || !
	gpTªe
->
	g£m


387 #i‡
OS
 == 3 || OS == 4

388 
£mTake
(
pTªe
->
£m
,
timeout
);

403 
	gAVL_TREE_UNLOCK


405 
tAVLTªe
 *
	gpTªe


407 i‡(!
	gpTªe


408 #i‡
OS
 == 3 || OS == 4

409 || !
	gpTªe
->
	g£m


414 #i‡
OS
 == 3 || OS == 4

415 
£mGive
(
pTªe
->
£m
);

433 
	gAVL_TREENODE_FREE


435 
tAVLTªe
 *
	gpTªe
,

436 
TREE_NODE
 *
	gpNode


438 i‡(!
	gpTªe
 || !
	gpNode
)

441 (*
	gpTªe
->
	g‰ì
)(
	gpNode
);

451 #ifde‡
ORDER_LIST_WANTED


469 
	g‹dîLi°In£π


471 
tAVLTªe
 *
	gpTªe
,

472 
TREE_NODE
 *
	gpNode
,

473 
TREE_NODE
 *
	gpIn£πNode
,

474 
	g¥ev_‹_√xt


476 
TREE_NODE
 *
	gp
 = 
AVL_NULL
;

478 i‡(!
	gpNode
)

481 i‡(
	g¥ev_‹_√xt
 =
INSERT_PREV
) {

482 
p
 = 
pNode
->
¥ev
;

483 i‡(
	gp
Ëp->
	g√xt
 = 
pIn£πNode
;

484 
	gpTªe
->
	gpLi°Hódî
 = 
pIn£πNode
;

486 
	gpIn£πNode
->
	g¥ev
 = 
p
;

487 
	gpIn£πNode
->
	g√xt
 = 
pNode
;

488 
	gpNode
->
	g¥ev
 = 
pIn£πNode
;

491 i‡(
	g¥ev_‹_√xt
 =
INSERT_NEXT
) {

492 
p
 = 
pNode
->
√xt
;

493 i‡(
	gp
Ëp->
	g¥ev
 = 
pIn£πNode
;

494 
	gpTªe
->
	gpLi°Taû
 = 
pIn£πNode
;

496 
	gpIn£πNode
->
	g¥ev
 = 
pNode
;

497 
	gpIn£πNode
->
	g√xt
 = 
p
;

498 
	gpNode
->
	g√xt
 = 
pIn£πNode
;

515 
	g‹dîLi°Remove


517 
tAVLTªe
 *
	gpTªe
,

518 
TREE_NODE
 *
	gpRemoveNode


520 
TREE_NODE
 *
	gpPªv
 = 
AVL_NULL
;

521 
TREE_NODE
 *
	gpNext
 = 
AVL_NULL
;

523 i‡(!
	gpRemoveNode
)

526 
	gpPªv
 = 
pRemoveNode
->
¥ev
;

527 
	gpNext
 = 
pRemoveNode
->
√xt
;

528 i‡(!
	gpPªv
 && !
	gpNext
) {

529 
	gpTªe
->
	gpLi°Hódî
 = 
pTªe
->
pLi°Taû
 = 
AVL_NULL
;

532 i‡(
	gpPªv
 && 
	gpNext
) {

533 
	gpPªv
->
	g√xt
 = 
pNext
;

534 
	gpNext
->
	g¥ev
 = 
pPªv
;

538 i‡(
	gpPªv
) {

539 
	gpPªv
->
	g√xt
 = 
AVL_NULL
;

540 
	gpTªe
->
	gpLi°Taû
 = 
pPªv
;

544 i‡(
	gpNext
) {

545 
	gpNext
->
	g¥ev
 = 
AVL_NULL
;

546 
	gpTªe
->
	gpLi°Hódî
 = 
pNext
;

562 
TREE_NODE
 *
	gavlTªeFú°


564 
tAVLTªe
 *
	gpTªe


566 i‡(!
	gpTªe
)

567  
	gAVL_NULL
;

569 i‡(!
	gpTªe
->
	gcou¡
 || !pTªe->
	gpTªeHódî
)

570  
	gAVL_NULL
;

572  (
	gTREE_NODE
 *Ë
	gpTªe
->
	gpLi°Hódî
;

584 
TREE_NODE
 *
	gavlTªeLa°


586 
tAVLTªe
 *
	gpTªe


588 i‡(!
	gpTªe
)

589  
	gAVL_NULL
;

591 i‡(!
	gpTªe
->
	gcou¡
 || !pTªe->
	gpTªeHódî
)

592  
	gAVL_NULL
;

594  (
	gTREE_NODE
 *Ë
	gpTªe
->
	gpLi°Taû
;

605 
TREE_NODE
 *
	gavlTªeNext


607 
TREE_NODE
 *
	gpNode


609 i‡(!
	gpNode
)

610  
	gAVL_NULL
;

612  (
	gTREE_NODE
 *Ë
	gpNode
->
	g√xt
;

623 
TREE_NODE
 *
	gavlTªePªv


625 
TREE_NODE
 *
	gpNode


627 i‡(!
	gpNode
)

628  
	gAVL_NULL
;

630  (
	gTREE_NODE
 *Ë
	gpNode
->
	g¥ev
;

650 
	gavlTªeIn£π


652 
tAVLTªe
 *
	gpTªe
,

653 
TREE_NODE
 **
	gµNode
,

654 
TREE_NODE
 *
	gpIn£πNode
,

655 *
	ggrowthFœg


657 
	gcompFœg
 = 0;

658 
TREE_NODE
 *
	gpNode
 = (TREE_NODE *Ë(*
µNode
);

660 i‡(
	gpTªe
->
	gcou¡
 == 0) {

661 
pTªe
->
pTªeHódî
 = 
pIn£πNode
;

662 
	gpIn£πNode
->
	gbf
 = 
EH_FACTOR
;

663 
	gpIn£πNode
->
	gÀ·_chûd
 = 
pIn£πNode
->
right_chûd
 = 
AVL_NULL
;

664 
	gpIn£πNode
->
	gåì_roŸ
 = 
AVL_NULL
;

665 #ifde‡
ORDER_LIST_WANTED


666 
	gpTªe
->
	gpLi°Hódî
 = 
pTªe
->
pLi°Taû
 = 
pIn£πNode
;

667 
	gpIn£πNode
->
	g¥ev
 = 
pIn£πNode
->
√xt
 = 
AVL_NULL
;

672 
	gcompFœg
 = ((*
pTªe
->
keyCom∑ª
)(
pNode
, 
	gpIn£πNode
));

673 i‡(!
	gcompFœg
) {

674 *
	ggrowthFœg
 = 0;

678 i‡(
	gcompFœg
 < 0) {

679 i‡(!
	gpNode
->
	gÀ·_chûd
) {

680 
	gpNode
->
	gÀ·_chûd
 = 
pIn£πNode
;

681 
	gpIn£πNode
->
	gbf
 = 
EH_FACTOR
;

682 
	gpIn£πNode
->
	gÀ·_chûd
 = 
pIn£πNode
->
right_chûd
 = 
AVL_NULL
;

683 
	gpIn£πNode
->
	gåì_roŸ
 = (
TREE_NODE
 *Ë
pNode
;

684 #ifde‡
ORDER_LIST_WANTED


685 
‹dîLi°In£π
(
pTªe
, 
pNode
, 
pIn£πNode
, 
INSERT_PREV
);

687 
	gpNode
->
	gbf
) {

688 
	gEH_FACTOR
:

689 
pNode
->
bf
 = 
LH_FACTOR
;

690 *
	ggrowthFœg
 = 1;

692 
	gRH_FACTOR
:

693 
pNode
->
bf
 = 
EH_FACTOR
;

694 *
	ggrowthFœg
 = 0;

698 i‡(!
avlTªeIn£π
(
pTªe
, &
pNode
->
À·_chûd
, 
pIn£πNode
, 
growthFœg
))

701 i‡(*
	ggrowthFœg
) {

702 
	gpNode
->
	gbf
) {

703 
	gLH_FACTOR
:

704 
Le·BÆ™˚
(
µNode
);

705 *
	ggrowthFœg
 = 0;

707 
	gEH_FACTOR
:

708 
pNode
->
bf
 = 
LH_FACTOR
;

709 *
	ggrowthFœg
 = 1;

711 
	gRH_FACTOR
:

712 
pNode
->
bf
 = 
EH_FACTOR
;

713 *
	ggrowthFœg
 = 0;

720 i‡(
	gcompFœg
 > 0) {

721 i‡(!
	gpNode
->
	gright_chûd
) {

722 
	gpNode
->
	gright_chûd
 = 
pIn£πNode
;

723 
	gpIn£πNode
->
	gbf
 = 
EH_FACTOR
;

724 
	gpIn£πNode
->
	gÀ·_chûd
 = 
pIn£πNode
->
right_chûd
 = 
AVL_NULL
;

725 
	gpIn£πNode
->
	gåì_roŸ
 = (
TREE_NODE
 *Ë
pNode
;

726 #ifde‡
ORDER_LIST_WANTED


727 
‹dîLi°In£π
(
pTªe
, 
pNode
, 
pIn£πNode
, 
INSERT_NEXT
);

729 
	gpNode
->
	gbf
) {

730 
	gEH_FACTOR
:

731 
pNode
->
bf
 = 
RH_FACTOR
;

732 *
	ggrowthFœg
 = 1;

734 
	gLH_FACTOR
:

735 
pNode
->
bf
 = 
EH_FACTOR
;

736 *
	ggrowthFœg
 = 0;

740 i‡(!
avlTªeIn£π
(
pTªe
, &
pNode
->
right_chûd
, 
pIn£πNode
, 
growthFœg
))

743 i‡(*
	ggrowthFœg
) {

744 
	gpNode
->
	gbf
) {

745 
	gLH_FACTOR
:

746 
pNode
->
bf
 = 
EH_FACTOR
;

747 *
	ggrowthFœg
 = 0;

749 
	gEH_FACTOR
:

750 
pNode
->
bf
 = 
RH_FACTOR
;

751 *
	ggrowthFœg
 = 1;

753 
	gRH_FACTOR
:

754 
RightBÆ™˚
(
µNode
);

755 *
	ggrowthFœg
 = 0;

791 
	gavlTªeRemove


793 
tAVLTªe
 *
	gpTªe
,

794 
TREE_NODE
 *
	gpRemoveNode


796 
	gcompFœg
 = 0;

797 
TREE_NODE
 *
	gåì_roŸ
 = 
AVL_NULL
;

798 
TREE_NODE
 *
	gp
 = 
AVL_NULL
;

799 
TREE_NODE
 *
	groŸ_p
 = 
AVL_NULL
;

800 
TREE_NODE
 
	gsw≠Node
;

802 
	gåì_roŸ
 = 
pRemoveNode
->
åì_roŸ
;

803 i‡(!
	gpRemoveNode
->
	gÀ·_chûd
 && !pRemoveNode->
	gright_chûd
) {

804 i‡(!
	gåì_roŸ
) {

805 
	gpTªe
->
	gpTªeHódî
 = 
AVL_NULL
;

806 #ifde‡
ORDER_LIST_WANTED


807 
	gpTªe
->
	gpLi°Hódî
 = 
pTªe
->
pLi°Taû
 = 
AVL_NULL
;

810 } i‡(
	gåì_roŸ
->
	gÀ·_chûd
 =
pRemoveNode
) {

811 #ifde‡
ORDER_LIST_WANTED


812 
‹dîLi°Remove
(
pTªe
, 
pRemoveNode
);

814 
	gåì_roŸ
->
	gÀ·_chûd
 = 
AVL_NULL
;

815 
avlDñBÆ™˚
(
pTªe
, 
åì_roŸ
, 
LEFT_MINUS
);

817 #ifde‡
ORDER_LIST_WANTED


818 
‹dîLi°Remove
(
pTªe
, 
pRemoveNode
);

820 
	gåì_roŸ
->
	gright_chûd
 = 
AVL_NULL
;

821 
avlDñBÆ™˚
(
pTªe
, 
åì_roŸ
, 
RIGHT_MINUS
);

825 i‡(
	gpRemoveNode
->
	gÀ·_chûd
 &&ÖRemoveNode->
	gright_chûd
) {

826 
TREE_NODE
 *
	g¥ev
 = 
AVL_NULL
;

827 
TREE_NODE
 *
	g√xt
 = 
AVL_NULL
;

828 
TREE_NODE
 *
	gr_chûd
 = 
AVL_NULL
;

829 
	groŸ_p
 = 
pRemoveNode
;

830 
	gp
 = 
pRemoveNode
->
right_chûd
;

831 
	gp
->
	gÀ·_chûd
) {

832 
	groŸ_p
 = 
p
;

833 
	gp
 = 
p
->
À·_chûd
;

835 i‡(
	gp
 =
pRemoveNode
->
right_chûd
) {

836 
p
->
åì_roŸ
 =Ö;

837 
	gpRemoveNode
->
	gright_chûd
 = 
pRemoveNode
;

839 
	gsw≠Node
 = *
p
;

840 
	g¥ev
 = 
p
->
¥ev
;

841 
	g√xt
 = 
p
->
√xt
;

842 *
	gp
 = *
pRemoveNode
;

843 
	gp
->
	g¥ev
 = 
¥ev
;

844 
	gp
->
	g√xt
 = 
√xt
;

845 
	g¥ev
 = 
pRemoveNode
->
¥ev
;

846 
	g√xt
 = 
pRemoveNode
->
√xt
;

847 *
	gpRemoveNode
 = 
sw≠Node
;

848 
	gpRemoveNode
->
	g¥ev
 = 
¥ev
;

849 
	gpRemoveNode
->
	g√xt
 = 
√xt
;

850 i‡(!
	gåì_roŸ
)

851 
	gpTªe
->
	gpTªeHódî
 = 
p
;

852 i‡(
	gåì_roŸ
->
	gÀ·_chûd
 =
pRemoveNode
)

853 
åì_roŸ
->
À·_chûd
 = 
p
;

855 
	gåì_roŸ
->
	gright_chûd
 = 
p
;

857 i‡(
	gp
->
	gÀ·_chûd
)

858 
	gp
->
	gÀ·_chûd
->
	gåì_roŸ
 = 
p
;

859 i‡(
	gp
->
	gright_chûd
)

860 
	gp
->
	gright_chûd
->
	gåì_roŸ
 = 
p
;

862 i‡(
	gpRemoveNode
->
	gÀ·_chûd
)

863 
	gpRemoveNode
->
	gÀ·_chûd
->
	gåì_roŸ
 = 
pRemoveNode
;

864 i‡(
	gpRemoveNode
->
	gright_chûd
)

865 
	gpRemoveNode
->
	gright_chûd
->
	gåì_roŸ
 = 
pRemoveNode
;

867 i‡(
	groŸ_p
 !
pRemoveNode
) {

868 i‡(
roŸ_p
->
À·_chûd
 =
p
)

869 
roŸ_p
->
À·_chûd
 = 
pRemoveNode
;

871 
	groŸ_p
->
	gright_chûd
 = 
pRemoveNode
;

874  
avlTªeRemove
(
pTªe
, 
pRemoveNode
);

877 i‡(
	gpRemoveNode
->
	gÀ·_chûd
) {

878 #ifde‡
ORDER_LIST_WANTED


879 
‹dîLi°Remove
(
pTªe
, 
pRemoveNode
);

881 i‡(!
	gåì_roŸ
) {

882 
	gpTªe
->
	gpTªeHódî
 = 
pRemoveNode
->
À·_chûd
;

883 
	gpRemoveNode
->
	gÀ·_chûd
->
	gåì_roŸ
 = 
AVL_NULL
;

887 i‡(
	gåì_roŸ
->
	gÀ·_chûd
 =
pRemoveNode
) {

888 
åì_roŸ
->
À·_chûd
 = 
pRemoveNode
->left_child;

889 
	gpRemoveNode
->
	gÀ·_chûd
->
	gåì_roŸ
 = 
åì_roŸ
;

890 
avlDñBÆ™˚
(
pTªe
, 
åì_roŸ
, 
LEFT_MINUS
);

892 
	gåì_roŸ
->
	gright_chûd
 = 
pRemoveNode
->
À·_chûd
;

893 
	gpRemoveNode
->
	gÀ·_chûd
->
	gåì_roŸ
 = 
åì_roŸ
;

894 
avlDñBÆ™˚
(
pTªe
, 
åì_roŸ
, 
RIGHT_MINUS
);

900 i‡(
	gpRemoveNode
->
	gright_chûd
) {

901 #ifde‡
ORDER_LIST_WANTED


902 
‹dîLi°Remove
(
pTªe
, 
pRemoveNode
);

904 i‡(!
	gåì_roŸ
) {

905 
	gpTªe
->
	gpTªeHódî
 = 
pRemoveNode
->
right_chûd
;

906 
	gpRemoveNode
->
	gright_chûd
->
	gåì_roŸ
 = 
AVL_NULL
;

910 i‡(
	gåì_roŸ
->
	gÀ·_chûd
 =
pRemoveNode
) {

911 
åì_roŸ
->
À·_chûd
 = 
pRemoveNode
->
right_chûd
;

912 
	gpRemoveNode
->
	gright_chûd
->
	gåì_roŸ
 = 
åì_roŸ
;

913 
avlDñBÆ™˚
(
pTªe
, 
åì_roŸ
, 
LEFT_MINUS
);

915 
	gåì_roŸ
->
	gright_chûd
 = 
pRemoveNode
->
right_chûd
;

916 
	gpRemoveNode
->
	gright_chûd
->
	gåì_roŸ
 = 
åì_roŸ
;

917 
avlDñBÆ™˚
(
pTªe
, 
åì_roŸ
, 
RIGHT_MINUS
);

940 
TREE_NODE
 *
	gavlTªeLookup


942 
tAVLTªe
 *
	gpTªe
,

943 
TREE_NODE
 *
	gpNode
,

944 
TREE_NODE
 *
	gpSórchKey


946 
	gcompFœg
 = 0;

947 i‡(!
	gpTªe
 || !
	gpNode
)

948  
	gAVL_NULL
;

950 
	gcompFœg
 = (*
pTªe
->
keyCom∑ª
)(
pNode
, 
	gpSórchKey
);

951 i‡(!
	gcompFœg
)

952  (
	gTREE_NODE
 *Ë
	gpNode
;

954 i‡(
	gcompFœg
 > 0Ë
	gpNode
 = 
pNode
->
right_chûd
;

955 
	gpNode
 = 
pNode
->
À·_chûd
;

957  (
	gTREE_NODE
 *Ë
avlTªeLookup
(
pTªe
, 
pNode
, 
pSórchKey
);

972 
tAVLTªe
 *
	$avlTªeCª©e
(*
keyCom∑ªFunc
, *
‰ìFunc
) {

973 
tAVLTªe
 *
pTªe
 = (tAVLTree *) 0;

975 i‡(!
keyCom∑ªFunc
 || !
‰ìFunc
)

976  (
tAVLTªe
 *) 0;

978 
pTªe
 = (
tAVLTªe
 *Ë
	`mÆloc
((tAVLTree));

980 i‡(
pTªe
 !(
tAVLTªe
 *) 0) {

981 
	`mem£t
((*Ë
pTªe
, 0, (
tAVLTªe
));

982 
pTªe
->
keyCom∑ª
 = (*Ë
keyCom∑ªFunc
;

983 
pTªe
->
‰ì
 = (*Ë
‰ìFunc
;

984 #ifde‡
ORDER_LIST_WANTED


985 
pTªe
->
pLi°Hódî
 =ÖTªe->
pLi°Taû
 = 
AVL_NULL
;

988 #i‡
OS
 == 3 || OS == 4

989 
pTªe
->
£m
 = 
	`£mBCª©e
(0 , 1);

990 if(!
pTªe
->
£m
)

992 
	`‰ì
((*)
pTªe
);

993  (
tAVLTªe
 *)0;

998  (
tAVLTªe
 *Ë
pTªe
;

999 
	}
}

1018 
	$avlTªeDñ
(
tAVLTªe
 *
pTªe
, 
TREE_NODE
 *
pDñNode
) {

1019 
ªt
 = 0;

1021 i‡(!
pTªe
 || !
pDñNode
 || !pTªe->
cou¡
)

1024 
ªt
 = 
	`avlTªeRemove
(
pTªe
, 
pDñNode
);

1025 i‡(
ªt
)

1026 
pTªe
->
cou¡
--;

1029 
	}
}

1045 
	gavlTªeDe°roy


1047 
tAVLTªe
 *
	gpTªe


1049 
TREE_NODE
 *
	gpNode
 = 
AVL_NULL
;

1050 i‡(!
	gpTªe
)

1053 
	gpNode
 = 
pTªe
->
pTªeHódî
) {

1054 
avlTªeDñ
(
pTªe
, 
pNode
);

1055 
AVL_TREENODE_FREE
(
pTªe
, 
pNode
);

1058 i‡(!
	gpTªe
->
	gcou¡
 || !pTªe->
	gpTªeHódî
) {

1059 #i‡
OS
 == 3 || OS == 4

1060 
£mDñëe
(
pTªe
->
£m
);

1062 
‰ì
((*Ë
pTªe
);

1082 
	gavlTªeFlush


1084 
tAVLTªe
 *
	gpTªe


1086 
TREE_NODE
 *
	gpNode
 = 
AVL_NULL
;

1088 i‡(!
	gpTªe
)

1091 i‡(!
	gpTªe
->
	gcou¡
 || !pTªe->
	gpTªeHódî
)

1094 
	gpNode
 = 
pTªe
->
pTªeHódî
) {

1095 
avlTªeDñ
(
pTªe
, 
pNode
);

1096 
AVL_TREENODE_FREE
(
pTªe
, 
pNode
);

1116 
	gavlTªeAdd


1118 
tAVLTªe
 *
	gpTªe
,

1119 
TREE_NODE
 *
	gpIn£πNode


1121 
	ggrowthFœg
 = 0, 
	gªt
 = 0;

1123 i‡(!
	gpTªe
 || !
	gpIn£πNode
)

1126 
	gªt
 = 
avlTªeIn£π
(
pTªe
, &pTªe->
pTªeHódî
, 
pIn£πNode
, &
growthFœg
);

1127 i‡(
	gªt
)

1128 
	gpTªe
->
	gcou¡
++;

1129  
	gªt
;

1147 
TREE_NODE
 *
	gavlTªeFöd


1149 
tAVLTªe
 *
	gpTªe
,

1150 
TREE_NODE
 *
	gpKeyNode


1152 i‡(!
	gpTªe
 || !pTªe->
	gcou¡
 || !pTªe->
	gpTªeHódî
)

1153  
	gAVL_NULL
;

1155  (
	gTREE_NODE
 *Ë
avlTªeLookup
(
pTªe
,ÖTªe->
pTªeHódî
, 
pKeyNode
);

1169 
	gavlTªeCou¡


1171 
tAVLTªe
 *
	gpTªe


1173 i‡(!
	gpTªe
)

1176  
	gpTªe
->
	gcou¡
;

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/avlTree.h

1 #i‚de‡
AVLTREE_H


2 
	#AVLTREE_H
 10000

	)

4 
	~<°rög.h
>

5 
	~<mÆloc.h
>

6 
	~<°dlib.h
>

8 
	#AVL_NULL
 (
TREE_NODE
 *)0

	)

10 
	#EH_FACTOR
 0

	)

11 
	#LH_FACTOR
 1

	)

12 
	#RH_FACTOR
 -1

	)

13 
	#LEFT_MINUS
 0

	)

14 
	#RIGHT_MINUS
 1

	)

17 
	#ORDER_LIST_WANTED


	)

19 
	#INSERT_PREV
 0

	)

20 
	#INSERT_NEXT
 1

	)

22 
	s_AVL_TREE_NODE
 {

23 #ifde‡
ORDER_LIST_WANTED


24 
_AVL_TREE_NODE
 *
	m¥ev
;

25 
_AVL_TREE_NODE
 *
	m√xt
;

27 
_AVL_TREE_NODE
 *
	måì_roŸ
;

28 
_AVL_TREE_NODE
 *
	mÀ·_chûd
;

29 
_AVL_TREE_NODE
 *
	mright_chûd
;

30 
	mbf
;

31 } 
	tTREE_NODE
;

33 
	sbuf„r_öfo
 {

34 
	mªad_hô
;

35 
	mªad_miss_hô
;

36 
	mwrôe_hô
;

37 
	mwrôe_miss_hô
;

38 
buf„r_group
 *
	mbuf„r_hód
;

39 
buf„r_group
 *
	mbuf„r_èû
;

41 
TREE_NODE
 *
	mpTªeHódî
;

43 
	mmax_buf„r_£˘‹
;

44 
	mbuf„r_£˘‹_cou¡
;

46 #ifde‡
ORDER_LIST_WANTED


47 
TREE_NODE
 *
	mpLi°Hódî
;

48 
TREE_NODE
 *
	mpLi°Taû
;

50 
	mcou¡
;

51 (*
	mkeyCom∑ª
)(
	mTREE_NODE
 *, TREE_NODE *);

53 (*
	m‰ì
)(
	mTREE_NODE
 *);

54 } 
	ttAVLTªe
;

57 
	sbuf„r_öfo_f‹_DFTL
 {

58 
	mªad_hô
;

59 
	mªad_miss_hô
;

60 
	mwrôe_hô
;

61 
	mwrôe_miss_hô
;

62 
buf„r_group_f‹_DFTL
 *
	mbuf„r_hód
;

63 
buf„r_group_f‹_DFTL
 *
	mbuf„r_èû
;

65 
TREE_NODE
 *
	mpTªeHódî
;

67 
	mmax_buf„r_size
;

68 
	mbuf„r_cuºít_size
;

70 #ifde‡
ORDER_LIST_WANTED


71 
TREE_NODE
 *
	mpLi°Hódî
;

72 
TREE_NODE
 *
	mpLi°Taû
;

74 
	mcou¡
;

75 (*
	mkeyCom∑ª
)(
	mTREE_NODE
 *, TREE_NODE *);

77 (*
	m‰ì
)(
	mTREE_NODE
 *);

78 } 
	ttAVLTªe_f‹_DFTL
;

85 
avlTªeHigh
(
TREE_NODE
 *);

87 
avlTªeCheck
(
tAVLTªe
 *, 
TREE_NODE
 *);

89 
R_RŸ©e
(
TREE_NODE
 **);

91 
L_RŸ©e
(
TREE_NODE
 **);

93 
Le·BÆ™˚
(
TREE_NODE
 **);

95 
RightBÆ™˚
(
TREE_NODE
 **);

97 
avlDñBÆ™˚
(
tAVLTªe
 *, 
TREE_NODE
 *, );

99 
AVL_TREE_LOCK
(
tAVLTªe
 *, );

101 
AVL_TREE_UNLOCK
(
tAVLTªe
 *);

103 
AVL_TREENODE_FREE
(
tAVLTªe
 *, 
TREE_NODE
 *);

105 #ifde‡
ORDER_LIST_WANTED


107 
‹dîLi°In£π
(
tAVLTªe
 *, 
TREE_NODE
 *, TREE_NODE *, );

109 
‹dîLi°Remove
(
tAVLTªe
 *, 
TREE_NODE
 *);

111 
TREE_NODE
 *
avlTªeFú°
(
tAVLTªe
 *);

113 
TREE_NODE
 *
avlTªeLa°
(
tAVLTªe
 *);

115 
TREE_NODE
 *
avlTªeNext
(TREE_NODE *
pNode
);

117 
TREE_NODE
 *
avlTªePªv
(TREE_NODE *
pNode
);

121 
avlTªeIn£π
(
tAVLTªe
 *, 
TREE_NODE
 **, TREE_NODE *, *);

123 
avlTªeRemove
(
tAVLTªe
 *, 
TREE_NODE
 *);

125 
TREE_NODE
 *
avlTªeLookup
(
tAVLTªe
 *, TREE_NODE *, TREE_NODE *);

127 
tAVLTªe
 *
avlTªeCª©e
(*, *);

129 
avlTªeDe°roy
(
tAVLTªe
 *);

131 
avlTªeFlush
(
tAVLTªe
 *);

133 
avlTªeAdd
(
tAVLTªe
 *, 
TREE_NODE
 *);

135 
avlTªeDñ
(
tAVLTªe
 *, 
TREE_NODE
 *);

137 
TREE_NODE
 *
avlTªeFöd
(
tAVLTªe
 *, TREE_NODE *);

139 
avlTªeCou¡
(
tAVLTªe
 *);

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/bi_list.c

1 
	~"bi_li°.h
"

2 
	~"debug.h
"

3 
	~<°dlib.h
>

6 
_bi_node
* 
	$¸óã_™d_öô_bi_node
(
Õn
, 
°©e
)

8 
_bi_node
* 
√w_node
 = (_bi_node*)
	`mÆloc
((_bi_node));

9 
√w_node
->
¥evNode
 = 
NULL
;

10 
√w_node
->
√xtNode
 = 
NULL
;

11 
√w_node
->
Õn_™d_°©e
[0] = 
Õn
;

12 
√w_node
->
Õn_™d_°©e
[1] = 
°©e
;

13  
√w_node
;

14 
	}
}

17 
	$dñ_bi_node
(
_bi_node
* 
node
)

19 if((
node
->
√xtNode
 =
NULL
Ë&& (node->
¥evNode
 == NULL)){

21 
	`‰ì
(
node
);

22 
node
 = 
NULL
;

26 if((
node
->
√xtNode
 =
NULL
Ë&& (node->
¥evNode
 != NULL)){

27 
node
->
¥evNode
->
√xtNode
 = 
NULL
;

31 if((
node
->
√xtNode
 !
NULL
Ë&& (node->
¥evNode
 == NULL)){

32 
node
->
√xtNode
->
¥evNode
 = 
NULL
;

35 
	`‰ì
(
node
);

36 
node
 = 
NULL
;

38 
	}
}

41 
_bi_li°
* 
	$¸óã_™d_öô_bi_li°
()

43 
_bi_li°
* 
√w_li°
 = (_bi_li°*)
	`mÆloc
((_bi_list));

44 
√w_li°
->
node_hód
 = 
NULL
;

45 
√w_li°
->
node_èû
 = 
NULL
;

46 
√w_li°
->
Àn
 = 0;

48  
√w_li°
;

49 
	}
}

56 
	$Õush
(
_bi_li°
* 
li°
, 
Õn
, 
°©e
)

58 
_bi_node
* 
√w_node
 = 
	`¸óã_™d_öô_bi_node
(
Õn
, 
°©e
);

60 
√w_node
->
√xtNode
 = 
li°
->
node_hód
;

62 if(
li°
->
node_hód
 !
NULL
){

63 
li°
->
node_hód
->
¥evNode
 = 
√w_node
;

66 
li°
->
node_hód
 = 
√w_node
;

67 if(
li°
->
Àn
 == 0){

68 
li°
->
node_èû
 = 
√w_node
;

70 
li°
->
Àn
++;

71 
	}
}

76 
	$dñ_bi_li°
(
_bi_li°
* 
li°
)

78 
i
 = 0;

79 
_bi_node
* 
ãmp
, *
ãmp1
;

81 if(
li°
->
Àn
 == 0){

82 
	`‰ì
(
li°
);

83 
li°
 = 
NULL
;

85 
ãmp
 = 
li°
->
node_hód
;

86 
i
=0; i<
li°
->
Àn
; i++){

87 
ãmp1
 = 
ãmp
->
√xtNode
;

88 
	`dñ_bi_node
(
ãmp
);

89 
ãmp
 = 
ãmp1
;

90 (
li°
->
Àn
) --;

92 
	`åa˚Eº‹_msg
("ö bûi°.c, dñëögÜi°, bi_li°Üí i†%d,", 
li°
->
Àn
);

97 
	}
}

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/bi_list.h

1 #i‚de‡ 
_BI_LIST_H


2 
	#_BI_LIST_H


	)

5 
	~<°dio.h
>

6 
	~<°dlib.h
>

8 
	s_bi_node
 {

9 
_bi_node
* 
	m¥evNode
;

10 
_bi_node
* 
	m√xtNode
;

11 
	mÕn_™d_°©e
[2];

13 }
	tbi_node
;

16 
_bi_node
* 
¸óã_™d_öô_bi_node
(
Õn
, 
°©e
);

18 
dñ_bi_node
(
_bi_node
* 
node
);

21 
	s_bi_li°
{

22 
_bi_node
* 
	mnode_hód
;

23 
_bi_node
* 
	mnode_èû
;

24 
	mÀn
;

26 }
	tbi_li°
;

28 
_bi_li°
* 
¸óã_™d_öô_bi_li°
();

33 
Õush
(
_bi_li°
* 
li°
, 
Õn
, 
°©e
);

39 
dñ_bi_li°
(
_bi_li°
* 
li°
);

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/debug.h

1 #i‚de‡
_SSDSIM_DEBUG_H


2 
	#_SSDSIM_DEBUG_H


	)

4 
	~<°dio.h
>

6 
	#com¥essi⁄_ªÀv™t


	)

7 
	#CONFIG_TRACE_WRITE_PROCESS


	)

8 
	#CONFIG_TRACE_READ_PROCESS


	)

9 
	#CONFIG_BUFFER_MONITOR_ENTRY


	)

10 
	#CONFIG_BUFFER_MONITOR_TRANS


	)

11 
	#CONFIG_BUFFER_MONITOR_COMPRESSION_TRANS


	)

18 
	#CONFIG_ENABLE_MSG


	)

19 
	#CONFIG_WRONG_PROCESS_DEBUG_ENABLE_MSG


	)

21 #ifde‡
CONFIG_ENABLE_MSG


22 
	#ssdsim_msg
(
fmt
, ...) \

24 
	`¥ötf
("ssdsim:" 
fmt
 "\n", ##
__VA_ARGS__
);\

25 }0);

	)

29 
	#ssdsim_msg
(
fmt
, ...)

	)

36 #ifde‡
CONFIG_WRONG_PROCESS_DEBUG_ENABLE_MSG


37 
	#åa˚Eº‹_msg
(
fmt
, ...) \

39 
	`¥ötf
("simuœt‹Åø˚:" 
fmt
 "\n", ##
__VA_ARGS__
);\

40 }0);

	)

44 
	#åa˚Eº‹_msg
(
fmt
, ...)

	)

49 #ifde‡
CONFIG_TRACE_READ_PROCESS


50 
	#åa˚Ród_msg
(
fmt
, ...) \

52 
	`¥ötf
("simuœt‹Åø˚Ñód:" 
fmt
 "\n", ##
__VA_ARGS__
);\

53 }0);

	)

57 
	#åa˚Ród_msg
(
fmt
, ...)

	)

61 #ifde‡
CONFIG_TRACE_WRITE_PROCESS


62 
	#åa˚Wrôe_msg
(
fmt
, ...) \

64 
	`¥ötf
("simuœt‹Åø˚ wrôe:" 
fmt
 "\n", ##
__VA_ARGS__
);\

65 }0);

	)

69 
	#åa˚Wrôe_msg
(
fmt
, ...)

	)

74 #ifde‡
CONFIG_BUFFER_MONITOR_ENTRY


75 
	#åa˚E¡rybuf„r_msg
(
fmt
, ...) \

77 
	`¥ötf
("simuœt‹Åø˚ buf„∏íåy:" 
fmt
 "\n", ##
__VA_ARGS__
);\

78 }0);

	)

82 
	#åa˚E¡rybuf„r_msg
(
fmt
, ...)

	)

90 #ifde‡
CONFIG_BUFFER_MONITOR_TRANS


91 
	#åa˚Tøn¶©i⁄buf„r_msg
(
fmt
, ...) \

93 
	`¥ötf
("simuœt‹Åø˚ buf„∏å™¶©i⁄Öages:" 
fmt
 "\n", ##
__VA_ARGS__
);\

94 }0);

	)

98 
	#åa˚Tøn¶©i⁄buf„r_msg
(
fmt
, ...)

	)

106 #ifde‡
CONFIG_BUFFER_MONITOR_COMPRESSION_TRANS


107 
	#åa˚CompTøn¶©i⁄buf„r_msg
(
fmt
, ...) \

109 
	`¥ötf
("simuœt‹Åø˚ buf„∏com¥essi⁄Åøn¶©i⁄Öages:" 
fmt
 "\n", ##
__VA_ARGS__
);\

110 }0);

	)

114 
	#åa˚CompTøn¶©i⁄buf„r_msg
(
fmt
, ...)

	)

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/dictionary.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~"di˘i⁄¨y.h
"

5 
DIC_ENTRY
* 
	$¸óãE¡ry
(
vÆue
)

7  
	`¸óãNode
(
vÆue
);

8 
	}
}

9 
DICTIONARY
* 
	$¸óãDi˘i⁄¨y
()

11 
DICTIONARY
* 
√wDi˘i⁄¨y
 = (DICTIONARY*Ë
	`mÆloc
((DICTIONARY));

12 
	`öôLi°
(
√wDi˘i⁄¨y
);

13  
√wDi˘i⁄¨y
;

14 
	}
}

15 
	$de°royDi˘i⁄¨y
(
DICTIONARY
* 
di˘i⁄¨y
)

17 
DIC_ENTRY
* 
curE¡ry
;

18 
	`numE¡ry
(
di˘i⁄¨y
) != 0)

20 
curE¡ry
 = 
	`gëE¡ry
(-1, 
di˘i⁄¨y
);

21 
	`dñëeNode
(
curE¡ry
, 
di˘i⁄¨y
);

22 
	`‰ì
(
curE¡ry
);

24 
	`‰ì
(
di˘i⁄¨y
);

25 
	}
}

27 
	$numE¡ry
(
DICTIONARY
* 
di˘i⁄¨y
)

29  
di˘i⁄¨y
->
numNode
;

30 
	}
}

32 
	$gëVÆueOfE¡ry
(
DIC_ENTRY
* 
íåy
)

34  
íåy
->
vÆue
;

35 
	}
}

37 
DIC_ENTRY
* 
	$gëNextE¡ry
(
DIC_ENTRY
* 
íåy
)

39  
íåy
->
√xtNode
;

40 
	}
}

42 
DIC_ENTRY
* 
	$gëPªvE¡ry
(
DIC_ENTRY
* 
íåy
)

44  
íåy
->
¥evNode
;

45 
	}
}

47 
DIC_ENTRY
* 
	$gëE¡ry
(
ödex
, 
DICTIONARY
* 
di˘i⁄¨y
)

49  
	`gëNode
(
ödex
, 
di˘i⁄¨y
);

50 
	}
}

52 
	$moveFr⁄t
(
DIC_ENTRY
* 
íåy
, 
DICTIONARY
* 
di˘i⁄¨y
)

54 
	`dñëeNode
(
íåy
, 
di˘i⁄¨y
);

55  
	`ö£πNode
(0, 
íåy
, 
di˘i⁄¨y
);

56 
	}
}

58 
	$ö£πE¡ry
(
ödex
, 
DIC_ENTRY
* 
íåy
, 
DICTIONARY
* 
di˘i⁄¨y
)

60 
DIC_ENTRY
* 
curNode
;

61 if(
	`ö£πNode
(
ödex
, 
íåy
, 
di˘i⁄¨y
) == -1)

63 
	`¥ötf
("dictionary ERROR: insertion failed\n");

66 if(
	`numE¡ry
(
di˘i⁄¨y
Ë> 
DICTIONARY_SIZE
)

68 
curNode
 = 
	`gëNode
(-1, 
di˘i⁄¨y
);

69 
	`dñëeNode
(
curNode
, 
di˘i⁄¨y
);

70 
	`‰ì
(
curNode
);

73 
	}
}

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/dictionary.h

1 #i‚de‡
_DICTIONARY_H


2 
	#_DICTIONARY_H


	)

4 
	~"js_li°.h
"

6 
	#DICTIONARY_SIZE
 255

	)

7 
	#LOG_DICTIONARY_SIZE
 8

	)

9 
	#DICTIONARY
 
jsLi°


	)

10 
	#DIC_ENTRY
 
nodeJSLi°


	)

12 
DIC_ENTRY
* 
¸óãE¡ry
(
vÆue
);

13 
DICTIONARY
* 
¸óãDi˘i⁄¨y
();

14 
de°royDi˘i⁄¨y
(
DICTIONARY
* 
di˘i⁄¨y
);

15 
numE¡ry
(
DICTIONARY
* 
di˘i⁄¨y
);

16 
gëVÆueOfE¡ry
(
DIC_ENTRY
* 
íåy
);

17 
DIC_ENTRY
* 
gëNextE¡ry
(DIC_ENTRY* 
íåy
);

18 
DIC_ENTRY
* 
gëPªvE¡ry
(DIC_ENTRY* 
íåy
);

19 
DIC_ENTRY
* 
gëE¡ry
(
ödex
, 
DICTIONARY
* 
di˘i⁄¨y
);

20 
moveFr⁄t
(
DIC_ENTRY
* 
íåy
, 
DICTIONARY
* 
di˘i⁄¨y
);

21 
ö£πE¡ry
(
ödex
, 
DIC_ENTRY
* 
íåy
, 
DICTIONARY
* 
di˘i⁄¨y
);

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/diffXmatch.c

1 #i‚de‡
_DIFFXMATCH_C


2 
	#_DIFFXMATCH_C


	)

4 
	~<°dio.h
>

5 
	~<°dlib.h
>

6 
	~<°rög.h
>

7 
	~<mÆloc.h
>

8 
	~"diffXm©ch.h
"

10 
	$diffcom¥ess
(* 
ªf
, * 
§c
, * 
de°
)

12 
i
, 
ªtVÆue
;

13 
ãmp
[
CHUNKSIZE
 * 2];

15 
i
 = 0 ; i < 
CHUNKSIZE
 ; i++)

17 
ãmp
[
i
] = (
ªf
[i] ^ 
§c
[i]);

20 
ªtVÆue
 = 
	`xm©chCom¥ess
(
ãmp
, 
CHUNKSIZE
, 
de°
);

22  
ªtVÆue
;

23 
	}
}

25 
	$diffdecom¥ess
(* 
ªf
, * 
§c
, * 
de°
, 
öputSize
)

27 
i
, 
ªtVÆue
;

28 
ãmp
[
CHUNKSIZE
];

30 
ªtVÆue
 = 
	`xm©chDecom¥ess
(
§c
, 
öputSize
, 
ãmp
);

32 
i
 = 0 ; i < 
CHUNKSIZE
 ; i++)

34 
de°
[
i
] = (
ªf
[i] ^ 
ãmp
[i]);

37  
ªtVÆue
;

38 
	}
}

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/diffXmatch.h

1 
	~"xm©chPro.h
"

3 
	#CHUNKSIZE
 4096

	)

5 
diffcom¥ess
(* 
ªf
, * 
§c
, * 
de°
);

6 
diffdecom¥ess
(* 
ªf
, * 
§c
, * 
de°
, 
öputSize
);

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/flash.c

19 
	~"Êash.h
"

20 
	~"ssd.h
"

21 
	#NUMBER_OF_WRITE_ITERATION
 3

	)

24 
	$¨ønge_the_loˇti⁄_by_Õn
(
ssd_öfo
* 
ssd
, 
sub_ªque°
* 
sub_ªq
)

26 
loˇti⁄_bef‹e
 = -1;

27 
ãmp_tŸÆ_∂™e
 = (
ssd
->
∑ømëî
->
ch™√l_numbî
Ë* (ssd->∑ømëî->
chù_ch™√l
[0]Ë* (ssd->∑ømëî->
dõ_chù
Ë* (ssd->∑ømëî->
∂™e_dõ
);

29 
loˇti⁄_bef‹e
 = 
sub_ªq
->
Õn
 % 
ãmp_tŸÆ_∂™e
;

31 
sub_ªq
->
loˇti⁄
->
ch™√l
 = 
loˇti⁄_bef‹e
 % ( (
ssd
->
∑ømëî
->
ch™√l_numbî
)*(ssd->∑ømëî->
chù_ch™√l
[0]) ) % (ssd->parameter->channel_number);

32 
sub_ªq
->
loˇti⁄
->
chù
 = 
loˇti⁄_bef‹e
 % ( (
ssd
->
∑ømëî
->
ch™√l_numbî
)*(ssd->∑ømëî->
chù_ch™√l
[0]) ) / (ssd->parameter->channel_number);

34 
sub_ªq
->
loˇti⁄
->
dõ
 = 
loˇti⁄_bef‹e
 / ( (
ssd
->
∑ømëî
->
ch™√l_numbî
)*(ssd->∑ømëî->
chù_ch™√l
[0]ËË/ (ssd->∑ømëî->
∂™e_dõ
);

36 
sub_ªq
->
loˇti⁄
->
∂™e
 = 
loˇti⁄_bef‹e
 / ( (
ssd
->
∑ømëî
->
ch™√l_numbî
)*(ssd->∑ømëî->
chù_ch™√l
[0]ËË% (ssd->∑ømëî->
∂™e_dõ
);

40 
	}
}

46 
Sètus
 
	$Æloˇã_loˇti⁄
(
ssd_öfo
 *
ssd
, 
sub_ªque°
 *
sub_ªq
) {

47 
sub_ªque°
 *
upd©e
 = 
NULL
;

48 
ch™√l_num
 = 0, 
chù_num
 = 0, 
dõ_num
 = 0, 
∂™e_num
 = 0;

49 
loˇl
 *
loˇti⁄
 = 
NULL
;

51 
ch™√l_num
 = 
ssd
->
∑ømëî
->
ch™√l_numbî
;

52 
chù_num
 = 
ssd
->
∑ømëî
->
chù_ch™√l
[0];

53 
dõ_num
 = 
ssd
->
∑ømëî
->
dõ_chù
;

54 
∂™e_num
 = 
ssd
->
∑ømëî
->
∂™e_dõ
;

55 #ifde‡
DEBUG_CURR_TIME


56 
	`¥ötf
("cuºít_timêi†%Œd i¿Æloˇã_loˇti⁄ fun˘i⁄,ánd ssdsimÖ¨amëî hîêi† ch™√ um %d, chùnum %d, dõnum %d,Öœ√Çum%d\n", 
ssd
->
cuºít_time
, 
ch™√l_num
, 
chù_num
, 
dõ_num
, 
∂™e_num
);

60 i‡(
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 == 0)

66 i‡(
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub_ªq
->
Õn
].
°©e
 != 0) {

67 i‡((
sub_ªq
->
°©e
 & 
ssd
->
døm
->
m≠
->
m≠_íåy
[sub_ªq->
Õn
].state) !=

68 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub_ªq
->
Õn
].
°©e
) {

69 #ifde‡
DEBUG


70 
	`¥ötf
("©Üó° , wrôêªque° should bêÊushed i¡ÿÊashcuºít_timêi†%Œd i¿Æloˇã_loˇti⁄ fun˘i⁄\n", 
ssd
->
cuºít_time
);

73 
ssd
->
ªad_cou¡
++;

74 
ssd
->
upd©e_ªad_cou¡
++;

76 
upd©e
 = (
sub_ªque°
 *Ë
	`mÆloc
((sub_request));

77 
	`Æloc_as£π
(
upd©e
, "update");

78 
	`mem£t
(
upd©e
, 0, (
sub_ªque°
));

80 i‡(
upd©e
 =
NULL
) {

81  
ERROR
;

83 
upd©e
->
loˇti⁄
 = 
NULL
;

84 
upd©e
->
√xt_node
 = 
NULL
;

85 
upd©e
->
√xt_subs
 = 
NULL
;

86 
upd©e
->upd©ê
NULL
;

87 
loˇti⁄
 = 
	`föd_loˇti⁄
(
ssd
, ssd->
døm
->
m≠
->
m≠_íåy
[
sub_ªq
->
Õn
].
≤
);

88 
upd©e
->
loˇti⁄
 =Üocation;

89 
upd©e
->
begö_time
 = 
ssd
->
cuºít_time
;

90 
upd©e
->
cuºít_°©e
 = 
SR_WAIT
;

91 
upd©e
->
cuºít_time
 = 
MAX_INT64
;

92 #ifde‡
DEBUG_CURR_TIME


93 
	`¥ötf
("cuºít_timêi†%Œd i¿áŒoˇã_loˇti⁄ fun˘i⁄ m≠_íåy[xx].°©e!=0ánd dy«mi¯Æloˇti⁄\n", 
ssd
->
cuºít_time
);

96 
upd©e
->
√xt_°©e
 = 
SR_R_C_A_TRANSFER
;

97 
upd©e
->
√xt_°©e_¥edi˘_time
 = 
MAX_INT64
;

98 
upd©e
->
Õn
 = 
sub_ªq
->lpn;

99 
upd©e
->
°©e
 = ((
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub_ªq
->
Õn
].state ^ sub_req->state) & 0x7fffffff);

100 
upd©e
->
size
 = 
	`size
(upd©e->
°©e
);

101 
upd©e
->
µn
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub_ªq
->
Õn
].
≤
;

102 
upd©e
->
›î©i⁄
 = 
READ
;

105 i‡((
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
subs_r_hód
 !
NULL
 )&& (ssd->ch™√l_hód[loˇti⁄->ch™√l].
subs_r_èû
 !=

106 
NULL
) )

109 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
subs_r_èû
->
√xt_node
 = 
upd©e
;

110 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
subs_r_èû
 = 
upd©e
;

112 if(
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
chù_ªad_queue_Àngth
 != 0){

113 
	`¥ötf
("lxclxclxc,wrong \n");

115 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
subs_r_èû
 = 
upd©e
;

116 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
subs_r_hód
 = 
upd©e
;

125 
ssd
->
∑ømëî
->
dy«mic_Æloˇti⁄
) {

127 
sub_ªq
->
loˇti⁄
->
ch™√l
 = -1;

128 
sub_ªq
->
loˇti⁄
->
chù
 = -1;

129 
sub_ªq
->
loˇti⁄
->
dõ
 = -1;

130 
sub_ªq
->
loˇti⁄
->
∂™e
 = -1;

131 
sub_ªq
->
loˇti⁄
->
block
 = -1;

132 
sub_ªq
->
loˇti⁄
->
∑ge
 = -1;

134 i‡(
ssd
->
subs_w_èû
 !
NULL
) {

135 
ssd
->
subs_w_èû
->
√xt_node
 = 
sub_ªq
;

136 
ssd
->
subs_w_èû
 = 
sub_ªq
;

138 
ssd
->
subs_w_èû
 = 
sub_ªq
;

139 
ssd
->
subs_w_hód
 = 
sub_ªq
;

142 i‡(
upd©e
 !
NULL
) {

143 
sub_ªq
->
upd©e
 = update;

150 
sub_ªq
->
loˇti⁄
->
ch™√l
 = sub_ªq->
Õn
 % 
ssd
->
∑ømëî
->
ch™√l_numbî
;

151 
sub_ªq
->
loˇti⁄
->
chù
 = -1;

152 
sub_ªq
->
loˇti⁄
->
dõ
 = -1;

153 
sub_ªq
->
loˇti⁄
->
∂™e
 = -1;

154 
sub_ªq
->
loˇti⁄
->
block
 = -1;

155 
sub_ªq
->
loˇti⁄
->
∑ge
 = -1;

157 i‡(
upd©e
 !
NULL
) {

158 
sub_ªq
->
upd©e
 = update;

177 #ifde‡
DEBUGSUSPEND


178 
	`¥ötf
("hîêi†°©ic_Æloˇti⁄ i¿ÆloˇãÜoˇti⁄....,™d så©egy i†%d, \n", 
ssd
->
∑ømëî
->
°©ic_Æloˇti⁄
);

181 
ssd
->
∑ømëî
->
°©ic_Æloˇti⁄
) {

184 
sub_ªq
->
loˇti⁄
->
ch™√l
 = (sub_ªq->
Õn
 / (
∂™e_num
 * 
dõ_num
 * 
chù_num
)Ë% 
ch™√l_num
;

185 
sub_ªq
->
loˇti⁄
->
chù
 = sub_ªq->
Õn
 % 
chù_num
;

186 
sub_ªq
->
loˇti⁄
->
dõ
 = (sub_ªq->
Õn
 / 
chù_num
Ë% 
dõ_num
;

187 
sub_ªq
->
loˇti⁄
->
∂™e
 = (sub_ªq->
Õn
 / (
dõ_num
 * 
chù_num
)Ë% 
∂™e_num
;

192 
	`¥ötf
("in case 1\n");

193 
sub_ªq
->
loˇti⁄
->
ch™√l
 = sub_ªq->
Õn
 % 
ch™√l_num
;

194 
sub_ªq
->
loˇti⁄
->
chù
 = (sub_ªq->
Õn
 / 
ch™√l_num
Ë% 
chù_num
;

195 
sub_ªq
->
loˇti⁄
->
dõ
 = (sub_ªq->
Õn
 / (
chù_num
 * 
ch™√l_num
)Ë% 
dõ_num
;

196 
sub_ªq
->
loˇti⁄
->
∂™e
 = (sub_ªq->
Õn
 / (
dõ_num
 * 
chù_num
 * 
ch™√l_num
)Ë% 
∂™e_num
;

201 
	`¥ötf
("in case 2\n");

202 
	`¨ønge_the_loˇti⁄_by_Õn
(
ssd
, 
sub_ªq
);

210 
sub_ªq
->
loˇti⁄
->
ch™√l
 = sub_ªq->
Õn
 % 
ch™√l_num
;

211 
sub_ªq
->
loˇti⁄
->
chù
 = (sub_ªq->
Õn
 / (
dõ_num
 * 
ch™√l_num
)Ë% 
chù_num
;

212 
sub_ªq
->
loˇti⁄
->
dõ
 = (sub_ªq->
Õn
 / 
ch™√l_num
Ë% 
dõ_num
;

213 
sub_ªq
->
loˇti⁄
->
∂™e
 = (sub_ªq->
Õn
 / (
dõ_num
 * 
chù_num
 * 
ch™√l_num
)Ë% 
∂™e_num
;

217 
sub_ªq
->
loˇti⁄
->
ch™√l
 = sub_ªq->
Õn
 % 
ch™√l_num
;

218 
sub_ªq
->
loˇti⁄
->
chù
 = (sub_ªq->
Õn
 / (
∂™e_num
 * 
dõ_num
 * 
ch™√l_num
)Ë% 
chù_num
;

219 
sub_ªq
->
loˇti⁄
->
dõ
 = (sub_ªq->
Õn
 / (
∂™e_num
 * 
ch™√l_num
)Ë% 
dõ_num
;

220 
sub_ªq
->
loˇti⁄
->
∂™e
 = (sub_ªq->
Õn
 / 
ch™√l_num
Ë% 
∂™e_num
;

225 
sub_ªq
->
loˇti⁄
->
ch™√l
 = sub_ªq->
Õn
 % 
ch™√l_num
;

226 
sub_ªq
->
loˇti⁄
->
chù
 = (sub_ªq->
Õn
 / (
∂™e_num
 * 
dõ_num
 * 
ch™√l_num
)Ë% 
chù_num
;

227 
sub_ªq
->
loˇti⁄
->
dõ
 = (sub_ªq->
Õn
 / 
ch™√l_num
Ë% 
dõ_num
;

228 
sub_ªq
->
loˇti⁄
->
∂™e
 = (sub_ªq->
Õn
 / (
dõ_num
 * 
ch™√l_num
)Ë% 
∂™e_num
;

233  
ERROR
;

237 #ifde‡
DEBUGSUSPEND


238 
	`¥ötf
("a·î sèti¯Æloˇti⁄.....now, wrôêªque° cª©ed i¿ch™√»%d, chù %d, dõ %d,Öœ√ %d\n",
sub_ªq
->
loˇti⁄
->
ch™√l
,sub_ªq->loˇti⁄->
chù
,sub_ªq->loˇti⁄->
dõ
, sub_ªq->loˇti⁄->
∂™e
);

242 i‡–(
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub_ªq
->
Õn
].
°©e
 !=

243 0Ë&& (
sub_ªq
->
waô_evi˘_sign
 == 0) ) {

244 i‡((
sub_ªq
->
°©e
 & 
ssd
->
døm
->
m≠
->
m≠_íåy
[sub_ªq->
Õn
].state) !=

245 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub_ªq
->
Õn
].
°©e
) {

246 #ifde‡
DEBUGSUSPEND


247 
	`¥ötf
("should create update for writeÇow.\n");

250 
ssd
->
ªad_cou¡
++;

251 
ssd
->
upd©e_ªad_cou¡
++;

252 
upd©e
 = (
sub_ªque°
 *Ë
	`mÆloc
((sub_request));

253 
	`Æloc_as£π
(
upd©e
, "update");

254 
	`mem£t
(
upd©e
, 0, (
sub_ªque°
));

256 i‡(
upd©e
 == 0x0) {

257 #ifde‡
DEBUGSUSPEND


258 
	`¥ötf
("lxclxc, wrong in creating updateÑead for write .\n");

263  
ERROR
;

265 
upd©e
->
loˇti⁄
 = 
NULL
;

266 
upd©e
->
√xt_node
 = 
NULL
;

267 
upd©e
->
√xt_subs
 = 
NULL
;

268 
upd©e
->upd©ê
NULL
;

269 
loˇti⁄
 = 
	`föd_loˇti⁄
(
ssd
, ssd->
døm
->
m≠
->
m≠_íåy
[
sub_ªq
->
Õn
].
≤
);

270 if(
loˇti⁄
 == 0x0){

272 
	`¥ötf
("lxc, wrôe'†upd©êÕ¿%d, sizê%d,Ñeque° %Œd, o≥øti⁄ %d ha†wr⁄gÇow\n", 
sub_ªq
->
Õn
,sub_ªq->
size
, sub_ªq,sub_ªq->
›î©i⁄
);

273 
	`¥ötf
("lxclxc, wrong in creating updateÑead for write .\n");

278 
upd©e
->
loˇti⁄
 =Üocation;

279 
upd©e
->
begö_time
 = 
ssd
->
cuºít_time
;

280 #ifde‡
DEBUG_CURR_TIME


281 
	`¥ötf
("cuºít_timêi†%Œd i¿áŒoˇã_loˇti⁄ fun˘i⁄ m≠_íåy[xx].°©e!=0ánd sèti¯Æloˇti⁄\n", 
ssd
->
cuºít_time
);

285 
upd©e
->
cuºít_°©e
 = 
SR_WAIT
;

286 
upd©e
->
cuºít_time
 = 
MAX_INT64
;

287 
upd©e
->
√xt_°©e
 = 
SR_R_C_A_TRANSFER
;

288 
upd©e
->
√xt_°©e_¥edi˘_time
 = 
MAX_INT64
;

289 
upd©e
->
Õn
 = 
sub_ªq
->lpn;

290 
upd©e
->
°©e
 = ((
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub_ªq
->
Õn
].state ^ sub_req->state) & 0x7fffffff);

291 
upd©e
->
size
 = 
	`size
(upd©e->
°©e
);

292 
upd©e
->
µn
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub_ªq
->
Õn
].
≤
;

293 
upd©e
->
›î©i⁄
 = 
READ
;

294 #ifde‡
DEBUGSUSPEND


295 
	`¥ötf
("hîêbuà•ecü»f‹ wrôe!!áddÑód, fú° sîvi˚Ñód,now.ÑódÜoˇti⁄ i†ch™√l%d, chù %d, dõ %d,∂™ê%d,Ö≤ %d\n",
upd©e
->
loˇti⁄
->
ch™√l
, upd©e->loˇti⁄->
chù
,upd©e->loˇti⁄->
dõ
,upd©e->loˇti⁄->
∂™e
 ,upd©e->
µn
 );

299 if–(
ssd
->
ch™√l_hód
[
upd©e
->
loˇti⁄
->
ch™√l
].
subs_r_hód
 !
NULL
)&&(ssd->ch™√l_hód[upd©e->loˇti⁄->ch™√l].
subs_r_èû
 != NULL) ){

300 #ifde‡
DEBUGSUSPEND


301 
	`¥ötf
("hîêmón†sus_r_èû i†nŸ NULL , hîêi†ch™√»[%d], chù [%d],ha†thêèûáddªs†%Œd,upd©êaddªs†i†%Œd\n",
upd©e
->
loˇti⁄
->
ch™√l
, upd©e->loˇti⁄->
chù
,
ssd
->
ch™√l_hód
[upd©e->loˇti⁄->ch™√l].
subs_r_èû
, update );

304 
ssd
->
ch™√l_hód
[
upd©e
->
loˇti⁄
->
ch™√l
].
subs_r_èû
->
√xt_node
 = update;

305 
ssd
->
ch™√l_hód
[
upd©e
->
loˇti⁄
->
ch™√l
].
subs_r_èû
 = update;

306 } i‡((
ssd
->
ch™√l_hód
[
upd©e
->
loˇti⁄
->
ch™√l
].
subs_r_hód
 =
NULL
Ë&& (ssd->ch™√l_hód[upd©e->loˇti⁄->ch™√l].
subs_r_èû
 == NULL)){

307 if(
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
chù_ªad_queue_Àngth
 != 0){

308 
	`¥ötf
("lxclxclxc, wrong\n");

311 
ssd
->
ch™√l_hód
[
upd©e
->
loˇti⁄
->
ch™√l
].
subs_r_èû
 = update;

312 
ssd
->
ch™√l_hód
[
upd©e
->
loˇti⁄
->
ch™√l
].
subs_r_hód
 = update;

314 
	`¥ötf
("lxclxclxc2,áddedÑead wrong\n");

316 #ifde‡
DEBUGSUSPEND


317 
	`¥ötf
("addedÑód hîêi†ch™√»[%d], chù [%d],ha†thêèûáddªs†%Œd,upd©êaddªs†i†%Œd\n",
upd©e
->
loˇti⁄
->
ch™√l
, upd©e->loˇti⁄->
chù
,
ssd
->
ch™√l_hód
[upd©e->loˇti⁄->ch™√l].
subs_r_èû
, update );

321 i‡(
upd©e
 !
NULL
) {

323 
sub_ªq
->
upd©e
 = update;

324 
sub_ªq
->
°©e
 = (sub_ªq->°©ê| 
upd©e
->state);

325 
sub_ªq
->
size
 = 
	`size
(sub_ªq->
°©e
);

328 
ssd
->
ch™√l_hód
[
upd©e
->
loˇti⁄
->
ch™√l
].
chù_hód
[upd©e->loˇti⁄->
chù
].
chù_ªad_queue_Àngth
 ++;

329 
	`¥ötf
("added upd©ê%Œd,Üoˇti⁄ i†%Œd\n",
upd©e
, upd©e->
loˇti⁄
);

330 if(
upd©e
->
loˇti⁄
 =
NULL
){

331 
	`¥ötf
("lxclxclxc_updatelocation wrong\n");

338 
	`¥ötf
("now ch™√»%d, chù %dÜígth i†%d, hódáddªs†%Œd,Åaûáddªs†%Œd , sub %Œd\n", 
loˇti⁄
->
ch™√l
,Üoˇti⁄->
chù
, 
ssd
->
ch™√l_hód
[loˇti⁄->ch™√l].
chù_hód
[loˇti⁄->chù].
chù_ªad_queue_Àngth
, ssd->ch™√l_hód[loˇti⁄->ch™√l].
subs_r_hód
,ssd->ch™√l_hód[loˇti⁄->ch™√l].
subs_r_èû
, 
upd©e
);

340 if(
upd©e
->
loˇti⁄
 =
NULL
){

342 
	`¥ötf
("√w cª©Ñód upd©êÜoˇti⁄ i†ch™√»%d, chù %d, dõ %d,Öœ√ %d\n",
loˇti⁄
->
ch™√l
,loˇti⁄->
chù
,loˇti⁄->
dõ
,loˇti⁄->
∂™e
);

352 if(
sub_ªq
->
loˇti⁄
 =
NULL
){

353 
	`¥ötf
("√w cª© wrôêloˇti⁄ i†ch™√»%d, chù %d, dõ %d,Öœ√ %d\n",
sub_ªq
->
loˇti⁄
->
ch™√l
,sub_ªq->loˇti⁄->
chù
,sub_ªq->loˇti⁄->
dõ
,sub_ªq->loˇti⁄->
∂™e
);

359 
ssd
->
ch™√l_hód
[
sub_ªq
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub_ªq->loˇti⁄->
chù
].
chù_wrôe_queue_Àngth
 ++;

360 #ifde‡
DEBUGSUSPEND


361 
	`¥ötf
("ch™√l[%d], chù[%d], wrôêÀngthádd o√ i†[%d]\n",
sub_ªq
->
loˇti⁄
->
ch™√l
, sub_ªq->loˇti⁄->
chù
, 
ssd
->
ch™√l_hód
[sub_ªq->loˇti⁄->ch™√l].
chù_hód
[sub_ªq->loˇti⁄->chù].
chù_wrôe_queue_Àngth
);

364 i‡((
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 !0Ë|| (ssd->∑ømëî->
dy«mic_Æloˇti⁄
 != 0)) {

365 if–(
ssd
->
ch™√l_hód
[
sub_ªq
->
loˇti⁄
->
ch™√l
].
subs_w_èû
 !
NULL
Ë&& (ssd->ch™√l_hód[sub_ªq->loˇti⁄->ch™√l].
subs_w_hód
 != NULL) ) {

366 
ssd
->
ch™√l_hód
[
sub_ªq
->
loˇti⁄
->
ch™√l
].
subs_w_èû
->
√xt_node
 = sub_req;

367 
ssd
->
ch™√l_hód
[
sub_ªq
->
loˇti⁄
->
ch™√l
].
subs_w_èû
 = sub_req;

368 } if–(
ssd
->
ch™√l_hód
[
sub_ªq
->
loˇti⁄
->
ch™√l
].
subs_w_èû
 =
NULL
Ë&& (ssd->ch™√l_hód[sub_ªq->loˇti⁄->ch™√l].
subs_w_hód
 == NULL)){

369 
ssd
->
ch™√l_hód
[
sub_ªq
->
loˇti⁄
->
ch™√l
].
subs_w_èû
 = sub_req;

370 
ssd
->
ch™√l_hód
[
sub_ªq
->
loˇti⁄
->
ch™√l
].
subs_w_hód
 = sub_req;

372 
	`¥ötf
("writewrong\n");

384  
SUCCESS
;

385 
	}
}

391 
ssd_öfo
 *

392 
	$ö£π2buf„r
(
ssd_öfo
 *
ssd
, 
Õn
, 
°©e
, 
sub_ªque°
 *
sub
, 
ªque°
 *
ªq
) {

393 
wrôe_back_cou¡
, 
Êag
 = 0;

394 
i
, 
l¢
, 
hô_Êag
, 
add_Êag
, 
£˘‹_cou¡
, 
a˘ive_ªgi⁄_Êag
 = 0, 
‰ì_£˘‹
 = 0;

395 
buf„r_group
 *
buf„r_node
 = 
NULL
, *
±
, *
√w_node
 = NULL, 
key
;

396 
sub_ªque°
 *
sub_ªq
 = 
NULL
, *
upd©e
 = NULL;

399 
sub_ªq_°©e
 = 0, 
sub_ªq_size
 = 0, 
sub_ªq_Õn
 = 0;

401 #ifde‡
DEBUG_CURR_TIME


402 
	`¥ötf
("íã∏ö£π2buf„r,Åhi†i†ªÆÜ≤ (⁄êby o√Ë‰omÑó»ssd->ªque°_èû,Åh© món†Æsÿthê√wÑeque°. cuºíàtime:%Œd,Ü≤:%d, sèã:%d, .sÿbuf„r->èûÑeq'†l¢ i†%d, sizêi†%d, o≥øti⁄ i†%d\n",
ssd
->
cuºít_time
,
Õn
,
°©e
, 
ªq
->
l¢
,Ñeq->
size
,Ñeq->
›î©i⁄
);

405 
£˘‹_cou¡
 = 
	`size
(
°©e
);

406 
key
.
group
 = 
Õn
;

407 
buf„r_node
 = (
buf„r_group
 *Ë
	`avlTªeFöd
(
ssd
->
døm
->
buf„r
,

408 (
TREE_NODE
 *Ë&
key
);

417 #ifde‡
DEBUG


418 
	`¥ötf
("buf„r_nodêi†%d\n",
buf„r_node
);

420 i‡(
buf„r_node
 =
NULL
) {

421 #ifde‡
DEBUG


422 
	`¥ötf
("buffer_node hasÇot been hitted\n");

425 
‰ì_£˘‹
 = 
ssd
->
døm
->
buf„r
->
max_buf„r_£˘‹
 - ssd->døm->buf„r->
buf„r_£˘‹_cou¡
;

426 i‡(
‰ì_£˘‹
 >
£˘‹_cou¡
) {

427 
Êag
 = 1;

429 i‡(
Êag
 == 0) {

430 #ifde‡
DEBUG


431 
	`¥ötf
("buf„∏nŸ hô, fªe_£˘‹Ñemaöed i†%d,√ed wrôêötÿ£˘‹_cou¡ i†%d\n",
‰ì_£˘‹
, 
£˘‹_cou¡
);

434 
wrôe_back_cou¡
 = 
£˘‹_cou¡
 - 
‰ì_£˘‹
;

436 if(
wrôe_back_cou¡
 > 0){

437 
ssd
->
døm
->
buf„r
->
wrôe_miss_hô
 = ssd->døm->buf„r->wrôe_miss_hô + 
wrôe_back_cou¡
;

439 
wrôe_back_cou¡
 > 0) {

440 
sub_ªq
 = 
NULL
;

441 
sub_ªq_°©e
 = 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
°‹ed
;

442 #ifde‡
DEBUG


443 
	`¥ötf
("next is write back buffer sizeámount.\n");

445 
sub_ªq_size
 = 
	`size
(
ssd
->
døm
->
buf„r
->
buf„r_èû
->
°‹ed
);

446 
sub_ªq_Õn
 = 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
group
;

447 
sub_ªq
 = 
	`¸ót_sub_ªque°
(
ssd
, 
sub_ªq_Õn
, 
sub_ªq_size
, 
sub_ªq_°©e
, 
ªq
, 
WRITE
);

456 i‡(
ªq
 !
NULL
) {

458 #ifde‡
DEBUG


459 
	`¥ötf
("opps,Çever happen \n");

461 
sub_ªq
->
√xt_subs
 = 
sub
->next_subs;

462 
sub
->
√xt_subs
 = 
sub_ªq
;

471 
ssd
->
døm
->
buf„r
->
buf„r_£˘‹_cou¡
 = ssd->døm->buf„r->buf„r_£˘‹_cou¡ - 
sub_ªq_size
;

473 
±
 = 
ssd
->
døm
->
buf„r
->
buf„r_èû
;

474 
	`avlTªeDñ
(
ssd
->
døm
->
buf„r
, (
TREE_NODE
 *Ë
±
);

475 i‡(
ssd
->
døm
->
buf„r
->
buf„r_hód
->
LRU_lök_√xt
 =
NULL
) {

476 
ssd
->
døm
->
buf„r
->
buf„r_hód
 = 
NULL
;

477 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = 
NULL
;

479 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = ssd->døm->buf„r->buf„r_èû->
LRU_lök_¥e
;

480 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
LRU_lök_√xt
 = 
NULL
;

482 
±
->
LRU_lök_√xt
 = 
NULL
;

483 
±
->
LRU_lök_¥e
 = 
NULL
;

484 
	`AVL_TREENODE_FREE
(
ssd
->
døm
->
buf„r
, (
TREE_NODE
 *Ë
±
);

485 
±
 = 
NULL
;

487 
wrôe_back_cou¡
 =

489 
wrôe_back_cou¡
 - 
sub_ªq_size
;

490 #ifde‡
DEBUG


491 
	`¥ötf
("⁄˚ wrôêö£π i¡ÿbuf„∏buàwrôeback fú°,áŒÇìd wrôêötÿ£˘‹êi†%d, buàthi†timêwrôeback i¡ÿ£˘‹ i†%d \n", 
wrôe_back_cou¡
, 
sub_ªq_size
);

499 #ifde‡
DEBUG


500 
	`¥ötf
("here makeá buffer-nodeánd insert into bufferÅree. shouldÖrintf here\n");

502 
√w_node
 = 
NULL
;

503 
√w_node
 = (
buf„r_group
 *Ë
	`mÆloc
((buffer_group));

504 
	`Æloc_as£π
(
√w_node
, "buffer_group_node");

505 
	`mem£t
(
√w_node
, 0, (
buf„r_group
));

507 
√w_node
->
group
 = 
Õn
;

508 
√w_node
->
°‹ed
 = 
°©e
;

509 
√w_node
->
dúty_˛ón
 = 
°©e
;

510 
√w_node
->
LRU_lök_¥e
 = 
NULL
;

511 
√w_node
->
LRU_lök_√xt
 = 
ssd
->
døm
->
buf„r
->
buf„r_hód
;

512 i‡(
ssd
->
døm
->
buf„r
->
buf„r_hód
 !
NULL
) {

513 
ssd
->
døm
->
buf„r
->
buf„r_hód
->
LRU_lök_¥e
 = 
√w_node
;

515 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = 
√w_node
;

517 
ssd
->
døm
->
buf„r
->
buf„r_hód
 = 
√w_node
;

518 
√w_node
->
LRU_lök_¥e
 = 
NULL
;

519 
	`avlTªeAdd
(
ssd
->
døm
->
buf„r
, (
TREE_NODE
 *Ë
√w_node
);

520 
ssd
->
døm
->
buf„r
->
buf„r_£˘‹_cou¡
 +
£˘‹_cou¡
;

528 #ifde‡
DEBUG


529 
	`¥ötf
("buffer_node hit\n");

532 
i
 = 0; i < 
ssd
->
∑ømëî
->
sub∑ge_∑ge
; i++) {

537 i‡((
°©e
 >> 
i
) % 2 != 0) {

538 
l¢
 = 
Õn
 * 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 + 
i
;

539 
hô_Êag
 = 0;

540 
hô_Êag
 = (
buf„r_node
->
°‹ed
Ë& (0x00000001 << 
i
);

542 i‡(
hô_Êag
 !=

545 
a˘ive_ªgi⁄_Êag
 = 1;

547 i‡(
ªq
 !
NULL
) {

548 i‡(
ssd
->
døm
->
buf„r
->
buf„r_hód
 !
buf„r_node
) {

549 i‡(
ssd
->
døm
->
buf„r
->
buf„r_èû
 =
buf„r_node
) {

550 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = 
buf„r_node
->
LRU_lök_¥e
;

551 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = 
NULL
;

552 } i‡(
buf„r_node
 !
ssd
->
døm
->
buf„r
->
buf„r_hód
) {

553 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = buffer_node->LRU_link_next;

554 
buf„r_node
->
LRU_lök_√xt
->
LRU_lök_¥e
 = buffer_node->LRU_link_pre;

556 
buf„r_node
->
LRU_lök_√xt
 = 
ssd
->
døm
->
buf„r
->
buf„r_hód
;

557 
ssd
->
døm
->
buf„r
->
buf„r_hód
->
LRU_lök_¥e
 = 
buf„r_node
;

558 
buf„r_node
->
LRU_lök_¥e
 = 
NULL
;

559 
ssd
->
døm
->
buf„r
->
buf„r_hód
 = 
buf„r_node
;

561 
ssd
->
døm
->
buf„r
->
wrôe_hô
++;

562 
ªq
->
com∂ëe_l¢_cou¡
++;

575 
ssd
->
døm
->
buf„r
->
wrôe_miss_hô
++;

577 i‡(
ssd
->
døm
->
buf„r
->
buf„r_£˘‹_cou¡
 >ssd->døm->buf„r->
max_buf„r_£˘‹
) {

578 i‡(
buf„r_node
 ==

579 
ssd
->
døm
->
buf„r
->
buf„r_èû
)

581 
±
 = 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
LRU_lök_¥e
;

582 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
LRU_lök_¥e
 = 
±
->LRU_link_pre;

583 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
LRU_lök_¥e
->
LRU_lök_√xt
 = ssd->dram->buffer->buffer_tail;

584 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
LRU_lök_√xt
 = 
±
;

585 
±
->
LRU_lök_√xt
 = 
NULL
;

586 
±
->
LRU_lök_¥e
 = 
ssd
->
døm
->
buf„r
->
buf„r_èû
;

587 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = 
±
;

590 
sub_ªq
 = 
NULL
;

591 
sub_ªq_°©e
 = 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
°‹ed
;

592 
sub_ªq_size
 = 
	`size
(
ssd
->
døm
->
buf„r
->
buf„r_èû
->
°‹ed
);

593 
sub_ªq_Õn
 = 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
group
;

594 
sub_ªq
 = 
	`¸ót_sub_ªque°
(
ssd
, 
sub_ªq_Õn
, 
sub_ªq_size
, 
sub_ªq_°©e
, 
ªq
, 
WRITE
);

596 i‡(
ªq
 !
NULL
) {

598 } i‡(
ªq
 =
NULL
) {

599 
sub_ªq
->
√xt_subs
 = 
sub
->next_subs;

600 
sub
->
√xt_subs
 = 
sub_ªq
;

603 
ssd
->
døm
->
buf„r
->
buf„r_£˘‹_cou¡
 = ssd->døm->buf„r->buf„r_£˘‹_cou¡ - 
sub_ªq
->
size
;

604 
±
 = 
ssd
->
døm
->
buf„r
->
buf„r_èû
;

605 
	`avlTªeDñ
(
ssd
->
døm
->
buf„r
, (
TREE_NODE
 *Ë
±
);

611 i‡(
ssd
->
døm
->
buf„r
->
buf„r_hód
->
LRU_lök_√xt
 =
NULL
) {

612 
ssd
->
døm
->
buf„r
->
buf„r_hód
 = 
NULL
;

613 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = 
NULL
;

615 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = ssd->døm->buf„r->buf„r_èû->
LRU_lök_¥e
;

616 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
LRU_lök_√xt
 = 
NULL
;

618 
±
->
LRU_lök_√xt
 = 
NULL
;

619 
±
->
LRU_lök_¥e
 = 
NULL
;

620 
	`AVL_TREENODE_FREE
(
ssd
->
døm
->
buf„r
, (
TREE_NODE
 *Ë
±
);

621 
±
 = 
NULL
;

625 
add_Êag
 = 0x00000001 << (
l¢
 % 
ssd
->
∑ømëî
->
sub∑ge_∑ge
);

627 i‡(
ssd
->
døm
->
buf„r
->
buf„r_hód
 !=

628 
buf„r_node
)

630 i‡(
ssd
->
døm
->
buf„r
->
buf„r_èû
 =
buf„r_node
) {

631 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = 
NULL
;

632 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = 
buf„r_node
->
LRU_lök_¥e
;

634 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = buffer_node->LRU_link_next;

635 
buf„r_node
->
LRU_lök_√xt
->
LRU_lök_¥e
 = buffer_node->LRU_link_pre;

637 
buf„r_node
->
LRU_lök_√xt
 = 
ssd
->
døm
->
buf„r
->
buf„r_hód
;

638 
ssd
->
døm
->
buf„r
->
buf„r_hód
->
LRU_lök_¥e
 = 
buf„r_node
;

639 
buf„r_node
->
LRU_lök_¥e
 = 
NULL
;

640 
ssd
->
døm
->
buf„r
->
buf„r_hód
 = 
buf„r_node
;

642 
buf„r_node
->
°‹ed
 = buf„r_node->°‹ed | 
add_Êag
;

643 
buf„r_node
->
dúty_˛ón
 = buf„r_node->dúty_˛ó¿| 
add_Êag
;

644 
ssd
->
døm
->
buf„r
->
buf„r_£˘‹_cou¡
++;

651  
ssd
;

652 
	}
}

657 
Sètus


658 
	$föd_a˘ive_block
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
) {

659 
a˘ive_block
;

660 
‰ì_∑ge_num
 = 0;

661 
cou¡
 = 0;

663 
a˘ive_block
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].active_block;

664 
‰ì_∑ge_num
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].free_page_num;

666 (
‰ì_∑ge_num
 =0Ë&& (
cou¡
 < 
ssd
->
∑ømëî
->
block_∂™e
)) {

667 
a˘ive_block
 = (a˘ive_block + 1Ë% 
ssd
->
∑ømëî
->
block_∂™e
;

668 
‰ì_∑ge_num
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].free_page_num;

669 
cou¡
++;

671 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
a˘ive_block
 =áctive_block;

672 i‡(
cou¡
 < 
ssd
->
∑ømëî
->
block_∂™e
) {

673  
SUCCESS
;

675  
FAILURE
;

677 
	}
}

683 
Sètus
 
	$wrôe_∑ge
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
,

684 
a˘ive_block
, *
µn
) {

685 
œ°_wrôe_∑ge
 = 0;

686 
œ°_wrôe_∑ge
 = ++(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].last_write_page);

687 i‡(
œ°_wrôe_∑ge
 >(Ë(
ssd
->
∑ømëî
->
∑ge_block
)) {

688 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].
œ°_wrôe_∑ge
 = 0;

689 
	`¥ötf
("error!ÅheÜast writeÖageÜargerÅhan 64!!\n");

690  
ERROR
;

693 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].
‰ì_∑ge_num
--;

694 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
‰ì_∑ge
--;

695 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].
∑ge_hód
[
œ°_wrôe_∑ge
].
wrôãn_cou¡
++;

696 
ssd
->
wrôe_Êash_cou¡
++;

697 *
µn
 = 
	`föd_µn
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
a˘ive_block
, 
œ°_wrôe_∑ge
);

699  
SUCCESS
;

700 
	}
}

707 
sub_ªque°
 *

708 
	$¸ót_sub_ªque°
(
ssd_öfo
 *
ssd
, 
Õn
, 
size
, 
°©e
, 
ªque°
 *
ªq
,

709 
›î©i⁄
) {

710 
sub_ªque°
 *
sub
 = 
NULL
, *
sub_r
 = NULL;

711 
ch™√l_öfo
 *
p_ch
 = 
NULL
;

712 
loˇl
 *
loc
 = 
NULL
;

713 
Êag
 = 0;

714 
∑ge_num_ãmp
 = 
ssd
->
∑ømëî
->
∑ge_block
 * ssd->∑ømëî->
block_∂™e
 * ssd->∑ømëî->
∂™e_dõ
 * ssd->∑ømëî->
dõ_chù
 * ssd->∑ømëî->
chù_num
;

722 
sub
 = (
sub_ªque°
 *Ë
	`mÆloc
((sub_request));

723 
	`Æloc_as£π
(
sub
, "sub_request");

724 
	`mem£t
(
sub
, 0, (
sub_ªque°
));

726 i‡(
sub
 =
NULL
) {

727  
NULL
;

728 
	`ssdsim_msg
("malloc subrequest wrong");

733 
sub
->
loˇti⁄
 = 
NULL
;

734 
sub
->
√xt_node
 = 
NULL
;

735 
sub
->
√xt_subs
 = 
NULL
;

736 
sub
->
upd©e
 = 
NULL
;

738 i‡(
ªq
 !
NULL
) {

739 
sub
->
√xt_subs
 = 
ªq
->
subs
;

740 
ªq
->
subs
 = 
sub
;

742 #ifde‡
DEBUG


743 
	`¥ötf
("íã∏¸ót_sub_ªque°.!!!!!!!⁄˚ o√ buf„r->èûÉÀmít.sÿthêªqánd sizêi†righàªq„ÄÇnŸÅhêssd->ªque°_èû'†ªque°!!!!!! o≥øti⁄ i†%d,Ñeq i†%x“ÿ0 i†nÿNULL),Õ¿i†%d, sizêi†%d, sèã i†%d\n",
›î©i⁄
, 
ªq
, 
Õn
, 
size
, 
°©e
);

749 i‡(
›î©i⁄
 =
READ
) {

768 
loc
 = 
	`föd_loˇti⁄
(
ssd
, ssd->
døm
->
m≠
->
m≠_íåy
[
Õn
].
≤
);

771 if(
loc
 == 0x0){

773 
	`¥ötf
("n‹mÆÑód,Üx˛x˛xc,Õ¿%d, sizê%d,Ñeque° %Œd, o≥øti⁄ %d ha†wr⁄gÇow\n", 
Õn
, 
size
, 
ªq
, 
›î©i⁄
);

778 if(
Õn
 > 
∑ge_num_ãmp
){

779 
	`¥ötf
("Õ¿%d >ÅŸÆ_∑ge_num %dÇow\n",
Õn
, 
∑ge_num_ãmp
);

786 if(
ªq
->
if_√ed_movemít_bëwìn_com_™d_uncom_Êag_™d_∑ge_numbîs
 != 0){

787 
sub
->
com¥essi⁄_co°_add_Êag
 = 
ªq
->
if_√ed_movemít_bëwìn_com_™d_uncom_Êag_™d_∑ge_numbîs
 * 
COMPRESSION_COST_TIME_ONE_PAGE
;

793 
sub
->
loˇti⁄
 = 
loc
;

795 
sub
->
begö_time
 = 
ssd
->
cuºít_time
 ;

796 
sub
->
cuºít_°©e
 = 
SR_WAIT
;

797 
sub
->
cuºít_time
 = 
MAX_INT64
;

798 
sub
->
√xt_°©e
 = 
SR_R_C_A_TRANSFER
;

799 
sub
->
√xt_°©e_¥edi˘_time
 = 
MAX_INT64
;

800 
sub
->
Õn
 =Üpn;

801 
sub
->
size
 = size;

804 
p_ch
 = &
ssd
->
ch™√l_hód
[
loc
->
ch™√l
];

805 
sub
->
µn
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
≤
;

806 
sub
->
›î©i⁄
 = 
READ
;

807 
sub
->
°©e
 = (
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].state & 0x7fffffff);

808 
sub_r
 = 
p_ch
->
subs_r_hód
;

809 
Êag
 = 0;

810 
sub_r
 !
NULL
) {

811 i‡(
sub_r
->
µn
 =
sub
->ppn) {

812 
Êag
 = 1;

815 
sub_r
 = sub_r->
√xt_node
;

817 #ifde‡
DEBUG


818 
	`¥ötf
("Êag i†%d *** 1 món†thîêi†ßmêsubªque° i¿queuê0 i†›posôe\n",
Êag
);

820 i‡(
Êag
 == 0) {

821 #ifde‡
DEBUG


822 
	`¥ötf
("sub†queuêö£πÑód,Êag=0Åhí in£π sub†ötÿpch %d\n",
loc
->
ch™√l
);

827 #ifde‡
DEBUGSUSPEND


828 
	`¥ötf
("⁄ly hîêadd chù'†ªadÜígth,√w cª©ÑódÜoˇti⁄ i†ch™√»%d, chù %d, dõ %d,Öœ√ %d,Ö≤ %d\n",
loc
->
ch™√l
,Üoc->
chù
,Üoc->
dõ
,Üoc->
∂™e
, 
sub
->
µn
);

831 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
chù_ªad_queue_Àngth
 ++;

835 
ãmp_Àngth
 = 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
chù_ªad_queue_Àngth
;

838 #ifde‡
DEBUGSUSPEND


839 
	`¥ötf
("chù_ªad_queue_Àngthádd o√Çow i†%d,[ch™√»%d, chù %d] sîvi˚d_timêi†%Œd\n", 
ãmp_Àngth
,
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->
£rvi˚d_time
);

845 if––
p_ch
->
subs_r_hód
 !
NULL
Ë&& (p_ch->
subs_r_èû
 != NULL)){

847 
p_ch
->
subs_r_èû
->
√xt_node
 = 
sub
;

848 
p_ch
->
subs_r_èû
 = 
sub
;

849 } if((
p_ch
->
subs_r_hód
 =
NULL
) && (p_ch->subs_r_head == NULL)){

851 
p_ch
->
subs_r_hód
 = 
sub
;

852 
p_ch
->
subs_r_èû
 = 
sub
;

854 
	`¥ötf
("Ñeadádded wrongÇow\n");

865 if(
sub
->
loˇti⁄
 =
NULL
){

866 
	`¥ötf
("lxclxclxc_readlocation wrong\n");

874 #ifde‡
DEBUG


875 
	`¥ötf
("sub†queuê°©u†ch™gê°©ê‰om SR_R_DATA_RANSFERÅÿ√xt_°©êcom∂ëê™d subÇexàtime=+1000,Êag=1Öch i† %d\n",
p_ch
);

878 
	`¥ötf
("read dont haveÅo be inserted 1000Çow\n");

879 
sub
->
cuºít_°©e
 = 
SR_R_DATA_TRANSFER
;

880 
sub
->
cuºít_time
 = 
ssd
->current_time;

881 #ifde‡
DEBUG_CURR_TIME


882 
	`¥ötf
("sub_cuºít_timêi†%Œd , ssd_cuºít_timêi†%Œd i¿¸ót_sub_ªque° fun˘i⁄\n", 
sub
->
cuºít_time
,
ssd
->current_time);

885 
sub
->
√xt_°©e
 = 
SR_COMPLETE
;

886 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 1000;

887 
sub
->
com∂ëe_time
 = 
ssd
->
cuºít_time
 + 1000;

889 
	`åa˚Eº‹_msg
("subªque°,timêdebug:Ç‹mÆÑód,Ü≤ i†%d, begöÅimê%Œd", 
sub
->
Õn
, sub->
begö_time
);

894 i‡(
›î©i⁄
 =
WRITE
) {

897 if(
ªq
->
if_√ed_movemít_bëwìn_com_™d_uncom_Êag_™d_∑ge_numbîs
 != 0){

898 
sub
->
com¥essi⁄_co°_add_Êag
 = 
ªq
->
if_√ed_movemít_bëwìn_com_™d_uncom_Êag_™d_∑ge_numbîs
 * 
COMPRESSION_COST_TIME_ONE_PAGE
;

904 
sub
->
µn
 = 0;

905 
sub
->
›î©i⁄
 = 
WRITE
;

906 
sub
->
loˇti⁄
 = (
loˇl
 *Ë
	`mÆloc
((local));

907 
	`Æloc_as£π
(
sub
->
loˇti⁄
, "sub->location");

908 
	`mem£t
(
sub
->
loˇti⁄
, 0, (
loˇl
));

910 
sub
->
cuºít_°©e
 = 
SR_WAIT
;

911 
sub
->
cuºít_time
 = 
ssd
->current_time;

912 
sub
->
Õn
 =Üpn;

913 
sub
->
size
 = size;

914 
sub
->
°©e
 = state;

916 
sub
->
begö_time
 = 
ssd
->
cuºít_time
;

918 i‡(
	`Æloˇã_loˇti⁄
(
ssd
, 
sub
Ë=
ERROR
) {

919 
	`¥ötf
("lxc, must mark here, create writeÑequest fail!!\n");

923 
	`‰ì
(
sub
->
loˇti⁄
);

924 
sub
->
loˇti⁄
 = 
NULL
;

925 
	`‰ì
(
sub
);

926 
sub
 = 
NULL
;

927  
NULL
;

930 
	`åa˚Eº‹_msg
("subªque°,timêdebug:Ç‹mÆ wrôe,Ü≤ i†%d, begöÅimê%Œd", 
sub
->
Õn
, sub->
begö_time
);

933 } i‡(
›î©i⁄
 =
MAPPINGTABLE_WRITE
 ){

934 
sub
->
waô_evi˘_sign
 = 1;

935 
sub
->
waô_„tch_m≠pögèbÀ_sign
 = 1;

937 
sub
->
µn
 = -1;

938 
sub
->
›î©i⁄
 = 
WRITE
;

939 
sub
->
loˇti⁄
 = (
loˇl
 *Ë
	`mÆloc
((local));

940 
	`Æloc_as£π
(
sub
->
loˇti⁄
, "sub->location");

941 
	`mem£t
(
sub
->
loˇti⁄
, 0, (
loˇl
));

943 
sub
->
cuºít_°©e
 = 
SR_WAIT
;

944 
sub
->
cuºít_time
 = 
ssd
->current_time;

945 
sub
->
Õn
 =Üpn;

946 
sub
->
size
 = size;

947 
sub
->
°©e
 = state;

948 
sub
->
begö_time
 = 
ssd
->
cuºít_time
;

950 i‡(
	`Æloˇã_loˇti⁄
(
ssd
, 
sub
Ë=
ERROR
) {

951 
	`¥ötf
("lxc, must mark here, create writeÑequest fail!!\n");

955 
	`‰ì
(
sub
->
loˇti⁄
);

956 
sub
->
loˇti⁄
 = 
NULL
;

957 
	`‰ì
(
sub
);

958 
sub
 = 
NULL
;

959  
NULL
;

962 
	`åa˚Eº‹_msg
("subªque°,timêdebug: m≠pögèbÀ_wrôe,Ü≤ i†%d, begöÅimê%Œd", 
sub
->
Õn
, sub->
begö_time
);

964 }if(
›î©i⁄
 =
MAPPINGTABLE_READ
){

965 
sub
->
waô_„tch_m≠pögèbÀ_sign
 = 1;

969 
loc
 = 
	`föd_loˇti⁄
(
ssd
, 
Õn
);

970 if(
loc
 == 0x0){

971 
	`¥ötf
("MAPPINGTABLE_READ,Õ¿%d, sizê%d,Ñeque° %Œd, o≥øti⁄ %d ha†wr⁄gÇow\n", 
Õn
, 
size
, 
ªq
, 
›î©i⁄
);

977 
loc
->
block
 = 0;

978 
loc
->
∑ge
 = 0;

981 if(
Õn
 > 
∑ge_num_ãmp
){

982 
	`¥ötf
("shouldÜimittedánother situation inÅhe future.\n");

986 
sub
->
loˇti⁄
 = 
loc
;

987 
sub
->
begö_time
 = 
ssd
->
cuºít_time
;

988 
sub
->
cuºít_°©e
 = 
SR_WAIT
;

989 
sub
->
cuºít_time
 = 
MAX_INT64
;

990 
sub
->
√xt_°©e
 = 
SR_R_C_A_TRANSFER
;

991 
sub
->
√xt_°©e_¥edi˘_time
 = 
MAX_INT64
;

992 
sub
->
Õn
 =Üpn;

993 
sub
->
size
 = size;

996 
p_ch
 = &
ssd
->
ch™√l_hód
[
loc
->
ch™√l
];

999 
sub
->
µn
 = -2;

1000 
sub
->
›î©i⁄
 = 
READ
;

1003 
sub
->
°©e
 = 15;

1004 
sub_r
 = 
p_ch
->
subs_r_hód
;

1008 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
chù_ªad_queue_Àngth
 ++;

1010 if––
p_ch
->
subs_r_hód
 !
NULL
Ë&& (p_ch->
subs_r_èû
 != NULL)){

1011 
p_ch
->
subs_r_èû
->
√xt_node
 = 
sub
;

1012 
p_ch
->
subs_r_èû
 = 
sub
;

1013 } if((
p_ch
->
subs_r_hód
 =
NULL
) && (p_ch->subs_r_head == NULL)){

1015 
p_ch
->
subs_r_hód
 = 
sub
;

1016 
p_ch
->
subs_r_èû
 = 
sub
;

1018 
	`¥ötf
("lxclxclxc,Ñeadádded wrongÇow\n");

1025 if(
sub
->
loˇti⁄
 =
NULL
){

1026 
	`¥ötf
("lxclxclxc_readlocation wrong\n");

1032 
	`åa˚Eº‹_msg
("›ps!!!!MAPPINGTABLE_READ hîêmón†ªadögÇevî fëch hîêshould h≠≥¿!!!!wêju° c™ st› hîêtÿvîify it.subªque°,timêdebug: m≠pögèbÀ_ªad,Ü≤ i†%d, begöÅimê%Œd", 
sub
->
Õn
, sub->
begö_time
);

1037 
	`¥ötf
("opps!,Çever happen\n");

1038 
	`‰ì
(
sub
->
loˇti⁄
);

1039 
sub
->
loˇti⁄
 = 
NULL
;

1040 
	`‰ì
(
sub
);

1041 
sub
 = 
NULL
;

1042 
	`¥ötf
("\nERROR ! Unexpected command.\n");

1043  
NULL
;

1046  
sub
;

1047 
	}
}

1053 
sub_ªque°
 *

1054 
	$föd_ªad_sub_ªque°
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
) {

1055 
∂™e
 = 0;

1056 
addªss_µn
 = 0;

1057 
sub_ªque°
 *
sub
 = 
NULL
, *
p
 = NULL;

1059 
∂™e
 = 0;Öœ√ < 
ssd
->
∑ømëî
->
∂™e_dõ
;Ölane++) {

1060 
addªss_µn
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
add_ªg_µn
;

1061 #ifde‡
DEBUG


1065 if(
addªss_µn
 == -2){

1067 
sub
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_r_hód
;

1068 if((
sub
->
waô_„tch_m≠pögèbÀ_sign
 =1)&&(sub->
√xt_°©e
 =
SR_R_DATA_TRANSFER
)){

1069  
sub
;

1072 (
sub
->
waô_„tch_m≠pögèbÀ_sign
 !1Ë&& (sub->
√xt_node
 !
NULL
)) {

1074 if((
sub
->
√xt_node
->
waô_„tch_m≠pögèbÀ_sign
 =1)&&(sub->√xt_node->
√xt_°©e
 =
SR_R_DATA_TRANSFER
)){

1076 
p
 = 
sub
->
√xt_node
;

1078  
p
;

1081 i‡(
p
->
√xt_node
 =
NULL
) {

1082 
sub
->
√xt_node
 = 
NULL
;

1083 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_r_èû
 = 
sub
;

1085 
sub
->
√xt_node
 = 
p
->next_node;

1087 
sub
 = 
p
;

1090 
sub
 = sub->
√xt_node
;

1098 i‡((
addªss_µn
 != -1)&&(address_ppn != -2)) {

1099 
sub
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_r_hód
;

1100 i‡(
sub
->
µn
 =
addªss_µn
) {

1102  
sub
;

1105 i‡(
sub
->
√xt_node
 =
NULL
) {

1106 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_r_hód
 = 
NULL
;

1107 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_r_èû
 = 
NULL
;

1109 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_r_hód
 = 
sub
->
√xt_node
;

1111 (
sub
->
µn
 !
addªss_µn
Ë&& (sub->
√xt_node
 !
NULL
)) {

1112 i‡(
sub
->
√xt_node
->
µn
 =
addªss_µn
) {

1113 
p
 = 
sub
->
√xt_node
;

1115  
p
;

1118 i‡(
p
->
√xt_node
 =
NULL
) {

1119 
sub
->
√xt_node
 = 
NULL
;

1120 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_r_èû
 = 
sub
;

1122 
sub
->
√xt_node
 = 
p
->next_node;

1124 
sub
 = 
p
;

1127 
sub
 = sub->
√xt_node
;

1129 i‡(
sub
->
µn
 =
addªss_µn
) {

1130 
sub
->
√xt_node
 = 
NULL
;

1131 
	`¥ötf
("födÑód sub , subÖ≤ i†%d\n",
sub
->
µn
);

1132  
sub
;

1134 
	`¥ötf
("Error! Can't findÅhe subÑequest.");

1138  
NULL
;

1139 
	}
}

1146 
sub_ªque°
 *
	$föd_wrôe_sub_ªque°
(
ssd_öfo
 *
ssd
, 
ch™√l
) {

1147 
sub_ªque°
 *
sub
 = 
NULL
, *
p
 = NULL;

1148 i‡((
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 =0Ë&& (ssd->∑ømëî->
dy«mic_Æloˇti⁄
 == 0))

1150 
sub
 = 
ssd
->
subs_w_hód
;

1151 
sub
 !
NULL
) {

1153 i‡((
sub
->
cuºít_°©e
 =
SR_WAIT
)&&(sub->
begö_time
 <
ssd
->
cuºít_time
)) {

1154 i‡(
sub
->
upd©e
 !
NULL
)

1156 i‡((
sub
->
upd©e
->
cuºít_°©e
 =
SR_COMPLETE
Ë|| ((sub->upd©e->
√xt_°©e
 == SR_COMPLETE) &&

1157 (
sub
->
upd©e
->
√xt_°©e_¥edi˘_time
 <=

1158 
ssd
->
cuºít_time
)))

1166 
p
 = 
sub
;

1167 
sub
 = sub->
√xt_node
;

1170 i‡(
sub
 ==

1171 
NULL
)

1173  
NULL
;

1176 i‡(
sub
 !
ssd
->
subs_w_hód
) {

1177 i‡(
sub
 !
ssd
->
subs_w_èû
) {

1178 
p
->
√xt_node
 = 
sub
->next_node;

1180 
ssd
->
subs_w_èû
 = 
p
;

1181 
ssd
->
subs_w_èû
->
√xt_node
 = 
NULL
;

1184 i‡(
sub
->
√xt_node
 !
NULL
) {

1185 
ssd
->
subs_w_hód
 = 
sub
->
√xt_node
;

1187 
ssd
->
subs_w_hód
 = 
NULL
;

1188 
ssd
->
subs_w_èû
 = 
NULL
;

1191 
sub
->
√xt_node
 = 
NULL
;

1192 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_èû
 !
NULL
) {

1193 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_èû
->
√xt_node
 = 
sub
;

1194 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_èû
 = 
sub
;

1196 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_èû
 = 
sub
;

1197 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 = 
sub
;

1205 
sub
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
;

1206 
sub
 !
NULL
) {

1207 i‡(
sub
->
cuºít_°©e
 =
SR_WAIT
) {

1208 i‡(
sub
->
upd©e
 !
NULL
) {

1209 i‡((
sub
->
upd©e
->
cuºít_°©e
 =
SR_COMPLETE
Ë|| ((sub->upd©e->
√xt_°©e
 == SR_COMPLETE) &&

1210 (
sub
->
upd©e
->
√xt_°©e_¥edi˘_time
 <=

1211 
ssd
->
cuºít_time
)))

1219 
p
 = 
sub
;

1220 
sub
 = sub->
√xt_node
;

1223 i‡(
sub
 =
NULL
) {

1224  
NULL
;

1228  
sub
;

1229 
	}
}

1232 
	$£rvi˚s_2_wrôe_busy_ö_chù
(
ssd_öfo
 *
ssd
)

1235 
i
 = 0;

1236 
j
 = 0;

1237 
Has_ªad_ªque°
 = 0;

1238 
sub_ªque°
 *
sub
 = 
NULL
, *
p
 = NULL;

1239 
sub_ªque°
 *
sub_f‹_ªad
 = 
NULL
;

1240 
sub_ªque°
 *
ã°_sub
 = 
NULL
;

1242 #ifde‡
DEBUGSUSPEND


1243 
	`¥ötf
("services_2_write_busy_in_chip function go into.\n");

1247 
i
 = 0; i <

1248 
ssd
->
∑ømëî
->
ch™√l_numbî
; 
i
++)

1262 
j
 = 0; j < 
ssd
->
ch™√l_hód
[
i
].
chù
; j++){

1263 #ifde‡
DEBUG


1264 
	`¥ötf
("evîyÅimê¥o˚s†fun˘i⁄Ç‹mÆ m⁄i°îÇewe°Çum_w_cy˛êvÆuêhîêthê%d ch™√», %d chù,Çum_w_wrôêi†%d.\n",
i
 ,
j
, 
ssd
->
ch™√l_hód
[i].
chù_hód
[j].
num_w_cy˛e
 );

1266 if(
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
wrôe_¥ìm±ive_sign
 == 1) {

1267 #ifde‡
DEBUGSUSPEND


1268 
	`¥ötf
("hîêi†wrôêÖªem±ivê! jum∞out,ándÇowÅhê%d ch™√», %d chù,Çum_w_wrôêi†%d.\n",
i
 ,
j
, 
ssd
->
ch™√l_hód
[i].
chù_hód
[j].
num_w_cy˛e
 );

1275 i‡(
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
cuºít_°©e
 !
CHIP_WRITE_DATA_CMD_BUSY
){

1277 i‡(
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
cuºít_°©e
 !
CHIP_WRITE_BUSY
) {

1278 #ifde‡
DEBUGSUSPEND


1279 
	`¥ötf
("here chip isÇot write status ! jump out.\n");

1291 if(
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
√xt_°©e_¥edi˘_time
 <ssd->
cuºít_time
){

1294 if(
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
cuºít_°©e
 =
CHIP_WRITE_DATA_CMD_BUSY
){

1296 
sub
 = 
ssd
->
ch™√l_hód
[
i
].
subs_w_hód
;

1297 
sub
 !
NULL
){

1298 if–(
sub
->
cuºít_°©e
 =
SR_W_C_A_DATA_TRANSFER
Ë&& (sub->
loˇti⁄
->
chù
 =
j
) ){

1301 
sub
 = sub->
√xt_node
;

1303 if(
sub
 =
NULL
){

1304 
	`¥ötf
("error happen,Üxclxclxc\n");

1309 
ã°_sub
 = 
ssd
->
ch™√l_hód
[
i
].
subs_w_hód
;

1310 
ã°_sub
 !
NULL
){

1311 if–
ã°_sub
->
loˇti⁄
->
chù
 =
j
 ){

1314 
ã°_sub
 =Åe°_sub->
√xt_node
;

1316 if(
sub
 !
ã°_sub
){

1317 
	`¥ötf
("lx˛x˛xc1.£riou¶y wr⁄g, fú°_wrôe_sub cuºít_°©êi†%d,Çext_°©êi†%d\n", 
ã°_sub
->
cuºít_°©e
,Åe°_sub->
√xt_°©e
);

1319 
	`¥ötf
("lxclxclxc2.right\n");

1322 #ifde‡
DEBUGSUSPEND


1323 
	`¥ötf
("now i†judgög föish síd_wrôe_cmdÖro˚ss,™dÅhêsub'†ch™√»%d, chù %d , block %d,Öagê%d(block,∑gêha†nŸ inôüÀd hîe)\n",
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
block
, sub->loˇti⁄->
∑ge
);

1326 i‡–(
sub
->
cuºít_°©e
 =
SR_W_C_A_DATA_TRANSFER
Ë&& (sub->
√xt_°©e
 =
SR_W_DATA_TRANSFER
) ) {

1328 #ifde‡
DEBUGSUSPEND


1329 
	`¥ötf
("now wû»go_⁄e_°ï f‹ föishög síd_wrôe_cmdÖro˚ss,™dÅhêsub'†ch™√»%d, chù %d , block %d,Öagê%d(block,∑gêha†nŸ inôüÀd hîe)\n",
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
block
, sub->loˇti⁄->
∑ge
);

1332 
	`go_⁄e_°ï
(
ssd
, 
sub
, 
NULL
, 
SR_W_DATA_TRANSFER_ONE_PROG_OF_ITERATIONS
, 
NORMAL
);

1334 #ifde‡
DEBUGSUSPEND


1335 
	`¥ötf
("bef‹Çum_w_cy˛êadd 1 i†%d\n",
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
);

1337 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
 += 1;

1339 #ifde‡
DEBUGSUSPEND


1340 
	`¥ötf
("a·îÇum_w_cy˛êadd 1 i†%d\n",
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
);

1346 #ifde‡
DEBUGSUSPEND


1347 
	`¥ötf
("beginÅo judge for suspendÅhe write,now.\n");

1351 
Has_ªad_ªque°
 = 0;

1352 
sub_f‹_ªad
 = 
ssd
->
ch™√l_hód
[
i
].
subs_r_hód
;

1353 
sub_f‹_ªad
 !
NULL
)

1356 if(
sub_f‹_ªad
->
loˇti⁄
->
chù
 =
j
)

1360 
sub_f‹_ªad
 = sub_f‹_ªad->
√xt_node
 ;

1362 if(
sub_f‹_ªad
 !
NULL
){

1363 
Has_ªad_ªque°
 = 1;

1364 #ifde‡
DEBUGSUSPEND


1365 
	`¥ötf
("suspend!!!!!Çowáfter send_cmd do suspend forÑead\n");

1368 
	`¥ötf
("wrôêsu•ídÖosôi⁄ i†ö ju° föish síd_ªad_cmd .Çum_w_cyl˚ i† %d\n",
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
);

1371 #ifde‡
DEBUGSUSPEND


1372 
	`¥ötf
("don'tÇeedÅo suspend.\n");

1387 
Has_ªad_ªque°
 = 0;

1388 if(
Has_ªad_ªque°
 == 1) {

1389 
ssd
->
wrôe_su•íd_times
 ++;

1391 
	`¥ötf
("wrôêsu•ídÅime†i†%d\n", 
ssd
->
wrôe_su•íd_times
);

1392 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
wrôe_¥ìm±ive_sign
 = 1;

1395 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

1396 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
cuºít_°©e
 = 
UNKNOWN
;

1397 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
cuºít_time
 = ssd->current_time;

1398 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 = ssd->
cuºít_time
 + (7+2Ë* ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

1399 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
°‹edsub
 = sub;

1401 
	`¥ötf
("statistic_suspendsion_write, 0\n");

1404 
	`¥ötf
("°‹esub o≥øti⁄. chù: %d,Ü≤: %d,Ö≤: %d o≥øti⁄: %d,size: %d, ////sub_ªque° sètus:: cuºít_°©e: %d, cuºít_time: %Œu,Çext_°©e: %d,Çext_°©e_¥edi˘_time: %Œu, sèã(⁄ly f‹ wrôe): %d\n", 
sub
->
loˇti⁄
->
chù
, sub->
Õn
, sub->
µn
,sub->
›î©i⁄
, sub->
size
, sub->
cuºít_°©e
, sub->
cuºít_time
,sub->
√xt_°©e
, sub->
√xt_°©e_¥edi˘_time
, sub->
°©e
) ;

1407 
	`¥ötf
("wrôêsu•ídÖosôi⁄ i†ôî©i⁄.Çum_w_cyl˚ i† %d, st‹ed sub i†%Œd, sub i†%Œd\n",
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
, ssd->ch™√l_hód[sub->loˇti⁄->ch™√l].chù_hód[sub->loˇti⁄->chù].
°‹edsub
, sub);

1423 if–(
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
num_w_cy˛e
 <= 10) && (ssd->channel_head[i].chip_head[j].num_w_cycle >= 1) ){

1428 
sub
 = 
ssd
->
ch™√l_hód
[
i
].
subs_w_hód
;

1429 
sub
 !
NULL
){

1430 if–((
sub
->
cuºít_°©e
 =
SR_W_DATA_TRANSFER
Ë&& (sub->
loˇti⁄
->
chù
 =
j
)) ) {

1433 
sub
 = sub->
√xt_node
;

1435 if(
sub
 =
NULL
){

1436 
	`¥ötf
("error happen,Üxclxclxc\n");

1441 i‡((
sub
->
√xt_°©e_¥edi˘_time
 <
ssd
->
cuºít_time
Ë&& (ssd->
ch™√l_hód
[sub->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
 == 10) ) {

1443 #ifde‡
DEBUGSUSPEND


1444 
	`¥ötf
("now wû»åyÅÿdÿœ° vîifyÇow sub'†ch™√»%d, chù %d , block %d,Öagê%d(block,∑gêha†nŸ inôüÀd hîe)\n",
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
block
, sub->loˇti⁄->
∑ge
);

1446 #ifde‡
DEBUGSUSPEND


1447 
	`¥ötf
("sub cuºít_ßèã i†(%d)=SR_COMPLETE o∏sub->√xt_°©êi†(%d)=SR_COMPLETE,\n",
sub
->
cuºít_°©e
, sub->
√xt_°©e
);

1451 if(
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
cuºít_°©e
 =
CHIP_WRITE_BUSY
){

1452 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
cuºít_°©e
 = 
CHIP_IDLE
;

1457 #ifde‡
DEBUGSUSPEND


1458 
	`¥ötf
("begin get_ppn operationÇow,\n");

1461 
sub
->
com∂ëe_time
 = sub->
√xt_°©e_¥edi˘_time
;

1462 
sub
->
√xt_°©e
 = 
SR_COMPLETE
;

1466 if(
sub
->
waô_evi˘_sign
 == 0){

1467 
	`gë_µn
(
ssd
, 
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
∂™e
, sub);

1479 if(
sub
->
waô_evi˘_sign
 == 1){

1480 if(
sub
->
waô_„tch_m≠pögèbÀ_sign
 != 1){

1481 
	`ssdsim_msg
("serious wrong in signs value");

1486 
	`assign_rightvÆue_f‹_com∂ëed_m≠pögªœãd_subªque°
(
sub
);

1487 
ssd
->
¥ogøm_cou¡
 ++;

1492 #ifde‡
DEBUGSUSPEND


1493 
	`¥ötf
("begin delete shownábove sub_writeÇow\n");

1496 
	`dñëe_w_sub_ªque°
(
ssd
, 
sub
->
loˇti⁄
->
ch™√l
, sub);

1497 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
 = 0;

1538 if–(
sub
->
√xt_°©e_¥edi˘_time
 <
ssd
->
cuºít_time
Ë&& (ssd->
ch™√l_hód
[sub->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
 < 10) && (ssd->channel_head[sub->location->channel].chip_head[sub->location->chip].num_w_cycle > 0) ) {

1539 #ifde‡
DEBUGSUSPEND


1540 
	`¥ötf
("now wû» dÿn‹mÆ iãøti⁄Çow sub'†ch™√»%d, chù %d , block %d,Öagê%d(block,∑gêha†nŸ inôüÀd hîe)\n",
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
block
, sub->loˇti⁄->
∑ge
);

1543 #ifde‡
DEBUGSUSPEND


1544 
	`¥ötf
("now gÿötÿwrôê3.2.2!! %d ch™√l, %d chù,Çum_w_cy˛ê%d\n",
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
,
ssd
->
ch™√l_hód
[sub->loˇti⁄->ch™√l].
chù_hód
[sub->loˇti⁄->chù].
num_w_cy˛e
 );

1547 if–((
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
) % 2) == 1 ){

1549 
	`go_⁄e_°ï
–
ssd
, 
sub
, 
NULL
,
SR_W_DATA_TRANSFER_ONE_VERIFY_OF_ITERATIONS
, 
NORMAL
);

1551 #ifde‡
DEBUGSUSPEND


1552 
	`¥ötf
("bef‹Çum_w_cy˛êadd 1 i†%d\n",
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
);

1554 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
 += 1;

1556 #ifde‡
DEBUGSUSPEND


1557 
	`¥ötf
("a·îÇum_w_cy˛êadd 1 i†%d\n",
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
);

1561 #ifde‡
DEBUGSUSPEND


1562 
	`¥ötf
("bef‹Çum_w_cy˛êadd 1 i†%d\n",
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
);

1564 
	`go_⁄e_°ï
–
ssd
, 
sub
, 
NULL
, 
SR_W_DATA_TRANSFER_ONE_PROG_OF_ITERATIONS
, 
NORMAL
);

1565 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
 += 1;

1567 #ifde‡
DEBUGSUSPEND


1568 
	`¥ötf
("a·îÇum_w_cy˛êadd 1 i†%d\n",
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
);

1571 if–(
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
) == 10){

1572 #ifde‡
DEBUGSUSPEND


1573 
	`¥ötf
("num_w_cycle == 10\n");

1628 #ifde‡
DEBUGSUSPEND


1629 
	`¥ötf
("beginÅo judge for suspendÅhe write,now.\n");

1632 
Has_ªad_ªque°
 = 0;

1633 
sub_f‹_ªad
 = 
ssd
->
ch™√l_hód
[
i
].
subs_r_hód
;

1634 
sub_f‹_ªad
 !
NULL
)

1637 if(
sub_f‹_ªad
->
loˇti⁄
->
chù
 =
j
)

1641 
sub_f‹_ªad
 = sub_f‹_ªad->
√xt_node
 ;

1643 if(
sub_f‹_ªad
 !
NULL
){

1644 
Has_ªad_ªque°
 = 1;

1645 #ifde‡
DEBUGSUSPEND


1646 
	`¥ötf
("su•íd!!!!!Çow durögÖrogøm dÿsu•íd f‹Ñód,Çum_w_cy˛e%d\n",
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
);

1650 #ifde‡
DEBUGSUSPEND


1651 
	`¥ötf
("don'tÇeedÅo suspendÇow \n");

1655 
Has_ªad_ªque°
 = 0;

1700 if(
Has_ªad_ªque°
 == 1) {

1702 
ssd
->
wrôe_su•íd_times
 ++;

1703 
	`¥ötf
("wrôêsu•ídÅime†i†%d\n", 
ssd
->
wrôe_su•íd_times
);

1704 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
wrôe_¥ìm±ive_sign
 = 1;

1707 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

1708 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
cuºít_°©e
 = 
UNKNOWN
;

1709 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
cuºít_time
 = ssd->current_time;

1710 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 = ssd->
cuºít_time
 + (7+2Ë* ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

1712 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
°‹edsub
 = sub;

1713 
	`¥ötf
("°©i°ic_su•ísi⁄_wrôe, %d, %Œd\n",
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
, ssd->
cuºít_time
);

1715 
	`¥ötf
("wrôêsu•ídÖosôi⁄ i†ôî©i⁄.Çum_w_cyl˚ i† %d, st‹ed sub i†%Œd\n",
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
num_w_cy˛e
, ssd->ch™√l_hód[sub->loˇti⁄->ch™√l].chù_hód[sub->loˇti⁄->chù].
°‹edsub
);

1730 #ifde‡
DEBUG


1731 
	`¥ötf
("ssd->ch™√l_hód[%d].chù_hód[%d].√xt_°©e_¥edi˘_time[%Œd] i†nŸ <ssd->cuºít_time[%Œd],sÿgivêup\n", 
i
, 
j
, 
ssd
->
ch™√l_hód
[i].
chù_hód
[j].
√xt_°©e_¥edi˘_time
,ssd->
cuºít_time
);

1740  
SUCCESS
;

1742 
	}
}

1748 
	$åy_to_ª°‹e_gc_fun˘i⁄
(
ssd_öfo
 *
ssd
, 
gc_›î©i⁄
 *
gc_node
, 
ch™√l
, 
chù
)

1750 
j
 = -1;

1752 
j
 = 
	`judgög_ªad_ö_gc_chù
(
ssd
, 
ch™√l
);

1753 if(
j
 == 1){

1754 
gc_node
->
sign_f‹_¥ìm±ive
 = 0;

1755 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
gc_node
->
chù_°©us
;

1756 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 = ssd->
cuºít_time
 + 
gc_node
->
chù_√xt_¥edi˘_time_diff
;

1758 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
gc_node
->
chù_√xt_°©us
;

1759 
	`¥ötf
("now g¯ˇ¿bêª°‹ed hîe,ch™√»i†%d \n", 
ch™√l
);

1760 
	`¥ötf_gc_node_öf‹m©i⁄
(
gc_node
);

1761 #ifde‡
DEBUGSUSPEND


1762 
	`¥ötf
("now gc can beÑestored here\n");

1766 #ifde‡
DEBUG


1767 
	`¥ötf
("now gc can'tÑestore here, forÅhereáreÑeads here.\n");

1770 
	}
}

1776 
	$gc_åy_to_su•íd_fun˘i⁄
(
ssd_öfo
 *
ssd
, 
gc_›î©i⁄
 *
gc_node
, 
ch™√l
, 
chù
, 
cuºít_°©e
, 
√xt_°©e
, 
time
)

1778 
j
 = -1;

1780 
j
 = 
	`judgög_ªad_ö_gc_chù
(
ssd
, 
ch™√l
);

1782 
j
 = 1;

1783 if(
j
 == 0){

1784 
gc_node
->
chù_°©us
 = 
cuºít_°©e
;

1785 
gc_node
->
chù_√xt_°©us
 = 
√xt_°©e
;

1786 
gc_node
->
sign_f‹_¥ìm±ive
 = 1;

1787 
gc_node
->
chù_√xt_¥edi˘_time_diff
 = 
time
;

1789 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
UNKNOWN
;

1792 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

1793 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

1794 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 = ssd->
cuºít_time
 +(7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
) ;

1798 
ssd
->
gc_su•íd_times
 ++;

1799 
	`¥ötf
("°©i°ic_su•ísi⁄_gc, vi˘im_block_numbî,ªad, wrôe, wrôe_ö√r,Éø£, ch™√l, chù, dõ,Öœ√, cuºít_timê%d,%d,%d,%d,%d, %d,%d,%d,%d,%Œd\n", 
gc_node
->
vi˘im_block_numbî
, gc_node->
ªad
, gc_node->
wrôe
, gc_node->
gc_wrôe_ö√r
, gc_node->
îa£
, 
ch™√l
, gc_node->
chù
, gc_node->
dõ
, gc_node->
∂™e
, 
ssd
->
cuºít_time
);

1800 
	`¥ötf
("g¯su•ídÅime†i†%d\n", 
ssd
->
gc_su•íd_times
);

1801 
	`¥ötf
("now inÖreemptive state here\n");

1802 
	`¥ötf_gc_node_öf‹m©i⁄
(
gc_node
);

1803 #ifde‡
DEBUG


1804 
	`¥ötf
("now inÖreemptive state here\n");

1808 #ifde‡
DEBUG


1809 
	`¥ötf
("dont haveÅo suspend here\n");

1812 
	}
}

1821 
	$£rvi˚s_2_gc_busy_ö_chù
(
ssd_öfo
 *
ssd
)

1823 
i
 = 0;

1824 
j
 = 0;

1825 
gc_›î©i⁄
 *
gc_node
 = 
NULL
;

1826 
cuºít_°©e
 = 0, 
√xt_°©e
 = 0;

1827 
√xt_°©e_¥edi˘_time
 = 0;

1829 
loˇl
 *
loˇti⁄
 = 
NULL
;

1830 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
block
, 
å™s„r_size
;

1831 #ifde‡
DEBUG


1832 
	`¥ötf
("go into gc busyÖrocess here\n");

1836 if(
ssd
->
debug_sign
 == 1){

1847 
i
 = 0; i < 
ssd
->
∑ømëî
->
ch™√l_numbî
; i++) {

1849 
gc_node
 = 
ssd
->
ch™√l_hód
[
i
].
gc_comm™d
;

1852 if(
gc_node
 =
NULL
){

1853 #ifde‡
DEBUGONLYGC


1854 
	`¥ötf
("hîêch™√»%d ha†nÿg¯! jum∞out.\n", 
i
);

1858 
ch™√l
 = 
i
;

1859 
chù
 = 
gc_node
->chip;

1860 
dõ
 = 
gc_node
->die;

1861 
∂™e
 = 
gc_node
->plane;

1862 
block
 = 
gc_node
->block;

1864 i‡(
gc_node
->
sign_f‹_¥ìm±ive
 == 1){

1865 #ifde‡
DEBUGONLYGC


1866 
	`¥ötf
("here is gcÖreemptive ! jump out.\n");

1872 #ifde‡
DEBUGONLYGC


1874 
	`¥ötf
("hîêi†ch™√»%d begö gc_busy_dó»now.\n", 
i
);

1875 
	`¥ötf_gc_node_öf‹m©i⁄
 (
gc_node
);

1879 i‡(
gc_node
 !
NULL
) {

1880 #ifde‡
DEBUG


1881 
	`¥ötf
("gc must be unNULL sinceÅhis isÅhe channel gc.\n");

1884 
cuºít_°©e
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].current_state;

1885 
√xt_°©e
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].next_state;

1886 
√xt_°©e_¥edi˘_time
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].next_state_predict_time;

1890 if–(
cuºít_°©e
 !
CHIP_GC_RW_BUSY
Ë&& (cuºít_°©ê!
CHIP_ERASE_BUSY
) ) {

1892 #ifde‡
DEBUG


1893 
	`¥ötf
("here channel's chip isÇot gc status ! jump out.\n");

1906 i‡((
gc_node
->
ªad_wrôe_íd
 =-1Ë&& (
√xt_°©e_¥edi˘_time
 <
ssd
->
cuºít_time
)){

1907 #ifde‡
DEBUG


1908 
	`¥ötf
("inÑead_transfer_writeÖart\n");

1911 #ifde‡
DEBUG


1912 
	`¥ötf_ssd_gc_node
(
ssd
);

1919 if–(
gc_node
->
ªad
 =1Ë&& (gc_node->
wrôe
 =0Ë&& (gc_node->
gc_ªad_ö√r
 == 0)) {

1920 #ifde‡
DEBUG


1921 
	`¥ötf
("g¯ªadÖha£,Ñód iãøti⁄†i†%d,™d i¬î sequí˚ i†%d \n", 
gc_node
->
ªad
, gc_node->
gc_ªad_ö√r
);

1927 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_GC_RW_BUSY
;

1928 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

1929 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

1931 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 = ssd->
cuºít_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
;

1934 
gc_node
->
gc_ªad_ö√r
 = 1;

1938 if–
	`gc_åy_to_su•íd_fun˘i⁄
(
ssd
, 
gc_node
, 
ch™√l
, 
chù
, 
CHIP_GC_RW_BUSY
, 
CHIP_IDLE
, ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
) == 1 ){

1952 if–(
gc_node
->
ªad
 =1Ë&& (gc_node->
wrôe
 =0Ë&& (gc_node->
gc_ªad_ö√r
 == 1)) {

1953 #ifde‡
DEBUG


1954 
	`¥ötf
("g¯ªadÖha£,Ñód iãøti⁄†i†%d,™d i¬î sequí˚ i†%d \n", 
gc_node
->
ªad
, gc_node->
gc_ªad_ö√r
);

1959 
gc_node
->
gc_ªad_ö√r
 = -1;

1960 
gc_node
->
ªad
 = 0;

1961 
gc_node
->
wrôe
 = 1;

1969 if–(
gc_node
->
ªad
 =0Ë&& (gc_node->
wrôe
 =1Ë&& (gc_node->
gc_wrôe_ö√r
 >= 0) && (gc_node->gc_write_inner <= 9)) {

1970 #ifde‡
DEBUG


1971 
	`¥ötf
("ch™√»%d, g¯wrôêpha£, wrôêôî©i⁄†i†%d,™d i¬î sequí˚ i†%d \n",
ch™√l
, 
gc_node
->
wrôe
, gc_node->
gc_wrôe_ö√r
);

1978 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_GC_RW_BUSY
;

1979 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

1980 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_GC_RW_BUSY
;

1982 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 = ssd->
cuºít_time
 + 20000;

1984 
gc_node
->
gc_wrôe_ö√r
 ++;

1989 i‡–
	`gc_åy_to_su•íd_fun˘i⁄
(
ssd
, 
gc_node
, 
ch™√l
, 
chù
, 
CHIP_GC_RW_BUSY
, CHIP_GC_RW_BUSY, 20000) == 1){

2005 if–(
gc_node
->
ªad
 =0Ë&& (gc_node->
wrôe
 =1Ë&& (gc_node->
gc_wrôe_ö√r
 == 10)) {

2006 #ifde‡
DEBUG


2007 
	`¥ötf
("g¯wrôêpha£, wrôêôî©i⁄†i†%d,™d i¬î sequí˚ i†%d \n", 
gc_node
->
wrôe
, gc_node->
gc_wrôe_ö√r
);

2013 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

2015 if(
gc_node
->
œ°_∑ge_ö_vi˘im_dól
 == 0)

2017 
gc_node
->
ªad_wrôe_íd
 = 0;

2019 
loˇti⁄
 = (
loˇl
 *Ë
	`mÆloc
((local));

2020 
	`Æloc_as£π
(
loˇti⁄
, "location");

2021 
	`mem£t
(
loˇti⁄
, 0, (
loˇl
));

2023 
loˇti⁄
->
ch™√l
 = channel;

2024 
loˇti⁄
->
chù
 = chip;

2025 
loˇti⁄
->
dõ
 = die;

2026 
loˇti⁄
->
∂™e
 =Ölane;

2027 
loˇti⁄
->
block
 = block;

2028 
loˇti⁄
->
∑ge
 = 
gc_node
->
c›y_∑ge_numbî
;

2029 
	`move_∑ge
(
ssd
, 
loˇti⁄
,

2030 &
å™s„r_size
);

2035 
gc_node
->
gc_wrôe_ö√r
 = -1;

2036 
gc_node
->
ªad
 = 1;

2037 
gc_node
->
wrôe
 = 0;

2043 
loˇti⁄
 = (
loˇl
 *Ë
	`mÆloc
((local));

2044 
	`Æloc_as£π
(
loˇti⁄
, "location");

2045 
	`mem£t
(
loˇti⁄
, 0, (
loˇl
));

2047 
loˇti⁄
->
ch™√l
 = channel;

2048 
loˇti⁄
->
chù
 = chip;

2049 
loˇti⁄
->
dõ
 = die;

2050 
loˇti⁄
->
∂™e
 =Ölane;

2051 
loˇti⁄
->
block
 = block;

2052 
loˇti⁄
->
∑ge
 = 
gc_node
->
c›y_∑ge_numbî
;

2053 
	`move_∑ge
(
ssd
, 
loˇti⁄
,

2054 &
å™s„r_size
);

2057 
	`‰ì
(
loˇti⁄
);

2058 
loˇti⁄
 = 
NULL
;

2066 #ifde‡
DEBUG


2067 
	`¥ötf_ssd_gc_node
(
ssd
);

2077 i‡((
gc_node
->
ªad_wrôe_íd
 =0Ë&& (
√xt_°©e_¥edi˘_time
 <
ssd
->
cuºít_time
)){

2079 #ifde‡
DEBUG


2080 
	`¥ötf
("inÉraseÖart\n");

2082 #ifde‡
DEBUG


2083 
	`¥ötf_ssd_gc_node
(
ssd
);

2088 if(
gc_node
->
îa£
 < (
ssd
->
îa£_ôî©i⁄s
 - 1)){

2091 #ifde‡
DEBUG


2092 
	`¥ötf
("g¯îa£Öha£,Éø£ iãøti⁄†i†%d\n", 
gc_node
->
îa£
);

2096 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_ERASE_BUSY
;

2097 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

2098 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_ERASE_BUSY
;

2100 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 = ssd->
cuºít_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tBERS
/ssd->
îa£_ôî©i⁄s
;

2102 
gc_node
->
îa£
 += 1;

2105 if–
	`gc_åy_to_su•íd_fun˘i⁄
(
ssd
, 
gc_node
, 
ch™√l
, 
chù
, 
CHIP_ERASE_BUSY
, CHIP_ERASE_BUSY, ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tBERS
/ ssd->
îa£_ôî©i⁄s
) == 1){

2119 i‡(
gc_node
->
îa£
 =(
ssd
->
îa£_ôî©i⁄s
 - 1)) {

2120 #ifde‡
DEBUG


2121 
	`¥ötf
("g¯îa£Öha£,Éø£ iãøti⁄†i†%d\n", 
gc_node
->
îa£
);

2126 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_ERASE_BUSY
;

2127 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

2128 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

2130 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 = ssd->
cuºít_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tBERS
/ ssd->
îa£_ôî©i⁄s
;

2131 
gc_node
->
îa£
 = 
ssd
->
îa£_ôî©i⁄s
;

2134 if–
	`gc_åy_to_su•íd_fun˘i⁄
(
ssd
, 
gc_node
, 
ch™√l
, 
chù
, 
CHIP_ERASE_BUSY
, 
CHIP_IDLE
, ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tBERS
/ssd->
îa£_ôî©i⁄s
) == 1){

2149 i‡(
gc_node
->
îa£
 =
ssd
->
îa£_ôî©i⁄s
) {

2150 #ifde‡
DEBUG


2151 
	`¥ötf
("g¯îa£Öha£,Éø£ iãøti⁄†i†%d\n", 
gc_node
->
îa£
);

2165 
	`îa£_›î©i⁄
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
block
);

2167 
	`¥ötf
("now g¯föished i¿ch™√»%d\n", 
i
);

2168 
	`dñëe_gc_node
(
ssd
, 
ch™√l
, 
gc_node
);

2185 
	}
}

2189 
	$assign_rightvÆue_f‹_com∂ëed_m≠pögªœãd_subªque°
(
sub_ªque°
* 
sub
)

2191 if–(
sub
->
waô_evi˘_sign
 =1)&& (sub->
waô_„tch_m≠pögèbÀ_sign
 == 1) ){

2192 
sub
->
waô_evi˘_sign_föished
 = 1;

2194 if–(
sub
->
waô_evi˘_sign
 =0)&& (sub->
waô_„tch_m≠pögèbÀ_sign
 == 1) ){

2195 
sub
->
waô_„tch_m≠pögèbÀ_sign_föished
 = 1;

2198 
	}
}

2202 
	$wrôe_ã°_dñëi⁄_f‹_subªque°
(
ssd_öfo
 *
ssd
)

2204 
i
 = 0;

2205 
sub_ªque°
 *
sub
 = 
NULL
, *
p
 = NULL;

2207 
ãmp_chù_numbî
 = 0 ;

2208 
ãmpch™√l_ªad_Àngth
 = 0;

2210 
gc_›î©i⁄
 *
gc_node
 = 
NULL
;

2211 
chù
 ;

2218 
i
 = 0; i <

2219 
ssd
->
∑ømëî
->
ch™√l_numbî
; 
i
++)

2221 
sub
 = 
ssd
->
ch™√l_hód
[
i
].
subs_w_hód
;

2222 
p
 = 
sub
;

2223 
sub
 !
NULL
) {

2227 if(
sub
->
loˇti⁄
 =
NULL
){

2228 
	`¥ötf
("subs_r_hódÜoˇti⁄ i†wr⁄g,now i†wr⁄gÑód hîe.ch™√»i†%d, \n", 
i
);

2235 if(
i
 !
sub
->
loˇti⁄
->
ch™√l
){

2236 
	`¥ötf
("here what kind of wrong???\n");

2241 
chù
 = 
sub
->
loˇti⁄
->chip;

2243 i‡((
sub
->
cuºít_°©e
 =
SR_COMPLETE
) ||

2244 ((
sub
->
√xt_°©e
 =
SR_COMPLETE
Ë&& (sub->
√xt_°©e_¥edi˘_time
 <
ssd
->
cuºít_time
))) {

2246 
	`ssdsim_msg
("wrong in deletion for subrequestÇow forÑead");

2253 
sub
 = sub->
√xt_node
;

2260  
SUCCESS
;

2263 
	}
}

2270 
	$ªad_ã°_dñëi⁄_f‹_subªque°
(
ssd_öfo
 *
ssd
)

2272 
i
 = 0;

2273 
sub_ªque°
 *
sub
 = 
NULL
, *
p
 = NULL;

2275 
ãmp_chù_numbî
 = 0 ;

2276 
ãmpch™√l_ªad_Àngth
 = 0;

2278 
gc_›î©i⁄
 *
gc_node
 = 
NULL
;

2279 
chù
 ;

2286 
i
 = 0; i <

2287 
ssd
->
∑ømëî
->
ch™√l_numbî
; 
i
++)

2289 
sub
 = 
ssd
->
ch™√l_hód
[
i
].
subs_r_hód
;

2290 
p
 = 
sub
;

2291 
sub
 !
NULL
) {

2295 if(
sub
->
loˇti⁄
 =
NULL
){

2296 
	`¥ötf
("subs_r_hódÜoˇti⁄ i†wr⁄g,now i†wr⁄gÑód hîe.ch™√»i†%d, \n", 
i
);

2303 if(
i
 !
sub
->
loˇti⁄
->
ch™√l
){

2304 
	`¥ötf
("here what kind of wrong???\n");

2309 
chù
 = 
sub
->
loˇti⁄
->chip;

2311 i‡((
sub
->
cuºít_°©e
 =
SR_COMPLETE
) ||

2312 ((
sub
->
√xt_°©e
 =
SR_COMPLETE
Ë&& (sub->
√xt_°©e_¥edi˘_time
 <
ssd
->
cuºít_time
))) {

2314 
	`ssdsim_msg
("wrong in deletion for subrequestÇow forÑead");

2321 
sub
 = sub->
√xt_node
;

2328  
SUCCESS
;

2331 
	}
}

2339 
	$£rvi˚s_2_r_cmd_å™s_™d_com∂ëe
(
ssd_öfo
 *
ssd
) {

2340 
i
 = 0;

2341 
sub_ªque°
 *
sub
 = 
NULL
, *
p
 = NULL;

2343 
ãmp_chù_numbî
 = 0 ;

2344 
ãmpch™√l_ªad_Àngth
 = 0;

2346 
gc_›î©i⁄
 *
gc_node
 = 
NULL
;

2347 
chù
 ;

2348 #ifde‡
DEBUGSUSPEND


2349 
	`¥ötf
("go into services_2_r_cmd_trans_and_complete\n");

2353 
i
 = 0; i <

2354 
ssd
->
∑ømëî
->
ch™√l_numbî
; 
i
++)

2356 
sub
 = 
ssd
->
ch™√l_hód
[
i
].
subs_r_hód
;

2358 
sub
 !
NULL
) {

2361 if(
sub
->
loˇti⁄
 =
NULL
){

2362 
	`¥ötf
("lxc,now i†wr⁄gÑód hîe.ch™√»i†%d, \n", 
i
);

2369 if(
i
 !
sub
->
loˇti⁄
->
ch™√l
){

2370 
	`¥ötf
("here what kind of wrong???\n");

2372 
chù
 = 
sub
->
loˇti⁄
->chip;

2373 #ifde‡
DEBUGSUSPEND


2376 
	`¥ötf
(":£rvi˚s_2_r_cmd_å™s_™d_com∂ëêsub inf‹m©i⁄: ch™√»%d, chù %d, dõ %d,Öœ√ %d,Ö≤ %d,sub->cuºít_timê%Œd, sub->√xt_timê%Œd,ssd-> cuºít_timê%Œd, sub->cuºít_°©ê%d, sub->√xt_°©ê%d\n",
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
∂™e
, sub->
µn
, sub->
cuºít_time
, sub->
√xt_°©e_¥edi˘_time
, 
ssd
->cuºít_time,sub->
cuºít_°©e
, sub->
√xt_°©e
 );

2379 i‡(
sub
->
cuºít_°©e
 ==

2380 
SR_R_C_A_TRANSFER
)

2382 
	`åa˚Ród_msg
("sub cuºít_°©êi†SR_R_C_A_TRANSFER,sub i†%Œd\n",
sub
);

2384 i‡(
sub
->
√xt_°©e_¥edi˘_time
 <
ssd
->
cuºít_time
) {

2386 
	`åa˚Ród_msg
("öÑód_cmd_™d_com∂ëêfun˘i⁄,begöÅÿ£rvi˚,™d gÿ⁄ê°ï sub %Œd ->begö_timêi†%Œd,sub->cuºít_timêi†%Œd, ssd->cuºít_timêi†%Œd ", 
sub
, sub->
begö_time
, sub->
cuºít_time
, 
ssd
->current_time);

2387 
	`go_⁄e_°ï
(
ssd
, 
sub
, 
NULL
, 
SR_R_READ
, 
NORMAL
);

2391 
sub
 = sub->
√xt_node
;

2397 
i
 = 0; i <

2398 
ssd
->
∑ømëî
->
ch™√l_numbî
; 
i
++)

2400 
sub
 = 
ssd
->
ch™√l_hód
[
i
].
subs_r_hód
;

2401 
p
 = 
sub
;

2402 
sub
 !
NULL
) {

2406 if(
sub
->
loˇti⁄
 =
NULL
){

2407 
	`¥ötf
("subs_r_hódÜoˇti⁄ i†wr⁄g,now i†wr⁄gÑód hîe.ch™√»i†%d, \n", 
i
);

2414 if(
i
 !
sub
->
loˇti⁄
->
ch™√l
){

2415 
	`¥ötf
("here what kind of wrong???\n");

2420 
chù
 = 
sub
->
loˇti⁄
->chip;

2422 i‡((
sub
->
cuºít_°©e
 =
SR_COMPLETE
) ||

2423 ((
sub
->
√xt_°©e
 =
SR_COMPLETE
Ë&& (sub->
√xt_°©e_¥edi˘_time
 <
ssd
->
cuºít_time
))) {

2443 
	`ssdsim_msg
("ö sîvi˚s_2_r_cmd_å™s_™d_com∂ëe, wêwû»assig¿sub %Œd, com∂ëed m≠pögÅhögs", 
sub
);

2445 if–(
sub
->
waô_evi˘_sign
 =0)&& (sub->
waô_„tch_m≠pögèbÀ_sign
 == 1) ){

2446 
	`assign_rightvÆue_f‹_com∂ëed_m≠pögªœãd_subªque°
(
sub
);

2454 #ifde‡
DEBUGSUSPEND


2455 
	`¥ötf
("now gÿötÿªad com∂ëêfun˘i⁄.sub->cuºít_ßèã i†(%d)=SR_COMPLETE o∏sub->√xt_°©êi†(%d)=COMPLETE,\n",
sub
->
cuºít_°©e
, sub->
√xt_°©e
);

2468 
ãmp_chù_numbî
 = 0, 
ãmpch™√l_ªad_Àngth
 = 0;Åemp_chù_numbî < (
ssd
->
∑ømëî
->
chù_num
 / ssd->∑ømëî->
ch™√l_numbî
);Åemp_chip_number ++){

2469 
	`åa˚Eº‹_msg
("ch™√»%d, chù %d,Ñód_Àngth i†%d", 
i
, 
ãmp_chù_numbî
, 
ssd
->
ch™√l_hód
[i].
chù_hód
[ãmp_chù_numbî].
chù_ªad_queue_Àngth
);

2470 
ãmpch™√l_ªad_Àngth
 +
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
ãmp_chù_numbî
].
chù_ªad_queue_Àngth
;

2475 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
chù_ªad_queue_Àngth
 --;

2479 i‡(
sub
 !=

2480 
ssd
->
ch™√l_hód
[
i
].
subs_r_hód
)

2482 
	`¥ötf
("not head\n");

2485 if(
sub
 =
ssd
->
ch™√l_hód
[
i
].
subs_r_èû
){

2488 
p
->
√xt_node
 = 
NULL
;

2489 
ssd
->
ch™√l_hód
[
i
].
subs_r_èû
 = 
p
;

2493 
p
->
√xt_node
 = 
sub
->next_node;

2495 
sub
 = sub->
√xt_node
;

2502 if(
ãmpch™√l_ªad_Àngth
 == 0){

2503 
	`ssdsim_msg
("1wrong in deletingÑead completed");

2509 if(
ãmpch™√l_ªad_Àngth
 == 1){

2510 
ssd
->
ch™√l_hód
[
i
].
subs_r_hód
 = 
NULL
;

2511 
ssd
->
ch™√l_hód
[
i
].
subs_r_èû
 = 
NULL
;

2516 
ssd
->
ch™√l_hód
[
i
].
subs_r_hód
 = ssd->ch™√l_hód[i].subs_r_hód->
√xt_node
;

2517 
sub
 = sub->
√xt_node
;

2518 
p
 = 
sub
;

2519 if(
sub
 !
ssd
->
ch™√l_hód
[
i
].
subs_r_hód
){

2520 
	`ssdsim_msg
("3_deletereadwrongin channelhead");

2533 if((
ãmpch™√l_ªad_Àngth
 !0Ë&&(–
ssd
->
ch™√l_hód
[
i
].
subs_r_èû
 =
NULL
Ë|| ( ssd->ch™√l_hód[i].
subs_r_hód
 == NULL))){

2534 
	`¥ötf
("stop here, sinceÜist deleting inÑead sub completion is wrong.\n");

2541 if(
ssd
->
ch™√l_hód
[
i
].
subs_r_èû
 =ssd->ch™√l_hód[i].
subs_r_hód
){

2544 
p
 = 
sub
;

2545 
sub
 = sub->
√xt_node
;

2574  
SUCCESS
;

2575 
	}
}

2581 
Sètus
 
	$£rvi˚s_2_r_d©a_å™s
(
ssd_öfo
 *
ssd
, 
ch™√l
, *
ch™√l_busy_Êag
,

2582 *
ch™ge_cuºít_time_Êag
) {

2583 
chù
 = 0;

2584 
dõ
 = 0, 
∂™e
 = 0, 
addªss_µn
 = 0, 
dõ1
 = 0;

2585 
sub_ªque°
 *
sub
 = 
NULL
, *
p
 = NULL, *
sub1
 = NULL;

2586 
sub_ªque°
 *
sub_tw›œ√_⁄e
 = 
NULL
, *
sub_tw›œ√_two
 = NULL;

2587 
sub_ªque°
 *
sub_öãæóve_⁄e
 = 
NULL
, *
sub_öãæóve_two
 = NULL;

2588 
chù
 = 0; chù < 
ssd
->
ch™√l_hód
[
ch™√l
].chip; chip++) {

2589 i‡((
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 =
CHIP_WAIT
) ||

2590 ((
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 =
CHIP_DATA_TRANSFER
) &&

2591 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 <ssd->
cuºít_time
))) {

2592 
dõ
 = 0; dõ < 
ssd
->
∑ømëî
->
dõ_chù
; die++) {

2593 
sub
 = 
	`föd_ªad_sub_ªque°
(
ssd
, 
ch™√l
, 
chù
, 
dõ
);

2594 i‡(
sub
 !
NULL
) {

2599 i‡(
sub
 =
NULL
) {

2603 #ifde‡
DEBUGSUSPEND


2604 
	`¥ötf
("SERVICES_2_r_d©a_å™s, sub from föd_ªad_sub_ªque°,sub inf‹m©i⁄: ch™√»%d, chù %d, dõ %d,Öœ√ %d,Ö≤ %d\n",
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
∂™e
, sub->
µn
);

2614 i‡(((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_TWOPLANE_READ
) == AD_TWOPLANE_READ) ||

2615 ((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) == AD_INTERLEAVE)) {

2616 i‡((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_TWOPLANE_READ
) ==

2617 
AD_TWOPLANE_READ
)

2619 #ifde‡
DEBUG


2620 
	`¥ötf
("only hasád_twoplane_read\n");

2622 
sub_tw›œ√_⁄e
 = 
sub
;

2623 
sub_tw›œ√_two
 = 
NULL
;

2625 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
sub
->
loˇti⁄
->
∂™e
].
add_ªg_µn
 = -1;

2626 
sub_tw›œ√_two
 = 
	`föd_ªad_sub_ªque°
(
ssd
, 
ch™√l
, 
chù
,

2627 
dõ
);

2633 i‡(
sub_tw›œ√_two
 =
NULL
) {

2634 
	`go_⁄e_°ï
(
ssd
, 
sub_tw›œ√_⁄e
, 
NULL
, 
SR_R_DATA_TRANSFER
, 
NORMAL
);

2635 *
ch™ge_cuºít_time_Êag
 = 0;

2636 *
ch™√l_busy_Êag
 = 1;

2639 
	`go_⁄e_°ï
(
ssd
, 
sub_tw›œ√_⁄e
, 
sub_tw›œ√_two
, 
SR_R_DATA_TRANSFER
, 
TWO_PLANE
);

2640 *
ch™ge_cuºít_time_Êag
 = 0;

2641 *
ch™√l_busy_Êag
 = 1;

2644 } i‡((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) ==

2645 
AD_INTERLEAVE
)

2647 #ifde‡
DEBUG


2648 
	`¥ötf
("opps,Çever here forád_interleave\n");

2650 
sub_öãæóve_⁄e
 = 
sub
;

2651 
sub_öãæóve_two
 = 
NULL
;

2652 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
sub
->
loˇti⁄
->
∂™e
].
add_ªg_µn
 = -1;

2654 
dõ1
 = 0; dõ1 < 
ssd
->
∑ømëî
->
dõ_chù
; die1++) {

2655 i‡(
dõ1
 !
dõ
) {

2656 
sub_öãæóve_two
 = 
	`föd_ªad_sub_ªque°
(
ssd
, 
ch™√l
, 
chù
,

2657 
dõ1
);

2658 i‡(
sub_öãæóve_two
 !
NULL
) {

2663 i‡(
sub_öãæóve_two
 =
NULL
) {

2664 
	`go_⁄e_°ï
(
ssd
, 
sub_öãæóve_⁄e
, 
NULL
, 
SR_R_DATA_TRANSFER
, 
NORMAL
);

2666 *
ch™ge_cuºít_time_Êag
 = 0;

2667 *
ch™√l_busy_Êag
 = 1;

2670 
	`go_⁄e_°ï
(
ssd
, 
sub_tw›œ√_⁄e
, 
sub_öãæóve_two
, 
SR_R_DATA_TRANSFER
, 
INTERLEAVE
);

2672 *
ch™ge_cuºít_time_Êag
 = 0;

2673 *
ch™√l_busy_Êag
 = 1;

2679 #ifde‡
DEBUGSUSPEND


2680 
	`¥ötf
("SERVICES_2_r_data_trans, in chipÉnter go_one_step(SR_R_DATA_TRANSFER)Çow\n");

2683 
	`go_⁄e_°ï
(
ssd
, 
sub
, 
NULL
, 
SR_R_DATA_TRANSFER
, 
NORMAL
);

2684 *
ch™ge_cuºít_time_Êag
 = 0;

2685 *
ch™√l_busy_Êag
 = 1;

2691 i‡(*
ch™√l_busy_Êag
 == 1) {

2695  
SUCCESS
;

2696 
	}
}

2702 
	$£rvi˚s_2_r_waô
(
ssd_öfo
 *
ssd
, 
ch™√l
, *
ch™√l_busy_Êag
,

2703 *
ch™ge_cuºít_time_Êag
) {

2704 
∂™e
 = 0, 
addªss_µn
 = 0;

2705 
sub_ªque°
 *
sub
 = 
NULL
, *
p
 = NULL;

2706 
sub_ªque°
 *
sub_tw›œ√_⁄e
 = 
NULL
, *
sub_tw›œ√_two
 = NULL;

2707 
sub_ªque°
 *
sub_öãæóve_⁄e
 = 
NULL
, *
sub_öãæóve_two
 = NULL;

2709 
sub_ªque°
 *
ãmp_f‹_wrôesub
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
;

2711 
sub
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_r_hód
;

2713 #ifde‡
DEBUGSUSPEND


2714 
	`¥ötf
("enter services_2_r_wait\n");

2717 i‡((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_TWOPLANE_READ
) ==

2718 
AD_TWOPLANE_READ
)

2720 #ifde‡
DEBUGSUSPEND


2721 
	`¥ötf
("enter services_2_r_wait AD_TWOPLANE_READ\n");

2725 
sub_tw›œ√_⁄e
 = 
NULL
;

2726 
sub_tw›œ√_two
 = 
NULL
;

2728 
	`föd_öãæóve_tw›œ√_sub_ªque°
(
ssd
, 
ch™√l
, 
sub_tw›œ√_⁄e
, 
sub_tw›œ√_two
, 
TWO_PLANE
);

2730 i‡(
sub_tw›œ√_two
 !
NULL
)

2732 #ifde‡
DEBUG


2733 
	`¥ötf
("opps,Çever happen,enter services_2_r_wait\n");

2736 
	`go_⁄e_°ï
(
ssd
, 
sub_tw›œ√_⁄e
, 
sub_tw›œ√_two
, 
SR_R_C_A_TRANSFER
, 
TWO_PLANE
);

2738 *
ch™ge_cuºít_time_Êag
 = 0;

2739 *
ch™√l_busy_Êag
 = 1;

2740 } i‡((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) !=

2741 
AD_INTERLEAVE
)

2743 #ifde‡
DEBUG


2744 
	`¥ötf
("opps1,Çever happenálso here, services_2_r_wait\n");

2747 
sub
 !=

2748 
NULL
)

2750 i‡(
sub
->
cuºít_°©e
 =
SR_WAIT
) {

2752 i‡((
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
cuºít_°©e
 ==

2753 
CHIP_IDLE
) ||

2754 ((
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
√xt_°©e
 ==

2755 
CHIP_IDLE
) &&

2756 (
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 <=

2757 
ssd
->
cuºít_time
))) {

2758 
	`go_⁄e_°ï
(
ssd
, 
sub
, 
NULL
, 
SR_R_C_A_TRANSFER
, 
NORMAL
);

2760 *
ch™ge_cuºít_time_Êag
 = 0;

2761 *
ch™√l_busy_Êag
 = 1;

2767 
sub
 = sub->
√xt_node
;

2771 i‡((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) ==

2772 
AD_INTERLEAVE
)

2774 #ifde‡
DEBUGSUSPEND


2775 
	`¥ötf
("enter services_2_r_wait INTERLEAVE\n");

2779 
sub_öãæóve_⁄e
 = 
NULL
;

2780 
sub_öãæóve_two
 = 
NULL
;

2781 
	`föd_öãæóve_tw›œ√_sub_ªque°
(
ssd
, 
ch™√l
, 
sub_öãæóve_⁄e
, 
sub_öãæóve_two
, 
INTERLEAVE
);

2783 i‡(
sub_öãæóve_two
 !
NULL
)

2785 #ifde‡
DEBUG


2786 
	`¥ötf
("opps2,Çever happen services_2_r_wait\n");

2790 
	`go_⁄e_°ï
(
ssd
, 
sub_öãæóve_⁄e
, 
sub_öãæóve_two
, 
SR_R_C_A_TRANSFER
, 
INTERLEAVE
);

2792 *
ch™ge_cuºít_time_Êag
 = 0;

2793 *
ch™√l_busy_Êag
 = 1;

2796 #ifde‡
DEBUG


2797 
	`¥ötf
("in services_2_r_wait, only here\n");

2800 
sub
 !=

2801 
NULL
)

2803 i‡(
sub
->
cuºít_°©e
 =
SR_WAIT
) {

2804 i‡((
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
cuºít_°©e
 ==

2805 
CHIP_IDLE
) ||

2806 ((
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
√xt_°©e
 ==

2807 
CHIP_IDLE
) &&

2808 (
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 <=

2809 
ssd
->
cuºít_time
))) {

2811 
	`go_⁄e_°ï
(
ssd
, 
sub
, 
NULL
, 
SR_R_C_A_TRANSFER
, 
NORMAL
);

2813 *
ch™ge_cuºít_time_Êag
 = 0;

2814 *
ch™√l_busy_Êag
 = 1;

2822 
sub
 = sub->
√xt_node
;

2830 i‡(((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) != AD_INTERLEAVE) &&

2831 ((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_TWOPLANE_READ
) != AD_TWOPLANE_READ)) {

2832 
sub
 !=

2833 
NULL
)

2836 #ifde‡
DEBUGSUSPEND


2837 
	`¥ötf
("begöÉ¡î sîvi˚s_2_r_waô NOádv™˚ comm™ds,hîêi†sub inf‹m©i⁄, but, somêo‡themáªÇŸ u£ful, sub cuºít_°©ê%d, sub cuºít_timê%Œd, subÇext_°©ê%d,subÇexà¥edi˘Åimê%Œd, sub begö_timê%Œd, sub ch™√»%d, sub chù %d, sub dõ %d, subÖœ√ %d, sub block %d, subÖagê%d, sub->Õ¿%d\n",
sub
->
cuºít_°©e
, sub->
cuºít_time
, sub->
√xt_°©e
, sub->
√xt_°©e_¥edi˘_time
, sub->
begö_time
, sub->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
∂™e
, sub->loˇti⁄->
block
, sub->loˇti⁄->
∑ge
, sub->
Õn
);

2840 
	`åa˚Ród_msg
("öÑód_waô fun˘i⁄,begöÅÿ£rvi˚ sub %Œd ->begö_timêi†%Œd, ssd->cuºít_timêi†%Œd ", 
sub
, sub->
begö_time
, 
ssd
->
cuºít_time
);

2842 i‡–(
sub
->
cuºít_°©e
 =
SR_WAIT
Ë&&(sub->
begö_time
 <
ssd
->
cuºít_time
)) {

2844 i‡((
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
cuºít_°©e
 ==

2845 
CHIP_IDLE
) ||

2846 ((
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
√xt_°©e
 ==

2847 
CHIP_IDLE
) &&

2848 (
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 <=

2849 
ssd
->
cuºít_time
))) {

2898 
	`åa˚Ród_msg
("nowáÃódy c™ sîvi˚ sub %Œd ->begö_timêi†%Œd, ssd->cuºít_timêi†%Œd ", 
sub
, sub->
begö_time
, 
ssd
->
cuºít_time
);

2900 
	`go_⁄e_°ï
(
ssd
, 
sub
, 
NULL
, 
SR_R_C_A_TRANSFER
, 
NORMAL
);

2901 
	`ssdsim_msg
("go out from go_one_step with sr_r_c_a_transfer");

2903 *
ch™ge_cuºít_time_Êag
 = 0;

2904 *
ch™√l_busy_Êag
 = 1;

2910 
sub
 = sub->
√xt_node
;

2914  
SUCCESS
;

2915 
	}
}

2919 
	$judge_wrôe_exi°ög_ö_chù
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
)

2923 
sub_ªque°
 *
ãmp_sub
 = 
NULL
;

2924 
ãmp_sub
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_r_hód
;

2925 
ãmp_sub
 !
NULL
){

2927 if(
ãmp_sub
->
loˇti⁄
->
chù
 == chip){

2928 if(
ãmp_sub
->
›î©i⁄
 == 0){

2932 
ãmp_sub
 =Åemp_sub->
√xt_node
;

2934 
ãmp_sub
 =Åemp_sub->
√xt_node
;

2940 
	}
}

2944 
sub_ªque°
* 
	$gë_the_¥evious_sub
(
ssd_öfo
* 
ssd
, 
ch™√l
, 
sub_ªque°
 * 
sub
)

2946 
sub_ªque°
* 
¥e_sub
 = 
NULL
;

2950 
	}
}

2955 
	$dñëe_w_sub_ªque°
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
sub_ªque°
 *
sub
) {

2956 
sub_ªque°
 *
p
 = 
NULL
;

2961 
ssd
->
ch™√l_hód
[
sub
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub->loˇti⁄->
chù
].
chù_wrôe_queue_Àngth
 --;

2962 #ifde‡
DEBUGSUSPEND


2963 
	`¥ötf
("ch™√»[%d], chù [%d],dõ [%d], block[%d],Öage[%d], wrôêqueuêÀngth möu†⁄ê%d\n",
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
block
, sub->loˇti⁄->
∑ge
, 
ssd
->
ch™√l_hód
[sub->loˇti⁄->ch™√l].
chù_hód
[sub->loˇti⁄->chù].
chù_wrôe_queue_Àngth
);

2966 i‡(
sub
 =
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
)

2968 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 !ssd->ch™√l_hód[ch™√l].
subs_w_èû
) {

2969 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 = 
sub
->
√xt_node
;

2971 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 = 
NULL
;

2972 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_èû
 = 
NULL
;

2975 
p
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
;

2976 
p
->
√xt_node
 !
sub
) {

2977 
p
 =Ö->
√xt_node
;

2980 i‡(
sub
->
√xt_node
 !
NULL
) {

2981 
p
->
√xt_node
 = 
sub
->next_node;

2983 
p
->
√xt_node
 = 
NULL
;

2984 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_èû
 = 
p
;

2988  
SUCCESS
;

2989 
	}
}

2994 
Sètus


2995 
	$c›y_back
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
sub_ªque°
 *
sub
) {

2996 
ﬁd_µn
 = -1, 
√w_µn
 = -1;

2997 
time
 = 0;

2998 i‡(
ssd
->
∑ømëî
->
gªed_CB_ad
 == 1)

3000 
ﬁd_µn
 = -1;

3001 i‡(
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
°©e
 !=

3004 i‡((
sub
->
°©e
 & 
ssd
->
døm
->
m≠
->
m≠_íåy
[sub->
Õn
].state) == ssd->dram->map->map_entry[sub->lpn].state) {

3005 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

3006 (
sub
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

3007 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

3009 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 19 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

3010 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
 +

3011 (
sub
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

3012 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

3013 
ssd
->
c›y_back_cou¡
++;

3014 
ssd
->
ªad_cou¡
++;

3015 
ssd
->
upd©e_ªad_cou¡
++;

3016 
ﬁd_µn
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
≤
;

3019 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

3020 (
sub
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

3021 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

3023 
sub
->
com∂ëe_time
 = sub->
√xt_°©e_¥edi˘_time
;

3024 
time
 = 
sub
->
com∂ëe_time
;

3026 
	`gë_µn
(
ssd
, 
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
∂™e
, sub);

3028 i‡(
ﬁd_µn
 !=

3031 
√w_µn
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
≤
;

3032 
ﬁd_µn
 % 2 !
√w_µn
 % 2)

3034 
	`gë_µn
(
ssd
, 
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
∂™e
,

3035 
sub
);

3036 
ssd
->
¥ogøm_cou¡
--;

3037 
ssd
->
wrôe_Êash_cou¡
--;

3038 
ssd
->
wa°e_∑ge_cou¡
++;

3039 
√w_µn
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
≤
;

3044 i‡(
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
°©e
 != 0) {

3045 i‡((
sub
->
°©e
 & 
ssd
->
døm
->
m≠
->
m≠_íåy
[sub->
Õn
].state) == ssd->dram->map->map_entry[sub->lpn].state) {

3046 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

3047 (
sub
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

3048 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

3049 
	`gë_µn
(
ssd
, 
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
∂™e
,

3050 
sub
);

3052 
ﬁd_µn
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
≤
;

3053 
	`gë_µn
(
ssd
, 
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
∂™e
,

3054 
sub
);

3055 
√w_µn
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
≤
;

3056 i‡(
ﬁd_µn
 % 2 =
√w_µn
 % 2) {

3057 
ssd
->
c›y_back_cou¡
++;

3058 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 19 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

3059 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
 +

3060 (
sub
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

3061 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

3063 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

3064 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
 +

3065 (
	`size
(
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
°©e
)) *

3066 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tRC
 +

3067 (
sub
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

3068 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

3070 
ssd
->
ªad_cou¡
++;

3071 
ssd
->
upd©e_ªad_cou¡
++;

3074 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

3075 (
sub
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

3076 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

3077 
	`gë_µn
(
ssd
, 
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
∂™e
, sub);

3079 
sub
->
com∂ëe_time
 = sub->
√xt_°©e_¥edi˘_time
;

3080 
time
 = 
sub
->
com∂ëe_time
;

3086 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_TRANSFER
;

3087 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

3088 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

3089 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 = 
time
;

3091 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_WRITE_BUSY
;

3092 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

3093 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

3094 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

3095 
time
 + 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG
;

3097  
SUCCESS
;

3098 
	}
}

3103 
Sètus


3104 
	$°©ic_wrôe
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
sub_ªque°
 *
sub
) {

3105 
time
 = 0;

3106 i‡(
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
°©e
 !=

3109 i‡((
sub
->
°©e
 & 
ssd
->
døm
->
m≠
->
m≠_íåy
[sub->
Õn
].state) ==

3110 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
°©e
)

3112 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

3113 (
sub
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

3114 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

3116 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

3117 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
 +

3118 (
	`size
((
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
°©e
 ^ sub->state))) *

3119 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tRC
 +

3120 (
sub
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

3121 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

3122 
ssd
->
ªad_cou¡
++;

3123 
ssd
->
upd©e_ªad_cou¡
++;

3126 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

3127 (
sub
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

3128 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

3130 
sub
->
com∂ëe_time
 = sub->
√xt_°©e_¥edi˘_time
;

3131 
time
 = 
sub
->
com∂ëe_time
;

3133 
	`gë_µn
(
ssd
, 
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
∂™e
, sub);

3138 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_TRANSFER
;

3139 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

3140 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

3141 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 = 
time
;

3143 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_WRITE_BUSY
;

3144 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

3145 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

3146 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

3147 
time
 + 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG
;

3149  
SUCCESS
;

3150 
	}
}

3155 
	$√w_£rvi˚s_2_wrôe
(
ssd_öfo
 *
ssd
, 
ch™√l
, *
ch™√l_busy_Êag
,

3156 *
ch™ge_cuºít_time_Êag
) {

3157 
j
 = 0, 
chù
 = 0;

3158 
k
 = 0;

3159 
ﬁd_µn
 = 0, 
√w_µn
 = 0;

3160 
chù_tokí
 = 0, 
dõ_tokí
 = 0, 
∂™e_tokí
 = 0, 
addªss_µn
 = 0;

3161 
dõ
 = 0, 
∂™e
 = 0;

3162 
time
 = 0;

3163 
sub_ªque°
 *
sub
 = 
NULL
, *
p
 = NULL;

3164 
sub_ªque°
 *
sub_tw›œ√_⁄e
 = 
NULL
, *
sub_tw›œ√_two
 = NULL;

3165 
sub_ªque°
 *
sub_öãæóve_⁄e
 = 
NULL
, *
sub_öãæóve_two
 = NULL;

3171 #ifde‡
DEBUG


3172 
	`¥ötf
("íã∏£rvi˚s_2_wrôe, ch™√»i†%d, ch™√l_busy_Êag i†%d, ch™ge_cuºít_time_Êag i†%d\n",
ch™√l
, *
ch™√l_busy_Êag
, *
ch™ge_cuºít_time_Êag
);

3174 i‡((
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 !
NULL
) || (ssd->subs_w_head != NULL)) {

3175 i‡(
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 == 0)

3177 
j
 = 0; j < 
ssd
->
ch™√l_hód
[
ch™√l
].
chù
; j++) {

3178 i‡((
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 =
NULL
) && (ssd->subs_w_head == NULL)) {

3183 
chù_tokí
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
;

3184 #ifde‡
DEBUG


3185 
	`¥ötf
("ch™√»%d'†chùÅokí i†%d\n", 
ch™√l
, 
chù_tokí
);

3189 i‡(*
ch™√l_busy_Êag
 == 0) {

3190 i‡((
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
cuºít_°©e
 =
CHIP_IDLE
) ||

3191 ((
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
√xt_°©e
 =
CHIP_IDLE
) &&

3192 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
√xt_°©e_¥edi˘_time
 <=

3193 
ssd
->
cuºít_time
))) {

3194 i‡((
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 =
NULL
) && (ssd->subs_w_head == NULL)) {

3197 
dõ_tokí
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
tokí
;

3198 #ifde‡
DEBUG


3199 
	`¥ötf
("ch™√»%d'†chùÅokí i†%d,dõÅokí i†%d\n", 
ch™√l
, 
chù_tokí
, 
dõ_tokí
);

3203 i‡(((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) != AD_INTERLEAVE) &&

3204 ((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_TWOPLANE
) !=

3205 
AD_TWOPLANE
))

3207 #ifde‡
DEBUG


3208 
	`¥ötf
("if you haveÇot setádvanced command,then only doÇormalÑeadánd write\n");

3211 
sub
 = 
	`föd_wrôe_sub_ªque°
(
ssd
, 
ch™√l
);

3212 i‡(
sub
 =
NULL
) {

3216 i‡(
sub
->
cuºít_°©e
 =
SR_WAIT
) {

3217 
∂™e_tokí
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
dõ_hód
[
dõ_tokí
].
tokí
;

3219 
	`gë_µn
(
ssd
, 
ch™√l
, 
chù_tokí
, 
dõ_tokí
, 
∂™e_tokí
, 
sub
);

3221 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
dõ_hód
[
dõ_tokí
].
tokí
 =

3222 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
dõ_hód
[
dõ_tokí
].
tokí
 +

3223 1Ë% 
ssd
->
∑ømëî
->
∂™e_dõ
;

3225 *
ch™ge_cuºít_time_Êag
 = 0;

3227 i‡(
ssd
->
∑ømëî
->
ad_¥i‹ôy2
 == 0) {

3228 
ssd
->
ªÆ_time_subªq
--;

3230 
	`go_⁄e_°ï
(
ssd
, 
sub
, 
NULL
, 
SR_W_TRANSFER
, 
NORMAL
);

3231 
	`dñëe_w_sub_ªque°
(
ssd
, 
ch™√l
, 
sub
);

3233 *
ch™√l_busy_Êag
 = 1;

3239 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
tokí
 =

3240 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
tokí
 + 1) %

3241 
ssd
->
∑ømëî
->
dõ_chù
;

3242 
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
 =

3243 (
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
 + 1Ë% ssd->
∑ømëî
->
chù_ch™√l
[channel];

3248 i‡(
	`dy«mic_adv™˚d_¥o˚ss
(
ssd
, 
ch™√l
, 
chù_tokí
Ë=
NULL
) {

3249 *
ch™√l_busy_Êag
 = 0;

3250 #ifde‡
DEBUG


3251 
	`¥ötf
("ch™√»%d'†chùÅokí i†%d,Åhîêi†nŸ suô o≥øti⁄ i¿thi†ch™√l\n", 
ch™√l
, 
chù_tokí
);

3255 #ifde‡
DEBUG


3256 
	`¥ötf
("ch™√»%d'†chùÅokí i†%d, hîêgëá dy«mic_adv™˚_¥o˚ss\n", 
ch™√l
, 
chù_tokí
);

3259 *
ch™√l_busy_Êag
 = 1;

3260 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
tokí
 =

3261 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
tokí
 + 1) %

3262 
ssd
->
∑ømëî
->
dõ_chù
;

3263 
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
 =

3264 (
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
 + 1Ë% ssd->
∑ømëî
->
chù_ch™√l
[channel];

3265 #ifde‡
DEBUG


3266 
	`¥ötf
("ch™√l---tokí upd©ê(⁄ly movêahódËch™√»%d'†chùÅokí i†%d\n", 
ch™√l
, 
ssd
->
ch™√l_hód
[ch™√l].
tokí
);

3273 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
tokí
 =

3274 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
tokí
 + 1Ë% ssd->
∑ømëî
->
dõ_chù
;

3275 #ifde‡
DEBUG


3276 
	`¥ötf
("dõ---tokí upd©ê(⁄ly movêhód),ÅhíÇewÅokí i†ch™√»%d'†chùÅokí i†%d, dõ_tokí i†%d\n", 
ch™√l
, 
chù_tokí
, 
ssd
->
ch™√l_hód
[ch™√l].
chù_hód
[chù_tokí].
tokí
);

3282 
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
 =

3283 (
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
 + 1Ë% ssd->
∑ømëî
->
chù_ch™√l
[channel];

3285 } i‡(
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 == 1)

3287 #ifde‡
DEBUGSUSPEND


3288 
	`¥ötf
("°©i¯Æloˇti⁄.....now,ánd vîy imp‹è¡, ch™√»hîêi†%d.\n", 
ch™√l
);

3290 
chù
 = 0; chù < 
ssd
->
ch™√l_hód
[
ch™√l
].chip; chip++) {

3292 i‡((
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 =
CHIP_IDLE
) ||

3293 ((
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 =
CHIP_IDLE
) &&

3294 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 <ssd->
cuºít_time
))) {

3295 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 =
NULL
) {

3298 i‡(*
ch™√l_busy_Êag
 == 0) {

3300 i‡(((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) != AD_INTERLEAVE) &&

3301 ((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_TWOPLANE
) != AD_TWOPLANE))

3303 #ifde‡
DEBUGSUSPEND


3304 
	`¥ötf
("new_services_2_write static operation. Here marksÅhatÅhere isÇo use of interleaveándÅwoplaneÅechonologies. \n");

3308 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 =
NULL
) {

3311 #ifde‡
DEBUGSUSPEND


3312 
	`¥ötf
("f‹Üo›,ch™√»i†%d, chù i†%d, dõ i†%d\n",
ch™√l
, 
chù
, 
dõ
);

3316 
sub
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
;

3317 
sub
 !
NULL
) {

3318 #ifde‡
DEBUGSUSPEND


3319 
	`¥ötf
("lxc!!, hîêi†°ønge!!,Évîy sub: sub->loˇti⁄->ch™√»%d, sub->loˇti⁄->chù %d, sub->loˇti⁄->dõ %d, sub->loˇti⁄->block %d, sub->loˇti⁄->∑gê%d ,sub->cuºít_°©ê%d\n", 
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
block
, sub->loˇti⁄->
∑ge
, sub->
cuºít_°©e
 );

3322 i‡((
sub
->
cuºít_°©e
 =
SR_WAIT
Ë&& (sub->
loˇti⁄
->
ch™√l
 == channel) &&

3323 (
sub
->
loˇti⁄
->
chù
 == chip) )

3328 
sub
 = sub->
√xt_node
;

3330 i‡(
sub
 =
NULL
) {

3331 #ifde‡
DEBUGSUSPEND


3332 
	`¥ötf
("thi†chù %d, dõ %d ha†nÿavaûabÀ sub-ªque°s,movêtÿ√xàdõ \n", 
chù
,
dõ
);

3338 i‡(
sub
->
cuºít_°©e
 =
SR_WAIT
) {

3339 
sub
->
cuºít_time
 = 
ssd
->current_time;

3344 i‡((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_COPYBACK
) == AD_COPYBACK) {

3345 
	`c›y_back
(
ssd
, 
ch™√l
, 
chù
, 
dõ
,

3346 
sub
);

3347 #ifde‡
DEBUGSUSPEND


3348 
	`¥ötf
("willÇever happenÇow,Üxclxclxc\n");

3352 *
ch™ge_cuºít_time_Êag
 = 0;

3355 #ifde‡
DEBUGSUSPEND


3356 
	`¥ötf
("wrôêbegö!!now begöÑu¿thêgo_⁄e_°ï, sr_w_c_a_d©a_å™s„r,Çow %d ch™√l, %d chù\n",
ch™√l
, 
chù
);

3358 
	`go_⁄e_°ï
(
ssd
, 
sub
, 
NULL
, 
SR_W_C_A_DATA_TRANSFER
, 
NORMAL
);

3360 *
ch™ge_cuºít_time_Êag
 = 0;

3364 *
ch™√l_busy_Êag
 = 1;

3370 i‡(
	`dy«mic_adv™˚d_¥o˚ss
(
ssd
, 
ch™√l
, 
chù
Ë=
NULL
) {

3371 *
ch™√l_busy_Êag
 = 0;

3373 *
ch™√l_busy_Êag
 = 1;

3382 #ifde‡
DEBUGSUSPEND


3383 
	`¥ötf
("öÇew sîvi˚s_2_wrôêch™√»%d, chù %d i†busy\n", 
ch™√l
, 
chù
);

3390  
SUCCESS
;

3391 
	}
}

3394 
	$åy_to_ª°‹e_wrôe_fun˘i⁄
(
ssd_öfo
 *
ssd
){

3396 
ch™√l
 , 
chù
;

3398 
sub_ªque°
 *
sub_f‹_ªad
 = 
NULL
;

3399 
sub_ªque°
 *
sub_f‹_wrôe
 = 
NULL
;

3400 
sub_ªque°
 *
ãmp_sub_f‹_°‹e
 = 
NULL
;

3402 
gc_›î©i⁄
 *
gc_node
 = 
NULL
;

3404 
ch™√l
 = 0; ch™√»< 
ssd
->
∑ømëî
->
ch™√l_numbî
; channel++) {

3406 
chù
 = 0; chù < 
ssd
->
ch™√l_hód
[
ch™√l
].chip; chip ++) {

3408 if(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
wrôe_¥ìm±ive_sign
 == 1){

3409 #ifde‡
DEBUGSUSPEND


3410 
	`¥ötf
("åyÅÿª°‹êÆªady wrôêsu•íded ch™√»[%d], chù [%d] .\n", 
ch™√l
, 
chù
);

3414 
sub_f‹_ªad
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_r_hód
;

3415 
sub_f‹_ªad
 !
NULL
)

3417 if(
sub_f‹_ªad
->
loˇti⁄
->
chù
 == chip)

3421 
sub_f‹_ªad
 = sub_f‹_ªad->
√xt_node
 ;

3431 if(
sub_f‹_ªad
 =
NULL
){

3433 
sub_f‹_wrôe
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
;

3434 
sub_f‹_wrôe
 !
NULL
)

3436 if(
sub_f‹_wrôe
->
loˇti⁄
->
chù
 == chip)

3440 
sub_f‹_wrôe
 = sub_f‹_wrôe->
√xt_node
 ;

3445 
	`¥ötf
("°‹ed sub i†%Œd\n", 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
°‹edsub
);

3446 
ãmp_sub_f‹_°‹e
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
°‹edsub
;

3447 
	`¥ötf
("ªad o≥øti⁄. chù: %d,Ü≤: %d,Ö≤: %d o≥øti⁄: %d,size: %d, ////sub_ªque° sètus:: cuºít_°©e: %d, cuºít_time: %Œu,Çext_°©e: %d,Çext_°©e_¥edi˘_time: %Œu, sèã(⁄ly f‹ wrôe): %d\n", 
ãmp_sub_f‹_°‹e
->
loˇti⁄
->
chù
,Åemp_sub_f‹_°‹e->
Õn
,Åemp_sub_f‹_°‹e->
µn
,ãmp_sub_f‹_°‹e->
›î©i⁄
,Åemp_sub_f‹_°‹e->
size
,Åemp_sub_f‹_°‹e->
cuºít_°©e
,ãmp_sub_f‹_°‹e->
cuºít_time
,ãmp_sub_f‹_°‹e->
√xt_°©e
,Åemp_sub_f‹_°‹e->
√xt_°©e_¥edi˘_time
,Åemp_sub_f‹_°‹e->
°©e
) ;

3448 if(
sub_f‹_wrôe
 !
ãmp_sub_f‹_°‹e
){

3449 
	`¥ötf
("lx˛x˛xc,sÿ£riou†wr⁄g!!!, chù %d fú° wrôê%Œd\n", 
chù
, 
sub_f‹_wrôe
);

3451 #ifde‡
DEBUGSUSPEND


3452 
	`¥ötf
("thi†chù ha†nÿªadÇow, sÿbegöÅÿª°‹e,buàhavêtÿjudgmíàch™√»i†IDLEándÅhênum_w_cy˛êi†%d.\n",
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
num_w_cy˛e
);

3456 i‡((
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 =
CHANNEL_IDLE
Ë|| (ssd->ch™√l_hód[ch™√l].
√xt_°©e
 =CHANNEL_IDLE && ssd->ch™√l_hód[ch™√l].
√xt_°©e_¥edi˘_time
 <ssd->
cuºít_time
)) {

3459 if(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
num_w_cy˛e
 == 0){

3460 #ifde‡
DEBUGSUSPEND


3461 
	`¥ötf
("restoreÇum_w_cycle is 0 , wrong happen!!Üxclxclxc.\n");

3464 #ifde‡
DEBUGSUSPEND


3465 
	`¥ötf
("nowÑeally canÑestore .\n");

3470 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
wrôe_¥ìm±ive_sign
 = 0;

3471 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_WRITE_BUSY
;

3473 if–(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
num_w_cy˛e
) % 2 == 1 ){

3475 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 = ssd->
cuºít_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG_w_¥ogam
 + 5*ssd->∑ømëî->time_ch¨a˘îi°ics.
tWC
 ;

3477 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 = ssd->
cuºít_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG_w_vîify
 + 5*ssd->∑ømëî->time_ch¨a˘îi°ics.
tWC
;

3481 #ifde‡
DEBUGSUSPEND


3482 
	`¥ötf
("only because channel isÇot IDLE give upÑestoreÅhisÅime.\n");

3490 
	}
}

3500 
Sètus
 
	$£rvi˚s_2_wrôe
(
ssd_öfo
 *
ssd
, 
ch™√l
, *
ch™√l_busy_Êag
,

3501 *
ch™ge_cuºít_time_Êag
) {

3502 
j
 = 0, 
chù
 = 0;

3503 
k
 = 0;

3504 
ﬁd_µn
 = 0, 
√w_µn
 = 0;

3505 
chù_tokí
 = 0, 
dõ_tokí
 = 0, 
∂™e_tokí
 = 0, 
addªss_µn
 = 0;

3506 
dõ
 = 0, 
∂™e
 = 0;

3507 
time
 = 0;

3508 
sub_ªque°
 *
sub
 = 
NULL
, *
p
 = NULL;

3509 
sub_ªque°
 *
sub_tw›œ√_⁄e
 = 
NULL
, *
sub_tw›œ√_two
 = NULL;

3510 
sub_ªque°
 *
sub_öãæóve_⁄e
 = 
NULL
, *
sub_öãæóve_two
 = NULL;

3516 #ifde‡
DEBUG


3517 
	`¥ötf
("íã∏£rvi˚s_2_wrôe, ch™√»i†%d, ch™√l_busy_Êag i†%d, ch™ge_cuºít_time_Êag i†%d\n",
ch™√l
, 
ch™√l_busy_Êag
, 
ch™ge_cuºít_time_Êag
);

3519 i‡((
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 !
NULL
) || (ssd->subs_w_head != NULL)) {

3520 i‡(
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 == 0)

3522 
j
 = 0; j < 
ssd
->
ch™√l_hód
[
ch™√l
].
chù
; j++) {

3523 i‡((
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 =
NULL
) && (ssd->subs_w_head == NULL)) {

3527 
chù_tokí
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
;

3528 #ifde‡
DEBUG


3529 
	`¥ötf
("ch™√»%d'†chùÅokí i†%d\n", 
ch™√l
, 
chù_tokí
);

3533 i‡(*
ch™√l_busy_Êag
 == 0) {

3534 i‡((
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
cuºít_°©e
 =
CHIP_IDLE
) ||

3535 ((
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
√xt_°©e
 =
CHIP_IDLE
) &&

3536 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
√xt_°©e_¥edi˘_time
 <=

3537 
ssd
->
cuºít_time
))) {

3538 i‡((
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 =
NULL
) && (ssd->subs_w_head == NULL)) {

3541 
dõ_tokí
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
tokí
;

3542 #ifde‡
DEBUG


3543 
	`¥ötf
("ch™√»%d'†chùÅokí i†%d,dõÅokí i†%d\n", 
ch™√l
, 
chù_tokí
, 
dõ_tokí
);

3547 i‡(((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) != AD_INTERLEAVE) &&

3548 ((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_TWOPLANE
) !=

3549 
AD_TWOPLANE
))

3551 #ifde‡
DEBUG


3552 
	`¥ötf
("if you haveÇot setádvanced command,then only doÇormalÑeadánd write\n");

3555 
sub
 = 
	`föd_wrôe_sub_ªque°
(
ssd
, 
ch™√l
);

3556 i‡(
sub
 =
NULL
) {

3560 i‡(
sub
->
cuºít_°©e
 =
SR_WAIT
) {

3561 
∂™e_tokí
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
dõ_hód
[
dõ_tokí
].
tokí
;

3563 
	`gë_µn
(
ssd
, 
ch™√l
, 
chù_tokí
, 
dõ_tokí
, 
∂™e_tokí
, 
sub
);

3565 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
dõ_hód
[
dõ_tokí
].
tokí
 =

3566 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
dõ_hód
[
dõ_tokí
].
tokí
 +

3567 1Ë% 
ssd
->
∑ømëî
->
∂™e_dõ
;

3569 *
ch™ge_cuºít_time_Êag
 = 0;

3571 i‡(
ssd
->
∑ømëî
->
ad_¥i‹ôy2
 == 0) {

3572 
ssd
->
ªÆ_time_subªq
--;

3574 
	`go_⁄e_°ï
(
ssd
, 
sub
, 
NULL
, 
SR_W_TRANSFER
, 
NORMAL
);

3575 
	`dñëe_w_sub_ªque°
(
ssd
, 
ch™√l
, 
sub
);

3577 *
ch™√l_busy_Êag
 = 1;

3583 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
tokí
 =

3584 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
tokí
 + 1) %

3585 
ssd
->
∑ømëî
->
dõ_chù
;

3586 
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
 =

3587 (
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
 + 1Ë% ssd->
∑ømëî
->
chù_ch™√l
[channel];

3592 i‡(
	`dy«mic_adv™˚d_¥o˚ss
(
ssd
, 
ch™√l
, 
chù_tokí
Ë=
NULL
) {

3593 *
ch™√l_busy_Êag
 = 0;

3594 #ifde‡
DEBUG


3595 
	`¥ötf
("ch™√»%d'†chùÅokí i†%d,Åhîêi†nŸ suô o≥øti⁄ i¿thi†ch™√l\n", 
ch™√l
, 
chù_tokí
);

3599 #ifde‡
DEBUG


3600 
	`¥ötf
("ch™√»%d'†chùÅokí i†%d, hîêgëá dy«mic_adv™˚_¥o˚ss\n", 
ch™√l
, 
chù_tokí
);

3603 *
ch™√l_busy_Êag
 = 1;

3604 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
tokí
 =

3605 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
tokí
 + 1) %

3606 
ssd
->
∑ømëî
->
dõ_chù
;

3607 
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
 =

3608 (
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
 + 1Ë% ssd->
∑ømëî
->
chù_ch™√l
[channel];

3609 #ifde‡
DEBUG


3610 
	`¥ötf
("ch™√l---tokí upd©ê(⁄ly movêahódËch™√»%d'†chùÅokí i†%d\n", 
ch™√l
, 
ssd
->
ch™√l_hód
[ch™√l].
tokí
);

3617 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
tokí
 =

3618 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù_tokí
].
tokí
 + 1Ë% ssd->
∑ømëî
->
dõ_chù
;

3619 #ifde‡
DEBUG


3620 
	`¥ötf
("dõ---tokí upd©ê(⁄ly movêhód),ÅhíÇewÅokí i†ch™√»%d'†chùÅokí i†%d, dõ_tokí i†%d\n", 
ch™√l
, 
chù_tokí
, 
ssd
->
ch™√l_hód
[ch™√l].
chù_hód
[chù_tokí].
tokí
);

3626 
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
 =

3627 (
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
 + 1Ë% ssd->
∑ømëî
->
chù_ch™√l
[channel];

3629 } i‡(
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 == 1)

3631 #ifde‡
DEBUG


3632 
	`¥ötf
("staticállocation.....now.\n");

3635 
chù
 = 0; chù < 
ssd
->
ch™√l_hód
[
ch™√l
].chip; chip++) {

3636 i‡((
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 =
CHIP_IDLE
) ||

3637 ((
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 =
CHIP_IDLE
) &&

3638 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 <ssd->
cuºít_time
))) {

3639 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 =
NULL
) {

3642 i‡(*
ch™√l_busy_Êag
 == 0) {

3644 i‡(((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) != AD_INTERLEAVE) &&

3645 ((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_TWOPLANE
) != AD_TWOPLANE))

3647 #ifde‡
DEBUG


3648 
	`¥ötf
("services_2_writeÅatic operation. Here should beÖrinted for write\n");

3652 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 =
NULL
) {

3655 
sub
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
;

3656 
sub
 !
NULL
) {

3657 i‡((
sub
->
cuºít_°©e
 =
SR_WAIT
Ë&& (sub->
loˇti⁄
->
ch™√l
 == channel) &&

3658 (
sub
->
loˇti⁄
->
chù
 == chip) &&

3659 (
sub
->
loˇti⁄
->
dõ
 == die))

3663 
sub
 = sub->
√xt_node
;

3665 i‡(
sub
 =
NULL
) {

3669 i‡(
sub
->
cuºít_°©e
 =
SR_WAIT
) {

3670 
sub
->
cuºít_time
 = 
ssd
->current_time;

3671 
sub
->
cuºít_°©e
 = 
SR_W_TRANSFER
;

3672 
sub
->
√xt_°©e
 = 
SR_COMPLETE
;

3674 i‡((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_COPYBACK
) == AD_COPYBACK) {

3675 
	`c›y_back
(
ssd
, 
ch™√l
, 
chù
, 
dõ
,

3676 
sub
);

3677 *
ch™ge_cuºít_time_Êag
 = 0;

3679 
	`°©ic_wrôe
(
ssd
, 
ch™√l
, 
chù
, 
dõ
,

3680 
sub
);

3681 *
ch™ge_cuºít_time_Êag
 = 0;

3684 
	`dñëe_w_sub_ªque°
(
ssd
, 
ch™√l
, 
sub
);

3685 *
ch™√l_busy_Êag
 = 1;

3691 i‡(
	`dy«mic_adv™˚d_¥o˚ss
(
ssd
, 
ch™√l
, 
chù
Ë=
NULL
) {

3692 *
ch™√l_busy_Êag
 = 0;

3694 *
ch™√l_busy_Êag
 = 1;

3704  
SUCCESS
;

3705 
	}
}

3712 
ssd_öfo
 *
	$¥o˚ss
(
ssd_öfo
 *
ssd
) {

3721 
ﬁd_µn
 = -1, 
Êag_dõ
 = -1;

3722 
i
, 
ch™
, 
øndom_num
;

3723 
Êag
 = 0, 
√w_wrôe
 = 0, 
chg_cur_time_Êag
 = 1, 
Êag2
 = 0, 
Êag_gc
 = 0;

3724 
öt64_t
 
time
, 
ch™√l_time
 = 
MAX_INT64
;

3725 
sub_ªque°
 *
sub
;

3727 
whëhî_begö_run_gc
 = 0;

3728 
whëhî_°›_wrôe
 =0;

3732 if(
ssd
->
debug_sign
 == 1){

3742 
	`åa˚Eº‹_msg
("íã∏¥o˚ss, cuºíàtime:%Œd\n",
ssd
->
cuºít_time
);

3744 #ifde‡
DEBUG_CURR_TIME


3745 
	`¥ötf
("íã∏¥o˚ss, cuºíàtime:%Œd\n",
ssd
->
cuºít_time
);

3752 
i
 = 0; i < 
ssd
->
∑ømëî
->
ch™√l_numbî
; i++) {

3753 i‡((
ssd
->
ch™√l_hód
[
i
].
subs_r_hód
 =
NULL
Ë&& (ssd->ch™√l_hód[i].
subs_w_hód
 == NULL) &&

3754 (
ssd
->
subs_w_hód
 =
NULL
)) {

3758 
Êag
 = 0;

3762 #ifde‡
DEBUG


3763 
	`¥ötf
("Êag i†%d, *** 1 ha†nÿsubs,Çow c™ dÿbackground GC,,0 ha†subs\n",
Êag
);

3765 i‡(
Êag
 == 1) {

3766 
ssd
->
Êag
 = 1;

3767 i‡(
ssd
->
gc_ªque°
 > 0)

3769 
	`gc
(
ssd
, 0, 1);

3771  
ssd
;

3773 
ssd
->
Êag
 = 0;

3776 
time
 = 
ssd
->
cuºít_time
;

3777 #ifde‡
DEBUG


3778 
	`¥ötf
("begin go into services_2_r_cmd_trans_and_complete\n");

3779 
	`¥ötfsub_ªque°_°©us
(
ssd
);

3780 
	`¥ötf_evîy_chù_ªad_subªque°
(
ssd
);

3783 
	`£rvi˚s_2_r_cmd_å™s_™d_com∂ëe
(
ssd
);

3784 
	`ªad_ã°_dñëi⁄_f‹_subªque°
(
ssd
);

3785 #ifde‡
DEBUG


3786 
	`¥ötf
("finish services_2_r_cmd_trans_and_complete\n");

3787 
	`¥ötfsub_ªque°_°©us
(
ssd
);

3789 
	`¥ötf_evîy_chù_ªad_subªque°
(
ssd
);

3793 #ifde‡
DEBUG


3794 
	`¥ötf
("begin go into services_2_write_busy_in_chip\n");

3795 
	`¥ötfsub_ªque°_°©us
(
ssd
);

3796 
	`¥ötf_evîy_chù_ªad_subªque°
(
ssd
);

3799 
	`£rvi˚s_2_wrôe_busy_ö_chù
(
ssd
);

3800 
	`wrôe_ã°_dñëi⁄_f‹_subªque°
(
ssd
);

3801 #ifde‡
DEBUG


3802 
	`¥ötf
("finish services_2_write_busy_in_chip\n");

3803 
	`¥ötfsub_ªque°_°©us
(
ssd
);

3805 
	`¥ötf_evîy_chù_ªad_subªque°
(
ssd
);

3810 #ifde‡
DEBUG


3811 
	`¥ötf
("begin go into services_2_gc_busy_in_chip\n");

3812 
	`¥ötfsub_ªque°_°©us
(
ssd
);

3813 
	`¥ötf_evîy_chù_ªad_subªque°
(
ssd
);

3817 
	`£rvi˚s_2_gc_busy_ö_chù
(
ssd
);

3820 #ifde‡
DEBUG


3821 
	`¥ötf
("finish services_2_gc_busy_in_chip\n");

3822 
	`¥ötfsub_ªque°_°©us
(
ssd
);

3824 
	`¥ötf_evîy_chù_ªad_subªque°
(
ssd
);

3829 
øndom_num
 =

3830 
ssd
->
¥ogøm_cou¡
 % ssd->
∑ømëî
->
ch™√l_numbî
;

3836 
ch™
 = 0; ch™ < 
ssd
->
∑ømëî
->
ch™√l_numbî
; chan++) {

3837 
i
 = (
øndom_num
 + 
ch™
Ë% 
ssd
->
∑ømëî
->
ch™√l_numbî
;

3838 
Êag
 = 0;

3839 
Êag_gc
 = 0;

3840 #ifde‡
DEBUG


3841 
	`¥ötf
("íã∏thê¥o˚s†f‹ ch™√»%d cúcuœti⁄\n", 
i
);

3843 i‡((
ssd
->
ch™√l_hód
[
i
].
cuºít_°©e
 =
CHANNEL_IDLE
Ë|| (ssd->ch™√l_hód[i].
√xt_°©e
 == CHANNEL_IDLE &&

3844 
ssd
->
ch™√l_hód
[
i
].
√xt_°©e_¥edi˘_time
 <=

3845 
ssd
->
cuºít_time
)) {

3846 #ifde‡
DEBUG


3847 
	`¥ötf
("⁄ly dó»thêvÆuê0!! hîêi†thêvÆue: ssd->ch™√l_hód[%d].cuºít_°©êi†%d,‹ ssd->ch™√l_hód[%d].√xt_°©êi†%dándÇext_°©e_¥edi˘_time<ssd->cuºít_timê\n",
i
,
ssd
->
ch™√l_hód
[i].
cuºít_°©e
, i, ssd->ch™√l_hód[i].
√xt_°©e
);

3867 
sub
 = 
ssd
->
ch™√l_hód
[
i
].
subs_r_hód
;

3870 i‡–
ssd
->
ch™√l_hód
[
i
].
gc_comm™d
 !
NULL
 ){

3871 
whëhî_begö_run_gc
 = 1;}

3875 if(
whëhî_begö_run_gc
 != 1){

3876 #ifde‡
DEBUG


3877 
	`¥ötf
("begö gÿötÿ£rvi˚s_2_r_waô, fœg i†%d, fœg_g¯i†%d\n",
Êag
,
Êag_gc
);

3878 
	`¥ötfsub_ªque°_°©us
(
ssd
);

3879 
	`¥ötf_evîy_chù_ªad_subªque°
(
ssd
);

3881 
	`£rvi˚s_2_r_waô
(
ssd
, 
i
, &
Êag
, &
chg_cur_time_Êag
);

3882 #ifde‡
DEBUG


3883 
	`¥ötf
("föish sîvi˚s_2_r_waô, fœg i†%d, fœg_g¯i†%d\n",
Êag
,
Êag_gc
);

3884 
	`¥ötfsub_ªque°_°©us
(
ssd
);

3885 
	`¥ötf_evîy_chù_ªad_subªque°
(
ssd
);

3891 i‡((
Êag
 =0Ë&& (
ssd
->
ch™√l_hód
[
i
].
subs_r_hód
 !=

3892 
NULL
))

3894 #ifde‡
DEBUG


3895 
	`¥ötf
("begö gÿötÿ£rvi˚s_2_r_d©e_å™s, fœg i†%d, fœg_g¯i†%d\n",
Êag
,
Êag_gc
);

3896 
	`¥ötfsub_ªque°_°©us
(
ssd
);

3897 
	`¥ötf_evîy_chù_ªad_subªque°
(
ssd
);

3900 
	`£rvi˚s_2_r_d©a_å™s
(
ssd
, 
i
, &
Êag
, &
chg_cur_time_Êag
);

3901 #ifde‡
DEBUG


3902 
	`¥ötf
("föish sîvi˚s_2_r_d©a_å™s, fœg i†%d, fœg_g¯i†%d\n",
Êag
,
Êag_gc
);

3903 
	`¥ötfsub_ªque°_°©us
(
ssd
);

3904 
	`¥ötf_evîy_chù_ªad_subªque°
(
ssd
);

3916 if(
whëhî_begö_run_gc
 == 1 ){

3917 #ifde‡
DEBUG


3918 
	`¥ötf
("now ha†GC, fœg i†%d, fœg_g¯i†%d\n",
Êag
,
Êag_gc
);

3919 
	`¥ötfsub_ªque°_°©us
(
ssd
);

3920 
	`¥ötf_evîy_chù_ªad_subªque°
(
ssd
);

3925 
	`gc
(
ssd
, 
i
, 0);

3926 #ifde‡
DEBUG


3927 
	`¥ötf
("föish GC, fœg i†%d, fœg_g¯i†%d\n",
Êag
,
Êag_gc
);

3928 
	`¥ötfsub_ªque°_°©us
(
ssd
);

3929 
	`¥ötf_evîy_chù_ªad_subªque°
(
ssd
);

3938 i‡–
ssd
->
ch™√l_hód
[
i
].
gc_comm™d
 !
NULL
 ){

3940 
whëhî_°›_wrôe
 = 1;

3943 
whëhî_°›_wrôe
 = 0;

3945 #ifde‡
DEBUG


3946 
	`¥ötf
("whëhî_begö_run_g¯i†%d, whëhî_°›_wrôêi†%d\n",
whëhî_begö_run_gc
, 
whëhî_°›_wrôe
 );

3952 if(
whëhî_°›_wrôe
 == 0){

3954 i‡–(
Êag
 =0Ë&& (
ssd
->
ch™√l_hód
[
i
].
gc_comm™d
 =
NULL
) )

3956 #ifde‡
DEBUG


3957 
	`¥ötf
("begö gÿötÿ£rvi˚s_2_wrôe, fœg=0,Êag_g¯i†%d\n",
Êag_gc
);

3958 
	`¥ötfsub_ªque°_°©us
(
ssd
);

3959 
	`¥ötf_evîy_chù_ªad_subªque°
(
ssd
);

3967 #ifde‡
DEBUG


3968 
	`¥ötf
("bef‹êgÿötÿ£rvi˚s_2_wrôe,ch™√»i†%d\n",
i
);

3970 
	`√w_£rvi˚s_2_wrôe
(
ssd
, 
i
, &
Êag
, &
chg_cur_time_Êag
);

3974 #ifde‡
DEBUG


3975 
	`¥ötf
("föish sîvi˚s_2_wrôe, fœg i†%d, fœg_g¯i†%d\n",
Êag
, 
Êag_gc
);

3976 
	`¥ötfsub_ªque°_°©us
(
ssd
);

3977 
	`¥ötf_evîy_chù_ªad_subªque°
(
ssd
);

3985  
ssd
;

3986 
	}
}

3992 
ssd_öfo
 *
	$dy«mic_adv™˚d_¥o˚ss
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
) {

3993 
dõ
 = 0, 
∂™e
 = 0;

3994 
subs_cou¡
 = 0;

3995 
Êag
;

3996 
g©e
;

3997 
∂™e_∂a˚
;

3998 
sub_ªque°
 *
sub
 = 
NULL
, *
p
 = NULL, *
sub0
 = NULL, *
sub1
 = NULL, *
sub2
 = NULL, *
sub3
 = NULL, *
sub0_rw
 = NULL, *
sub1_rw
 = NULL, *
sub2_rw
 = NULL, *
sub3_rw
 = NULL;

3999 
sub_ªque°
 **
subs
 = 
NULL
;

4000 
max_sub_num
 = 0;

4001 
dõ_tokí
 = 0, 
∂™e_tokí
 = 0;

4002 *
∂™e_bôs
 = 
NULL
;

4003 
öãæóvî_cou¡
 = 0;

4005 
mask
 = 0x00000001;

4006 
i
 = 0, 
j
 = 0;

4007 #ifde‡
DEBUG


4008 
	`¥ötf
("enter dynamic_advanced_process\n");

4011 
max_sub_num
 = (
ssd
->
∑ømëî
->
dõ_chù
Ë* (ssd->∑ømëî->
∂™e_dõ
);

4012 
g©e
 = 
max_sub_num
;

4013 
subs
 = (
sub_ªque°
 **Ë
	`mÆloc
(
max_sub_num
 * (sub_request *));

4014 
	`Æloc_as£π
(
subs
, "sub_request");

4016 
i
 = 0; i < 
max_sub_num
; i++) {

4017 
subs
[
i
] = 
NULL
;

4020 i‡((
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 =0Ë&& (ssd->∑ømëî->
dy«mic_Æloˇti⁄
 == 0) &&

4021 (
ssd
->
∑ømëî
->
ad_¥i‹ôy2
 == 0)) {

4022 
g©e
 = 
ssd
->
ªÆ_time_subªq
 / ssd->
∑ømëî
->
ch™√l_numbî
;

4024 i‡(
g©e
 == 0) {

4025 
g©e
 = 1;

4027 i‡(
ssd
->
ªÆ_time_subªq
 % ssd->
∑ømëî
->
ch™√l_numbî
 != 0) {

4028 
g©e
++;

4033 i‡((
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 ==

4036 i‡(
ssd
->
∑ømëî
->
dy«mic_Æloˇti⁄
 == 0) {

4037 
sub
 = 
ssd
->
subs_w_hód
;

4039 
sub
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
;

4042 
subs_cou¡
 = 0;

4044 (
sub
 !
NULL
Ë&& (
subs_cou¡
 < 
max_sub_num
Ë&& (subs_cou¡ < 
g©e
)) {

4045 i‡(
sub
->
cuºít_°©e
 =
SR_WAIT
) {

4046 i‡((
sub
->
upd©e
 =
NULL
Ë|| ((sub->upd©ê!NULLË&& ((sub->upd©e->
cuºít_°©e
 =
SR_COMPLETE
) ||

4047 ((
sub
->
upd©e
->
√xt_°©e
 =
SR_COMPLETE
) &&

4048 (
sub
->
upd©e
->
√xt_°©e_¥edi˘_time
 <=

4049 
ssd
->
cuºít_time
)))))

4051 
subs
[
subs_cou¡
] = 
sub
;

4052 
subs_cou¡
++;

4056 
p
 = 
sub
;

4057 
sub
 = sub->
√xt_node
;

4060 i‡(
subs_cou¡
 == 0)

4062 
i
 = 0; i < 
max_sub_num
; i++) {

4063 
subs
[
i
] = 
NULL
;

4065 
	`‰ì
(
subs
);

4067 
subs
 = 
NULL
;

4068 
	`‰ì
(
∂™e_bôs
);

4069  
NULL
;

4071 i‡(
subs_cou¡
 >= 2) {

4076 i‡(((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_TWOPLANE
) == AD_TWOPLANE) &&

4077 ((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) == AD_INTERLEAVE)) {

4078 
	`gë_µn_f‹_adv™˚d_comm™ds
(
ssd
, 
ch™√l
, 
chù
, 
subs
, 
subs_cou¡
, 
INTERLEAVE_TWO_PLANE
);

4079 } i‡(((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_TWOPLANE
) == AD_TWOPLANE) &&

4080 ((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) != AD_INTERLEAVE)) {

4081 i‡(
subs_cou¡
 > 
ssd
->
∑ømëî
->
∂™e_dõ
) {

4082 
i
 = 
ssd
->
∑ømëî
->
∂™e_dõ
; i < 
subs_cou¡
; i++) {

4083 
subs
[
i
] = 
NULL
;

4085 
subs_cou¡
 = 
ssd
->
∑ømëî
->
∂™e_dõ
;

4087 
	`gë_µn_f‹_adv™˚d_comm™ds
(
ssd
, 
ch™√l
, 
chù
, 
subs
, 
subs_cou¡
, 
TWO_PLANE
);

4088 } i‡(((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_TWOPLANE
) != AD_TWOPLANE) &&

4089 ((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) == AD_INTERLEAVE)) {

4091 i‡(
subs_cou¡
 > 
ssd
->
∑ømëî
->
dõ_chù
) {

4092 
i
 = 
ssd
->
∑ømëî
->
dõ_chù
; i < 
subs_cou¡
; i++) {

4093 
subs
[
i
] = 
NULL
;

4095 
subs_cou¡
 = 
ssd
->
∑ømëî
->
dõ_chù
;

4097 
	`gë_µn_f‹_adv™˚d_comm™ds
(
ssd
, 
ch™√l
, 
chù
, 
subs
, 
subs_cou¡
, 
INTERLEAVE
);

4099 
i
 = 1; i < 
subs_cou¡
; i++) {

4100 
subs
[
i
] = 
NULL
;

4102 
subs_cou¡
 = 1;

4103 
	`gë_µn_f‹_n‹mÆ_comm™d
(
ssd
, 
ch™√l
, 
chù
, 
subs
[0]);

4107 i‡(
subs_cou¡
 == 1)

4109 
	`gë_µn_f‹_n‹mÆ_comm™d
(
ssd
, 
ch™√l
, 
chù
, 
subs
[0]);

4117 
sub
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
;

4118 
∂™e_bôs
 = (*Ë
	`mÆloc
((
ssd
->
∑ømëî
->
dõ_chù
) * ());

4119 
	`Æloc_as£π
(
∂™e_bôs
, "plane_bits");

4120 
	`mem£t
(
∂™e_bôs
, 0, (
ssd
->
∑ømëî
->
dõ_chù
) * ());

4122 
i
 = 0; i < 
ssd
->
∑ømëî
->
dõ_chù
; i++) {

4123 
∂™e_bôs
[
i
] = 0x00000000;

4125 
subs_cou¡
 = 0;

4127 (
sub
 !
NULL
Ë&& (
subs_cou¡
 < 
max_sub_num
)) {

4128 i‡(
sub
->
cuºít_°©e
 =
SR_WAIT
) {

4129 i‡((
sub
->
upd©e
 =
NULL
Ë|| ((sub->upd©ê!NULLË&& ((sub->upd©e->
cuºít_°©e
 =
SR_COMPLETE
) ||

4130 ((
sub
->
upd©e
->
√xt_°©e
 =
SR_COMPLETE
) &&

4131 (
sub
->
upd©e
->
√xt_°©e_¥edi˘_time
 <=

4132 
ssd
->
cuºít_time
))))) {

4133 i‡(
sub
->
loˇti⁄
->
chù
 == chip) {

4134 
∂™e_∂a˚
 = 0x00000001 << (
sub
->
loˇti⁄
->
∂™e
);

4136 i‡((
∂™e_bôs
[
sub
->
loˇti⁄
->
dõ
] & 
∂™e_∂a˚
) !=

4137 
∂™e_∂a˚
)

4139 
subs
[
sub
->
loˇti⁄
->
dõ
 * 
ssd
->
∑ømëî
->
∂™e_dõ
 + sub->loˇti⁄->
∂™e
] = sub;

4140 
subs_cou¡
++;

4141 
∂™e_bôs
[
sub
->
loˇti⁄
->
dõ
] = (∂™e_bôs[sub->loˇti⁄->dõ] | 
∂™e_∂a˚
);

4146 
sub
 = sub->
√xt_node
;

4149 i‡(
subs_cou¡
 == 0)

4151 
i
 = 0; i < 
max_sub_num
; i++) {

4152 
subs
[
i
] = 
NULL
;

4154 
	`‰ì
(
subs
);

4155 
subs
 = 
NULL
;

4156 
	`‰ì
(
∂™e_bôs
);

4157  
NULL
;

4160 
Êag
 = 0;

4161 i‡(
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 != 0) {

4162 i‡((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_COPYBACK
) == AD_COPYBACK)

4164 i‡(
subs_cou¡
 > 1)

4166 
	`gë_µn_f‹_adv™˚d_comm™ds
(
ssd
, 
ch™√l
, 
chù
, 
subs
, 
subs_cou¡
, 
COPY_BACK
);

4168 
i
 = 0; i < 
max_sub_num
; i++) {

4169 i‡(
subs
[
i
] !
NULL
) {

4173 
	`gë_µn_f‹_n‹mÆ_comm™d
(
ssd
, 
ch™√l
, 
chù
, 
subs
[
i
]);

4179 i‡(
subs_cou¡
 > 1)

4181 i‡(((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) == AD_INTERLEAVE) &&

4182 ((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_TWOPLANE
) == AD_TWOPLANE)) {

4183 
	`gë_µn_f‹_adv™˚d_comm™ds
(
ssd
, 
ch™√l
, 
chù
, 
subs
, 
subs_cou¡
, 
INTERLEAVE_TWO_PLANE
);

4184 } i‡(((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) == AD_INTERLEAVE) &&

4185 ((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_TWOPLANE
) != AD_TWOPLANE)) {

4186 
dõ
 = 0; dõ < 
ssd
->
∑ømëî
->
dõ_chù
; die++) {

4187 i‡(
∂™e_bôs
[
dõ
] != 0x00000000) {

4188 
i
 = 0; i < 
ssd
->
∑ømëî
->
∂™e_dõ
; i++) {

4189 
∂™e_tokí
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
;

4190 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 =

4191 (
∂™e_tokí
 + 1Ë% 
ssd
->
∑ømëî
->
∂™e_dõ
;

4192 
mask
 = 0x00000001 << 
∂™e_tokí
;

4193 i‡((
∂™e_bôs
[
dõ
] & 
mask
) == mask) {

4194 
∂™e_bôs
[
dõ
] = 
mask
;

4198 
i
 = i + 1; i < 
ssd
->
∑ømëî
->
∂™e_dõ
; i++) {

4199 
∂™e
 = (
∂™e_tokí
 + 1Ë% 
ssd
->
∑ømëî
->
∂™e_dõ
;

4200 
subs
[
dõ
 * 
ssd
->
∑ømëî
->
∂™e_dõ
 + 
∂™e
] = 
NULL
;

4201 
subs_cou¡
--;

4203 
öãæóvî_cou¡
++;

4206 i‡(
öãæóvî_cou¡
 >= 2) {

4207 
	`gë_µn_f‹_adv™˚d_comm™ds
(
ssd
, 
ch™√l
, 
chù
, 
subs
, 
subs_cou¡
, 
INTERLEAVE
);

4209 
i
 = 0; i < 
max_sub_num
; i++) {

4210 i‡(
subs
[
i
] !
NULL
) {

4214 
	`gë_µn_f‹_n‹mÆ_comm™d
(
ssd
, 
ch™√l
, 
chù
, 
subs
[
i
]);

4217 i‡(((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) != AD_INTERLEAVE) &&

4218 ((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_TWOPLANE
) == AD_TWOPLANE)) {

4219 
i
 = 0; i < 
ssd
->
∑ømëî
->
dõ_chù
; i++) {

4220 
dõ_tokí
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
;

4221 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
 =

4222 (
dõ_tokí
 + 1Ë% 
ssd
->
∑ømëî
->
dõ_chù
;

4223 i‡(
	`size
(
∂™e_bôs
[
dõ_tokí
]) > 1) {

4229 i‡(
i
 < 
ssd
->
∑ømëî
->
dõ_chù
) {

4230 
dõ
 = 0; dõ < 
ssd
->
∑ømëî
->
dõ_chù
; die++) {

4231 i‡(
dõ
 !
dõ_tokí
) {

4232 
∂™e
 = 0;Öœ√ < 
ssd
->
∑ømëî
->
∂™e_dõ
;Ölane++) {

4233 i‡(
subs
[
dõ
 * 
ssd
->
∑ømëî
->
∂™e_dõ
 + 
∂™e
] !
NULL
) {

4234 
subs
[
dõ
 * 
ssd
->
∑ømëî
->
∂™e_dõ
 + 
∂™e
] = 
NULL
;

4235 
subs_cou¡
--;

4240 
	`gë_µn_f‹_adv™˚d_comm™ds
(
ssd
, 
ch™√l
, 
chù
, 
subs
, 
subs_cou¡
, 
TWO_PLANE
);

4243 
i
 = 0; i < 
ssd
->
∑ømëî
->
dõ_chù
; i++) {

4244 
dõ_tokí
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
;

4245 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
 =

4246 (
dõ_tokí
 + 1Ë% 
ssd
->
∑ømëî
->
dõ_chù
;

4247 i‡(
∂™e_bôs
[
dõ_tokí
] != 0x00000000) {

4248 
j
 = 0; j < 
ssd
->
∑ømëî
->
∂™e_dõ
; j++) {

4249 
∂™e_tokí
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ_tokí
].
tokí
;

4250 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ_tokí
].
tokí
 =

4251 (
∂™e_tokí
 + 1Ë% 
ssd
->
∑ømëî
->
∂™e_dõ
;

4252 i‡(((
∂™e_bôs
[
dõ_tokí
]Ë& (0x00000001 << 
∂™e_tokí
)) != 0x00000000) {

4253 
sub
 = 
subs
[
dõ_tokí
 * 
ssd
->
∑ømëî
->
∂™e_dõ
 + 
∂™e_tokí
];

4259 
	`gë_µn_f‹_n‹mÆ_comm™d
(
ssd
, 
ch™√l
, 
chù
, 
sub
);

4264 
i
 = 0; i < 
ssd
->
∑ømëî
->
dõ_chù
; i++) {

4265 
dõ_tokí
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
;

4266 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
 = (
dõ_tokí
 + 1Ë% ssd->
∑ømëî
->
dõ_chù
;

4267 i‡(
∂™e_bôs
[
dõ_tokí
] != 0x00000000) {

4268 
j
 = 0; j < 
ssd
->
∑ømëî
->
∂™e_dõ
; j++) {

4269 
∂™e_tokí
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ_tokí
].
tokí
;

4270 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ_tokí
].
tokí
 =

4271 (
∂™e_tokí
 + 1Ë% 
ssd
->
∑ømëî
->
∂™e_dõ
;

4272 i‡(((
∂™e_bôs
[
dõ_tokí
]Ë& (0x00000001 << 
∂™e_tokí
)) != 0x00000000) {

4273 
sub
 = 
subs
[
dõ_tokí
 * 
ssd
->
∑ømëî
->
∂™e_dõ
 + 
∂™e_tokí
];

4277 i‡(
sub
 !
NULL
) {

4282 
	`gë_µn_f‹_n‹mÆ_comm™d
(
ssd
, 
ch™√l
, 
chù
, 
sub
);

4287 
i
 = 0; i < 
ssd
->
∑ømëî
->
dõ_chù
; i++) {

4288 
dõ_tokí
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
;

4289 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
 = (
dõ_tokí
 + 1Ë% ssd->
∑ømëî
->
dõ_chù
;

4290 i‡(
∂™e_bôs
[
dõ_tokí
] != 0x00000000) {

4291 
j
 = 0; j < 
ssd
->
∑ømëî
->
∂™e_dõ
; j++) {

4292 
∂™e_tokí
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ_tokí
].
tokí
;

4293 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 =

4294 (
∂™e_tokí
 + 1Ë% 
ssd
->
∑ømëî
->
∂™e_dõ
;

4295 i‡(((
∂™e_bôs
[
dõ_tokí
]Ë& (0x00000001 << 
∂™e_tokí
)) != 0x00000000) {

4296 
sub
 = 
subs
[
dõ_tokí
 * 
ssd
->
∑ømëî
->
∂™e_dõ
 + 
∂™e_tokí
];

4300 i‡(
sub
 !
NULL
) {

4305 
	`gë_µn_f‹_n‹mÆ_comm™d
(
ssd
, 
ch™√l
, 
chù
, 
sub
);

4310 
i
 = 0; i < 
max_sub_num
; i++) {

4311 
subs
[
i
] = 
NULL
;

4313 
	`‰ì
(
subs
);

4314 
subs
 = 
NULL
;

4315 
	`‰ì
(
∂™e_bôs
);

4316  
ssd
;

4317 
	}
}

4322 
Sètus


4323 
	$gë_µn_f‹_n‹mÆ_comm™d
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
sub_ªque°
 *
sub
) {

4324 
dõ
 = 0;

4325 
∂™e
 = 0;

4326 #ifde‡
DEBUG


4327 
	`¥ötf
("enter into get_ppn_for_normal_command\n");

4330 i‡(
sub
 =
NULL
) {

4331  
ERROR
;

4334 i‡(
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 =
DYNAMIC_ALLOCATION
) {

4335 
dõ
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
;

4336 
∂™e
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
;

4337 
	`gë_µn
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
sub
);

4338 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 = (
∂™e
 + 1Ë% ssd->
∑ømëî
->
∂™e_dõ
;

4339 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
 = (
dõ
 + 1Ë% ssd->
∑ømëî
->
dõ_chù
;

4341 
	`compuã_£rve_time
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, &
sub
, 1, 
NORMAL
);

4342  
SUCCESS
;

4344 
dõ
 = 
sub
->
loˇti⁄
->die;

4345 
∂™e
 = 
sub
->
loˇti⁄
->plane;

4346 
	`gë_µn
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
sub
);

4347 
	`compuã_£rve_time
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, &
sub
, 1, 
NORMAL
);

4348  
SUCCESS
;

4351 
	}
}

4362 
Sètus


4363 
	$gë_µn_f‹_adv™˚d_comm™ds
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
sub_ªque°
 **
subs
,

4364 
subs_cou¡
, 
comm™d
) {

4365 
dõ
 = 0, 
∂™e
 = 0;

4366 
dõ_tokí
 = 0, 
∂™e_tokí
 = 0;

4367 
sub_ªque°
 *
sub
 = 
NULL
;

4368 
i
 = 0, 
j
 = 0, 
k
 = 0;

4369 
unvÆid_subs_cou¡
 = 0;

4370 
vÆid_subs_cou¡
 = 0;

4371 
öãæóve_Êag
 = 
FALSE
;

4372 
mu…i_∂™e_Álg
 = 
FALSE
;

4373 
max_subs_num
 = 0;

4374 
sub_ªque°
 *
fú°_sub_ö_chù
 = 
NULL
;

4375 
sub_ªque°
 *
fú°_sub_ö_dõ
 = 
NULL
;

4376 
sub_ªque°
 *
£c⁄d_sub_ö_dõ
 = 
NULL
;

4377 
°©e
 = 
SUCCESS
;

4378 
mu…i_∂™e_Êag
 = 
FALSE
;

4380 
max_subs_num
 = 
ssd
->
∑ømëî
->
dõ_chù
 * ssd->∑ømëî->
∂™e_dõ
;

4382 #ifde‡
DEBUG


4383 
	`¥ötf
("enter get_ppn_for_advanced_commands\n");

4386 i‡(
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 =
DYNAMIC_ALLOCATION
)

4388 i‡((
comm™d
 =
INTERLEAVE_TWO_PLANE
) ||

4389 (
comm™d
 =
COPY_BACK
))

4391 
i
 = 0; i < 
subs_cou¡
; i++) {

4392 
dõ
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
;

4393 i‡(
i
 <

4394 
ssd
->
∑ømëî
->
dõ_chù
)

4396 
∂™e
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
;

4397 
	`gë_µn
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
subs
[
i
]);

4398 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 =

4399 (
∂™e
 + 1Ë% 
ssd
->
∑ømëî
->
∂™e_dõ
;

4406 
°©e
 = 
	`make_Àvñ_∑ge
(
ssd
, 
subs
[
i
 % ssd->
∑ømëî
->
dõ_chù
], subs[i]);

4407 i‡(
°©e
 !
SUCCESS
) {

4408 
subs
[
i
] = 
NULL
;

4409 
unvÆid_subs_cou¡
++;

4411 
mu…i_∂™e_Êag
 = 
TRUE
;

4414 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
 = (
dõ
 + 1Ë% ssd->
∑ømëî
->
dõ_chù
;

4416 
vÆid_subs_cou¡
 = 
subs_cou¡
 - 
unvÆid_subs_cou¡
;

4417 
ssd
->
öãæóve_cou¡
++;

4418 i‡(
mu…i_∂™e_Êag
 =
TRUE
) {

4419 
ssd
->
öãr_m∂™e_cou¡
++;

4420 
	`compuã_£rve_time
(
ssd
, 
ch™√l
, 
chù
, 0, 
subs
, 
vÆid_subs_cou¡
,

4421 
INTERLEAVE_TWO_PLANE
);

4423 
	`compuã_£rve_time
(
ssd
, 
ch™√l
, 
chù
, 0, 
subs
, 
vÆid_subs_cou¡
, 
INTERLEAVE
);

4425  
SUCCESS
;

4427 i‡(
comm™d
 =
INTERLEAVE
) {

4432 
i
 = 0; (ò< 
subs_cou¡
Ë&& (ò< 
ssd
->
∑ømëî
->
dõ_chù
); i++) {

4433 
dõ
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
;

4434 
∂™e
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
;

4435 
	`gë_µn
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
subs
[
i
]);

4436 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 =

4437 (
∂™e
 + 1Ë% 
ssd
->
∑ømëî
->
∂™e_dõ
;

4438 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
 = (
dõ
 + 1Ë% ssd->
∑ømëî
->
dõ_chù
;

4439 
vÆid_subs_cou¡
++;

4441 
ssd
->
öãæóve_cou¡
++;

4442 
	`compuã_£rve_time
(
ssd
, 
ch™√l
, 
chù
, 0, 
subs
, 
vÆid_subs_cou¡
, 
INTERLEAVE
);

4443  
SUCCESS
;

4445 i‡(
comm™d
 =
TWO_PLANE
) {

4446 i‡(
subs_cou¡
 < 2) {

4447  
ERROR
;

4449 
dõ
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
;

4450 
j
 = 0; j < 
subs_cou¡
; j++) {

4451 i‡(
j
 == 1) {

4452 
°©e
 = 
	`föd_Àvñ_∑ge
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
subs
[0],

4453 
subs
[1]);

4454 i‡(
°©e
 !
SUCCESS
) {

4455 
	`gë_µn_f‹_n‹mÆ_comm™d
(
ssd
, 
ch™√l
, 
chù
, 
subs
[0]);

4456  
FAILURE
;

4458 
vÆid_subs_cou¡
 = 2;

4460 } i‡(
j
 > 1) {

4461 
°©e
 = 
	`make_Àvñ_∑ge
(
ssd
, 
subs
[0],

4462 
subs
[
j
]);

4463 i‡(
°©e
 !
SUCCESS
) {

4464 
k
 = 
j
; k < 
subs_cou¡
; k++) {

4465 
subs
[
k
] = 
NULL
;

4467 
subs_cou¡
 = 
j
;

4470 
vÆid_subs_cou¡
++;

4474 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
 = (
dõ
 + 1Ë% ssd->
∑ømëî
->
dõ_chù
;

4475 
ssd
->
m_∂™e_¥og_cou¡
++;

4476 
	`compuã_£rve_time
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
subs
, 
vÆid_subs_cou¡
, 
TWO_PLANE
);

4477  
SUCCESS
;

4480  
ERROR
;

4485 i‡((
comm™d
 =
INTERLEAVE_TWO_PLANE
Ë|| (comm™d =
COPY_BACK
)) {

4486 
dõ
 = 0; dõ < 
ssd
->
∑ømëî
->
dõ_chù
; die++) {

4487 
fú°_sub_ö_dõ
 = 
NULL
;

4488 
∂™e
 = 0;Öœ√ < 
ssd
->
∑ømëî
->
∂™e_dõ
;Ölane++) {

4489 
sub
 = 
subs
[
dõ
 * 
ssd
->
∑ømëî
->
∂™e_dõ
 + 
∂™e
];

4490 i‡(
sub
 !
NULL
) {

4491 i‡(
fú°_sub_ö_dõ
 =
NULL
) {

4492 
fú°_sub_ö_dõ
 = 
sub
;

4493 
	`gë_µn
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
sub
);

4495 
°©e
 = 
	`make_Àvñ_∑ge
(
ssd
, 
fú°_sub_ö_dõ
, 
sub
);

4496 i‡(
°©e
 !
SUCCESS
) {

4497 
subs
[
dõ
 * 
ssd
->
∑ømëî
->
∂™e_dõ
 + 
∂™e
] = 
NULL
;

4498 
subs_cou¡
--;

4499 
sub
 = 
NULL
;

4501 
mu…i_∂™e_Êag
 = 
TRUE
;

4507 i‡(
mu…i_∂™e_Êag
 =
TRUE
) {

4508 
ssd
->
öãr_m∂™e_cou¡
++;

4509 
	`compuã_£rve_time
(
ssd
, 
ch™√l
, 
chù
, 0, 
subs
, 
vÆid_subs_cou¡
, 
INTERLEAVE_TWO_PLANE
);

4510  
SUCCESS
;

4512 
	`compuã_£rve_time
(
ssd
, 
ch™√l
, 
chù
, 0, 
subs
, 
vÆid_subs_cou¡
, 
INTERLEAVE
);

4513  
SUCCESS
;

4516 i‡(
comm™d
 =
INTERLEAVE
) {

4517 
dõ
 = 0; dõ < 
ssd
->
∑ømëî
->
dõ_chù
; die++) {

4518 
fú°_sub_ö_dõ
 = 
NULL
;

4519 
∂™e
 = 0;Öœ√ < 
ssd
->
∑ømëî
->
∂™e_dõ
;Ölane++) {

4520 
sub
 = 
subs
[
dõ
 * 
ssd
->
∑ømëî
->
∂™e_dõ
 + 
∂™e
];

4521 i‡(
sub
 !
NULL
) {

4522 i‡(
fú°_sub_ö_dõ
 =
NULL
) {

4523 
fú°_sub_ö_dõ
 = 
sub
;

4524 
	`gë_µn
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
sub
);

4525 
vÆid_subs_cou¡
++;

4527 
subs
[
dõ
 * 
ssd
->
∑ømëî
->
∂™e_dõ
 + 
∂™e
] = 
NULL
;

4528 
subs_cou¡
--;

4529 
sub
 = 
NULL
;

4534 i‡(
vÆid_subs_cou¡
 > 1) {

4535 
ssd
->
öãæóve_cou¡
++;

4537 
	`compuã_£rve_time
(
ssd
, 
ch™√l
, 
chù
, 0, 
subs
, 
vÆid_subs_cou¡
, 
INTERLEAVE
);

4539 i‡(
comm™d
 =
TWO_PLANE
) {

4540 
dõ
 = 0; dõ < 
ssd
->
∑ømëî
->
dõ_chù
; die++) {

4541 
fú°_sub_ö_dõ
 = 
NULL
;

4542 
£c⁄d_sub_ö_dõ
 = 
NULL
;

4543 
∂™e
 = 0;Öœ√ < 
ssd
->
∑ømëî
->
∂™e_dõ
;Ölane++) {

4544 
sub
 = 
subs
[
dõ
 * 
ssd
->
∑ømëî
->
∂™e_dõ
 + 
∂™e
];

4545 i‡(
sub
 !
NULL
) {

4546 i‡(
fú°_sub_ö_dõ
 =
NULL
) {

4547 
fú°_sub_ö_dõ
 = 
sub
;

4548 } i‡(
£c⁄d_sub_ö_dõ
 =
NULL
) {

4549 
£c⁄d_sub_ö_dõ
 = 
sub
;

4550 
°©e
 = 
	`föd_Àvñ_∑ge
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
fú°_sub_ö_dõ
, 
£c⁄d_sub_ö_dõ
);

4551 i‡(
°©e
 !
SUCCESS
) {

4552 
subs
[
dõ
 * 
ssd
->
∑ømëî
->
∂™e_dõ
 + 
∂™e
] = 
NULL
;

4553 
subs_cou¡
--;

4554 
£c⁄d_sub_ö_dõ
 = 
NULL
;

4555 
sub
 = 
NULL
;

4557 
vÆid_subs_cou¡
 = 2;

4560 
°©e
 = 
	`make_Àvñ_∑ge
(
ssd
, 
fú°_sub_ö_dõ
, 
sub
);

4561 i‡(
°©e
 !
SUCCESS
) {

4562 
subs
[
dõ
 * 
ssd
->
∑ømëî
->
∂™e_dõ
 + 
∂™e
] = 
NULL
;

4563 
subs_cou¡
--;

4564 
sub
 = 
NULL
;

4566 
vÆid_subs_cou¡
++;

4571 i‡(
£c⁄d_sub_ö_dõ
 !
NULL
) {

4572 
mu…i_∂™e_Êag
 = 
TRUE
;

4576 i‡(
mu…i_∂™e_Êag
 =
TRUE
) {

4577 
ssd
->
m_∂™e_¥og_cou¡
++;

4578 
	`compuã_£rve_time
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
subs
, 
vÆid_subs_cou¡
, 
TWO_PLANE
);

4579  
SUCCESS
;

4582 
i
 = 0;

4583 
sub
 = 
NULL
;

4584 (
sub
 =
NULL
Ë&& (
i
 < 
max_subs_num
)) {

4585 
sub
 = 
subs
[
i
];

4586 
i
++;

4588 i‡(
sub
 !
NULL
) {

4589 
	`gë_µn_f‹_n‹mÆ_comm™d
(
ssd
, 
ch™√l
, 
chù
, 
sub
);

4590  
FAILURE
;

4592  
ERROR
;

4597  
ERROR
;

4600 
	}
}

4606 
Sètus
 
	$make_Àvñ_∑ge
(
ssd_öfo
 *
ssd
, 
sub_ªque°
 *
sub0
, sub_ªque° *
sub1
) {

4607 
i
 = 0, 
j
 = 0, 
k
 = 0;

4608 
ch™√l
 = 0, 
chù
 = 0, 
dõ
 = 0, 
∂™e0
 = 0, 
∂™e1
 = 0, 
block0
 = 0, 
block1
 = 0, 
∑ge0
 = 0, 
∑ge1
 = 0;

4609 
a˘ive_block0
 = 0, 
a˘ive_block1
 = 0;

4610 
ﬁd_∂™e_tokí
 = 0;

4612 i‡((
sub0
 =
NULL
Ë|| (
sub1
 =NULLË|| (sub0->
loˇti⁄
 == NULL)) {

4613  
ERROR
;

4615 
ch™√l
 = 
sub0
->
loˇti⁄
->channel;

4616 
chù
 = 
sub0
->
loˇti⁄
->chip;

4617 
dõ
 = 
sub0
->
loˇti⁄
->die;

4618 
∂™e0
 = 
sub0
->
loˇti⁄
->
∂™e
;

4619 
block0
 = 
sub0
->
loˇti⁄
->
block
;

4620 
∑ge0
 = 
sub0
->
loˇti⁄
->
∑ge
;

4621 
ﬁd_∂™e_tokí
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
;

4628 i‡(
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 =
DYNAMIC_ALLOCATION
) {

4629 
ﬁd_∂™e_tokí
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
;

4630 
i
 = 0; i < 
ssd
->
∑ømëî
->
∂™e_dõ
; i++) {

4631 
∂™e1
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
;

4632 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e1
].
add_ªg_µn
 == -1) {

4633 
	`föd_a˘ive_block
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e1
);

4634 
block1
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e1
].
a˘ive_block
;

4641 i‡(
block1
 =
block0
) {

4642 
∑ge1
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e1
].
blk_hód
[
block1
].
œ°_wrôe_∑ge
 +

4644 i‡(
∑ge1
 =
∑ge0
) {

4646 } i‡(
∑ge1
 < 
∑ge0
) {

4647 i‡(
ssd
->
∑ømëî
->
gªed_MPW_ad
 == 1)

4650 
	`make_ßme_Àvñ
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e1
, 
block1
, 
∑ge0
);

4656 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 = (
∂™e1
 + 1Ë% ssd->
∑ømëî
->
∂™e_dõ
;

4658 i‡(
i
 < 
ssd
->
∑ømëî
->
∂™e_dõ
) {

4659 
	`Êash_∑ge_°©e_modify
(
ssd
, 
sub1
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e1
, 
block1
,

4660 
∑ge0
);

4662 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 = (
∂™e1
 + 1Ë% ssd->
∑ømëî
->
∂™e_dõ
;

4663  
SUCCESS
;

4665 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 = 
ﬁd_∂™e_tokí
;

4666  
FAILURE
;

4670 i‡((
sub1
->
loˇti⁄
 =
NULL
Ë|| (sub1->loˇti⁄->
ch™√l
 !ch™√lË|| (sub1->loˇti⁄->
chù
 != chip) ||

4671 (
sub1
->
loˇti⁄
->
dõ
 != die)) {

4672  
ERROR
;

4674 
∂™e1
 = 
sub1
->
loˇti⁄
->
∂™e
;

4675 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e1
].
add_ªg_µn
 == -1) {

4676 
	`föd_a˘ive_block
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e1
);

4677 
block1
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e1
].
a˘ive_block
;

4678 i‡(
block1
 =
block0
) {

4679 
∑ge1
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e1
].
blk_hód
[
block1
].
œ°_wrôe_∑ge
 +

4681 i‡(
∑ge1
 > 
∑ge0
) {

4682  
FAILURE
;

4683 } i‡(
∑ge1
 < 
∑ge0
) {

4684 i‡(
ssd
->
∑ømëî
->
gªed_MPW_ad
 == 1) {

4686 
	`make_ßme_Àvñ
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e1
, 
block1
, 
∑ge0
);

4687 
	`Êash_∑ge_°©e_modify
(
ssd
, 
sub1
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e1
, 
block1
, 
∑ge0
);

4689  
SUCCESS
;

4691  
FAILURE
;

4694 
	`Êash_∑ge_°©e_modify
(
ssd
, 
sub1
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e1
, 
block1
, 
∑ge0
);

4696  
SUCCESS
;

4700  
FAILURE
;

4704  
ERROR
;

4708 
	}
}

4715 
Sètus
 
	$föd_Àvñ_∑ge
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
,

4716 
sub_ªque°
 *
subA
, sub_ªque° *
subB
) {

4717 
i
, 
∂™eA
, 
∂™eB
, 
a˘ive_blockA
, 
a˘ive_blockB
, 
∑geA
, 
∑geB
, 
aim_∑ge
, 
ﬁd_∂™e
;

4718 
gc_›î©i⁄
 *
gc_node
;

4720 
ﬁd_∂™e
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
;

4727 i‡(
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 == 0) {

4728 
∂™eA
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
;

4729 i‡(
∂™eA
 % 2 == 0) {

4730 
∂™eB
 = 
∂™eA
 + 1;

4731 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 =

4732 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 + 2Ë% ssd->
∑ømëî
->
∂™e_dõ
;

4734 
∂™eA
 = (∂™eA + 1Ë% 
ssd
->
∑ømëî
->
∂™e_dõ
;

4735 
∂™eB
 = 
∂™eA
 + 1;

4736 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 =

4737 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 + 3Ë% ssd->
∑ømëî
->
∂™e_dõ
;

4741 
∂™eA
 = 
subA
->
loˇti⁄
->
∂™e
;

4742 
∂™eB
 = 
subB
->
loˇti⁄
->
∂™e
;

4744 
	`föd_a˘ive_block
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eA
);

4745 
	`föd_a˘ive_block
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eB
);

4746 
a˘ive_blockA
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eA
].
a˘ive_block
;

4747 
a˘ive_blockB
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eB
].
a˘ive_block
;

4755 i‡(
a˘ive_blockA
 =
a˘ive_blockB
) {

4756 
∑geA
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eA
].
blk_hód
[
a˘ive_blockA
].
œ°_wrôe_∑ge
 +

4758 
∑geB
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eB
].
blk_hód
[
a˘ive_blockB
].
œ°_wrôe_∑ge
 +

4760 i‡(
∑geA
 =
∑geB
)

4762 
	`Êash_∑ge_°©e_modify
(
ssd
, 
subA
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eA
, 
a˘ive_blockA
, 
∑geA
);

4763 
	`Êash_∑ge_°©e_modify
(
ssd
, 
subB
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eB
, 
a˘ive_blockB
, 
∑geB
);

4765 i‡(
ssd
->
∑ømëî
->
gªed_MPW_ad
 == 1)

4767 i‡(
∑geA
 < 
∑geB
) {

4768 
aim_∑ge
 = 
∑geB
;

4769 
	`make_ßme_Àvñ
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eA
, 
a˘ive_blockA
,

4770 
aim_∑ge
);

4772 
aim_∑ge
 = 
∑geA
;

4773 
	`make_ßme_Àvñ
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eB
, 
a˘ive_blockB
, 
aim_∑ge
);

4775 
	`Êash_∑ge_°©e_modify
(
ssd
, 
subA
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eA
, 
a˘ive_blockA
, 
aim_∑ge
);

4776 
	`Êash_∑ge_°©e_modify
(
ssd
, 
subB
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eB
, 
a˘ive_blockB
, 
aim_∑ge
);

4779 
subA
 = 
NULL
;

4780 
subB
 = 
NULL
;

4781 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 = 
ﬁd_∂™e
;

4782  
FAILURE
;

4790 
∑geA
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eA
].
blk_hód
[
a˘ive_blockA
].
œ°_wrôe_∑ge
 +

4792 
∑geB
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eB
].
blk_hód
[
a˘ive_blockB
].
œ°_wrôe_∑ge
 +

4794 i‡(
∑geA
 < 
∑geB
) {

4795 i‡(
ssd
->
∑ømëî
->
gªed_MPW_ad
 == 1)

4802 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eA
].
blk_hód
[
a˘ive_blockB
].
∑ge_hód
[
∑geB
].
‰ì_°©e
 ==

4803 
PG_SUB
) {

4804 
	`make_ßme_Àvñ
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eA
, 
a˘ive_blockB
, 
∑geB
);

4805 
	`Êash_∑ge_°©e_modify
(
ssd
, 
subA
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eA
, 
a˘ive_blockB
, 
∑geB
);

4806 
	`Êash_∑ge_°©e_modify
(
ssd
, 
subB
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eB
, 
a˘ive_blockB
, 
∑geB
);

4813 
i
 = 0; i < 
ssd
->
∑ømëî
->
block_∂™e
; i++) {

4814 
∑geA
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eA
].
blk_hód
[
i
].
œ°_wrôe_∑ge
 +

4816 
∑geB
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eB
].
blk_hód
[
i
].
œ°_wrôe_∑ge
 +

4818 i‡((
∑geA
 < 
ssd
->
∑ømëî
->
∑ge_block
Ë&& (
∑geB
 < ssd->parameter->page_block)) {

4819 i‡(
∑geA
 < 
∑geB
) {

4820 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eA
].
blk_hód
[
i
].
∑ge_hód
[
∑geB
].
‰ì_°©e
 ==

4821 
PG_SUB
) {

4822 
aim_∑ge
 = 
∑geB
;

4823 
	`make_ßme_Àvñ
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eA
, 
i
, 
aim_∑ge
);

4827 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eB
].
blk_hód
[
i
].
∑ge_hód
[
∑geA
].
‰ì_°©e
 ==

4828 
PG_SUB
) {

4829 
aim_∑ge
 = 
∑geA
;

4830 
	`make_ßme_Àvñ
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eB
, 
i
, 
aim_∑ge
);

4836 i‡(
i
 < 
ssd
->
∑ømëî
->
block_∂™e
) {

4837 
	`Êash_∑ge_°©e_modify
(
ssd
, 
subA
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eA
, 
i
, 
aim_∑ge
);

4838 
	`Êash_∑ge_°©e_modify
(
ssd
, 
subB
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eB
, 
i
, 
aim_∑ge
);

4840 
subA
 = 
NULL
;

4841 
subB
 = 
NULL
;

4842 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 = 
ﬁd_∂™e
;

4843  
FAILURE
;

4848 
subA
 = 
NULL
;

4849 
subB
 = 
NULL
;

4850 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 = 
ﬁd_∂™e
;

4851  
FAILURE
;

4855 i‡(
ssd
->
∑ømëî
->
gªed_MPW_ad
 == 1) {

4856 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eB
].
blk_hód
[
a˘ive_blockA
].
∑ge_hód
[
∑geA
].
‰ì_°©e
 ==

4857 
PG_SUB
) {

4858 
	`make_ßme_Àvñ
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eB
, 
a˘ive_blockA
, 
∑geA
);

4859 
	`Êash_∑ge_°©e_modify
(
ssd
, 
subA
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eA
, 
a˘ive_blockA
, 
∑geA
);

4860 
	`Êash_∑ge_°©e_modify
(
ssd
, 
subB
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eB
, 
a˘ive_blockA
, 
∑geA
);

4862 
i
 = 0; i < 
ssd
->
∑ømëî
->
block_∂™e
; i++) {

4863 
∑geA
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eA
].
blk_hód
[
i
].
œ°_wrôe_∑ge
 +

4865 
∑geB
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eB
].
blk_hód
[
i
].
œ°_wrôe_∑ge
 +

4867 i‡((
∑geA
 < 
ssd
->
∑ømëî
->
∑ge_block
Ë&& (
∑geB
 < ssd->parameter->page_block)) {

4868 i‡(
∑geA
 < 
∑geB
) {

4869 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eA
].
blk_hód
[
i
].
∑ge_hód
[
∑geB
].
‰ì_°©e
 ==

4870 
PG_SUB
) {

4871 
aim_∑ge
 = 
∑geB
;

4872 
	`make_ßme_Àvñ
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eA
, 
i
, 
aim_∑ge
);

4876 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eB
].
blk_hód
[
i
].
∑ge_hód
[
∑geA
].
‰ì_°©e
 ==

4877 
PG_SUB
) {

4878 
aim_∑ge
 = 
∑geA
;

4879 
	`make_ßme_Àvñ
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eB
, 
i
, 
aim_∑ge
);

4885 i‡(
i
 < 
ssd
->
∑ømëî
->
block_∂™e
) {

4886 
	`Êash_∑ge_°©e_modify
(
ssd
, 
subA
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eA
, 
i
, 
aim_∑ge
);

4887 
	`Êash_∑ge_°©e_modify
(
ssd
, 
subB
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eB
, 
i
, 
aim_∑ge
);

4889 
subA
 = 
NULL
;

4890 
subB
 = 
NULL
;

4891 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 = 
ﬁd_∂™e
;

4892  
FAILURE
;

4897 i‡((
∑geA
 =
∑geB
) && (pageA == 0)) {

4903 i‡((
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eA
].
blk_hód
[
a˘ive_blockA
].
∑ge_hód
[
∑geA
].
‰ì_°©e
 ==

4904 
PG_SUB
)

4906 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eB
].
blk_hód
[
a˘ive_blockA
].
∑ge_hód
[
∑geA
].
‰ì_°©e
 ==

4907 
PG_SUB
)) {

4908 
	`Êash_∑ge_°©e_modify
(
ssd
, 
subA
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eA
, 
a˘ive_blockA
, 
∑geA
);

4909 
	`Êash_∑ge_°©e_modify
(
ssd
, 
subB
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eB
, 
a˘ive_blockA
, 
∑geA
);

4911 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eA
].
blk_hód
[
a˘ive_blockB
].
∑ge_hód
[
∑geA
].
‰ì_°©e
 ==

4912 
PG_SUB
)

4914 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eB
].
blk_hód
[
a˘ive_blockB
].
∑ge_hód
[
∑geA
].
‰ì_°©e
 ==

4915 
PG_SUB
)) {

4916 
	`Êash_∑ge_°©e_modify
(
ssd
, 
subA
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eA
, 
a˘ive_blockB
, 
∑geA
);

4917 
	`Êash_∑ge_°©e_modify
(
ssd
, 
subB
, 
ch™√l
, 
chù
, 
dõ
, 
∂™eB
, 
a˘ive_blockB
, 
∑geA
);

4919 
subA
 = 
NULL
;

4920 
subB
 = 
NULL
;

4921 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 = 
ﬁd_∂™e
;

4922  
FAILURE
;

4925 
subA
 = 
NULL
;

4926 
subB
 = 
NULL
;

4927 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 = 
ﬁd_∂™e
;

4928  
ERROR
;

4934 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eA
].
‰ì_∑ge
 <

4935 (
ssd
->
∑ømëî
->
∑ge_block
 * ssd->∑ømëî->
block_∂™e
 * ssd->∑ømëî->
gc_h¨d_thªshﬁd
)) {

4936 
gc_node
 = (
gc_›î©i⁄
 *Ë
	`mÆloc
((gc_operation));

4937 
	`Æloc_as£π
(
gc_node
, "gc_node");

4938 
	`mem£t
(
gc_node
, 0, (
gc_›î©i⁄
));

4940 
gc_node
->
√xt_node
 = 
NULL
;

4941 
gc_node
->
chù
 = chip;

4942 
gc_node
->
dõ
 = die;

4943 
gc_node
->
∂™e
 = 
∂™eA
;

4944 
gc_node
->
block
 = 0xffffffff;

4945 
gc_node
->
∑ge
 = 0;

4946 
gc_node
->
°©e
 = 
GC_WAIT
;

4947 
gc_node
->
¥i‹ôy
 = 
GC_UNINTERRUPT
;

4948 
gc_node
->
√xt_node
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
gc_comm™d
;

4949 
ssd
->
ch™√l_hód
[
ch™√l
].
gc_comm™d
 = 
gc_node
;

4950 
ssd
->
gc_ªque°
++;

4952 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™eB
].
‰ì_∑ge
 <

4953 (
ssd
->
∑ømëî
->
∑ge_block
 * ssd->∑ømëî->
block_∂™e
 * ssd->∑ømëî->
gc_h¨d_thªshﬁd
)) {

4954 
gc_node
 = (
gc_›î©i⁄
 *Ë
	`mÆloc
((gc_operation));

4955 
	`Æloc_as£π
(
gc_node
, "gc_node");

4956 
	`mem£t
(
gc_node
, 0, (
gc_›î©i⁄
));

4958 
gc_node
->
√xt_node
 = 
NULL
;

4959 
gc_node
->
chù
 = chip;

4960 
gc_node
->
dõ
 = die;

4961 
gc_node
->
∂™e
 = 
∂™eB
;

4962 
gc_node
->
block
 = 0xffffffff;

4963 
gc_node
->
∑ge
 = 0;

4964 
gc_node
->
°©e
 = 
GC_WAIT
;

4965 
gc_node
->
¥i‹ôy
 = 
GC_UNINTERRUPT
;

4966 
gc_node
->
√xt_node
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
gc_comm™d
;

4967 
ssd
->
ch™√l_hód
[
ch™√l
].
gc_comm™d
 = 
gc_node
;

4968 
ssd
->
gc_ªque°
++;

4971  
SUCCESS
;

4972 
	}
}

4977 
ssd_öfo
 *

4978 
	$Êash_∑ge_°©e_modify
(
ssd_öfo
 *
ssd
, 
sub_ªque°
 *
sub
, 
ch™√l
, 
chù
,

4979 
dõ
, 
∂™e
, 
block
, 
∑ge
) {

4980 
µn
, 
fuŒ_∑ge
;

4981 
loˇl
 *
loˇti⁄
;

4982 
dúe˘_îa£
 *
√w_dúe˘_îa£
, *
dúe˘_îa£_node
;

4984 
fuŒ_∑ge
 = ~(0xfffffff‡<< 
ssd
->
∑ømëî
->
sub∑ge_∑ge
);

4985 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
œ°_wrôe_∑ge
 = 
∑ge
;

4986 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
‰ì_∑ge_num
--;

4988 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
œ°_wrôe_∑ge
 >

4989 
ssd
->
∑ømëî
->
∑ge_block
) {

4990 
	`¥ötf
("îr‹!Åhêœ° wrôê∑gêœrgîÅh™ %d\n", 
ssd
->
∑ømëî
->
∑ge_block
);

4994 i‡(
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
°©e
 ==

4997 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
≤
 = 
	`föd_µn
(ssd, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
block
, 
∑ge
);

4998 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
°©e
 = sub->state;

5001 
µn
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
≤
;

5002 
loˇti⁄
 = 
	`föd_loˇti⁄
(
ssd
, 
µn
);

5003 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].
vÆid_°©e
 = 0;

5004 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].
‰ì_°©e
 = 0;

5005 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].
Õn
 = 0;

5006 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
övÆid_∑ge_num
++;

5007 i‡(
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
övÆid_∑ge_num
 ==

5008 
ssd
->
∑ømëî
->
∑ge_block
)

5010 
√w_dúe˘_îa£
 = (
dúe˘_îa£
 *Ë
	`mÆloc
((direct_erase));

5011 
	`Æloc_as£π
(
√w_dúe˘_îa£
, "new_direct_erase");

5012 
	`mem£t
(
√w_dúe˘_îa£
, 0, (
dúe˘_îa£
));

5014 
√w_dúe˘_îa£
->
block
 = 
loˇti⁄
->block;

5015 
√w_dúe˘_îa£
->
√xt_node
 = 
NULL
;

5016 
dúe˘_îa£_node
 = 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
îa£_node
;

5017 i‡(
dúe˘_îa£_node
 =
NULL
) {

5018 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
îa£_node
 = 
√w_dúe˘_îa£
;

5020 
√w_dúe˘_îa£
->
√xt_node
 = 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
îa£_node
;

5021 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
îa£_node
 = 
√w_dúe˘_îa£
;

5024 
	`‰ì
(
loˇti⁄
);

5025 
loˇti⁄
 = 
NULL
;

5026 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
≤
 = 
	`föd_µn
(ssd, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
block
, 
∑ge
);

5027 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
°©e
 = (ssd->dram->map->map_entry[sub->lpn].state | sub->state);

5030 
sub
->
µn
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
[sub->
Õn
].
≤
;

5031 
sub
->
loˇti⁄
->
ch™√l
 = channel;

5032 
sub
->
loˇti⁄
->
chù
 = chip;

5033 
sub
->
loˇti⁄
->
dõ
 = die;

5034 
sub
->
loˇti⁄
->
∂™e
 =Ölane;

5035 
sub
->
loˇti⁄
->
block
 = block;

5036 
sub
->
loˇti⁄
->
∑ge
 =Öage;

5038 
ssd
->
¥ogøm_cou¡
++;

5039 
ssd
->
ch™√l_hód
[
ch™√l
].
¥ogøm_cou¡
++;

5040 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
¥ogøm_cou¡
++;

5041 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
‰ì_∑ge
--;

5042 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
∑ge_hód
[
∑ge
].
Õn
 = 
sub
->lpn;

5043 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
∑ge_hód
[
∑ge
].
vÆid_°©e
 = 
sub
->
°©e
;

5044 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
∑ge_hód
[
∑ge
].
‰ì_°©e
 = (

5045 (~(
sub
->
°©e
)Ë& 
fuŒ_∑ge
);

5046 
ssd
->
wrôe_Êash_cou¡
++;

5048  
ssd
;

5049 
	}
}

5055 
ssd_öfo
 *

5056 
	$make_ßme_Àvñ
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
,

5057 
block
, 
aim_∑ge
) {

5058 
i
 = 0, 
°ï
, 
∑ge
;

5059 
dúe˘_îa£
 *
√w_dúe˘_îa£
, *
dúe˘_îa£_node
;

5061 
∑ge
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
œ°_wrôe_∑ge
 +

5063 
°ï
 = 
aim_∑ge
 - 
∑ge
;

5064 
i
 < 
°ï
) {

5065 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
∑ge_hód
[
∑ge
 +

5066 
i
].
vÆid_°©e
 = 0;

5067 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
∑ge_hód
[
∑ge
 +

5068 
i
].
‰ì_°©e
 = 0;

5069 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
∑ge_hód
[
∑ge
 +

5070 
i
].
Õn
 = 0;

5072 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
övÆid_∑ge_num
++;

5074 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
‰ì_∑ge_num
--;

5076 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
‰ì_∑ge
--;

5078 
i
++;

5081 
ssd
->
wa°e_∑ge_cou¡
 +
°ï
;

5083 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
œ°_wrôe_∑ge
 =

5084 
aim_∑ge
 - 1;

5086 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
övÆid_∑ge_num
 ==

5087 
ssd
->
∑ømëî
->
∑ge_block
)

5089 
√w_dúe˘_îa£
 = (
dúe˘_îa£
 *Ë
	`mÆloc
((direct_erase));

5090 
	`Æloc_as£π
(
√w_dúe˘_îa£
, "new_direct_erase");

5091 
	`mem£t
(
√w_dúe˘_îa£
, 0, (
dúe˘_îa£
));

5093 
dúe˘_îa£_node
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
îa£_node
;

5094 i‡(
dúe˘_îa£_node
 =
NULL
) {

5095 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
îa£_node
 = 
√w_dúe˘_îa£
;

5097 
√w_dúe˘_îa£
->
√xt_node
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
îa£_node
;

5098 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
îa£_node
 = 
√w_dúe˘_îa£
;

5102 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
œ°_wrôe_∑ge
 >

5103 
ssd
->
∑ømëî
->
∑ge_block
) {

5104 
	`¥ötf
("îr‹!Åhêœ° wrôê∑gêœrgîÅh™ %d\n", 
ssd
->
∑ømëî
->
∑ge_block
);

5108  
ssd
;

5109 
	}
}

5116 
ssd_öfo
 *
	$compuã_£rve_time
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
,

5117 
sub_ªque°
 **
subs
, 
subs_cou¡
, 
comm™d
) {

5118 
i
 = 0;

5119 
max_subs_num
 = 0;

5120 
sub_ªque°
 *
sub
 = 
NULL
, *
p
 = NULL;

5121 
sub_ªque°
 *
œ°_sub
 = 
NULL
;

5122 
max_subs_num
 = 
ssd
->
∑ømëî
->
dõ_chù
 * ssd->∑ømëî->
∂™e_dõ
;

5124 i‡((
comm™d
 =
INTERLEAVE_TWO_PLANE
Ë|| (comm™d =
COPY_BACK
)) {

5125 
i
 = 0; i < 
max_subs_num
; i++) {

5126 i‡(
subs
[
i
] !
NULL
) {

5127 
œ°_sub
 = 
subs
[
i
];

5128 
subs
[
i
]->
cuºít_°©e
 = 
SR_W_TRANSFER
;

5129 
subs
[
i
]->
cuºít_time
 = 
ssd
->current_time;

5130 
subs
[
i
]->
√xt_°©e
 = 
SR_COMPLETE
;

5131 
subs
[
i
]->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

5132 (
subs
[
i
]->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

5133 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5134 
subs
[
i
]->
com∂ëe_time
 = subs[i]->
√xt_°©e_¥edi˘_time
;

5136 
	`dñëe_‰om_ch™√l
(
ssd
, 
ch™√l
, 
subs
[
i
]);

5139 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_TRANSFER
;

5140 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

5141 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

5142 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 = 
œ°_sub
->
com∂ëe_time
;

5144 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_WRITE_BUSY
;

5145 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

5146 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

5147 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

5148 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG
;

5149 } i‡(
comm™d
 =
TWO_PLANE
) {

5150 
i
 = 0; i < 
max_subs_num
; i++) {

5151 i‡(
subs
[
i
] !
NULL
) {

5153 
subs
[
i
]->
cuºít_°©e
 = 
SR_W_TRANSFER
;

5154 i‡(
œ°_sub
 =
NULL
) {

5155 
subs
[
i
]->
cuºít_time
 = 
ssd
->current_time;

5157 
subs
[
i
]->
cuºít_time
 = 
œ°_sub
->
com∂ëe_time
 + 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tDBSY
;

5160 
subs
[
i
]->
√xt_°©e
 = 
SR_COMPLETE
;

5161 
subs
[
i
]->
√xt_°©e_¥edi˘_time
 =

5162 
subs
[
i
]->
cuºít_time
 + 7 * 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

5163 (
subs
[
i
]->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
Ë* ssd->∑ømëî->
time_ch¨a˘îi°ics
.
tWC
;

5164 
subs
[
i
]->
com∂ëe_time
 = subs[i]->
√xt_°©e_¥edi˘_time
;

5165 
œ°_sub
 = 
subs
[
i
];

5167 
	`dñëe_‰om_ch™√l
(
ssd
, 
ch™√l
, 
subs
[
i
]);

5170 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_TRANSFER
;

5171 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

5172 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

5173 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 = 
œ°_sub
->
com∂ëe_time
;

5175 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_WRITE_BUSY
;

5176 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

5177 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

5178 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

5179 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG
;

5180 } i‡(
comm™d
 =
INTERLEAVE
) {

5181 
i
 = 0; i < 
max_subs_num
; i++) {

5182 i‡(
subs
[
i
] !
NULL
) {

5184 
subs
[
i
]->
cuºít_°©e
 = 
SR_W_TRANSFER
;

5185 i‡(
œ°_sub
 =
NULL
) {

5186 
subs
[
i
]->
cuºít_time
 = 
ssd
->current_time;

5188 
subs
[
i
]->
cuºít_time
 = 
œ°_sub
->
com∂ëe_time
;

5190 
subs
[
i
]->
√xt_°©e
 = 
SR_COMPLETE
;

5191 
subs
[
i
]->
√xt_°©e_¥edi˘_time
 =

5192 
subs
[
i
]->
cuºít_time
 + 7 * 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

5193 (
subs
[
i
]->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
Ë* ssd->∑ømëî->
time_ch¨a˘îi°ics
.
tWC
;

5194 
subs
[
i
]->
com∂ëe_time
 = subs[i]->
√xt_°©e_¥edi˘_time
;

5195 
œ°_sub
 = 
subs
[
i
];

5197 
	`dñëe_‰om_ch™√l
(
ssd
, 
ch™√l
, 
subs
[
i
]);

5200 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_TRANSFER
;

5201 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

5202 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

5203 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 = 
œ°_sub
->
com∂ëe_time
;

5205 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_WRITE_BUSY
;

5206 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

5207 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

5208 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

5209 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG
;

5210 } i‡(
comm™d
 =
NORMAL
) {

5211 
subs
[0]->
cuºít_°©e
 = 
SR_W_TRANSFER
;

5212 
subs
[0]->
cuºít_time
 = 
ssd
->current_time;

5213 
subs
[0]->
√xt_°©e
 = 
SR_COMPLETE
;

5214 
subs
[0]->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

5215 (
subs
[0]->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

5216 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5217 
subs
[0]->
com∂ëe_time
 = subs[0]->
√xt_°©e_¥edi˘_time
;

5219 
	`dñëe_‰om_ch™√l
(
ssd
, 
ch™√l
, 
subs
[0]);

5221 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_TRANSFER
;

5222 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

5223 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

5224 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 = 
subs
[0]->
com∂ëe_time
;

5226 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_WRITE_BUSY
;

5227 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

5228 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

5229 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

5230 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG
;

5232  
NULL
;

5235  
ssd
;

5237 
	}
}

5243 
ssd_öfo
 *
	$dñëe_‰om_ch™√l
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
sub_ªque°
 *
sub_ªq
) {

5244 
sub_ªque°
 *
sub
, *
p
;

5250 i‡((
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 =0Ë&& (ssd->∑ømëî->
dy«mic_Æloˇti⁄
 == 0)) {

5251 
sub
 = 
ssd
->
subs_w_hód
;

5253 
sub
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
;

5255 
p
 = 
sub
;

5257 
sub
 !
NULL
) {

5258 i‡(
sub
 =
sub_ªq
) {

5259 i‡((
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 =0Ë&& (ssd->∑ømëî->
dy«mic_Æloˇti⁄
 == 0)) {

5260 i‡(
ssd
->
∑ømëî
->
ad_¥i‹ôy2
 == 0) {

5261 
ssd
->
ªÆ_time_subªq
--;

5264 i‡(
sub
 ==

5265 
ssd
->
subs_w_hód
)

5267 i‡(
ssd
->
subs_w_hód
 !ssd->
subs_w_èû
) {

5268 
ssd
->
subs_w_hód
 = 
sub
->
√xt_node
;

5269 
sub
 = 
ssd
->
subs_w_hód
;

5272 
ssd
->
subs_w_hód
 = 
NULL
;

5273 
ssd
->
subs_w_èû
 = 
NULL
;

5274 
p
 = 
NULL
;

5279 i‡(
sub
->
√xt_node
 !
NULL
) {

5280 
p
->
√xt_node
 = 
sub
->next_node;

5281 
sub
 = 
p
->
√xt_node
;

5284 
ssd
->
subs_w_èû
 = 
p
;

5285 
ssd
->
subs_w_èû
->
√xt_node
 = 
NULL
;

5291 i‡(
sub
 =
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
)

5293 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 !ssd->ch™√l_hód[ch™√l].
subs_w_èû
) {

5294 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 = 
sub
->
√xt_node
;

5295 
sub
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
;

5298 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 = 
NULL
;

5299 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_èû
 = 
NULL
;

5300 
p
 = 
NULL
;

5305 i‡(
sub
->
√xt_node
 !
NULL
) {

5306 
p
->
√xt_node
 = 
sub
->next_node;

5307 
sub
 = 
p
->
√xt_node
;

5310 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_èû
 = 
p
;

5311 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_èû
->
√xt_node
 = 
NULL
;

5317 
p
 = 
sub
;

5318 
sub
 = sub->
√xt_node
;

5321  
ssd
;

5322 
	}
}

5325 
ssd_öfo
 *

5326 
	$un_gªed_öãæóve_c›yback
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
,

5327 
sub_ªque°
 *
sub1
, sub_ªque° *
sub2
) {

5328 
ﬁd_µn1
, 
µn1
, 
ﬁd_µn2
, 
µn2
, 
gªed_Êag
 = 0;

5330 
ﬁd_µn1
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub1
->
Õn
].
≤
;

5331 
	`gë_µn
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
sub1
->
loˇti⁄
->
∂™e
,

5332 
sub1
);

5333 
µn1
 = 
sub1
->
µn
;

5335 
ﬁd_µn2
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub2
->
Õn
].
≤
;

5336 
	`gë_µn
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
sub2
->
loˇti⁄
->
∂™e
,

5337 
sub2
);

5338 
µn2
 = 
sub2
->
µn
;

5340 i‡((
ﬁd_µn1
 % 2 =
µn1
 % 2Ë&& (
ﬁd_µn2
 % 2 =
µn2
 % 2)) {

5341 
ssd
->
c›y_back_cou¡
++;

5342 
ssd
->
c›y_back_cou¡
++;

5344 
sub1
->
cuºít_°©e
 = 
SR_W_TRANSFER
;

5345 
sub1
->
cuºít_time
 = 
ssd
->current_time;

5346 
sub1
->
√xt_°©e
 = 
SR_COMPLETE
;

5347 
sub1
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 14 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

5348 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
 +

5349 (
sub1
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

5350 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5351 
sub1
->
com∂ëe_time
 = sub1->
√xt_°©e_¥edi˘_time
;

5353 
sub2
->
cuºít_°©e
 = 
SR_W_TRANSFER
;

5354 
sub2
->
cuºít_time
 = 
sub1
->
com∂ëe_time
;

5355 
sub2
->
√xt_°©e
 = 
SR_COMPLETE
;

5356 
sub2
->
√xt_°©e_¥edi˘_time
 = sub2->
cuºít_time
 + 14 * 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

5357 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
 +

5358 (
sub2
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

5359 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5360 
sub2
->
com∂ëe_time
 = sub2->
√xt_°©e_¥edi˘_time
;

5362 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_TRANSFER
;

5363 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

5364 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

5365 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 = 
sub2
->
com∂ëe_time
;

5367 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_WRITE_BUSY
;

5368 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

5369 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

5370 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

5371 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG
;

5373 
	`dñëe_‰om_ch™√l
(
ssd
, 
ch™√l
, 
sub1
);

5374 
	`dñëe_‰om_ch™√l
(
ssd
, 
ch™√l
, 
sub2
);

5376 i‡((
ﬁd_µn1
 % 2 =
µn1
 % 2Ë&& (
ﬁd_µn2
 % 2 !
µn2
 % 2)) {

5377 
ssd
->
öãæóve_cou¡
--;

5378 
ssd
->
c›y_back_cou¡
++;

5380 
sub1
->
cuºít_°©e
 = 
SR_W_TRANSFER
;

5381 
sub1
->
cuºít_time
 = 
ssd
->current_time;

5382 
sub1
->
√xt_°©e
 = 
SR_COMPLETE
;

5383 
sub1
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 14 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

5384 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
 +

5385 (
sub1
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

5386 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5387 
sub1
->
com∂ëe_time
 = sub1->
√xt_°©e_¥edi˘_time
;

5389 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_TRANSFER
;

5390 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

5391 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

5392 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 = 
sub1
->
com∂ëe_time
;

5394 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_WRITE_BUSY
;

5395 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

5396 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

5397 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

5398 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG
;

5400 
	`dñëe_‰om_ch™√l
(
ssd
, 
ch™√l
, 
sub1
);

5402 i‡((
ﬁd_µn1
 % 2 !
µn1
 % 2Ë&& (
ﬁd_µn2
 % 2 =
µn2
 % 2)) {

5403 
ssd
->
öãæóve_cou¡
--;

5404 
ssd
->
c›y_back_cou¡
++;

5406 
sub2
->
cuºít_°©e
 = 
SR_W_TRANSFER
;

5407 
sub2
->
cuºít_time
 = 
ssd
->current_time;

5408 
sub2
->
√xt_°©e
 = 
SR_COMPLETE
;

5409 
sub2
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 14 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

5410 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
 +

5411 (
sub2
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

5412 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5413 
sub2
->
com∂ëe_time
 = sub2->
√xt_°©e_¥edi˘_time
;

5415 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_TRANSFER
;

5416 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

5417 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

5418 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 = 
sub2
->
com∂ëe_time
;

5420 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_WRITE_BUSY
;

5421 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

5422 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

5423 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

5424 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG
;

5426 
	`dñëe_‰om_ch™√l
(
ssd
, 
ch™√l
, 
sub2
);

5429 
ssd
->
öãæóve_cou¡
--;

5431 
sub1
->
cuºít_°©e
 = 
SR_W_TRANSFER
;

5432 
sub1
->
cuºít_time
 = 
ssd
->current_time;

5433 
sub1
->
√xt_°©e
 = 
SR_COMPLETE
;

5434 
sub1
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 14 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

5435 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
 +

5436 2 * (
ssd
->
∑ømëî
->
sub∑ge_∑ge
 * ssd->∑ømëî->
sub∑ge_ˇ∑côy
) *

5437 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5438 
sub1
->
com∂ëe_time
 = sub1->
√xt_°©e_¥edi˘_time
;

5440 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_TRANSFER
;

5441 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

5442 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

5443 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 = 
sub1
->
com∂ëe_time
;

5445 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_WRITE_BUSY
;

5446 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

5447 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

5448 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

5449 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG
;

5451 
	`dñëe_‰om_ch™√l
(
ssd
, 
ch™√l
, 
sub1
);

5454  
ssd
;

5455 
	}
}

5458 
ssd_öfo
 *
	$un_gªed_c›yback
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
,

5459 
sub_ªque°
 *
sub1
) {

5460 
ﬁd_µn
, 
µn
;

5462 
ﬁd_µn
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub1
->
Õn
].
≤
;

5463 
	`gë_µn
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 0,

5464 
sub1
);

5465 
µn
 = 
sub1
->ppn;

5467 i‡(
ﬁd_µn
 % 2 =
µn
 % 2) {

5468 
ssd
->
c›y_back_cou¡
++;

5469 
sub1
->
cuºít_°©e
 = 
SR_W_TRANSFER
;

5470 
sub1
->
cuºít_time
 = 
ssd
->current_time;

5471 
sub1
->
√xt_°©e
 = 
SR_COMPLETE
;

5472 
sub1
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 14 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

5473 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
 +

5474 (
sub1
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

5475 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5476 
sub1
->
com∂ëe_time
 = sub1->
√xt_°©e_¥edi˘_time
;

5478 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_TRANSFER
;

5479 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

5480 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

5481 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 = 
sub1
->
com∂ëe_time
;

5483 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_WRITE_BUSY
;

5484 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

5485 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

5486 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

5487 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG
;

5490 
sub1
->
cuºít_°©e
 = 
SR_W_TRANSFER
;

5491 
sub1
->
cuºít_time
 = 
ssd
->current_time;

5492 
sub1
->
√xt_°©e
 = 
SR_COMPLETE
;

5493 
sub1
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 14 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

5494 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
 +

5495 2 * (
ssd
->
∑ømëî
->
sub∑ge_∑ge
 * ssd->∑ømëî->
sub∑ge_ˇ∑côy
) *

5496 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5497 
sub1
->
com∂ëe_time
 = sub1->
√xt_°©e_¥edi˘_time
;

5499 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_TRANSFER
;

5500 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

5501 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

5502 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 = 
sub1
->
com∂ëe_time
;

5504 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_WRITE_BUSY
;

5505 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

5506 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

5507 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

5508 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG
;

5511 
	`dñëe_‰om_ch™√l
(
ssd
, 
ch™√l
, 
sub1
);

5513  
ssd
;

5514 
	}
}

5521 
sub_ªque°
 *

5522 
	$föd_öãæóve_tw›œ√_∑ge
(
ssd_öfo
 *
ssd
, 
sub_ªque°
 *
⁄e_∑ge
, 
comm™d
) {

5523 
sub_ªque°
 *
two_∑ge
;

5525 i‡(
⁄e_∑ge
->
cuºít_°©e
 !
SR_WAIT
) {

5526  
NULL
;

5528 i‡(((
ssd
->
ch™√l_hód
[
⁄e_∑ge
->
loˇti⁄
->
ch™√l
].
chù_hód
[⁄e_∑ge->loˇti⁄->
chù
].
cuºít_°©e
 ==

5529 
CHIP_IDLE
) ||

5530 ((
ssd
->
ch™√l_hód
[
⁄e_∑ge
->
loˇti⁄
->
ch™√l
].
chù_hód
[⁄e_∑ge->loˇti⁄->
chù
].
√xt_°©e
 ==

5531 
CHIP_IDLE
) &&

5532 (
ssd
->
ch™√l_hód
[
⁄e_∑ge
->
loˇti⁄
->
ch™√l
].
chù_hód
[⁄e_∑ge->loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 <=

5533 
ssd
->
cuºít_time
)))) {

5534 
two_∑ge
 = 
⁄e_∑ge
->
√xt_node
;

5535 i‡(
comm™d
 =
TWO_PLANE
) {

5536 
two_∑ge
 !
NULL
) {

5537 i‡(
two_∑ge
->
cuºít_°©e
 !
SR_WAIT
) {

5538 
two_∑ge
 =Åwo_∑ge->
√xt_node
;

5539 } i‡((
⁄e_∑ge
->
loˇti⁄
->
chù
 =
two_∑ge
->location->chip) &&

5540 (
⁄e_∑ge
->
loˇti⁄
->
dõ
 =
two_∑ge
->location->die) &&

5541 (
⁄e_∑ge
->
loˇti⁄
->
block
 =
two_∑ge
->location->block) &&

5542 (
⁄e_∑ge
->
loˇti⁄
->
∑ge
 =
two_∑ge
->location->page)) {

5543 i‡(
⁄e_∑ge
->
loˇti⁄
->
∂™e
 !
two_∑ge
->location->plane) {

5544  
two_∑ge
;

5546 
two_∑ge
 =Åwo_∑ge->
√xt_node
;

5549 
two_∑ge
 =Åwo_∑ge->
√xt_node
;

5552 i‡(
two_∑ge
 ==

5553 
NULL
)

5555  
NULL
;

5558 i‡(
comm™d
 =
INTERLEAVE
) {

5559 
two_∑ge
 !
NULL
) {

5560 i‡(
two_∑ge
->
cuºít_°©e
 !
SR_WAIT
) {

5561 
two_∑ge
 =Åwo_∑ge->
√xt_node
;

5562 } i‡((
⁄e_∑ge
->
loˇti⁄
->
chù
 =
two_∑ge
->location->chip) &&

5563 (
⁄e_∑ge
->
loˇti⁄
->
dõ
 !
two_∑ge
->location->die)) {

5564  
two_∑ge
;

5566 
two_∑ge
 =Åwo_∑ge->
√xt_node
;

5569 i‡(
two_∑ge
 ==

5570 
NULL
)

5572  
NULL
;

5578  
NULL
;

5580 
	}
}

5587 
	$föd_öãæóve_tw›œ√_sub_ªque°
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
sub_ªque°
 *
sub_ªque°_⁄e
,

5588 
sub_ªque°
 *
sub_ªque°_two
, 
comm™d
) {

5589 
sub_ªque°_⁄e
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_r_hód
;

5590 
sub_ªque°_⁄e
 !
NULL
) {

5591 
sub_ªque°_two
 = 
	`föd_öãæóve_tw›œ√_∑ge
(
ssd
, 
sub_ªque°_⁄e
,

5592 
comm™d
);

5593 i‡(
sub_ªque°_two
 =
NULL
) {

5594 
sub_ªque°_⁄e
 = sub_ªque°_⁄e->
√xt_node
;

5595 } i‡(
sub_ªque°_two
 !=

5596 
NULL
)

5602 i‡(
sub_ªque°_two
 !
NULL
) {

5603 i‡(
ssd
->
ªque°_queue
 !=

5604 
ssd
->
ªque°_èû
) {

5605 i‡((
ssd
->
ªque°_queue
->
l¢
 - ssd->
∑ømëî
->
sub∑ge_∑ge
) <

5606 (
sub_ªque°_⁄e
->
Õn
 * 
ssd
->
∑ømëî
->
sub∑ge_∑ge
)) {

5607 i‡((
ssd
->
ªque°_queue
->
l¢
 + ssd->ªque°_queue->
size
 + ssd->
∑ømëî
->
sub∑ge_∑ge
) >

5608 (
sub_ªque°_⁄e
->
Õn
 * 
ssd
->
∑ømëî
->
sub∑ge_∑ge
)) {

5610 
sub_ªque°_two
 = 
NULL
;

5613 
sub_ªque°_two
 = 
NULL
;

5618 i‡(
sub_ªque°_two
 !
NULL
) {

5619  
SUCCESS
;

5621  
FAILURE
;

5624 
	}
}

5631 
Sètus
 
	$go_⁄e_°ï
(
ssd_öfo
 *
ssd
, 
sub_ªque°
 *
sub1
, sub_ªque° *
sub2
, 
aim_°©e
,

5632 
comm™d
) {

5633 
i
 = 0, 
j
 = 0, 
k
 = 0, 
m
 = 0;

5634 
time
 = 0;

5635 
sub_ªque°
 *
sub
 = 
NULL
;

5636 
sub_ªque°
 *
sub_tw›œ√_⁄e
 = 
NULL
, *
sub_tw›œ√_two
 = NULL;

5637 
sub_ªque°
 *
sub_öãæóve_⁄e
 = 
NULL
, *
sub_öãæóve_two
 = NULL;

5638 
loˇl
 *
loˇti⁄
 = 
NULL
;

5639 i‡(
sub1
 =
NULL
) {

5640  
ERROR
;

5642 #ifde‡
DEBUG


5643 
	`¥ötf
("íã∏thêgo_⁄e_°ï fun˘i⁄,subáddªs†poöài†%Œd,sub ch™√»%d, sub chù %d, sub dõ %d, subÖœ√ %d, sub block %d, subÖagê%d, sub sub-∑gê%d,áim_°©êi†%d, comm™d i†%d\n",
sub1
, sub1->
loˇti⁄
->
ch™√l
,sub1->loˇti⁄->
chù
,sub1->loˇti⁄->
dõ
,sub1->loˇti⁄->
∂™e
,sub1->loˇti⁄->
block
,sub1->loˇti⁄->
∑ge
,sub1->loˇti⁄->
sub_∑ge
, 
aim_°©e
, 
comm™d
);

5650 i‡(
comm™d
 =
NORMAL
) {

5651 #ifde‡
DEBUG


5652 
	`¥ötf
("enterÇormal command\n");

5655 
sub
 = 
sub1
;

5656 
loˇti⁄
 = 
sub1
->location;

5657 
aim_°©e
) {

5658 
SR_R_READ
: {

5664 #ifde‡
DEBUG


5665 
	`¥ötf
("íã∏n‹mÆ comm™d'†SR_R_REAS,™d ssd->cuºít_timêi†%Œu \n",
ssd
->
cuºít_time
);

5668 
sub
->
cuºít_time
 = 
ssd
->current_time;

5669 
sub
->
cuºít_°©e
 = 
SR_R_READ
;

5670 
sub
->
√xt_°©e
 = 
SR_R_DATA_TRANSFER
;

5671 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
;

5673 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_°©e
 = 
CHIP_READ_BUSY
;

5674 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_time
 = ssd->current_time;

5675 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e
 = 
CHIP_DATA_TRANSFER
;

5676 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 =

5677 
ssd
->
cuºít_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
;

5679 #ifde‡
DEBUGSUSPEND


5680 
	`¥ötf
("SR_R_READ: sub inf‹m©i⁄: ch™√»%d, chù %d, dõ %d,Öœ√ %d,Ö≤ %d, sub->cuºít_timê%Œd, sub->√xt_timê%Œd, ssd->cuºít_timê%Œd, ssd->cuºít_°©ê%d, ssd->√xt_°©ê%d ,chù %dÇext_¥edi˘_timê%Œd\n",
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
∂™e
, sub->
µn
, sub->
cuºít_time
, sub->
√xt_°©e_¥edi˘_time
, 
ssd
->cuºít_time,sub->
cuºít_°©e
, sub->
√xt_°©e
,Üoˇti⁄->chù, ssd->
ch™√l_hód
[loˇti⁄->ch™√l].
chù_hód
[location->chip].next_state_predict_time );

5686 
SR_R_C_A_TRANSFER
: {

5693 
sub
->
cuºít_time
 = 
ssd
->current_time;

5694 
sub
->
cuºít_°©e
 = 
SR_R_C_A_TRANSFER
;

5695 
sub
->
√xt_°©e
 = 
SR_R_READ
;

5696 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5697 
sub
->
begö_time
 = 
ssd
->
cuºít_time
;

5701 if(
sub
->
waô_„tch_m≠pögèbÀ_sign
 == 1){

5703 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
add_ªg_µn
 = -2 ;

5706 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
add_ªg_µn
 = 
sub
->
µn
;

5708 
ssd
->
ªad_cou¡
++;

5710 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
cuºít_°©e
 = 
CHANNEL_C_A_TRANSFER
;

5711 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
cuºít_time
 = ssd->current_time;

5712 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

5713 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
√xt_°©e_¥edi˘_time
 =

5714 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5716 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_°©e
 = 
CHIP_C_A_TRANSFER
;

5717 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_time
 = ssd->current_time;

5718 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e
 = 
CHIP_READ_BUSY
;

5719 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 =

5720 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5722 #ifde‡
DEBUGSUSPEND


5723 
	`¥ötf
("SR_R_C_A_TRANSFER: sub inf‹m©i⁄: ch™√»%d, chù %d, dõ %d,Öœ√ %d,Ö≤ %d, sub->cuºít_timê%Œd, sub->√xt_timê%Œd, ssd->cuºít_timê%Œd, ssd->cuºít_°©ê%d, ssd->√xt_°©ê%d, chù %dÇext_¥edi˘_timê%Œd \n",
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
∂™e
, sub->
µn
, sub->
cuºít_time
, sub->
√xt_°©e_¥edi˘_time
, 
ssd
->cuºít_time,sub->
cuºít_°©e
, sub->
√xt_°©e
,loˇti⁄->chù, ssd->
ch™√l_hód
[loˇti⁄->ch™√l].
chù_hód
[location->chip].next_state_predict_time );

5730 
SR_R_DATA_TRANSFER
: {

5738 
sub
->
cuºít_time
 = 
ssd
->current_time;

5739 
sub
->
cuºít_°©e
 = 
SR_R_DATA_TRANSFER
;

5740 
sub
->
√xt_°©e
 = 
SR_COMPLETE
;

5741 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + (sub->
size
 * ssd->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

5742 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tRC
;

5743 
sub
->
com∂ëe_time
 = sub->
√xt_°©e_¥edi˘_time
;

5745 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
cuºít_°©e
 = 
CHANNEL_DATA_TRANSFER
;

5746 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
cuºít_time
 = ssd->current_time;

5747 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

5748 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
√xt_°©e_¥edi˘_time
 = 
sub
->next_state_predict_time;

5750 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_°©e
 = 
CHIP_DATA_TRANSFER
;

5751 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_time
 = ssd->current_time;

5752 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

5753 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 = 
sub
->next_state_predict_time;

5755 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
add_ªg_µn
 = -1;

5757 #ifde‡
DEBUGSUSPEND


5758 
	`¥ötf
("SR_R_DATA_TRANSFER: sub inf‹m©i⁄: ch™√»%d, chù %d, dõ %d,Öœ√ %d,Ö≤ %d, sub->cuºít_timê%Œd, sub->√xt_timê%Œd, ssd->cuºít_timê%Œd, ssd->cuºít_°©ê%d, ssd->√xt_°©ê%d, chù %dÇext_¥edi˘_timê%Œd ,\n",
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
∂™e
, sub->
µn
, sub->
cuºít_time
, sub->
√xt_°©e_¥edi˘_time
, 
ssd
->cuºít_time, sub->
cuºít_°©e
, sub->
√xt_°©e
,loˇti⁄->chù, ssd->
ch™√l_hód
[loˇti⁄->ch™√l].
chù_hód
[location->chip].next_state_predict_time );

5765 
SR_W_TRANSFER
: {

5773 #ifde‡
DEBUG


5774 
	`¥ötf
("íã∏n‹mÆ comm™d'†SR_W_TRANSFERS,™d ssd->cuºít_timêi†%Œu \n",
ssd
->
cuºít_time
);

5777 
sub
->
cuºít_time
 = 
ssd
->current_time;

5778 
sub
->
cuºít_°©e
 = 
SR_W_TRANSFER
;

5779 
sub
->
√xt_°©e
 = 
SR_COMPLETE
;

5780 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

5781 (
sub
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

5782 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5783 
sub
->
com∂ëe_time
 = sub->
√xt_°©e_¥edi˘_time
 + 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG
;

5784 
time
 = 
sub
->
com∂ëe_time
;

5786 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
cuºít_°©e
 = 
CHANNEL_TRANSFER
;

5787 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
cuºít_time
 = ssd->current_time;

5788 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

5789 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
√xt_°©e_¥edi˘_time
 = 
time
;

5791 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_°©e
 = 
CHIP_WRITE_BUSY
;

5792 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_time
 = ssd->current_time;

5793 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

5794 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 =

5795 
time
 + 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG
;

5800 
SR_W_C_A_DATA_TRANSFER
: {

5806 #ifde‡
DEBUG


5807 
	`¥ötf
("íã∏n‹mÆ comm™d'†SR_W_C_A_DATA_TRANSFER,™d ssd->cuºít_timêi†%Œu \n",
ssd
->
cuºít_time
);

5811 i‡–(
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
°©e
 !=

5812 0Ë&& (
sub
->
waô_„tch_m≠pögèbÀ_sign
 == 0))

5814 i‡((
sub
->
°©e
 & 
ssd
->
døm
->
m≠
->
m≠_íåy
[sub->
Õn
].state) ==

5815 
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
°©e
)

5817 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

5818 (
sub
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

5819 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5821 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

5822 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
 +

5823 (
	`size
((
ssd
->
døm
->
m≠
->
m≠_íåy
[
sub
->
Õn
].
°©e
 ^ sub->state))) *

5824 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tRC
 +

5825 (
sub
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

5826 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5827 
ssd
->
ªad_cou¡
++;

5828 
ssd
->
upd©e_ªad_cou¡
++;

5831 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

5832 (
sub
->
size
 * 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

5833 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5844 
sub
->
cuºít_time
 = 
ssd
->current_time;

5845 
sub
->
cuºít_°©e
 = 
SR_W_C_A_DATA_TRANSFER
;

5846 
sub
->
√xt_°©e
 = 
SR_W_DATA_TRANSFER
;

5853 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
cuºít_°©e
 = 
CHANNEL_TRANSFER
;

5854 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
cuºít_time
 = ssd->current_time;

5855 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

5856 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
√xt_°©e_¥edi˘_time
 = 
sub
->next_state_predict_time;

5858 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_°©e
 = 
CHIP_WRITE_DATA_CMD_BUSY
;

5859 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_time
 = ssd->current_time;

5860 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e
 = 
CHIP_WRITE_BUSY
;

5861 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 = 
sub
->next_state_predict_time;

5867 #ifde‡
DEBUGSUSPEND


5868 
	`¥ötf
("SR_W_C_A_DATA_TRANSFER: sub inf‹m©i⁄: ch™√»%d, chù %d, dõ %d,Öœ√ %d,Ö≤ %d, sub->cuºít_timê%Œd, sub->√xt_timê%Œd, ssd->cuºít_timê%Œd, ssd->cuºít_°©ê%d, ssd->√xt_°©ê%d, chù %dÇext_¥edi˘_timê%Œd \n",
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
∂™e
, sub->
µn
, sub->
cuºít_time
, sub->
√xt_°©e_¥edi˘_time
, 
ssd
->cuºít_time, sub->
cuºít_°©e
, sub->
√xt_°©e
,loˇti⁄->chù, ssd->
ch™√l_hód
[loˇti⁄->ch™√l].
chù_hód
[location->chip].next_state_predict_time );

5874 
SR_W_DATA_TRANSFER_ONE_PROG_OF_ITERATIONS
: {

5880 #ifde‡
DEBUG


5881 
	`¥ötf
("íã∏n‹mÆ comm™d'†SR_W_DATA_TRANSFER_ONE_PROG_OF_ITERATIONS,™d ssd->cuºít_timêi†%Œu \n",
ssd
->
cuºít_time
);

5885 
sub
->
cuºít_time
 = 
ssd
->current_time;

5886 
sub
->
cuºít_°©e
 = 
SR_W_DATA_TRANSFER
;

5887 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG_w_¥ogam
;

5889 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_°©e
 = 
CHIP_WRITE_BUSY
;

5890 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_time
 = ssd->current_time;

5891 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 = 
sub
->next_state_predict_time;

5892 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e
 = 
CHIP_WRITE_BUSY
;

5893 
sub
->
√xt_°©e
 = 
SR_W_DATA_TRANSFER
;

5896 #ifde‡
DEBUGSUSPEND


5897 
	`¥ötf
("SR_W_DATA_TRANSFER_ONE_PROG_OF_ITERATIONS: sub inf‹m©i⁄: ch™√»%d, chù %d, dõ %d,Öœ√ %d,Ö≤ %d, sub->cuºít_timê%Œd, sub->√xt_timê%Œd, ssd->cuºít_timê%Œd, ssd->cuºít_°©ê%d, ssd->√xt_°©ê%d, chù %dÇext_¥edi˘_timê%Œd \n",
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
∂™e
, sub->
µn
, sub->
cuºít_time
, sub->
√xt_°©e_¥edi˘_time
, 
ssd
->cuºít_time, sub->
cuºít_°©e
, sub->
√xt_°©e
,loˇti⁄->chù, ssd->
ch™√l_hód
[loˇti⁄->ch™√l].
chù_hód
[location->chip].next_state_predict_time );

5904 
SR_W_DATA_TRANSFER_ONE_VERIFY_OF_ITERATIONS
: {

5910 #ifde‡
DEBUG


5911 
	`¥ötf
("íã∏n‹mÆ comm™d'†SR_W_DATA_TRANSFER_ONE_VERIFY_OF_ITERATIONS,™d ssd->cuºít_timêi†%Œu \n",
ssd
->
cuºít_time
);

5915 
sub
->
cuºít_time
 = 
ssd
->current_time;

5916 
sub
->
cuºít_°©e
 = 
SR_W_DATA_TRANSFER
;

5917 
sub
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG_w_vîify
;

5919 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_°©e
 = 
CHIP_WRITE_BUSY
;

5920 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_time
 = ssd->current_time;

5921 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 = 
sub
->next_state_predict_time;

5922 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e
 = 
CHIP_WRITE_BUSY
;

5923 
sub
->
√xt_°©e
 = 
SR_W_DATA_TRANSFER
;

5926 #ifde‡
DEBUGSUSPEND


5927 
	`¥ötf
("SR_W_DATA_TRANSFER_ONE_VERIFY_OF_ITERATIONS: sub inf‹m©i⁄: ch™√»%d, chù %d, dõ %d,Öœ√ %d,Ö≤ %d, sub->cuºít_timê%Œd, sub->√xt_timê%Œd, ssd->cuºít_timê%Œd, ssd->cuºít_°©ê%d, ssd->√xt_°©ê%d, chù %dÇext_¥edi˘_timê%Œd \n",
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
∂™e
, sub->
µn
, sub->
cuºít_time
, sub->
√xt_°©e_¥edi˘_time
, 
ssd
->cuºít_time, sub->
cuºít_°©e
, sub->
√xt_°©e
,loˇti⁄->chù, ssd->
ch™√l_hód
[loˇti⁄->ch™√l].
chù_hód
[location->chip].next_state_predict_time );

5936  
ERROR
;

5940 i‡(
comm™d
 =
TWO_PLANE
) {

5941 #ifde‡
DEBUG


5942 
	`¥ötf
("enter TWO_PLANE\n");

5950 i‡((
sub1
 =
NULL
Ë|| (
sub2
 == NULL)) {

5951  
ERROR
;

5953 
sub_tw›œ√_⁄e
 = 
sub1
;

5954 
sub_tw›œ√_two
 = 
sub2
;

5955 
loˇti⁄
 = 
sub1
->location;

5957 
aim_°©e
) {

5958 
SR_R_C_A_TRANSFER
: {

5959 #ifde‡
DEBUG


5960 
	`¥ötf
("íã∏TWO_PLANE,ö SRC_R_C_A_TRANSFER,ssdd->cuºít_timêi†%Œu \n",
ssd
->
cuºít_time
);

5963 
sub_tw›œ√_⁄e
->
cuºít_time
 = 
ssd
->current_time;

5964 
sub_tw›œ√_⁄e
->
cuºít_°©e
 = 
SR_R_C_A_TRANSFER
;

5965 
sub_tw›œ√_⁄e
->
√xt_°©e
 = 
SR_R_READ
;

5966 
sub_tw›œ√_⁄e
->
√xt_°©e_¥edi˘_time
 =

5967 
ssd
->
cuºít_time
 + 14 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5968 
sub_tw›œ√_⁄e
->
begö_time
 = 
ssd
->
cuºít_time
;

5970 
ssd
->
ch™√l_hód
[
sub_tw›œ√_⁄e
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub_tw›œ√_⁄e->loˇti⁄->
chù
].
dõ_hód
[sub_tw›œ√_⁄e->loˇti⁄->
dõ
].
∂™e_hód
[sub_tw›œ√_⁄e->loˇti⁄->
∂™e
].
add_ªg_µn
 = sub_tw›œ√_⁄e->
µn
;

5971 
ssd
->
ªad_cou¡
++;

5973 
sub_tw›œ√_two
->
cuºít_time
 = 
ssd
->current_time;

5974 
sub_tw›œ√_two
->
cuºít_°©e
 = 
SR_R_C_A_TRANSFER
;

5975 
sub_tw›œ√_two
->
√xt_°©e
 = 
SR_R_READ
;

5976 
sub_tw›œ√_two
->
√xt_°©e_¥edi˘_time
 = 
sub_tw›œ√_⁄e
->next_state_predict_time;

5977 
sub_tw›œ√_two
->
begö_time
 = 
ssd
->
cuºít_time
;

5979 
ssd
->
ch™√l_hód
[
sub_tw›œ√_two
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub_tw›œ√_two->loˇti⁄->
chù
].
dõ_hód
[sub_tw›œ√_two->loˇti⁄->
dõ
].
∂™e_hód
[sub_tw›œ√_two->loˇti⁄->
∂™e
].
add_ªg_µn
 = sub_tw›œ√_two->
µn
;

5980 
ssd
->
ªad_cou¡
++;

5981 
ssd
->
m_∂™e_ªad_cou¡
++;

5983 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
cuºít_°©e
 = 
CHANNEL_C_A_TRANSFER
;

5984 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
cuºít_time
 = ssd->current_time;

5985 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

5986 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
√xt_°©e_¥edi˘_time
 =

5987 
ssd
->
cuºít_time
 + 14 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5989 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_°©e
 = 
CHIP_C_A_TRANSFER
;

5990 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_time
 = ssd->current_time;

5991 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e
 = 
CHIP_READ_BUSY
;

5992 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 =

5993 
ssd
->
cuºít_time
 + 14 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

5998 
SR_R_DATA_TRANSFER
: {

5999 #ifde‡
DEBUG


6000 
	`¥ötf
("íã∏TWO_PLANE,™d ssd->cuºít_timêi†%Œu \n",
ssd
->
cuºít_time
);

6003 
sub_tw›œ√_⁄e
->
cuºít_time
 = 
ssd
->current_time;

6004 
sub_tw›œ√_⁄e
->
cuºít_°©e
 = 
SR_R_DATA_TRANSFER
;

6005 
sub_tw›œ√_⁄e
->
√xt_°©e
 = 
SR_COMPLETE
;

6006 
sub_tw›œ√_⁄e
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + (sub_tw›œ√_⁄e->
size
 *

6007 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

6008 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tRC
;

6009 
sub_tw›œ√_⁄e
->
com∂ëe_time
 = sub_tw›œ√_⁄e->
√xt_°©e_¥edi˘_time
;

6011 
sub_tw›œ√_two
->
cuºít_time
 = 
sub_tw›œ√_⁄e
->
√xt_°©e_¥edi˘_time
;

6012 
sub_tw›œ√_two
->
cuºít_°©e
 = 
SR_R_DATA_TRANSFER
;

6013 
sub_tw›œ√_two
->
√xt_°©e
 = 
SR_COMPLETE
;

6014 
sub_tw›œ√_two
->
√xt_°©e_¥edi˘_time
 = sub_tw›œ√_two->
cuºít_time
 + (sub_tw›œ√_two->
size
 *

6015 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

6016 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tRC
;

6017 
sub_tw›œ√_two
->
com∂ëe_time
 = sub_tw›œ√_two->
√xt_°©e_¥edi˘_time
;

6019 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
cuºít_°©e
 = 
CHANNEL_DATA_TRANSFER
;

6020 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
cuºít_time
 = ssd->current_time;

6021 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

6022 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
√xt_°©e_¥edi˘_time
 = 
sub_tw›œ√_⁄e
->next_state_predict_time;

6024 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_°©e
 = 
CHIP_DATA_TRANSFER
;

6025 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_time
 = ssd->current_time;

6026 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

6027 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 = 
sub_tw›œ√_⁄e
->next_state_predict_time;

6029 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
add_ªg_µn
 = -1;

6034  
ERROR
;

6037 i‡(
comm™d
 =
INTERLEAVE
) {

6038 #ifde‡
DEBUG


6039 
	`¥ötf
("enter INTERLEAVE\n");

6042 i‡((
sub1
 =
NULL
Ë|| (
sub2
 == NULL)) {

6043  
ERROR
;

6045 
sub_öãæóve_⁄e
 = 
sub1
;

6046 
sub_öãæóve_two
 = 
sub2
;

6047 
loˇti⁄
 = 
sub1
->location;

6049 
aim_°©e
) {

6050 
SR_R_C_A_TRANSFER
: {

6051 #ifde‡
DEBUG


6052 
	`¥ötf
("íã∏INTERLEAVE,™d ssd->cuºít_timêi†%Œu \n",
ssd
->
cuºít_time
);

6055 
sub_öãæóve_⁄e
->
cuºít_time
 = 
ssd
->current_time;

6056 
sub_öãæóve_⁄e
->
cuºít_°©e
 = 
SR_R_C_A_TRANSFER
;

6057 
sub_öãæóve_⁄e
->
√xt_°©e
 = 
SR_R_READ
;

6058 
sub_öãæóve_⁄e
->
√xt_°©e_¥edi˘_time
 =

6059 
ssd
->
cuºít_time
 + 14 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

6060 
sub_öãæóve_⁄e
->
begö_time
 = 
ssd
->
cuºít_time
;

6062 
ssd
->
ch™√l_hód
[
sub_öãæóve_⁄e
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub_öãæóve_⁄e->loˇti⁄->
chù
].
dõ_hód
[sub_öãæóve_⁄e->loˇti⁄->
dõ
].
∂™e_hód
[sub_öãæóve_⁄e->loˇti⁄->
∂™e
].
add_ªg_µn
 = sub_öãæóve_⁄e->
µn
;

6063 
ssd
->
ªad_cou¡
++;

6065 
sub_öãæóve_two
->
cuºít_time
 = 
ssd
->current_time;

6066 
sub_öãæóve_two
->
cuºít_°©e
 = 
SR_R_C_A_TRANSFER
;

6067 
sub_öãæóve_two
->
√xt_°©e
 = 
SR_R_READ
;

6068 
sub_öãæóve_two
->
√xt_°©e_¥edi˘_time
 = 
sub_öãæóve_⁄e
->next_state_predict_time;

6069 
sub_öãæóve_two
->
begö_time
 = 
ssd
->
cuºít_time
;

6071 
ssd
->
ch™√l_hód
[
sub_öãæóve_two
->
loˇti⁄
->
ch™√l
].
chù_hód
[sub_öãæóve_two->loˇti⁄->
chù
].
dõ_hód
[sub_öãæóve_two->loˇti⁄->
dõ
].
∂™e_hód
[sub_öãæóve_two->loˇti⁄->
∂™e
].
add_ªg_µn
 = sub_öãæóve_two->
µn
;

6072 
ssd
->
ªad_cou¡
++;

6073 
ssd
->
öãæóve_ªad_cou¡
++;

6075 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
cuºít_°©e
 = 
CHANNEL_C_A_TRANSFER
;

6076 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
cuºít_time
 = ssd->current_time;

6077 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

6078 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
√xt_°©e_¥edi˘_time
 =

6079 
ssd
->
cuºít_time
 + 14 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

6081 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_°©e
 = 
CHIP_C_A_TRANSFER
;

6082 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_time
 = ssd->current_time;

6083 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e
 = 
CHIP_READ_BUSY
;

6084 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 =

6085 
ssd
->
cuºít_time
 + 14 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

6090 
SR_R_DATA_TRANSFER
: {

6091 #ifde‡
DEBUG


6092 
	`¥ötf
("SR_R_DATA_TRANSFER TWO_PLANE,™d ssd->cuºít_timêi†%Œu \n",
ssd
->
cuºít_time
);

6095 
sub_öãæóve_⁄e
->
cuºít_time
 = 
ssd
->current_time;

6096 
sub_öãæóve_⁄e
->
cuºít_°©e
 = 
SR_R_DATA_TRANSFER
;

6097 
sub_öãæóve_⁄e
->
√xt_°©e
 = 
SR_COMPLETE
;

6098 
sub_öãæóve_⁄e
->
√xt_°©e_¥edi˘_time
 = 
ssd
->
cuºít_time
 + (sub_öãæóve_⁄e->
size
 *

6099 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

6100 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tRC
;

6101 
sub_öãæóve_⁄e
->
com∂ëe_time
 = sub_öãæóve_⁄e->
√xt_°©e_¥edi˘_time
;

6103 
sub_öãæóve_two
->
cuºít_time
 = 
sub_öãæóve_⁄e
->
√xt_°©e_¥edi˘_time
;

6104 
sub_öãæóve_two
->
cuºít_°©e
 = 
SR_R_DATA_TRANSFER
;

6105 
sub_öãæóve_two
->
√xt_°©e
 = 
SR_COMPLETE
;

6106 
sub_öãæóve_two
->
√xt_°©e_¥edi˘_time
 = sub_öãæóve_two->
cuºít_time
 +

6107 (
sub_öãæóve_two
->
size
 *

6108 
ssd
->
∑ømëî
->
sub∑ge_ˇ∑côy
) *

6109 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tRC
;

6110 
sub_öãæóve_two
->
com∂ëe_time
 = sub_öãæóve_two->
√xt_°©e_¥edi˘_time
;

6112 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
cuºít_°©e
 = 
CHANNEL_DATA_TRANSFER
;

6113 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
cuºít_time
 = ssd->current_time;

6114 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

6115 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
√xt_°©e_¥edi˘_time
 = 
sub_öãæóve_two
->next_state_predict_time;

6117 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_°©e
 = 
CHIP_DATA_TRANSFER
;

6118 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_time
 = ssd->current_time;

6119 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

6120 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 = 
sub_öãæóve_two
->next_state_predict_time;

6122 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
add_ªg_µn
 = -1;

6127  
ERROR
;

6131 
	`¥ötf
("\nERROR: Unexpected command !\n");

6132  
ERROR
;

6135  
SUCCESS
;

6136 
	}
}

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/flash.h

19 #i‚de‡
FLASH_H


20 
	#FLASH_H
 100000

	)

22 
	~<°dlib.h
>

23 
	~"∑gem≠.h
"

25 
ssd_öfo
 *
¥o˚ss
(ssd_info *);

27 
ssd_öfo
 *
ö£π2buf„r
(ssd_öfÿ*, , , 
sub_ªque°
 *, 
ªque°
 *);

29 
ssd_öfo
 *

30 
Êash_∑ge_°©e_modify
(
ssd_öfo
 *, 
sub_ªque°
 *, , , , ,

33 
ssd_öfo
 *

34 
make_ßme_Àvñ
(
ssd_öfo
 *, , , , , , );

36 
föd_Àvñ_∑ge
(
ssd_öfo
 *, , , , 
sub_ªque°
 *,

37 
sub_ªque°
 *);

39 
make_Àvñ_∑ge
(
ssd_öfo
 *
ssd
, 
sub_ªque°
 *
sub0
, sub_ªque° *
sub1
);

40 
ssd_öfo
 *
compuã_£rve_time
(ssd_öfÿ*
ssd
, 
ch™√l
, 
chù
, 
dõ
,

41 
sub_ªque°
 **
subs
, 
subs_cou¡
, 
comm™d
);

44 
gë_µn_f‹_adv™˚d_comm™ds
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
sub_ªque°
 **
subs
,

45 
subs_cou¡
, 
comm™d
);

47 
gë_µn_f‹_n‹mÆ_comm™d
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
sub_ªque°
 *
sub
);

49 
ssd_öfo
 *
dy«mic_adv™˚d_¥o˚ss
(ssd_öfÿ*
ssd
, 
ch™√l
, 
chù
);

51 
sub_ªque°
 *
föd_two_∂™e_∑ge
(
ssd_öfo
 *, sub_request *);

53 
sub_ªque°
 *
föd_öãæóve_ªad_∑ge
(
ssd_öfo
 *, sub_request *);

55 
föd_tw›œ√_wrôe_sub_ªque°
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
sub_ªque°
 *
sub_tw›œ√_⁄e
,

56 
sub_ªque°
 *
sub_tw›œ√_two
);

58 
föd_öãæóve_sub_ªque°
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
sub_ªque°
 *
sub_öãæóve_⁄e
,

59 
sub_ªque°
 *
sub_öãæóve_two
);

61 
sub_ªque°
 *

62 
föd_ªad_sub_ªque°
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
);

64 
sub_ªque°
 *
föd_wrôe_sub_ªque°
(
ssd_öfo
 *
ssd
, 
ch™√l
);

66 
sub_ªque°
 *

67 
¸ót_sub_ªque°
(
ssd_öfo
 *
ssd
, 
Õn
, 
size
, 
°©e
, 
ªque°
 *
ªq
,

68 
›î©i⁄
);

70 
sub_ªque°
 *

71 
föd_öãæóve_tw›œ√_∑ge
(
ssd_öfo
 *
ssd
, 
sub_ªque°
 *
⁄ïage
, 
comm™d
);

74 
föd_öãæóve_tw›œ√_sub_ªque°
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
sub_ªque°
 *
sub_ªque°_⁄e
,

75 
sub_ªque°
 *
sub_ªque°_two
, 
comm™d
);

77 
ssd_öfo
 *
dñëe_‰om_ch™√l
(ssd_öfÿ*
ssd
, 
ch™√l
, 
sub_ªque°
 *
sub_ªq
);

79 
ssd_öfo
 *

80 
un_gªed_öãæóve_c›yback
(
ssd_öfo
 *, , , , 
sub_ªque°
 *,

81 
sub_ªque°
 *);

83 
ssd_öfo
 *
un_gªed_c›yback
(ssd_öfÿ*, , , , 
sub_ªque°
 *);

86 
föd_a˘ive_block
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
);

88 
wrôe_∑ge
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
,

89 
a˘ive_block
, *
µn
);

91 
Æloˇã_loˇti⁄
(
ssd_öfo
 *
ssd
, 
sub_ªque°
 *
sub_ªq
);

94 
go_⁄e_°ï
(
ssd_öfo
 *
ssd
, 
sub_ªque°
 *
sub1
, sub_ªque° *
sub2
, 
aim_°©e
,

95 
comm™d
);

97 
£rvi˚s_2_r_cmd_å™s_™d_com∂ëe
(
ssd_öfo
 *
ssd
);

99 
£rvi˚s_2_r_waô
(
ssd_öfo
 *
ssd
, 
ch™√l
, *
ch™√l_busy_Êag
,

100 *
ch™ge_cuºít_time_Êag
);

102 
£rvi˚s_2_r_d©a_å™s
(
ssd_öfo
 *
ssd
, 
ch™√l
, *
ch™√l_busy_Êag
,

103 *
ch™ge_cuºít_time_Êag
);

105 
£rvi˚s_2_wrôe
(
ssd_öfo
 *
ssd
, 
ch™√l
, *
ch™√l_busy_Êag
,

106 *
ch™ge_cuºít_time_Êag
);

109 
£rvi˚s_2_wrôe
(
ssd_öfo
 *
ssd
, 
ch™√l
, *
ch™√l_busy_Êag
, *
ch™ge_cuºít_time_Êag
);

110 
£rvi˚s_2_wrôe_busy_ö_chù
(
ssd_öfo
 *
ssd
);

111 
£rvi˚s_2_gc_busy_ö_chù
(
ssd_öfo
 *
ssd
);

112 
gc_åy_to_su•íd_fun˘i⁄
(
ssd_öfo
 *
ssd
, 
gc_›î©i⁄
 *
gc_node
, 
ch™√l
, 
chù
, 
cuºít_°©e
, 
√xt_°©e
, 
time
);

113 
åy_to_ª°‹e_gc_fun˘i⁄
(
ssd_öfo
 *
ssd
, 
gc_›î©i⁄
 *
gc_node
, 
ch™√l
, 
chù
);

115 
åy_to_ª°‹e_wrôe_fun˘i⁄
(
ssd_öfo
 *
ssd
);

117 
√w_£rvi˚s_2_wrôe
(
ssd_öfo
 *
ssd
, 
ch™√l
, *
ch™√l_busy_Êag
,*
ch™ge_cuºít_time_Êag
);

121 
judge_wrôe_exi°ög_ö_chù
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
);

125 
dñëe_w_sub_ªque°
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
sub_ªque°
 *
sub
);

127 
c›y_back
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
sub_ªque°
 *
sub
);

130 
°©ic_wrôe
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
sub_ªque°
 *
sub
);

134 
¨ønge_the_loˇti⁄_by_Õn
(
ssd_öfo
* 
ssd
, 
sub_ªque°
* 
sub_ªq
);

135 
assign_rightvÆue_f‹_com∂ëed_m≠pögªœãd_subªque°
(
sub_ªque°
* 
sub
);

137 
ªad_ã°_dñëi⁄_f‹_subªque°
(
ssd_öfo
 *
ssd
);

138 
wrôe_ã°_dñëi⁄_f‹_subªque°
(
ssd_öfo
 *
ssd
);

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/initialize.c

19 
	#_CRTDBG_MAP_ALLOC


	)

21 
	~<°dlib.h
>

22 
	~"öôülize.h
"

23 
	~"∑gem≠.h
"

24 
	~"ssd.h
"

25 
	#FALSE
 0

	)

26 
	#TRUE
 1

	)

28 
	#ACTIVE_FIXED
 0

	)

29 
	#ACTIVE_ADJUST
 1

	)

30 
	#MAPPING_ENTRY_SIZE
 8

31 

	)

35 
	$keyCom∑ªFunc
(
TREE_NODE
 *
p
, TREE_NODE *
p1
) {

36 
buf„r_group
 *
T1
 = 
NULL
, *
T2
 = NULL;

38 
T1
 = (
buf„r_group
 *Ë
p
;

39 
T2
 = (
buf„r_group
 *Ë
p1
;

42 i‡(
T1
->
group
 < 
T2
->group)  1;

43 i‡(
T1
->
group
 > 
T2
->group)  -1;

46 
	}
}

49 
	$keyCom∑ªFunc_f‹_DFTL
(
TREE_NODE
 *
p
, TREE_NODE *
p1
) {

50 
buf„r_group_f‹_DFTL
 *
T1
 = 
NULL
, *
T2
 = NULL;

52 
T1
 = (
buf„r_group_f‹_DFTL
 *Ë
p
;

53 
T2
 = (
buf„r_group_f‹_DFTL
 *Ë
p1
;

56 i‡(
T1
->
group
 < 
T2
->group)  1;

57 i‡(
T1
->
group
 > 
T2
->group)  -1;

60 
	}
}

65 
	$‰ìFunc
(
TREE_NODE
 *
pNode
) {

67 i‡(
pNode
 !
NULL
) {

68 
	`‰ì
((*Ë
pNode
);

72 
pNode
 = 
NULL
;

74 
	}
}

84 
ssd_öfo
 *
	$öôüti⁄
(
ssd_öfo
 *
ssd
) {

85 
x
 = 0, 
y
 = 0, 
i
 = 0, 
j
 = 0, 
k
 = 0, 
l
 = 0, 
m
 = 0, 
n
 = 0;

87 
buf„r
[300];

88 
∑ømëî_vÆue
 *
∑ømëîs
;

89 
FILE
 *
Â
 = 
NULL
;

109 
ssd
->
îa£_ôî©i⁄s
 = 10;

110 
	`°∫˝y
(
ssd
->
∑ømëîfûíame
, "page.parameters", 16);

111 
	`°∫˝y
(
ssd
->
Â_numbî_subªque°s_txt_«me
, "fp_number_subrequests.txt", 25);

114 
	`¥ötf
("\ninputÅrace fileÇame:");

115 
	`sˇnf
("%s", 
ssd
->
åa˚fûíame
);

116 
	`°∫˝y
(
ssd
->
ouçutfûíame
, "ex.out", 7);

117 
	`°∫˝y
(
ssd
->
°©i°icfûíame
, "statistic10.dat", 16);

118 
	`°∫˝y
(
ssd
->
°©i°icfûíame2
, "statistic2.dat", 15);

121 
∑ømëîs
 = 
	`lﬂd_∑ømëîs
(
ssd
->
∑ømëîfûíame
);

122 
ssd
->
∑ømëî
 = 
∑ømëîs
;

123 
ssd
->
mö_l¢
 = 0x7fffffff;

124 
ssd
->
∑ge
 = ssd->
∑ømëî
->
chù_num
 * ssd->∑ømëî->
dõ_chù
 * ssd->∑ømëî->
∂™e_dõ
 *

125 
ssd
->
∑ømëî
->
block_∂™e
 * ssd->∑ømëî->
∑ge_block
;

128 
ssd
->
døm
 = (
døm_öfo
 *Ë
	`mÆloc
((dram_info));

129 
	`Æloc_as£π
(
ssd
->
døm
, "ssd->dram");

130 
	`mem£t
(
ssd
->
døm
, 0, (
døm_öfo
));

131 
	`öôülize_døm
(
ssd
);

134 
ssd
->
ch™√l_hód
 = (
ch™√l_öfo
 *Ë
	`mÆloc
(ssd->
∑ømëî
->
ch™√l_numbî
 * (channel_info));

135 
	`Æloc_as£π
(
ssd
->
ch™√l_hód
, "ssd->channel_head");

136 
	`mem£t
(
ssd
->
ch™√l_hód
, 0, ssd->
∑ømëî
->
ch™√l_numbî
 * (
ch™√l_öfo
));

137 
	`öôülize_ch™√ls
(
ssd
);

140 
	`¥ötf
("\n");

141 
ssd
->
Â_numbî_subªque°s_txt
 = 
	`f›í
(ssd->
Â_numbî_subªque°s_txt_«me
, "w");

142 i‡(
ssd
->
Â_numbî_subªque°s_txt
 =
NULL
) {

143 
	`¥ötf
("the ssd->fp_number_subrequests_txt file can't open\n");

148 
ssd
->
ouçutfûe
 = 
	`f›í
(ssd->
ouçutfûíame
, "w");

149 i‡(
ssd
->
ouçutfûe
 =
NULL
) {

150 
	`¥ötf
("the output file can't open\n");

151  
NULL
;

154 
	`¥ötf
("\n");

155 
ssd
->
°©i°icfûe
 = 
	`f›í
(ssd->
°©i°icfûíame
, "w");

156 i‡(
ssd
->
°©i°icfûe
 =
NULL
) {

157 
	`¥ötf
("the statistic file can't open\n");

158  
NULL
;

161 
	`¥ötf
("\n");

164 
	`Ârötf
(
ssd
->
ouçutfûe
, "∑ømëî fûe: %s\n", ssd->
∑ømëîfûíame
);

165 
	`Ârötf
(
ssd
->
ouçutfûe
, "åa˚ fûe: %s\n", ssd->
åa˚fûíame
);

166 
	`Ârötf
(
ssd
->
°©i°icfûe
, "∑ømëî fûe: %s\n", ssd->
∑ømëîfûíame
);

167 
	`Ârötf
(
ssd
->
°©i°icfûe
, "åa˚ fûe: %s\n", ssd->
åa˚fûíame
);

169 
	`fÊush
(
ssd
->
ouçutfûe
);

170 
	`fÊush
(
ssd
->
°©i°icfûe
);

172 
Â
 = 
	`f›í
(
ssd
->
∑ømëîfûíame
, "r");

173 i‡(
Â
 =
NULL
) {

174 
	`¥ötf
("\ntheÖarameter file can't open!\n");

175  
NULL
;

180 
	`Ârötf
(
ssd
->
ouçutfûe
, "-----------------------parameter file----------------------\n");

181 
	`Ârötf
(
ssd
->
°©i°icfûe
, "-----------------------parameter file----------------------\n");

182 
	`fgës
(
buf„r
, 300, 
Â
)) {

183 
	`Ârötf
(
ssd
->
ouçutfûe
, "%s", 
buf„r
);

184 
	`fÊush
(
ssd
->
ouçutfûe
);

185 
	`Ârötf
(
ssd
->
°©i°icfûe
, "%s", 
buf„r
);

186 
	`fÊush
(
ssd
->
°©i°icfûe
);

189 
	`Ârötf
(
ssd
->
ouçutfûe
, "\n");

190 
	`Ârötf
(
ssd
->
ouçutfûe
, "-----------------------simulation output----------------------\n");

191 
	`fÊush
(
ssd
->
ouçutfûe
);

193 
	`Ârötf
(
ssd
->
°©i°icfûe
, "\n");

194 
	`Ârötf
(
ssd
->
°©i°icfûe
, "-----------------------simulation output----------------------\n");

195 
	`fÊush
(
ssd
->
°©i°icfûe
);

197 
	`f˛o£
(
Â
);

198 
	`¥ötf
("initiation is completed!\n");

200  
ssd
;

201 
	}
}

204 
d·l_m≠pög_èbÀ_t
* 
	$d·l_¸óã_m≠pög_èbÀ
 (
ssd_öfo
 *
ssd
)

206 
d·l_m≠pög_èbÀ_t
* 
mt_ãmp
 = 
NULL
;

207 
i
 = 0;

208 
∑ge_num_ãmp
 = 
ssd
->
∑ømëî
->
∑ge_block
 * ssd->∑ømëî->
block_∂™e
 * ssd->∑ømëî->
∂™e_dõ
 *ssd->∑ømëî->
dõ_chù
 * ssd->∑ømëî->
chù_num
;

210 
å™¶©i⁄_∑ge_num
 = 
∑ge_num_ãmp
 / 
NUM_ENTRIES_PER_DIR
;

211 if(
∑ge_num_ãmp
 % 
NUM_ENTRIES_PER_DIR
 != 0){

212 
å™¶©i⁄_∑ge_num
 += 1;

214 
mt_ãmp
 = (
d·l_m≠pög_èbÀ_t
*Ë
	`mÆloc
((dftl_mapping_table_t));

215 
	`mem£t
(
mt_ãmp
, 0, (
d·l_m≠pög_èbÀ_t
));

217 
mt_ãmp
->
buf„r_DFTL
 = (
tAVLTªe
 *Ë
	`avlTªeCª©e
((*Ë
keyCom∑ªFunc
, (*Ë
‰ìFunc
);

218 #ifde‡
COMPRESSION_MAPPING


219 
mt_ãmp
->
buf„r_DFTL_UNCOM
 = (
tAVLTªe
 *Ë
	`avlTªeCª©e
((*Ë
keyCom∑ªFunc
, (*Ë
‰ìFunc
);

223 
mt_ãmp
->
buf„r_DFTL_UNCOM
 = 
NULL
;

226 #ifde‡
TRANSLATION_PAGE_UNIT


228 if(
mt_ãmp
->
buf„r_DFTL
 =
NULL
){

229 
	`ssdsim_msg
("wrong in malloc inávlTree for DFTL");

234 
mt_ãmp
->
m≠pög_íåy_size
 = 
MAPPING_ENTRY_SIZE
;

235 
mt_ãmp
->
ƒ_íåõs_≥r_dú_¶Ÿ
 = 
NUM_ENTRIES_PER_DIR
;

236 
mt_ãmp
->
ƒ_tŸÆ_dú_¶Ÿs
 = 
∑ge_num_ãmp
 / 
NUM_ENTRIES_PER_DIR
;

237 #ifde‡
COMPRESSION_MAPPING


238 if(
mt_ãmp
->
buf„r_DFTL_UNCOM
 =
NULL
){

239 
	`ssdsim_msg
("wrong in malloc inávlTree for uncompression_DFTL");

244 
mt_ãmp
->
max_ˇched_dú_¶Ÿs_sizeö_byã
 = 
MAX_CACHED_DIR_SLOTS_SIZE
 * (1- 
COMP_VS_UNCOMP_IN_DFTL_BUFFER
);

246 
mt_ãmp
->
uncom¥essi⁄_max_ˇched_dú_¶Ÿs_sizeö_byã
 = 
MAX_CACHED_DIR_SLOTS_SIZE
 * (
COMP_VS_UNCOMP_IN_DFTL_BUFFER
);

247 
mt_ãmp
->
uncom¥essi⁄_now_ˇched_dú_¶Ÿs_sizeö_byã
 = 0;

250 
mt_ãmp
->
max_ˇched_dú_¶Ÿs_sizeö_byã
 = 
MAX_CACHED_DIR_SLOTS_SIZE
;

252 
mt_ãmp
->
uncom¥essi⁄_max_ˇched_dú_¶Ÿs_sizeö_byã
 = 0;

253 
mt_ãmp
->
uncom¥essi⁄_now_ˇched_dú_¶Ÿs_sizeö_byã
 = 0;

256 
mt_ãmp
->
now_ˇched_dú_¶Ÿs_sizeö_byã
 = 0;

257 
mt_ãmp
->
max_ˇched_íåõs_sizeö_byã
 = 0;

258 
mt_ãmp
->
now_ˇched_íåõs_sizeö_byã
 = 0;

260 #ifde‡
COMPRESSION_MAPPING


261 
mt_ãmp
->
com¥essi⁄_size
 = (*)
	`mÆloc
((Ë* 
å™¶©i⁄_∑ge_num
);

262 
mt_ãmp
->
com¥essi⁄_°©e
 = (*)
	`mÆloc
((Ë* 
å™¶©i⁄_∑ge_num
);

263 
mt_ãmp
->
com¥essi⁄_dúty
 = (*)
	`mÆloc
((Ë* 
å™¶©i⁄_∑ge_num
);

264 
	`mem£t
(
mt_ãmp
->
com¥essi⁄_size
, 0, ()* 
å™¶©i⁄_∑ge_num
);

265 
	`mem£t
(
mt_ãmp
->
com¥essi⁄_°©e
, 0, ()* 
å™¶©i⁄_∑ge_num
);

266 
	`mem£t
(
mt_ãmp
->
com¥essi⁄_dúty
, 0, ()* 
å™¶©i⁄_∑ge_num
);

268 
mt_ãmp
->
com¥essi⁄_size
 = 
NULL
;

269 
mt_ãmp
->
com¥essi⁄_°©e
 = 
NULL
;

270 
mt_ãmp
->
com¥essi⁄_dúty
 = 
NULL
;

276 
mt_ãmp
->
dú
 = (
dúe˘‹y_¶Ÿ_t
*Ë
	`mÆloc
 ((dúe˘‹y_¶Ÿ_t)* mt_ãmp->
ƒ_tŸÆ_dú_¶Ÿs
);

278 
i
 = 0; i < 
mt_ãmp
->
ƒ_tŸÆ_dú_¶Ÿs
; i++ ){

279 
dúe˘‹y_¶Ÿ_t
* 
ds
 = &
mt_ãmp
->
dú
[
i
];

280 
ds
->
id
 = 
i
;

281 
ds
->
°©us
 = 
DFTL_DIR_EMPTY
;

282 
ds
->
is_undî_lﬂd
 = 0;

283 
ds
->
phyaddr
.
ch™√l
 = 
DFTL_PAGE_INVALID_ADDR
;

284 
ds
->
phyaddr
.
chù
 = 
DFTL_PAGE_INVALID_ADDR
;

285 
ds
->
phyaddr
.
dõ
 = 
DFTL_PAGE_INVALID_ADDR
;

286 
ds
->
phyaddr
.
∂™e
 = 
DFTL_PAGE_INVALID_ADDR
;

287 
ds
->
phyaddr
.
block
 = 
DFTL_PAGE_INVALID_ADDR
;

288 
ds
->
phyaddr
.
∑ge
 = 
DFTL_PAGE_INVALID_ADDR
;

289 
ds
->
me
 = 
NULL
;

292 
	`ssdsim_msg
("DFTL: m≠pög_íåy_sizê: %Œd",
mt_ãmp
->
m≠pög_íåy_size
 );

293 
	`ssdsim_msg
("DFTL:Çr_íåõs_≥r_dú_¶Ÿ : %Œd",
mt_ãmp
->
ƒ_íåõs_≥r_dú_¶Ÿ
 );

294 
	`ssdsim_msg
("DFTL:Çr_tŸÆ_dú_¶Ÿs: %Œd",
mt_ãmp
->
ƒ_tŸÆ_dú_¶Ÿs
 );

295 
	`ssdsim_msg
("DFTL: max_ˇched_dú_¶Ÿs_sizeö_byã: %Œd",
mt_ãmp
->
max_ˇched_dú_¶Ÿs_sizeö_byã
);

296 
	`ssdsim_msg
("DFTL:Çow_ˇched_dú_¶Ÿs_sizeö_byt: %Œd",
mt_ãmp
->
now_ˇched_dú_¶Ÿs_sizeö_byã
);

297 
	`ssdsim_msg
("DFTL: uncom¥essi⁄_max_ˇched_dú_¶Ÿs_sizeö_byã: %Œd",
mt_ãmp
->
uncom¥essi⁄_max_ˇched_dú_¶Ÿs_sizeö_byã
);

298 
	`ssdsim_msg
("DFTL: uncom¥essi⁄_now_ˇched_dú_¶Ÿs_sizeö_byã: %Œd",
mt_ãmp
->
uncom¥essi⁄_now_ˇched_dú_¶Ÿs_sizeö_byã
);

300 
	`ssdsim_msg
("thêma¸ÿdeföôi⁄ vÆue†hîe:Öage_numbî i†%d, NUM_ENTRIES_PER_DIR i†%d,Åøn¶©⁄_∑ge_num i†%d", 
∑ge_num_ãmp
, 
NUM_ENTRIES_PER_DIR
, 
å™¶©i⁄_∑ge_num
);

302  
mt_ãmp
;

308 #ifde‡
ENTRY_UNIT


309 if(
mt_ãmp
->
buf„r_DFTL
 =
NULL
){

310 
	`ssdsim_msg
("wrong in malloc inávlTree for DFTL");

312 
mt_ãmp
->
m≠pög_íåy_size
 = 
MAPPING_ENTRY_SIZE
;

313 
mt_ãmp
->
ƒ_íåõs_≥r_dú_¶Ÿ
 = -1;

314 
mt_ãmp
->
ƒ_tŸÆ_dú_¶Ÿs
 = -1;

315 
mt_ãmp
->
max_ˇched_dú_¶Ÿs_sizeö_byã
 = 0;

316 
mt_ãmp
->
now_ˇched_dú_¶Ÿs_sizeö_byã
 = 0;

317 
mt_ãmp
->
max_ˇched_íåõs_sizeö_byã
 = 
MAX_CACHED_ENTRIES_SIZE
;

318 
mt_ãmp
->
now_ˇched_íåõs_sizeö_byã
 = 0;

319 
mt_ãmp
->
dú
 = 
NULL
;

340 
	`ssdsim_msg
("DFTL: m≠pög_íåy_sizê: %Œd",
mt_ãmp
->
m≠pög_íåy_size
 );

341 
	`ssdsim_msg
("DFTL: max_ˇched_íåõs_sizeö_byã: %Œd",
mt_ãmp
->
max_ˇched_íåõs_sizeö_byã
);

342 
	`ssdsim_msg
("DFTL:Çow_ˇched_íåõs_sizeö_byã: %Œd",
mt_ãmp
->
now_ˇched_íåõs_sizeö_byã
);

346  
mt_ãmp
;

348 
	}
}

352 
døm_öfo
 *
	$öôülize_døm
(
ssd_öfo
 *
ssd
) {

353 
∑ge_num
;

355 
døm_öfo
 *
døm
 = 
ssd
->dram;

356 
døm
->
døm_ˇ∑côy
 = 
ssd
->
∑ømëî
->dram_capacity;

357 
døm
->
buf„r
 = (
tAVLTªe
 *Ë
	`avlTªeCª©e
((*Ë
keyCom∑ªFunc
, (*Ë
‰ìFunc
);

358 
døm
->
buf„r
->
max_buf„r_£˘‹
 = 
ssd
->
∑ømëî
->
døm_ˇ∑côy
 / 
SECTOR
;

360 
døm
->
m≠
 = (
m≠_öfo
 *Ë
	`mÆloc
((map_info));

361 
	`Æloc_as£π
(
døm
->
m≠
, "dram->map");

362 
	`mem£t
(
døm
->
m≠
, 0, (
m≠_öfo
));

365 
døm
->
mt
 = 
	`d·l_¸óã_m≠pög_èbÀ
 (
ssd
);

371 
∑ge_num
 = 
ssd
->
∑ømëî
->
∑ge_block
 * ssd->∑ømëî->
block_∂™e
 * ssd->∑ømëî->
∂™e_dõ
 *

372 
ssd
->
∑ømëî
->
dõ_chù
 * ssd->∑ømëî->
chù_num
;

373 
	`¥ötf
("∑ge_num i†%d\n", 
∑ge_num
);

374 
døm
->
m≠
->
m≠_íåy
 = (
íåy
 *Ë
	`mÆloc
((íåyË* 
∑ge_num
);

375 
	`Æloc_as£π
(
døm
->
m≠
->
m≠_íåy
, "dram->map->map_entry");

376 
	`mem£t
(
døm
->
m≠
->
m≠_íåy
, 0, (
íåy
Ë* 
∑ge_num
);

378  
døm
;

379 
	}
}

381 
∑ge_öfo
 *
	$öôülize_∑ge
(
∑ge_öfo
 *
p_∑ge
) {

382 
p_∑ge
->
vÆid_°©e
 = 0;

383 
p_∑ge
->
‰ì_°©e
 = 
PG_SUB
;

384 
p_∑ge
->
Õn
 = -1;

385 
p_∑ge
->
wrôãn_cou¡
 = 0;

386  
p_∑ge
;

387 
	}
}

389 
blk_öfo
 *
	$öôülize_block
(
blk_öfo
 *
p_block
, 
∑ømëî_vÆue
 *
∑ømëî
) {

390 
i
;

391 
∑ge_öfo
 *
p_∑ge
;

393 
p_block
->
‰ì_∑ge_num
 = 
∑ømëî
->
∑ge_block
;

394 
p_block
->
œ°_wrôe_∑ge
 = -1;

396 
p_block
->
∑ge_hód
 = (
∑ge_öfo
 *Ë
	`mÆloc
(
∑ømëî
->
∑ge_block
 * (page_info));

397 
	`Æloc_as£π
(
p_block
->
∑ge_hód
, "p_block->page_head");

398 
	`mem£t
(
p_block
->
∑ge_hód
, 0, 
∑ømëî
->
∑ge_block
 * (
∑ge_öfo
));

400 
i
 = 0; i < 
∑ømëî
->
∑ge_block
; i++) {

401 
p_∑ge
 = &(
p_block
->
∑ge_hód
[
i
]);

402 
	`öôülize_∑ge
(
p_∑ge
);

404  
p_block
;

406 
	}
}

408 
∂™e_öfo
 *
	$öôülize_∂™e
(
∂™e_öfo
 *
p_∂™e
, 
∑ømëî_vÆue
 *
∑ømëî
) {

409 
i
;

410 
blk_öfo
 *
p_block
;

411 
p_∂™e
->
add_ªg_µn
 = -1;

423 
p_∂™e
->
‰ì_∑ge
 = 
∑ømëî
->
block_∂™e
 *Ö¨amëî->
∑ge_block
;

425 
p_∂™e
->
blk_hód
 = (
blk_öfo
 *Ë
	`mÆloc
(
∑ømëî
->
block_∂™e
 * (blk_info));

426 
	`Æloc_as£π
(
p_∂™e
->
blk_hód
, "p_plane->blk_head");

427 
	`mem£t
(
p_∂™e
->
blk_hód
, 0, 
∑ømëî
->
block_∂™e
 * (
blk_öfo
));

429 
i
 = 0; i < 
∑ømëî
->
block_∂™e
; i++) {

430 
p_block
 = &(
p_∂™e
->
blk_hód
[
i
]);

431 
	`öôülize_block
(
p_block
, 
∑ømëî
);

433  
p_∂™e
;

434 
	}
}

436 
dõ_öfo
 *
	$öôülize_dõ
(
dõ_öfo
 *
p_dõ
, 
∑ømëî_vÆue
 *
∑ømëî
, 
cuºít_time
) {

437 
i
;

438 
∂™e_öfo
 *
p_∂™e
;

440 
p_dõ
->
tokí
 = 0;

442 
p_dõ
->
∂™e_hód
 = (
∂™e_öfo
 *Ë
	`mÆloc
(
∑ømëî
->
∂™e_dõ
 * (plane_info));

443 
	`Æloc_as£π
(
p_dõ
->
∂™e_hód
, "p_die->plane_head");

444 
	`mem£t
(
p_dõ
->
∂™e_hód
, 0, 
∑ømëî
->
∂™e_dõ
 * (
∂™e_öfo
));

446 
i
 = 0; i < 
∑ømëî
->
∂™e_dõ
; i++) {

447 
p_∂™e
 = &(
p_dõ
->
∂™e_hód
[
i
]);

448 
	`öôülize_∂™e
(
p_∂™e
, 
∑ømëî
);

451  
p_dõ
;

452 
	}
}

454 
chù_öfo
 *
	$öôülize_chù
(
chù_öfo
 *
p_chù
, 
∑ømëî_vÆue
 *
∑ømëî
, 
cuºít_time
) {

455 
i
;

456 
dõ_öfo
 *
p_dõ
;

458 
p_chù
->
cuºít_°©e
 = 
CHIP_IDLE
;

459 
p_chù
->
√xt_°©e
 = 
CHIP_IDLE
;

460 
p_chù
->
cuºít_time
 = current_time;

461 
p_chù
->
√xt_°©e_¥edi˘_time
 = 0;

462 
p_chù
->
dõ_num
 = 
∑ømëî
->
dõ_chù
;

463 
p_chù
->
∂™e_num_dõ
 = 
∑ømëî
->
∂™e_dõ
;

464 
p_chù
->
block_num_∂™e
 = 
∑ømëî
->
block_∂™e
;

465 
p_chù
->
∑ge_num_block
 = 
∑ømëî
->
block_∂™e
;

466 
p_chù
->
sub∑ge_num_∑ge
 = 
∑ømëî
->
sub∑ge_∑ge
;

467 
p_chù
->
îs_limô
 = 
∑ømëî
->ers_limit;

468 
p_chù
->
tokí
 = 0;

469 
p_chù
->
ac_timög
 = 
∑ømëî
->
time_ch¨a˘îi°ics
;

470 
p_chù
->
ªad_cou¡
 = 0;

471 
p_chù
->
¥ogøm_cou¡
 = 0;

472 
p_chù
->
îa£_cou¡
 = 0;

474 
p_chù
->
num_w_cy˛e
 = 0;

475 
p_chù
->
wrôe_¥ìm±ive_sign
 = 0;

476 
p_chù
->
chù_ªad_queue_Àngth
 = 0;

477 
p_chù
->
chù_wrôe_queue_Àngth
 = 0;

483 
p_chù
->
dõ_hód
 = (
dõ_öfo
 *Ë
	`mÆloc
(
∑ømëî
->
dõ_chù
 * (die_info));

484 
	`Æloc_as£π
(
p_chù
->
dõ_hód
, "p_chip->die_head");

485 
	`mem£t
(
p_chù
->
dõ_hód
, 0, 
∑ømëî
->
dõ_chù
 * (
dõ_öfo
));

487 
i
 = 0; i < 
∑ømëî
->
dõ_chù
; i++) {

488 
p_dõ
 = &(
p_chù
->
dõ_hód
[
i
]);

489 
	`öôülize_dõ
(
p_dõ
, 
∑ømëî
, 
cuºít_time
);

492  
p_chù
;

493 
	}
}

495 
ssd_öfo
 *
	$öôülize_ch™√ls
(
ssd_öfo
 *
ssd
) {

496 
i
, 
j
;

497 
ch™√l_öfo
 *
p_ch™√l
;

498 
chù_öfo
 *
p_chù
;

501 
i
 = 0; i < 
ssd
->
∑ømëî
->
ch™√l_numbî
; i++) {

502 
p_ch™√l
 = &(
ssd
->
ch™√l_hód
[
i
]);

503 
p_ch™√l
->
chù
 = 
ssd
->
∑ømëî
->
chù_ch™√l
[
i
];

504 
p_ch™√l
->
cuºít_°©e
 = 
CHANNEL_IDLE
;

505 
p_ch™√l
->
√xt_°©e
 = 
CHANNEL_IDLE
;

512 
p_ch™√l
->
chù_hód
 = (
chù_öfo
 *Ë
	`mÆloc
(
ssd
->
∑ømëî
->
chù_ch™√l
[
i
] * (chip_info));

513 
	`Æloc_as£π
(
p_ch™√l
->
chù_hód
, "p_channel->chip_head");

514 
	`mem£t
(
p_ch™√l
->
chù_hód
, 0, 
ssd
->
∑ømëî
->
chù_ch™√l
[
i
] * (
chù_öfo
));

516 
j
 = 0; j < 
ssd
->
∑ømëî
->
chù_ch™√l
[
i
]; j++) {

517 
p_chù
 = &(
p_ch™√l
->
chù_hód
[
j
]);

518 
	`öôülize_chù
(
p_chù
, 
ssd
->
∑ømëî
, ssd->
cuºít_time
);

519 #ifde‡
DEBUG


520 
	`¥ötf
("öôülizêch™√l†chù %d, ssd cuºít_timê%Œd\n",
j
, 
ssd
->
cuºít_time
);

525  
ssd
;

526 
	}
}

534 
∑ømëî_vÆue
 *
	$lﬂd_∑ømëîs
(
∑ømëî_fûe
[30]) {

535 
FILE
 *
Â
;

536 
FILE
 *
Â1
;

537 
FILE
 *
Â2
;

539 
∑ømëî_vÆue
 *
p
;

540 
buf
[
BUFSIZE
];

541 
i
;

542 
¥e_eql
, 
√xt_eql
;

543 
ªs_eql
;

544 *
±r
;

546 
p
 = (
∑ømëî_vÆue
 *Ë
	`mÆloc
((parameter_value));

547 
	`Æloc_as£π
(
p
, "parameter_value");

548 
	`mem£t
(
p
, 0, (
∑ømëî_vÆue
));

549 
p
->
queue_Àngth
 = 100;

550 
	`mem£t
(
buf
, 0, 
BUFSIZE
);

552 
Â
 = 
	`f›í
(
∑ømëî_fûe
, "r");

553 i‡(
Â
 =
NULL
) {

554 
	`¥ötf
("the fileÖarameter_fileÉrror!\n");

555  
p
;

557 
Â1
 = 
	`f›í
("parameters_name.txt", "w");

558 i‡(
Â1
 =
NULL
) {

559 
	`¥ötf
("the fileÖarameter_nameÉrror!\n");

560  
p
;

562 
Â2
 = 
	`f›í
("parameters_value.txt", "w");

563 i‡(
Â2
 =
NULL
) {

564 
	`¥ötf
("the fileÖarameter_valueÉrror!\n");

565  
p
;

569 
	`fgës
(
buf
, 200, 
Â
)) {

570 i‡(
buf
[0] == '#' || buf[0] == ' ') ;

571 
±r
 = 
	`°rchr
(
buf
, '=');

572 i‡(!
±r
) ;

574 
¥e_eql
 = 
±r
 - 
buf
;

575 
√xt_eql
 = 
¥e_eql
 + 1;

577 
buf
[
¥e_eql
 - 1] == ' ')Öre_eql--;

578 
buf
[
¥e_eql
] = 0;

579 i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "chipÇumber")) == 0) {

580 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
chù_num
);

581 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "dram capacity")) == 0) {

582 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
døm_ˇ∑côy
);

583 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "cpu sdram")) == 0) {

584 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
˝u_sdøm
);

585 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "channelÇumber")) == 0) {

586 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
ch™√l_numbî
);

587 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "dieÇumber")) == 0) {

588 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
dõ_chù
);

589 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "planeÇumber")) == 0) {

590 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
∂™e_dõ
);

591 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "blockÇumber")) == 0) {

592 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
block_∂™e
);

593 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "pageÇumber")) == 0) {

594 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
∑ge_block
);

595 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "subpageÖage")) == 0) {

596 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
sub∑ge_∑ge
);

597 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "page capacity")) == 0) {

598 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
∑ge_ˇ∑côy
);

599 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "subpage capacity")) == 0) {

600 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
sub∑ge_ˇ∑côy
);

601 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_PROG")) == 0) {

602 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tPROG
);

605 i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "tPROG_r_phy")) == 0) {

606 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tPROG_r_phy
) ;

607 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "tPROG_w_total ")) == 0) {

608 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tPROG_w_tŸÆ
) ;

609 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "tPROG_Nw_cycle")) == 0) {

610 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tPROG_Nw_cy˛e
) ;

611 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "tPROG_Tw_cycle")) == 0) {

612 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tPROG_Tw_cy˛e
) ;

613 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "tPROG_w_progam")) == 0) {

614 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tPROG_w_¥ogam
) ;

615 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "tPROG_w_verify")) == 0) {

616 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tPROG_w_vîify
) ;

617 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "tPROG_buffer")) == 0) {

618 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tPROG_buf„r
) ;

621 i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_DBSY")) == 0) {

622 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tDBSY
);

623 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_BERS")) == 0) {

624 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tBERS
);

625 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_CLS")) == 0) {

626 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tCLS
);

627 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_CLH")) == 0) {

628 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tCLH
);

629 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_CS")) == 0) {

630 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tCS
);

631 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_CH")) == 0) {

632 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tCH
);

633 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_WP")) == 0) {

634 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tWP
);

635 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_ALS")) == 0) {

636 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tALS
);

637 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_ALH")) == 0) {

638 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tALH
);

639 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_DS")) == 0) {

640 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tDS
);

641 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_DH")) == 0) {

642 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tDH
);

643 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_WC")) == 0) {

644 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tWC
);

645 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_WH")) == 0) {

646 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tWH
);

647 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_ADL")) == 0) {

648 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tADL
);

649 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_R")) == 0) {

650 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tR
);

651 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_AR")) == 0) {

652 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tAR
);

653 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_CLR")) == 0) {

654 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tCLR
);

655 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_RR")) == 0) {

656 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tRR
);

657 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_RP")) == 0) {

658 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tRP
);

659 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_WB")) == 0) {

660 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tWB
);

661 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_RC")) == 0) {

662 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tRC
);

663 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_REA")) == 0) {

664 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tREA
);

665 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_CEA")) == 0) {

666 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tCEA
);

667 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_RHZ")) == 0) {

668 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tRHZ
);

669 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_CHZ")) == 0) {

670 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tCHZ
);

671 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_RHOH")) == 0) {

672 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tRHOH
);

673 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_RLOH")) == 0) {

674 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tRLOH
);

675 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_COH")) == 0) {

676 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tCOH
);

677 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_REH")) == 0) {

678 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tREH
);

679 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_IR")) == 0) {

680 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tIR
);

681 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_RHW")) == 0) {

682 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tRHW
);

683 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_WHR")) == 0) {

684 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tWHR
);

685 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "t_RST")) == 0) {

686 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_ch¨a˘îi°ics
.
tRST
);

687 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "eraseÜimit")) == 0) {

688 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
îs_limô
);

689 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "flash operating current")) == 0) {

690 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%lf", &
p
->
›î©ög_cuºít
);

691 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "flash supply voltage")) == 0) {

692 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%lf", &
p
->
suµly_vﬁège
);

693 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "dramáctive current")) == 0) {

694 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%lf", &
p
->
døm_a˘ive_cuºít
);

695 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "dram standby current")) == 0) {

696 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%lf", &
p
->
døm_°™dby_cuºít
);

697 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "dramÑefresh current")) == 0) {

698 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%lf", &
p
->
døm_ª‰esh_cuºít
);

699 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "dram voltage")) == 0) {

700 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%lf", &
p
->
døm_vﬁège
);

701 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "address mapping")) == 0) {

702 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
addªss_m≠pög
);

703 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "wearÜeveling")) == 0) {

704 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
wór_Àvñög
);

705 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "gc")) == 0) {

706 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
gc
);

707 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "clean in background")) == 0) {

708 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
˛ón_ö_background
);

709 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "overprovide")) == 0) {

710 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%f", &
p
->
ovî¥ovide
);

711 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "gcÅhreshold")) == 0) {

712 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%f", &
p
->
gc_thªshﬁd
);

713 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "buffer management")) == 0) {

714 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
buf„r_m™agemít
);

715 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "schedulingálgorithm")) == 0) {

716 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
schedulög_Æg‹ôhm
);

717 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "quickÅableÑadio")) == 0) {

718 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%f", &
p
->
quick_ødio
);

719 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "related mapping")) == 0) {

720 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
ªœãd_m≠pög
);

721 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "striping")) == 0) {

722 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
°rùög
);

723 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "interleaving")) == 0) {

724 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
öãæóvög
);

725 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "pipelining")) == 0) {

726 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
pùñöög
);

727 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "time_step")) == 0) {

728 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
time_°ï
);

729 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "smallÜarge write")) == 0) {

730 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
smÆl_œrge_wrôe
);

731 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "active writeÅhreshold")) == 0) {

732 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
thªshﬁd_fixed_adju°
);

733 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "threshold value")) == 0) {

734 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%f", &
p
->
thªshﬁd_vÆue
);

735 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "active write")) == 0) {

736 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
a˘ive_wrôe
);

737 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "gc hardÅhreshold")) == 0) {

738 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%f", &
p
->
gc_h¨d_thªshﬁd
);

739 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "allocation")) == 0) {

740 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
Æloˇti⁄_scheme
);

741 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "static_allocation")) == 0) {

742 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
°©ic_Æloˇti⁄
);

743 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "dynamic_allocation")) == 0) {

744 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
dy«mic_Æloˇti⁄
);

745 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "advanced command")) == 0) {

746 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
adv™˚d_comm™ds
);

747 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "advanced commandÖriority")) == 0) {

748 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
ad_¥i‹ôy
);

749 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "advanced commandÖriority2")) == 0) {

750 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
ad_¥i‹ôy2
);

751 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "greed CB command")) == 0) {

752 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
gªed_CB_ad
);

753 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "greed MPW command")) == 0) {

754 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
gªed_MPW_ad
);

755 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "aged")) == 0) {

756 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
aged
);

757 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "agedÑatio")) == 0) {

758 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%f", &
p
->
aged_øtio
);

759 } i‡((
ªs_eql
 = 
	`°rcmp
(
buf
, "queue_length")) == 0) {

760 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
queue_Àngth
);

761 } i‡((
ªs_eql
 = 
	`°∫cmp
(
buf
, "chipÇumber", 11)) == 0) {

762 
	`ssˇnf
(
buf
 + 12, "%d", &
i
);

763 
	`ssˇnf
(
buf
 + 
√xt_eql
, "%d", &
p
->
chù_ch™√l
[
i
]);

765 
	`¥ötf
("d⁄'àm©ch\à%s\n", 
buf
);

768 
	`mem£t
(
buf
, 0, 
BUFSIZE
);

771 
	`f˛o£
(
Â
);

772 
	`f˛o£
(
Â1
);

773 
	`f˛o£
(
Â2
);

775  
p
;

776 
	}
}

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/initialize.h

18 #i‚de‡
INITIALIZE_H


19 
	#INITIALIZE_H


	)

21 
	~<°dio.h
>

22 
	~<°rög.h
>

23 
	~<°dlib.h
>

24 
	~<time.h
>

25 
	~<˘y≥.h
>

26 
	~<sys/ty≥s.h
>

27 
	~"avlTªe.h
"

29 
	#SECTOR
 512

	)

30 
	#BUFSIZE
 200

	)

32 
	#DYNAMIC_ALLOCATION
 0

	)

33 
	#STATIC_ALLOCATION
 1

	)

35 
	#INTERLEAVE
 0

	)

36 
	#TWO_PLANE
 1

	)

38 
	#NORMAL
 2

	)

39 
	#INTERLEAVE_TWO_PLANE
 3

	)

40 
	#COPY_BACK
 4

	)

42 
	#AD_RANDOM
 1

	)

43 
	#AD_COPYBACK
 2

	)

44 
	#AD_TWOPLANE
 4

	)

45 
	#AD_INTERLEAVE
 8

	)

46 
	#AD_TWOPLANE_READ
 16

	)

48 
	#READ
 1

	)

49 
	#WRITE
 0

	)

51 
	#MAPPINGTABLE_READ
 2

	)

52 
	#MAPPINGTABLE_WRITE
 3

	)

57 
	#NUM_ENTRIES_PER_DIR
 512

	)

58 
	#MAX_CACHED_DIR_SLOTS_SIZE
 10485760

59 
	#MAX_CACHED_ENTRIES_SIZE
 10485760

60 

	)

68 
	#CHANNEL_IDLE
 000

	)

69 
	#CHANNEL_C_A_TRANSFER
 3

	)

70 
	#CHANNEL_GC
 4

	)

72 
	#CHANNEL_GC_ERASE
 5

	)

75 
	#CHANNEL_DATA_TRANSFER
 7

	)

76 
	#CHANNEL_TRANSFER
 8

	)

77 
	#CHANNEL_UNKNOWN
 9

	)

79 
	#CHIP_IDLE
 100

	)

80 
	#CHIP_WRITE_BUSY
 101

	)

81 
	#CHIP_READ_BUSY
 102

	)

82 
	#CHIP_C_A_TRANSFER
 103

	)

84 
	#CHIP_WRITE_DATA_CMD_BUSY
 104

	)

85 
	#CHIP_GC_RW_BUSY
 105

	)

87 
	#CHIP_DATA_TRANSFER
 107

	)

88 
	#CHIP_WAIT
 108

	)

89 
	#CHIP_ERASE_BUSY
 109

90 
	#CHIP_COPYBACK_BUSY
 110

	)

91 
	#UNKNOWN
 111

	)

93 
	#SR_WAIT
 200

	)

94 
	#SR_R_C_A_TRANSFER
 201

	)

95 
	#SR_R_READ
 202

	)

96 
	#SR_R_DATA_TRANSFER
 203

	)

97 
	#SR_W_C_A_DATA_TRANSFER
 204

	)

98 
	#SR_W_DATA_TRANSFER_ONE_PROG_OF_ITERATIONS
 205

	)

99 
	#SR_W_DATA_TRANSFER_ONE_VERIFY_OF_ITERATIONS
 207

	)

100 
	#SR_W_TRANSFER
 206

	)

103 
	#SR_W_DATA_TRANSFER
 208

104 

	)

105 
	#SR_COMPLETE
 299

	)

107 
	#REQUEST_IN
 300

108 
	#OUTPUT
 301

109 

	)

110 
	#GC_WAIT
 400

	)

111 
	#GC_ERASE_C_A
 401

	)

112 
	#GC_COPY_BACK
 402

	)

113 
	#GC_COMPLETE
 403

	)

114 
	#GC_INTERRUPT
 0

	)

115 
	#GC_UNINTERRUPT
 1

	)

117 
	#CHANNEL
(
l¢
Ë÷¢&0x0000)>>16

	)

118 
	#chù
(
l¢
Ë÷¢&0x0000)>>16

	)

119 
	#dõ
(
l¢
Ë÷¢&0x0000)>>16

	)

120 
	#PLANE
(
l¢
Ë÷¢&0x0000)>>16

	)

121 
	#BLOKC
(
l¢
Ë÷¢&0x0000)>>16

	)

122 
	#PAGE
(
l¢
Ë÷¢&0x0000)>>16

	)

123 
	#SUBPAGE
(
l¢
Ë÷¢&0x0000)>>16

	)

125 
	#PG_SUB
 0xffffffff

	)

131 
	#TRUE
 1

	)

132 
	#FALSE
 0

	)

133 
	#SUCCESS
 1

	)

134 
	#FAILURE
 0

	)

135 
	#ERROR
 -1

	)

136 
	#INFEASIBLE
 -2

	)

137 
	#OVERFLOW
 -3

	)

138 
	tSètus
;

140 
	sac_time_ch¨a˘îi°ics
 {

141 
	mtPROG
;

143 
	mtPROG_r_phy
;

145 
	mtPROG_w_tŸÆ
;

146 
	mtPROG_Nw_cy˛e
;

147 
	mtPROG_Tw_cy˛e
;

148 
	mtPROG_w_¥ogam
;

149 
	mtPROG_w_vîify
;

150 
	mtPROG_buf„r
;

154 
	mtDBSY
;

155 
	mtBERS
;

156 
	mtCLS
;

157 
	mtCLH
;

158 
	mtCS
;

159 
	mtCH
;

160 
	mtWP
;

161 
	mtALS
;

162 
	mtALH
;

163 
	mtDS
;

164 
	mtDH
;

165 
	mtWC
;

166 
	mtWH
;

167 
	mtADL
;

168 
	mtR
;

169 
	mtAR
;

170 
	mtCLR
;

171 
	mtRR
;

172 
	mtRP
;

173 
	mtWB
;

174 
	mtRC
;

175 
	mtREA
;

176 
	mtCEA
;

177 
	mtRHZ
;

178 
	mtCHZ
;

179 
	mtRHOH
;

180 
	mtRLOH
;

181 
	mtCOH
;

182 
	mtREH
;

183 
	mtIR
;

184 
	mtRHW
;

185 
	mtWHR
;

186 
	mtRST
;

187 } 
	gac_timög
;

190 
	sssd_öfo
 {

192 
	mdebug_sign
;

193 
	mgc_su•íd_times
;

194 
	mwrôe_su•íd_times
;

195 
	mgc_su•íd_doög
;

196 
	mwrôe_su•íd_doög
;

197 
	m‹igöÆ_tŸÆ_∑ges_numbî
;

198 
	ma·î_¥e_¥o˚ss_∑ges_numbî
;

199 
	ma·î_¥e_¥o˚s£_™d_aged_∑ges_numbî
;

200 
	mœ°_tŸÆ_avaûabÀ_∑ges_numbî
;

203 
	mdiff_bëwìn_FCFS_RF
;

206 
	mîa£_ôî©i⁄s
;

207 
	möãr„ªn˚_°uf„d_Àngth
;

208 
	möãr„ªn˚_°uf„d_Àngth_durög_gc
;

209 
öt64_t
 
	mãmp_lba
;

214 
	mmissög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
;

218 
	mssd_íîgy
;

219 
öt64_t
 
	mcuºít_time
;

220 
öt64_t
 
	m√xt_ªque°_time
;

221 
	mªÆ_time_subªq
;

222 
	mÊag
;

223 
	ma˘ive_Êag
;

224 
	m∑ge
;

226 
	mtokí
;

227 
	mgc_ªque°
;

229 
	mwrôe_ªque°_cou¡
;

230 
	mªad_ªque°_cou¡
;

231 
öt64_t
 
	mwrôe_avg
;

232 
öt64_t
 
	mªad_avg
;

234 
	mmö_l¢
;

235 
	mmax_l¢
;

236 
	mªad_cou¡
;

237 
	m¥ogøm_cou¡
;

238 
	mîa£_cou¡
;

239 
	mdúe˘_îa£_cou¡
;

240 
	mc›y_back_cou¡
;

241 
	mm_∂™e_ªad_cou¡
;

242 
	mm_∂™e_¥og_cou¡
;

243 
	möãæóve_cou¡
;

244 
	möãæóve_ªad_cou¡
;

245 
	möãr_m∂™e_cou¡
;

246 
	möãr_m∂™e_¥og_cou¡
;

247 
	möãæóve_îa£_cou¡
;

248 
	mm∂™e_îa£_c⁄ut
;

249 
	möãæóve_m∂™e_îa£_cou¡
;

250 
	mgc_c›y_back
;

251 
	mwrôe_Êash_cou¡
;

252 
	mwa°e_∑ge_cou¡
;

253 
	mave_ªad_size
;

254 
	mave_wrôe_size
;

255 
	mªque°_queue_Àngth
;

256 
	mupd©e_ªad_cou¡
;

258 
	m∑ømëîfûíame
[30];

259 
	mÂ_numbî_subªque°s_txt_«me
[30];

260 
	måa˚fûíame
[30];

261 
	mouçutfûíame
[30];

262 
	m°©i°icfûíame
[30];

263 
	m°©i°icfûíame2
[30];

265 
FILE
 *
	mouçutfûe
;

266 
FILE
 *
	måa˚fûe
;

267 
FILE
 *
	m°©i°icfûe
;

268 
FILE
 *
	m°©i°icfûe2
;

269 
FILE
 * 
	mÂ_numbî_subªque°s_txt
;

271 
∑ømëî_vÆue
 *
	m∑ømëî
;

272 
døm_öfo
 *
	mdøm
;

273 
ªque°
 *
	mªque°_queue
;

274 
ªque°
 *
	mªque°_èû
;

275 
sub_ªque°
 *
	msubs_w_hód
;

276 
sub_ªque°
 *
	msubs_w_èû
;

277 
evít_node
 *
	mevít
;

278 
ch™√l_öfo
 *
	mch™√l_hód
;

282 
	sch™√l_öfo
 {

283 
	mchù
;

284 
	mªad_cou¡
;

285 
	m¥ogøm_cou¡
;

286 
	mîa£_cou¡
;

287 
	mtokí
;

289 
	mcuºít_°©e
;

290 
	m√xt_°©e
;

291 
öt64_t
 
	mcuºít_time
;

292 
öt64_t
 
	m√xt_°©e_¥edi˘_time
;

294 
evít_node
 *
	mevít
;

295 
sub_ªque°
 *
	msubs_r_hód
;

296 
sub_ªque°
 *
	msubs_r_èû
;

297 
sub_ªque°
 *
	msubs_w_hód
;

298 
sub_ªque°
 *
	msubs_w_èû
;

299 
gc_›î©i⁄
 *
	mgc_comm™d
;

300 
chù_öfo
 *
	mchù_hód
;

308 
	schù_öfo
 {

309 
	mdõ_num
;

310 
	m∂™e_num_dõ
;

311 
	mblock_num_∂™e
;

312 
	m∑ge_num_block
;

313 
	msub∑ge_num_∑ge
;

314 
	mîs_limô
;

315 
	mtokí
;

317 
	mcuºít_°©e
;

318 
	m√xt_°©e
;

319 
öt64_t
 
	mcuºít_time
;

320 
öt64_t
 
	m√xt_°©e_¥edi˘_time
;

322 
	mªad_cou¡
;

323 
	m¥ogøm_cou¡
;

324 
	mîa£_cou¡
;

326 
ac_time_ch¨a˘îi°ics
 
	mac_timög
;

327 
dõ_öfo
 *
	mdõ_hód
;

329 
	mwrôe_¥ìm±ive_sign
;

330 
	mnum_w_cy˛e
;

334 
	mchù_°©us
;

335 
	mchù_°©us_time
;

336 
	mchù_ªad_queue_Àngth
;

337 
	mchù_wrôe_queue_Àngth
;

339 
sub_ªque°
 *
	m°‹edsub
;

344 
	mchù_wrôe_ªc‹d_begö
;

345 
	mchù_wrôe_ªc‹d_íd
;

346 
	mchù_ªad_°›
;

347 
	mchù_ªad_ªÆ_°›
;

352 
	sdõ_öfo
 {

354 
	mtokí
;

355 
∂™e_öfo
 *
	m∂™e_hód
;

360 
	s∂™e_öfo
 {

361 
	madd_ªg_µn
;

368 
	m‰ì_∑ge
;

369 
	mîs_övÆid
;

370 
	ma˘ive_block
;

371 
	mˇn_îa£_block
;

372 
dúe˘_îa£
 *
	mîa£_node
;

373 
blk_öfo
 *
	mblk_hód
;

377 
	sblk_öfo
 {

378 
	mîa£_cou¡
;

379 
	m‰ì_∑ge_num
;

380 
	mövÆid_∑ge_num
;

381 
	mœ°_wrôe_∑ge
;

382 
∑ge_öfo
 *
	m∑ge_hód
;

386 
	s∑ge_öfo
 {

387 
	mvÆid_°©e
;

388 
	m‰ì_°©e
;

389 
	mÕn
;

390 
	mwrôãn_cou¡
;

394 
	sloˇl
 {

395 
	mch™√l
;

396 
	mchù
;

397 
	mdõ
;

398 
	m∂™e
;

399 
	mblock
;

400 
	m∑ge
;

401 
	msub_∑ge
;

411 
	mDFTL_DIR_EMPTY
 = 0,

412 
	mDFTL_DIR_FLASH
 = 0x100,

413 
	mDFTL_DIR_DRAM
 = 0x200,

414 
	mDFTL_DIR_CLEAN
 = 
DFTL_DIR_DRAM
 | 0x1,

415 
	mDFTL_DIR_DIRTY
 = 
DFTL_DIR_DRAM
 | 0x2,

416 }
	tdú_°©
;

418 
	eBDBM_DFTL_PAGE_STATUS
{

419 
	mDFTL_PAGE_NOT_EXIST
 = 0,

420 
	mDFTL_PAGE_NOT_MAPPED
,

421 
	mDFTL_PAGE_VALID
,

422 
	mDFTL_PAGE_INVALID
,

423 
	mDFTL_PAGE_INVALID_ADDR
 = -1,

427 
	m°©us
;

428 
loˇl
 
	mphyaddr
;

430 }
	tm≠pög_íåy_t
;

434 
	mid
;

435 
dú_°©
 
	m°©us
;

436 
loˇl
 
	mphyaddr
;

437 
m≠pög_íåy_t
 * 
	mme
;

438 
	mis_undî_lﬂd
;

439 }
	tdúe˘‹y_¶Ÿ_t
;

446 
buf„r_öfo
 *
	mbuf„r_DFTL
;

447 
buf„r_öfo
 *
	mbuf„r_DFTL_UNCOM
;

449 
	mm≠pög_íåy_size
;

450 
	mƒ_íåõs_≥r_dú_¶Ÿ
;

451 
	mƒ_tŸÆ_dú_¶Ÿs
;

452 
	mmax_ˇched_dú_¶Ÿs_sizeö_byã
;

453 
	mnow_ˇched_dú_¶Ÿs_sizeö_byã
;

455 
	mmax_ˇched_íåõs_sizeö_byã
;

456 
	mnow_ˇched_íåõs_sizeö_byã
;

460 
	muncom¥essi⁄_max_ˇched_dú_¶Ÿs_sizeö_byã
;

461 
	muncom¥essi⁄_now_ˇched_dú_¶Ÿs_sizeö_byã
;

463 
dúe˘‹y_¶Ÿ_t
* 
	mdú
;

466 * 
	mcom¥essi⁄_size
;

467 * 
	mcom¥essi⁄_°©e
;

468 * 
	mcom¥essi⁄_dúty
;

471 }
	td·l_m≠pög_èbÀ_t
;

474 
	sdøm_öfo
 {

475 
	mdøm_ˇ∑côy
;

476 
öt64_t
 
	mcuºít_time
;

478 
døm_∑ømëî
 *
	mdøm_∑ømãrs
;

479 
m≠_öfo
 *
	mm≠
;

480 
buf„r_öfo
 *
	mbuf„r
;

484 
d·l_m≠pög_èbÀ_t
* 
	mmt
;

501 
	sbuf„r_group
 {

502 
TREE_NODE
 
	mnode
;

503 
buf„r_group
 *
	mLRU_lök_√xt
;

504 
buf„r_group
 *
	mLRU_lök_¥e
;

506 
	mgroup
;

507 
	m°‹ed
;

508 
	mdúty_˛ón
;

509 
	mÊag
;

510 } 
	tbuf_node
;

514 
	sbuf„r_group_f‹_DFTL
 {

515 
TREE_NODE
 
	mnode
;

516 
buf„r_group
 *
	mLRU_lök_√xt
;

517 
buf„r_group
 *
	mLRU_lök_¥e
;

519 
	mgroup
;

520 * 
	m°‹ed
;

521 
	mthis_node_c⁄ã¡_size
;

522 
	mdúty_˛ón
;

523 
	mÊag
;

524 } 
	tbuf_node_f‹_DFTL
;

532 
	sdøm_∑ømëî
 {

533 
	ma˘ive_cuºít
;

534 
	m¶ìp_cuºít
;

535 
	mvﬁège
;

536 
	m˛ock_time
;

540 
	sm≠_öfo
 {

541 
íåy
 *
	mm≠_íåy
;

542 
buf„r_öfo
 *
	m©èch_öfo
;

546 
	sc⁄åﬁÀr_öfo
 {

547 
	m‰equícy
;

548 
öt64_t
 
	m˛ock_time
;

549 
	mpowî
;

553 
	sªque°
 {

554 
öt64_t
 
	mtime
;

555 
	ml¢
;

556 
	msize
;

557 
	m›î©i⁄
;

559 *
	m√ed_di°r_Êag
;

560 
	mcom∂ëe_l¢_cou¡
;

562 
	mdi°ri_Êag
;

564 
öt64_t
 
	mbegö_time
;

565 
öt64_t
 
	mª•⁄£_time
;

566 
	míîgy_c⁄sum±i⁄
;

568 
sub_ªque°
 *
	msubs
;

569 
ªque°
 *
	m√xt_node
;

572 
sub_ªque°
 * 
	mevi˘_sub_ªque°
;

573 
sub_ªque°
 * 
	m„tch_sub_ªque°
;

576 
_bi_li°
* 
	mshould_evi˘_Õn_d©a
;

577 
_bi_li°
* 
	mmissög_ö_d©a_buf„r_Õn_d©a
;

578 
_bi_li°
* 
	mmissög_ö_DFTL_buf„r_Õn_d©a
;

582 
	mtŸÆ_waô_evi˘
;

583 
	mtŸÆ_waô_„tch_m≠pögèbÀ
;

584 
	m¸óã_‹_nŸyë_evi˘_subªque°s
;

585 
	m¸óã_‹_nŸyë_„tch_subªque°s
;

586 
	m¸óã_‹_nŸyë_n‹mÆ_subªque°s
;

591 
	mhô_ö_uncom¥essi⁄_buf„r_numbî
;

592 
_bi_li°
* 
	mcom¥essi⁄_to_uncom¥essi⁄
;

593 
	mif_√ed_movemít_bëwìn_com_™d_uncom_Êag_™d_∑ge_numbîs
;

594 
	mthe_numbî_of_evi˘ög_‰om_uncom_to_com
;

599 
	ssub_ªque°
 {

600 
	mÕn
;

602 
	mµn
;

603 
	m›î©i⁄
;

604 
	msize
;

607 
	mcuºít_°©e
;

608 
öt64_t
 
	mcuºít_time
;

609 
	m√xt_°©e
;

610 
öt64_t
 
	m√xt_°©e_¥edi˘_time
;

611 
	m°©e
;

614 
öt64_t
 
	mbegö_time
;

615 
öt64_t
 
	mcom∂ëe_time
;

617 
loˇl
 *
	mloˇti⁄
;

618 
sub_ªque°
 *
	m√xt_subs
;

619 
sub_ªque°
 *
	m√xt_node
;

620 
sub_ªque°
 *
	mupd©e
;

624 
öt64_t
 
	m£rvi˚d_time
;

625 
öt64_t
 
	m¶ack_time
;

626 
	mœ°_sign
;

630 
	mwaô_evi˘_sign
;

631 
	mwaô_„tch_m≠pögèbÀ_sign
;

632 
	mwaô_evi˘_sign_föished
;

633 
	mwaô_„tch_m≠pögèbÀ_sign_föished
;

636 
	mcom¥essi⁄_co°_add_Êag
;

644 
	sevít_node
 {

645 
	mty≥
;

646 
öt64_t
 
	m¥edi˘_time
;

647 
evít_node
 *
	m√xt_node
;

648 
evít_node
 *
	m¥e_node
;

651 
	s∑ømëî_vÆue
 {

652 
	mchù_num
;

653 
	mdøm_ˇ∑côy
;

654 
	m˝u_sdøm
;

656 
	mch™√l_numbî
;

657 
	mchù_ch™√l
[100];

659 
	mdõ_chù
;

660 
	m∂™e_dõ
;

661 
	mblock_∂™e
;

662 
	m∑ge_block
;

663 
	msub∑ge_∑ge
;

665 
	m∑ge_ˇ∑côy
;

666 
	msub∑ge_ˇ∑côy
;

669 
	mîs_limô
;

670 
	maddªss_m≠pög
;

671 
	mwór_Àvñög
;

672 
	mgc
;

673 
	m˛ón_ö_background
;

674 
	mÆloc_poﬁ
;

675 
	movî¥ovide
;

676 
	mgc_thªshﬁd
;

678 
	m›î©ög_cuºít
;

679 
	msuµly_vﬁège
;

680 
	mdøm_a˘ive_cuºít
;

681 
	mdøm_°™dby_cuºít
;

682 
	mdøm_ª‰esh_cuºít
;

683 
	mdøm_vﬁège
;

685 
	mbuf„r_m™agemít
;

686 
	mschedulög_Æg‹ôhm
;

687 
	mquick_ødio
;

688 
	mªœãd_m≠pög
;

690 
	mtime_°ï
;

691 
	msmÆl_œrge_wrôe
;

693 
	m°rùög
;

694 
	möãæóvög
;

695 
	mpùñöög
;

696 
	mthªshﬁd_fixed_adju°
;

697 
	mthªshﬁd_vÆue
;

698 
	ma˘ive_wrôe
;

699 
	mgc_h¨d_thªshﬁd
;

700 
	mÆloˇti⁄_scheme
;

701 
	m°©ic_Æloˇti⁄
;

702 
	mdy«mic_Æloˇti⁄
;

703 
	madv™˚d_comm™ds
;

704 
	mad_¥i‹ôy
;

705 
	mad_¥i‹ôy2
;

706 
	mgªed_CB_ad
;

707 
	mgªed_MPW_ad
;

708 
	maged
;

709 
	maged_øtio
;

710 
	mqueue_Àngth
;

712 
ac_time_ch¨a˘îi°ics
 
	mtime_ch¨a˘îi°ics
;

718 
	síåy
 {

719 
	m≤
;

720 
	m°©e
;

725 
	sgc_öfo
 {

726 
öt64_t
 
	mbegö_time
;

727 
	mc›y_back_cou¡
;

728 
	mîa£_cou¡
;

729 
öt64_t
 
	m¥o˚ss_time
;

730 
	míîgy_c⁄sum±i⁄
;

734 
	sdúe˘_îa£
 {

735 
	mblock
;

736 
dúe˘_îa£
 *
	m√xt_node
;

743 
	sgc_›î©i⁄
 {

744 
	mchù
;

745 
	mdõ
;

746 
	m∂™e
;

747 
	mblock
;

748 
	m∑ge
;

749 
	m°©e
;

750 
	m¥i‹ôy
;

751 
gc_›î©i⁄
 *
	m√xt_node
;

753 
	mc›y_∑ge_numbî
;

754 
	mc›y_vÆid_numbî
;

755 
	mpos_ö_c›y
;

756 
	mªad
;

757 
	mwrôe
;

758 
	mîa£
;

759 
	mvi˘im_block_numbî
;

761 
	mgc_ªad_ö√r
;

762 
	mgc_wrôe_ö√r
;

763 
	mªad_wrôe_íd
;

764 
	mœ°_∑ge_ö_vi˘im_dól
;

766 
	mvi˘im_block_‰ì∑ge_°©i°ic
;

767 
	mchù_°©us
;

768 
	mchù_√xt_°©us
;

769 
	msign_f‹_¥ìm±ive
;

770 
	mchù_√xt_¥edi˘_time_diff
;

777 
	sDøm_wrôe_m≠
 {

778 
	m°©e
;

779 } 
	tDøm_wrôe_m≠
;

782 
ssd_öfo
 *
öôüti⁄
(ssd_info *);

784 
∑ømëî_vÆue
 *
lﬂd_∑ømëîs
(
∑ømëî_fûe
[30]);

786 
∑ge_öfo
 *
öôülize_∑ge
(∑ge_öfÿ*
p_∑ge
);

788 
blk_öfo
 *
öôülize_block
(blk_öfÿ*
p_block
, 
∑ømëî_vÆue
 *
∑ømëî
);

790 
∂™e_öfo
 *
öôülize_∂™e
(∂™e_öfÿ*
p_∂™e
, 
∑ømëî_vÆue
 *
∑ømëî
);

792 
dõ_öfo
 *
öôülize_dõ
(dõ_öfÿ*
p_dõ
, 
∑ømëî_vÆue
 *
∑ømëî
, 
cuºít_time
);

794 
chù_öfo
 *
öôülize_chù
(chù_öfÿ*
p_chù
, 
∑ømëî_vÆue
 *
∑ømëî
, 
cuºít_time
);

796 
ssd_öfo
 *
öôülize_ch™√ls
(ssd_öfÿ*
ssd
);

798 
døm_öfo
 *
öôülize_døm
(
ssd_öfo
 *
ssd
);

801 
d·l_m≠pög_èbÀ_t
* 
d·l_¸óã_m≠pög_èbÀ
 (
ssd_öfo
 *
ssd
);

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/js_list.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~"js_li°.h
"

5 
nodeJSLi°
* 
	$¸óãNode
(
TYPE
 
√wVÆue
)

7 
nodeJSLi°
* 
√wNode
 = (nodeJSLi°*Ë
	`mÆloc
((nodeJSList));

9 if(
√wNode
 =
NULL
)

11 
	`¥ötf
("ERROR: malloc is failed!\n");

12 
	`exô
(-1);

15 
√wNode
->
vÆue
 = 
√wVÆue
;

16 
√wNode
->
¥evNode
 = 
NULL
;

17 
√wNode
->
√xtNode
 = 
NULL
;

19  
√wNode
;

20 
	}
}

22 
	$öôLi°
(
jsLi°
* 
li°
)

24 
li°
->
numNode
 = 0;

25 
li°
->
hód
 = 
NULL
;

26 
li°
->
èû
 = 
NULL
;

27 
	}
}

29 
nodeJSLi°
* 
	$gëNode
(
ödex
, 
jsLi°
* 
li°
)

31 
i
;

32 
nodeJSLi°
* 
curNode
 = 
NULL
;

34 if(
ödex
 == -1)

36 
curNode
 = 
li°
->
èû
;

38 if(
ödex
 < 
li°
->
numNode
)

40 
i
 = 0, 
curNode
 = 
li°
->
hód
 ; i < 
ödex
 ; i++, curNodêcurNode->
√xtNode
);

43  
curNode
;

44 
	}
}

46 
	$ö£πNode
(
ödex
, 
nodeJSLi°
* 
√wNode
, 
jsLi°
* 
li°
)

48 
nodeJSLi°
* 
ãmpNode
;

49 if(
li°
->
numNode
 == 0)

51 
li°
->
hód
 = 
√wNode
;

52 
li°
->
èû
 = 
√wNode
;

56 if(
ödex
 == 0)

58 
li°
->
hód
->
¥evNode
 = 
√wNode
;

59 
√wNode
->
¥evNode
 = 
NULL
;

60 
√wNode
->
√xtNode
 = 
li°
->
hód
;

61 
li°
->
hód
 = 
√wNode
;

63 if(
ödex
 == -1)

65 
li°
->
èû
->
√xtNode
 = 
√wNode
;

66 
√wNode
->
¥evNode
 = 
li°
->
èû
;

67 
√wNode
->
√xtNode
 = 
NULL
;

68 
li°
->
èû
 = 
√wNode
;

72 
ãmpNode
 = 
	`gëNode
(
ödex
, 
li°
);

73 if(
ãmpNode
 =
NULL
)

75 
	`¥ötf
("JS_list ERROR: out ofÑange -Ñequest index = %d,Çumber ofÇodes = %d\n",

76 
ödex
, 
li°
->
numNode
);

79 
ãmpNode
->
¥evNode
->
√xtNode
 = 
√wNode
;

80 
√wNode
->
¥evNode
 = 
ãmpNode
->prevNode;

82 
ãmpNode
->
¥evNode
 = 
√wNode
;

83 
√wNode
->
√xtNode
 = 
ãmpNode
;

86 (
li°
->
numNode
)++;

88 
	}
}

90 
	$dñëeNode
(
nodeJSLi°
* 
dñëedNode
, 
jsLi°
* 
li°
)

92 if(
li°
->
numNode
 == 0)

94 
	`¥ötf
("JS_list ERROR: List isÉmpty.\n");

97 if(
li°
->
numNode
 == 1)

99 
li°
->
hód
 = 
NULL
;

101 if(
dñëedNode
 =
li°
->
hód
)

103 
li°
->
hód
 = 
dñëedNode
->
√xtNode
;

104 
li°
->
hód
->
¥evNode
 = 
NULL
;

106 if(
dñëedNode
 =
li°
->
èû
)

108 
li°
->
èû
 = 
dñëedNode
->
¥evNode
;

109 
li°
->
èû
->
√xtNode
 = 
NULL
;

113 
dñëedNode
->
¥evNode
->
√xtNode
 = deletedNode->nextNode;

114 
dñëedNode
->
√xtNode
->
¥evNode
 = deletedNode->prevNode;

116 (
li°
->
numNode
)--;

117 
	}
}

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/js_list.h

1 #i‚de‡
_JS_LIST_H


2 
	#_JS_LIST_H


	)

4 
	#TYPE
 

	)

6 
	snodeJSLi°


8 
nodeJSLi°
* 
	m¥evNode
;

9 
nodeJSLi°
* 
	m√xtNode
;

10 
TYPE
 
	mvÆue
;

13 
	sjsLi°


15 
	mnumNode
;

16 
nodeJSLi°
* 
	mhód
;

17 
nodeJSLi°
* 
	mèû
;

20 
nodeJSLi°
* 
¸óãNode
(
TYPE
 
√wVÆue
);

21 
öôLi°
(
jsLi°
* 
li°
);

22 
nodeJSLi°
* 
gëNode
(
ödex
, 
jsLi°
* 
li°
);

23 
ö£πNode
(
ödex
, 
nodeJSLi°
* 
√wNode
, 
jsLi°
* 
li°
);

24 
dñëeNode
(
nodeJSLi°
* 
dñëedNode
, 
jsLi°
* 
li°
);

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/pagemap.c

19 
	#_CRTDBG_MAP_ALLOC


	)

21 
	~"∑gem≠.h
"

22 
	~"ssd.h
"

28 
	$fûe_as£π
(
îr‹
, *
s
) {

29 i‡(
îr‹
 == 0) ;

30 
	`¥ötf
("›í %†îr‹\n", 
s
);

31 
	`gëch¨
();

32 
	`exô
(-1);

33 
	}
}

38 
	$Æloc_as£π
(*
p
, *
s
)

40 i‡(
p
 !
NULL
) ;

41 
	`¥ötf
("mÆlo¯%†îr‹\n", 
s
);

42 
	`gëch¨
();

43 
	`exô
(-1);

44 
	}
}

51 
	$åa˚_as£π
(
öt64_t
 
time_t
, 
devi˚
, 
l¢
, 
size
, 
›e
)

53 i‡(
time_t
 < 0 || 
devi˚
 < 0 || 
l¢
 < 0 || 
size
 < 0 || 
›e
 < 0) {

54 
	`¥ötf
("åa˚Éº‹:%Œd %d %d %d %d\n", 
time_t
, 
devi˚
, 
l¢
, 
size
, 
›e
);

55 
	`gëch¨
();

56 
	`exô
(-1);

58 i‡(
time_t
 =0 && 
devi˚
 =0 && 
l¢
 =0 && 
size
 =0 && 
›e
 == 0) {

59 
	`¥ötf
("probableÑeadá blankÜine\n");

60 
	`gëch¨
();

62 
	}
}

69 
loˇl
 *
	$föd_loˇti⁄
(
ssd_öfo
 *
ssd
, 
µn
) {

70 
loˇl
 *
loˇti⁄
 = 
NULL
;

71 
i
 = 0;

72 
≤
, 
µn_vÆue
 = 
µn
;

73 
∑ge_∂™e
 = 0, 
∑ge_dõ
 = 0, 
∑ge_chù
 = 0, 
∑ge_ch™√l
 = 0;

75 
≤
 = 
µn
;

76 #ifde‡
DEBUG


77 
	`¥ötf
("enter find_location\n");

80 
loˇti⁄
 = (
loˇl
 *Ë
	`mÆloc
((local));

81 
	`Æloc_as£π
(
loˇti⁄
, "location");

82 
	`mem£t
(
loˇti⁄
, 0, (
loˇl
));

84 
∑ge_∂™e
 = 
ssd
->
∑ømëî
->
∑ge_block
 * ssd->∑ømëî->
block_∂™e
;

85 
∑ge_dõ
 = 
∑ge_∂™e
 * 
ssd
->
∑ømëî
->
∂™e_dõ
;

86 
∑ge_chù
 = 
∑ge_dõ
 * 
ssd
->
∑ømëî
->
dõ_chù
;

87 
∑ge_ch™√l
 = 
∑ge_chù
 * 
ssd
->
∑ømëî
->
chù_ch™√l
[0];

92 
loˇti⁄_bef‹e
 = -1;

93 
ãmp_tŸÆ_∂™e
 = (
ssd
->
∑ømëî
->
ch™√l_numbî
Ë* (ssd->∑ømëî->
chù_ch™√l
[0]Ë* (ssd->∑ømëî->
dõ_chù
Ë* (ssd->∑ømëî->
∂™e_dõ
);

95 
loˇti⁄_bef‹e
 = 
µn
 % 
ãmp_tŸÆ_∂™e
;

97 
loˇti⁄
->
ch™√l
 = 
loˇti⁄_bef‹e
 % ( (
ssd
->
∑ømëî
->
ch™√l_numbî
)*(ssd->∑ømëî->
chù_ch™√l
[0]) ) % (ssd->parameter->channel_number);

98 
loˇti⁄
->
chù
 = 
loˇti⁄_bef‹e
 % ( (
ssd
->
∑ømëî
->
ch™√l_numbî
)*(ssd->∑ømëî->
chù_ch™√l
[0]) ) / (ssd->parameter->channel_number);

100 
loˇti⁄
->
dõ
 = 
loˇti⁄_bef‹e
 / ( (
ssd
->
∑ømëî
->
ch™√l_numbî
)*(ssd->∑ømëî->
chù_ch™√l
[0]ËË/ (ssd->∑ømëî->
∂™e_dõ
);

102 
loˇti⁄
->
∂™e
 = 
loˇti⁄_bef‹e
 / ( (
ssd
->
∑ømëî
->
ch™√l_numbî
)*(ssd->∑ømëî->
chù_ch™√l
[0]ËË% (ssd->∑ømëî->
∂™e_dõ
);

103 
loˇti⁄
->
block
 = (
µn
 / 
ãmp_tŸÆ_∂™e
Ë/ (
ssd
->
∑ømëî
->
∑ge_block
);

104 
loˇti⁄
->
∑ge
 = (
µn
 / 
ãmp_tŸÆ_∂™e
Ë% (
ssd
->
∑ømëî
->
∑ge_block
);

131  
loˇti⁄
;

132 
	}
}

135 
	$gë_µn_ö_dif„ª¡_ˇ£
(
ssd_öfo
* 
ssd
, 
ch™√l
, 
chù
,
dõ
,
∂™e
,
block
,
∑ge
)

138 
ch™√l_num
 = 0, 
chù_num
 = 0, 
dõ_num
 = 0, 
∂™e_num
 = 0;

139 
i
, 
∂™e_dõ
, 
∂™e_chù
, 
∂™e_ch™√l
, 
ãmp
, 
ãmp1
, 
µn_begö
, 
µn
;

141 
ch™√l_num
 = 
ssd
->
∑ømëî
->
ch™√l_numbî
;

142 
chù_num
 = 
ssd
->
∑ømëî
->
chù_ch™√l
[0];

143 
dõ_num
 = 
ssd
->
∑ømëî
->
dõ_chù
;

144 
∂™e_num
 = 
ssd
->
∑ømëî
->
∂™e_dõ
;

146 
∂™e_dõ
 = 
ssd
->
∑ømëî
->plane_die;

147 
∂™e_chù
 = 
dõ_num
 * 
∂™e_dõ
;

148 
∂™e_ch™√l
 = 
chù_num
 * 
∂™e_chù
;

150 
ãmp
 = 
ch™√l_num
 * 
chù_num
 * 
dõ_num
 * 
∂™e_num
;

155 if(
ãmp
 != 96){

156 
	`ssdsim_msg
("should changeÖosition_change_table here");

161 
posôi⁄_ch™ge_èbÀ
[96] ={\

170 
ãmp1
 = 
ch™√l
*
∂™e_ch™√l
 + 
chù
*
∂™e_chù
 + 
dõ
*
∂™e_dõ
 + 
∂™e
;

171 
µn_begö
 = 
posôi⁄_ch™ge_èbÀ
[
ãmp1
];

172 
µn
 = 
µn_begö
 + ((
ssd
->
∑ømëî
->
∑ge_block
 * 
block
Ë+ 
∑ge
Ë* 
ãmp
;

177  
µn
;

178 
	}
}

185 
	$föd_µn
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
,

186 
block
, 
∑ge
) {

187 
µn
 = 0;

188 
i
 = 0;

189 
∑ge_∂™e
 = 0, 
∑ge_dõ
 = 0, 
∑ge_chù
 = 0;

190 
∑ge_ch™√l
[100];

192 #ifde‡
DEBUG


199 
∑ge_∂™e
 = 
ssd
->
∑ømëî
->
∑ge_block
 * ssd->∑ømëî->
block_∂™e
;

200 
∑ge_dõ
 = 
∑ge_∂™e
 * 
ssd
->
∑ømëî
->
∂™e_dõ
;

201 
∑ge_chù
 = 
∑ge_dõ
 * 
ssd
->
∑ømëî
->
dõ_chù
;

202 
i
 < 
ssd
->
∑ømëî
->
ch™√l_numbî
) {

203 
∑ge_ch™√l
[
i
] = 
ssd
->
∑ømëî
->
chù_ch™√l
[i] * 
∑ge_chù
;

204 
i
++;

210 
i
 = 0;

216 
ssd
->
∑ømëî
->
°©ic_Æloˇti⁄
){

222 
µn
 = 
	`gë_µn_ö_dif„ª¡_ˇ£
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
block
, 
∑ge
);

237  
µn
;

238 
	}
}

243 
	$£t_íåy_°©e
(
ssd_öfo
 *
ssd
, 
l¢
, 
size
) {

244 
ãmp
, 
°©e
, 
move
;

246 
ãmp
 = ~(0xfffffff‡<< 
size
);

247 
move
 = 
l¢
 % 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

248 
°©e
 = 
ãmp
 << 
move
;

250  
°©e
;

251 
	}
}

257 
ssd_öfo
 *
	$¥e_¥o˚ss_∑ge
(
ssd_öfo
 *
ssd
) {

258 
Ê
 = 0;

259 
devi˚
, 
l¢
, 
size
, 
›e
, 
Õn
, 
fuŒ_∑ge
;

260 
œrge°_l¢
, 
sub_size
, 
µn
, 
add_size
 = 0;

261 
i
 = 0, 
j
, 
k
;

262 
m≠_íåy_√w
, 
m≠_íåy_ﬁd
, 
modify
;

263 
Êag
 = 0;

264 
buf„r_ªque°
[200];

265 
loˇl
 *
loˇti⁄
;

266 
öt64_t
 
time
;

268 
l
, 
ãmp_chù_ch™√l
 ;

269 
ãmp_chù_ch™√l
 = 
ssd
->
∑ømëî
->
chù_num
 / ssd->∑ømëî->
ch™√l_numbî
;

271 
	`¥ötf
("\n");

272 
	`¥ötf
("beginÖre_process_page.................\n");

274 
ssd
->
åa˚fûe
 = 
	`f›í
(ssd->
åa˚fûíame
, "r");

275 i‡(
ssd
->
åa˚fûe
 =
NULL
)

277 
	`¥ötf
("theÅrace file can't open\n");

278  
NULL
;

281 
fuŒ_∑ge
 = ~(0xfffffff‡<< (
ssd
->
∑ømëî
->
sub∑ge_∑ge
));

283 
ssd
->
‹igöÆ_tŸÆ_∑ges_numbî
 = (ssd->
∑ømëî
->
chù_num
 * ssd->∑ømëî->
dõ_chù
 * ssd->∑ømëî->
∂™e_dõ
 *ssd->∑ømëî->
block_∂™e
 * ssd->∑ømëî->
∑ge_block
);

284 
ssd
->
a·î_¥e_¥o˚ss_∑ges_numbî
 = ssd->
‹igöÆ_tŸÆ_∑ges_numbî
 * (1 - ssd->
∑ømëî
->
ovî¥ovide
);

286 
œrge°_l¢
 = (Ë((
ssd
->
∑ømëî
->
chù_num
 * ssd->∑ømëî->
dõ_chù
 * ssd->∑ømëî->
∂™e_dõ
 *

287 
ssd
->
∑ømëî
->
block_∂™e
 * ssd->∑ømëî->
∑ge_block
 *

288 
ssd
->
∑ømëî
->
sub∑ge_∑ge
Ë* (1 - ssd->∑ømëî->
ovî¥ovide
));

290 
	`fgës
(
buf„r_ªque°
, 200, 
ssd
->
åa˚fûe
)) {

291 
	`ssˇnf
(
buf„r_ªque°
, "%Œd %d %d %d %d", &
time
, &
devi˚
, &
l¢
, &
size
, &
›e
);

292 
Ê
++;

293 
	`åa˚_as£π
(
time
, 
devi˚
, 
l¢
, 
size
, 
›e
);

295 
add_size
 = 0;

297 i‡(
›e
 == 1)

299 
add_size
 < 
size
) {

300 
l¢
 =Ü¢ % 
œrge°_l¢
;

301 
sub_size
 = 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 - (
l¢
 % ssd->parameter->subpage_page);

302 i‡(
add_size
 + 
sub_size
 >=

303 
size
)

305 
sub_size
 = 
size
 - 
add_size
;

306 
add_size
 +
sub_size
;

309 i‡((
sub_size
 > 
ssd
->
∑ømëî
->
sub∑ge_∑ge
) ||

310 (
add_size
 > 
size
))

312 
	`¥ötf
("¥e_¥o˚s†sub_size:%d\n", 
sub_size
);

321 
Õn
 = 
l¢
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

322 i‡(
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
°©e
 == 0)

328 
µn
 = 
	`gë_µn_f‹_¥e_¥o˚ss
(
ssd
, 
l¢
);

329 
loˇti⁄
 = 
	`föd_loˇti⁄
(
ssd
, 
µn
);

330 
ssd
->
¥ogøm_cou¡
++;

331 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
¥ogøm_cou¡
++;

332 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
¥ogøm_cou¡
++;

333 
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
≤
 = 
µn
;

334 
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
°©e
 = 
	`£t_íåy_°©e
(ssd, 
l¢
, 
sub_size
);

335 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].
Õn
 =Üpn;

336 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].
vÆid_°©e
 = ssd->
døm
->
m≠
->
m≠_íåy
[
Õn
].
°©e
;

337 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].
‰ì_°©e
 = (

338 (~
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
°©e
Ë& 
fuŒ_∑ge
);

340 
	`‰ì
(
loˇti⁄
);

341 
loˇti⁄
 = 
NULL
;

343 i‡(
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
°©e
 > 0)

345 
m≠_íåy_√w
 = 
	`£t_íåy_°©e
(
ssd
, 
l¢
, 
sub_size
);

346 
m≠_íåy_ﬁd
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
°©e
;

347 
modify
 = 
m≠_íåy_√w
 | 
m≠_íåy_ﬁd
;

348 
µn
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
≤
;

349 
loˇti⁄
 = 
	`föd_loˇti⁄
(
ssd
, 
µn
);

351 
ssd
->
¥ogøm_cou¡
++;

352 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
¥ogøm_cou¡
++;

353 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
¥ogøm_cou¡
++;

354 
ssd
->
døm
->
m≠
->
m≠_íåy
[
l¢
 / ssd->
∑ømëî
->
sub∑ge_∑ge
].
°©e
 = 
modify
;

355 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].
vÆid_°©e
 = 
modify
;

356 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].
‰ì_°©e
 = (

357 (~
modify
Ë& 
fuŒ_∑ge
);

359 
	`‰ì
(
loˇti⁄
);

360 
loˇti⁄
 = 
NULL
;

362 
l¢
 =Ü¢ + 
sub_size
;

363 
add_size
 +
sub_size
;

368 
	`¥ötf
("\n");

369 
	`¥ötf
("pre_process is complete!\n");

371 
	`f˛o£
(
ssd
->
åa˚fûe
);

372 
	`Êush_m≠pögèbÀ_öto_fûes
(
ssd
, "map_pre_process.txt");

373 
i
 = 0; i < 
ssd
->
∑ømëî
->
ch™√l_numbî
; i++){

374 
l
 = 0;Ü < 
ãmp_chù_ch™√l
;Ü++){

375 
j
 = 0; j < 
ssd
->
∑ømëî
->
dõ_chù
; j++){

376 
k
 = 0; k < 
ssd
->
∑ømëî
->
∂™e_dõ
; k++){

377 
	`Ârötf
(
ssd
->
ouçutfûe
, "ch™√»%d, chù:%d, dõ:%d,Öœ√:%d havê‰ìÖage: %d\n", 
i
, 
l
, 
j
, 
k
,

378 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
l
].
dõ_hód
[
j
].
∂™e_hód
[
k
].
‰ì_∑ge
);

379 
ssd
->
a·î_¥e_¥o˚s£_™d_aged_∑ges_numbî
 +ssd->
ch™√l_hód
[
i
].
chù_hód
[
l
].
dõ_hód
[
j
].
∂™e_hód
[
k
].
‰ì_∑ge
;

380 
	`fÊush
(
ssd
->
ouçutfûe
);

385  
ssd
;

386 
	}
}

392 
	$gë_µn_f‹_¥e_¥o˚ss
(
ssd_öfo
 *
ssd
, 
l¢
) {

393 
ch™√l
 = 0, 
chù
 = 0, 
dõ
 = 0, 
∂™e
 = 0;

394 
µn
, 
Õn
;

395 
a˘ive_block
;

396 
ch™√l_num
 = 0, 
chù_num
 = 0, 
dõ_num
 = 0, 
∂™e_num
 = 0;

398 #ifde‡
DEBUG


399 
	`¥ötf
("enter get_psn_for_pre_process\n");

402 
ch™√l_num
 = 
ssd
->
∑ømëî
->
ch™√l_numbî
;

403 
chù_num
 = 
ssd
->
∑ømëî
->
chù_ch™√l
[0];

404 
dõ_num
 = 
ssd
->
∑ømëî
->
dõ_chù
;

405 
∂™e_num
 = 
ssd
->
∑ømëî
->
∂™e_dõ
;

406 
Õn
 = 
l¢
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

407 
loˇti⁄_bef‹e
 = -1;

408 
ãmp_tŸÆ_∂™e
 = (
ssd
->
∑ømëî
->
ch™√l_numbî
Ë* (ssd->∑ømëî->
chù_ch™√l
[0]Ë* (ssd->∑ømëî->
dõ_chù
Ë* (ssd->∑ømëî->
∂™e_dõ
);

411 i‡(
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 == 0)

413 i‡(
ssd
->
∑ømëî
->
dy«mic_Æloˇti⁄
 ==

416 
ch™√l
 = 
ssd
->
tokí
;

417 
ssd
->
tokí
 = (ssd->tokí + 1Ë% ssd->
∑ømëî
->
ch™√l_numbî
;

418 
chù
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
;

419 
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
 = (
chù
 + 1Ë% ssd->
∑ømëî
->
chù_ch™√l
[0];

420 
dõ
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
;

421 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
 = (
dõ
 + 1Ë% ssd->
∑ømëî
->
dõ_chù
;

422 
∂™e
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
;

423 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 = (
∂™e
 + 1Ë% ssd->
∑ømëî
->
∂™e_dõ
;

424 } i‡(
ssd
->
∑ømëî
->
dy«mic_Æloˇti⁄
 ==

427 
ch™√l
 = 
Õn
 % 
ssd
->
∑ømëî
->
ch™√l_numbî
;

428 
chù
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
;

429 
ssd
->
ch™√l_hód
[
ch™√l
].
tokí
 = (
chù
 + 1Ë% ssd->
∑ømëî
->
chù_ch™√l
[0];

430 
dõ
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
;

431 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
tokí
 = (
dõ
 + 1Ë% ssd->
∑ømëî
->
dõ_chù
;

432 
∂™e
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
;

433 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
tokí
 = (
∂™e
 + 1Ë% ssd->
∑ømëî
->
∂™e_dõ
;

435 } i‡(
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 == 1)

437 
ssd
->
∑ømëî
->
°©ic_Æloˇti⁄
) {

440 
ch™√l
 = (
Õn
 / (
∂™e_num
 * 
dõ_num
 * 
chù_num
)Ë% 
ch™√l_num
;

441 
chù
 = 
Õn
 % 
chù_num
;

442 
dõ
 = (
Õn
 / 
chù_num
Ë% 
dõ_num
;

443 
∂™e
 = (
Õn
 / (
dõ_num
 * 
chù_num
)Ë% 
∂™e_num
;

447 
ch™√l
 = 
Õn
 % 
ch™√l_num
;

448 
chù
 = (
Õn
 / 
ch™√l_num
Ë% 
chù_num
;

449 
dõ
 = (
Õn
 / (
chù_num
 * 
ch™√l_num
)Ë% 
dõ_num
;

450 
∂™e
 = (
Õn
 / (
dõ_num
 * 
chù_num
 * 
ch™√l_num
)Ë% 
∂™e_num
;

456 
loˇti⁄_bef‹e
 = 
Õn
 % 
ãmp_tŸÆ_∂™e
;

457 
ch™√l
 = 
loˇti⁄_bef‹e
 % ( (
ssd
->
∑ømëî
->
ch™√l_numbî
)*(ssd->∑ømëî->
chù_ch™√l
[0]) ) % (ssd->parameter->channel_number);

458 
chù
 = 
loˇti⁄_bef‹e
 % ( (
ssd
->
∑ømëî
->
ch™√l_numbî
)*(ssd->∑ømëî->
chù_ch™√l
[0]) ) / (ssd->parameter->channel_number);

460 
dõ
 = 
loˇti⁄_bef‹e
 / ( (
ssd
->
∑ømëî
->
ch™√l_numbî
)*(ssd->∑ømëî->
chù_ch™√l
[0]ËË/ (ssd->∑ømëî->
∂™e_dõ
);

462 
∂™e
 = 
loˇti⁄_bef‹e
 / ( (
ssd
->
∑ømëî
->
ch™√l_numbî
)*(ssd->∑ømëî->
chù_ch™√l
[0]ËË% (ssd->∑ømëî->
∂™e_dõ
);

472 
ch™√l
 = 
Õn
 % 
ch™√l_num
;

473 
chù
 = (
Õn
 / (
dõ_num
 * 
ch™√l_num
)Ë% 
chù_num
;

474 
dõ
 = (
Õn
 / 
ch™√l_num
Ë% 
dõ_num
;

475 
∂™e
 = (
Õn
 / (
dõ_num
 * 
chù_num
 * 
ch™√l_num
)Ë% 
∂™e_num
;

479 
ch™√l
 = 
Õn
 % 
ch™√l_num
;

480 
chù
 = (
Õn
 / (
∂™e_num
 * 
dõ_num
 * 
ch™√l_num
)Ë% 
chù_num
;

481 
dõ
 = (
Õn
 / (
∂™e_num
 * 
ch™√l_num
)Ë% 
dõ_num
;

482 
∂™e
 = (
Õn
 / 
ch™√l_num
Ë% 
∂™e_num
;

487 
ch™√l
 = 
Õn
 % 
ch™√l_num
;

488 
chù
 = (
Õn
 / (
∂™e_num
 * 
dõ_num
 * 
ch™√l_num
)Ë% 
chù_num
;

489 
dõ
 = (
Õn
 / 
ch™√l_num
Ë% 
dõ_num
;

490 
∂™e
 = (
Õn
 / (
dõ_num
 * 
ch™√l_num
)Ë% 
∂™e_num
;

503 #ifde‡
DEBUG


504 
	`¥ötf
("™d gë ch™√»%d,chù %d, dõ %d,Öœ√ %d\n", 
ch™√l
, 
chù
, 
dõ
, 
∂™e
);

507 i‡(
	`föd_a˘ive_block
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
Ë=
FAILURE
) {

508 
	`¥ötf
("theÑead operation isÉxpandÅhe capacity of SSD\n");

510 
	`ssdsim_msg
("wrong in get_ppn_for_pre_process");

515 
a˘ive_block
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].active_block;

516 i‡(
	`wrôe_∑ge
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
a˘ive_block
, &
µn
Ë=
ERROR
) {

520  
µn
;

521 
	}
}

528 
ssd_öfo
 *

529 
	$gë_µn
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
,

530 
sub_ªque°
 *
sub
) {

531 
ﬁd_µn
 = -1;

532 
µn
, 
Õn
, 
fuŒ_∑ge
;

533 
a˘ive_block
;

534 
block
;

535 
∑ge
, 
Êag
 = 0, 
Êag1
 = 0;

536 
ﬁd_°©e
 = 0, 
°©e
 = 0, 
c›y_sub∑ge
 = 0;

537 
loˇl
 *
loˇti⁄
;

538 
dúe˘_îa£
 *
dúe˘_îa£_node
, *
√w_dúe˘_îa£
;

539 
gc_›î©i⁄
 *
gc_node
;

541 
thªshﬁd_∑ge
 = 0;

542 
i
 = 0, 
j
 = 0, 
k
 = 0, 
l
 = 0, 
m
 = 0, 
n
 = 0;

544 #ifde‡
DEBUG


545 
	`¥ötf
("íã∏gë_µn,ch™√l:%d, chù:%d, dõ:%d,Öœ√:%d\n",
ch™√l
,
chù
,
dõ
,
∂™e
);

548 
fuŒ_∑ge
 = ~(0xfffffff‡<< (
ssd
->
∑ømëî
->
sub∑ge_∑ge
));

549 
Õn
 = 
sub
->lpn;

555 i‡(
	`föd_a˘ive_block
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
Ë=
FAILURE
) {

556 
	`¥ötf
("ERROR :thîêi†nÿ‰ìÖagêö ch™√l:%d, chù:%d, dõ:%d,Öœ√:%d\n", 
ch™√l
, 
chù
, 
dõ
, 
∂™e
);

557  
ssd
;

560 
a˘ive_block
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].active_block;

561 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].
œ°_wrôe_∑ge
++;

562 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].
‰ì_∑ge_num
--;

564 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].
œ°_wrôe_∑ge
 >

565 
ssd
->
∑ømëî
->
∑ge_block
) {

566 
	`¥ötf
("îr‹!Åhêœ° wrôê∑gêœrgîÅh™ %d\n", 
ssd
->
∑ømëî
->
∑ge_block
);

570 
block
 = 
a˘ive_block
;

571 
∑ge
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].
œ°_wrôe_∑ge
;

573 i‡(
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
°©e
 ==

576 i‡(
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
≤
 != 0) {

577 
	`¥ötf
("newÜogical, Error in get_ppn()\n");

579 
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
≤
 = 
	`föd_µn
(ssd, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
block
, 
∑ge
);

580 
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
°©e
 = 
sub
->state;

583 
µn
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
≤
;

584 
loˇti⁄
 = 
	`föd_loˇti⁄
(
ssd
, 
µn
);

585 i‡(
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].
Õn
 !=

586 
Õn
) {

587 
	`¥ötf
("\nch™gêlogiˇl,Eº‹ i¿gë_µn(), m≠èbÀ.µ¿i†%d,ÖagêßvedÖ≤ i†%d, wr⁄gÜoˇti⁄ ch™√»%d, chù %d, dõ %d,Öœ√ %d, block %d,Öagê%d\n", 
µn
,
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].
Õn
,Üocation->channel,Üocation->chip,Üocation->die,Üocation->plane,Üocation->block,Üocation->page);

590 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].
vÆid_°©e
 = 0;

591 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].
‰ì_°©e
 = 0;

592 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].
Õn
 = 0;

593 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
övÆid_∑ge_num
++;

598 i‡(
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
övÆid_∑ge_num
 ==

599 
ssd
->
∑ømëî
->
∑ge_block
) {

600 
√w_dúe˘_îa£
 = (
dúe˘_îa£
 *Ë
	`mÆloc
((direct_erase));

601 
	`Æloc_as£π
(
√w_dúe˘_îa£
, "new_direct_erase");

602 
	`mem£t
(
√w_dúe˘_îa£
, 0, (
dúe˘_îa£
));

604 
√w_dúe˘_îa£
->
block
 = 
loˇti⁄
->block;

605 
√w_dúe˘_îa£
->
√xt_node
 = 
NULL
;

606 
dúe˘_îa£_node
 = 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
îa£_node
;

607 i‡(
dúe˘_îa£_node
 =
NULL
) {

608 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
îa£_node
 = 
√w_dúe˘_îa£
;

610 
√w_dúe˘_îa£
->
√xt_node
 = 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
îa£_node
;

611 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
îa£_node
 = 
√w_dúe˘_îa£
;

615 
	`‰ì
(
loˇti⁄
);

616 
loˇti⁄
 = 
NULL
;

617 
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
≤
 = 
	`föd_µn
(ssd, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
block
, 
∑ge
);

618 
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
°©e
 = (ssd->døm->m≠->m≠_íåy[Õn].°©ê| 
sub
->state);

622 
sub
->
µn
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
≤
;

623 
sub
->
loˇti⁄
->
ch™√l
 = channel;

624 
sub
->
loˇti⁄
->
chù
 = chip;

625 
sub
->
loˇti⁄
->
dõ
 = die;

626 
sub
->
loˇti⁄
->
∂™e
 =Ölane;

627 
sub
->
loˇti⁄
->
block
 = 
a˘ive_block
;

628 
sub
->
loˇti⁄
->
∑ge
 =Öage;

630 
ssd
->
¥ogøm_cou¡
++;

631 
ssd
->
ch™√l_hód
[
ch™√l
].
¥ogøm_cou¡
++;

632 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
¥ogøm_cou¡
++;

633 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
‰ì_∑ge
--;

634 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].
∑ge_hód
[
∑ge
].
Õn
 =Üpn;

635 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].
∑ge_hód
[
∑ge
].
vÆid_°©e
 = 
sub
->
°©e
;

636 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].
∑ge_hód
[
∑ge
].
‰ì_°©e
 = (

637 (~(
sub
->
°©e
)Ë& 
fuŒ_∑ge
);

638 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].
∑ge_hód
[
∑ge
].
wrôãn_cou¡
++;

639 
ssd
->
wrôe_Êash_cou¡
++;

641 i‡(
ssd
->
∑ømëî
->
a˘ive_wrôe
 ==

645 
thªshﬁd_∑ge
 = (
ssd
->
∑ømëî
->
∑ge_block
Ë* (ssd->∑ømëî->
block_∂™e
Ë* (ssd->∑ømëî->
gc_h¨d_thªshﬁd
);

646 #ifde‡
DEBUG


648 
	`¥ötf
("opps, must be here!! forÇoáctive_write.now is inÇoáctive_write strategy\n");

652 
	`¥ötf
("whíÇ‹mÆ wrôêevîytimêu£ o√Öagê wû»ªp‹à∂™e'†‰ì_∑gêa†fﬁlow: ch™√»%d, chù %d, dõ %d,Öœ√ %d, block %d,Öagê%d, fªe_∑gê%d\n", 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
block
, 
∑ge
, 
ssd
->
ch™√l_hód
[ch™√l].
chù_hód
[chù].
dõ_hód
[dõ].
∂™e_hód
[∂™e].
‰ì_∑ge
);

656 if(
ssd
->
ch™√l_hód
[
ch™√l
].
gc_comm™d
 !
NULL
){

658 
	`¥ötf
("lxc, here will stopÅo moveáhead,willÑeturn. in channel GC\n");

659  
ssd
;

662 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
‰ì_∑ge
 <

663 (
ssd
->
∑ømëî
->
∑ge_block
 * ssd->∑ømëî->
block_∂™e
 * ssd->∑ømëî->
gc_h¨d_thªshﬁd
)) {

666 
gc_node
 = (
gc_›î©i⁄
 *Ë
	`mÆloc
((gc_operation));

667 
	`Æloc_as£π
(
gc_node
, "gc_node");

668 
	`mem£t
(
gc_node
, 0, (
gc_›î©i⁄
));

670 
gc_node
->
√xt_node
 = 
NULL
;

671 
gc_node
->
chù
 = chip;

672 
gc_node
->
dõ
 = die;

673 
gc_node
->
∂™e
 =Ölane;

674 
gc_node
->
block
 = 0xffffffff;

675 
gc_node
->
∑ge
 = 0;

676 
gc_node
->
°©e
 = 
GC_WAIT
;

677 
gc_node
->
¥i‹ôy
 = 
GC_UNINTERRUPT
;

678 
gc_node
->
√xt_node
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
gc_comm™d
;

682 
gc_node
->
c›y_∑ge_numbî
 = -1;

683 
gc_node
->
c›y_vÆid_numbî
 = -1;

684 
gc_node
->
pos_ö_c›y
 = -1;

685 
gc_node
->
ªad
 = 1;

686 
gc_node
->
wrôe
 = 0;

687 
gc_node
->
îa£
 = -1;

688 
gc_node
->
vi˘im_block_numbî
 = -1;

689 
gc_node
->
gc_ªad_ö√r
 = -1;

690 
gc_node
->
gc_wrôe_ö√r
 = -1;

691 
gc_node
->
ªad_wrôe_íd
 = -1;

692 
gc_node
->
vi˘im_block_‰ì∑ge_°©i°ic
 = -1;

693 
gc_node
->
œ°_∑ge_ö_vi˘im_dól
 = -1;

694 
gc_node
->
chù_√xt_¥edi˘_time_diff
 = 0;

695 
ssd
->
ch™√l_hód
[
ch™√l
].
gc_comm™d
 = 
gc_node
;

696 
ssd
->
gc_ªque°
++;

699 
	`¥ötf
("GC will happenát once!\n");

700 #ifde‡
DEBUGONLYGC


701 
	`¥ötf
("GC happenÇow!\n");

702 
	`¥ötf_gc_node_öf‹m©i⁄
 (
gc_node
);

707 #ifde‡
DEBUG


709 
	`¥ötf
("n‹mÆ gë_µ¿'†gc_nodêc⁄ã¡,%x\n", 
ssd
->
gc_ªque°
);

710 
	`¥ötf_ssd_gc_node
(
ssd
);

716  
ssd
;

717 
	}
}

724 
	$gë_µn_f‹_gc
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
) {

725 
µn
;

726 
a˘ive_block
, 
block
, 
∑ge
;

728 #ifde‡
DEBUG


729 
	`¥ötf
("íã∏gë_µn_f‹_gc,ch™√l:%d, chù:%d, dõ:%d,Öœ√:%d\n",
ch™√l
,
chù
,
dõ
,
∂™e
);

732 i‡(
	`föd_a˘ive_block
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
Ë!
SUCCESS
) {

733 
	`¥ötf
("\n\nlxc Error int get_ppn_for_gc().\n");

737 
a˘ive_block
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].active_block;

739 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].
œ°_wrôe_∑ge
++;

740 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].
‰ì_∑ge_num
--;

742 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].
œ°_wrôe_∑ge
 >

743 
ssd
->
∑ømëî
->
∑ge_block
) {

744 
	`¥ötf
("îr‹!Åhêœ° wrôê∑gêœrgîÅh™ %d\n", 
ssd
->
∑ømëî
->
∑ge_block
);

748 
block
 = 
a˘ive_block
;

749 
∑ge
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].
œ°_wrôe_∑ge
;

751 
µn
 = 
	`föd_µn
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
block
, 
∑ge
);

753 
ssd
->
¥ogøm_cou¡
++;

754 
ssd
->
ch™√l_hód
[
ch™√l
].
¥ogøm_cou¡
++;

755 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
¥ogøm_cou¡
++;

756 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
‰ì_∑ge
--;

757 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
a˘ive_block
].
∑ge_hód
[
∑ge
].
wrôãn_cou¡
++;

758 
ssd
->
wrôe_Êash_cou¡
++;

759 #ifde‡
DEBUGONLYGC


760 
	`¥ötf
("whí g¯gëÅhê√wÖ≤, ch™√»%d, chù %d, dõ %d,Öœ√ %d, block %d\n", 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
block
);

762  
µn
;

764 
	}
}

773 
Sètus


774 
	$îa£_›î©i⁄
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
,

775 
block
) {

776 
i
 = 0;

777 #ifde‡
DEBUG


778 
	`¥ötf
("nowÉø£ ch™√»%d, chù %d, dõ %d,Öœ√ %d, block %d \n", 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
block
);

781 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
‰ì_∑ge_num
 = ssd->
∑ømëî
->
∑ge_block
;

782 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
övÆid_∑ge_num
 = 0;

783 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
œ°_wrôe_∑ge
 = -1;

784 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
îa£_cou¡
++;

785 
i
 = 0; i < 
ssd
->
∑ømëî
->
∑ge_block
; i++) {

786 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
∑ge_hód
[
i
].
‰ì_°©e
 = 
PG_SUB
;

787 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
∑ge_hód
[
i
].
vÆid_°©e
 = 0;

788 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
block
].
∑ge_hód
[
i
].
Õn
 = -1;

790 
ssd
->
îa£_cou¡
++;

791 
ssd
->
ch™√l_hód
[
ch™√l
].
îa£_cou¡
++;

792 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
îa£_cou¡
++;

793 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
‰ì_∑ge
 +ssd->
∑ømëî
->
∑ge_block
;

795  
SUCCESS
;

797 
	}
}

803 
Sètus


804 
	$îa£_∂™es
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ1
, 
∂™e1
,

805 
comm™d
) {

806 
dõ
 = 0;

807 
∂™e
 = 0;

808 
block
 = 0;

809 
dúe˘_îa£
 *
dúe˘_îa£_node
 = 
NULL
;

810 
block0
 = 0xffffffff;

811 
block1
 = 0;

813 i‡((
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ1
].
∂™e_hód
[
∂™e1
].
îa£_node
 =
NULL
) ||

814 ((
comm™d
 !
INTERLEAVE_TWO_PLANE
Ë&& (comm™d !
INTERLEAVE
Ë&& (comm™d !
TWO_PLANE
) &&

815 (
comm™d
 !
NORMAL
)))

817  
ERROR
;

824 
block1
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ1
].
∂™e_hód
[
∂™e1
].
îa£_node
->
block
;

826 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_TRANSFER
;

827 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

828 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

830 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_ERASE_BUSY
;

831 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

832 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

834 i‡(
comm™d
 =
INTERLEAVE_TWO_PLANE
)

836 
dõ
 = 0; dõ < 
ssd
->
∑ømëî
->
dõ_chù
; die++) {

837 
block0
 = 0xffffffff;

838 i‡(
dõ
 =
dõ1
) {

839 
block0
 = 
block1
;

841 
∂™e
 = 0;Öœ√ < 
ssd
->
∑ømëî
->
∂™e_dõ
;Ölane++) {

842 
dúe˘_îa£_node
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
îa£_node
;

843 i‡(
dúe˘_îa£_node
 !
NULL
) {

845 
block
 = 
dúe˘_îa£_node
->block;

847 i‡(
block0
 == 0xffffffff) {

848 
block0
 = 
block
;

850 i‡(
block
 !
block0
) {

855 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
îa£_node
 = 
dúe˘_îa£_node
->
√xt_node
;

856 
	`îa£_›î©i⁄
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
block
);

857 
	`‰ì
(
dúe˘_îa£_node
);

858 
dúe˘_îa£_node
 = 
NULL
;

859 
ssd
->
dúe˘_îa£_cou¡
++;

865 
ssd
->
öãæóve_m∂™e_îa£_cou¡
++;

866 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 =

867 
ssd
->
cuºít_time
 + 18 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

868 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWB
;

869 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

870 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 - 9 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

871 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tBERS
;

873 } i‡(
comm™d
 =
INTERLEAVE
)

875 
dõ
 = 0; dõ < 
ssd
->
∑ømëî
->
dõ_chù
; die++) {

876 
∂™e
 = 0;Öœ√ < 
ssd
->
∑ømëî
->
∂™e_dõ
;Ölane++) {

877 i‡(
dõ
 =
dõ1
) {

878 
∂™e
 = 
∂™e1
;

880 
dúe˘_îa£_node
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
îa£_node
;

881 i‡(
dúe˘_îa£_node
 !
NULL
) {

882 
block
 = 
dúe˘_îa£_node
->block;

883 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
îa£_node
 = 
dúe˘_îa£_node
->
√xt_node
;

884 
	`îa£_›î©i⁄
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
block
);

885 
	`‰ì
(
dúe˘_îa£_node
);

886 
dúe˘_îa£_node
 = 
NULL
;

887 
ssd
->
dúe˘_îa£_cou¡
++;

892 
ssd
->
öãæóve_îa£_cou¡
++;

893 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 =

894 
ssd
->
cuºít_time
 + 14 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

895 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

896 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tBERS
;

897 } i‡(
comm™d
 =
TWO_PLANE
)

900 
∂™e
 = 0;Öœ√ < 
ssd
->
∑ømëî
->
∂™e_dõ
;Ölane++) {

901 
dúe˘_îa£_node
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ1
].
∂™e_hód
[
∂™e
].
îa£_node
;

902 i‡((
dúe˘_îa£_node
 !
NULL
)) {

903 
block
 = 
dúe˘_îa£_node
->block;

904 i‡(
block
 =
block1
) {

905 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ1
].
∂™e_hód
[
∂™e
].
îa£_node
 = 
dúe˘_îa£_node
->
√xt_node
;

906 
	`îa£_›î©i⁄
(
ssd
, 
ch™√l
, 
chù
, 
dõ1
, 
∂™e
, 
block
);

907 
	`‰ì
(
dúe˘_îa£_node
);

908 
dúe˘_îa£_node
 = 
NULL
;

909 
ssd
->
dúe˘_îa£_cou¡
++;

914 
ssd
->
m∂™e_îa£_c⁄ut
++;

915 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 =

916 
ssd
->
cuºít_time
 + 14 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

917 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

918 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tBERS
;

919 } i‡(
comm™d
 =
NORMAL
)

921 
dúe˘_îa£_node
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ1
].
∂™e_hód
[
∂™e1
].
îa£_node
;

922 
block
 = 
dúe˘_îa£_node
->block;

923 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ1
].
∂™e_hód
[
∂™e1
].
îa£_node
 = 
dúe˘_îa£_node
->
√xt_node
;

924 
	`‰ì
(
dúe˘_îa£_node
);

925 
dúe˘_îa£_node
 = 
NULL
;

926 
	`îa£_›î©i⁄
(
ssd
, 
ch™√l
, 
chù
, 
dõ1
, 
∂™e1
, 
block
);

928 
ssd
->
dúe˘_îa£_cou¡
++;

929 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 =

930 
ssd
->
cuºít_time
 + 5 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

931 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

932 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWB
 +

933 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tBERS
;

935  
ERROR
;

938 
dúe˘_îa£_node
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ1
].
∂™e_hód
[
∂™e1
].
îa£_node
;

940 i‡(((
dúe˘_îa£_node
Ë!
NULL
Ë&& (dúe˘_îa£_node->
block
 =
block1
)) {

941  
FAILURE
;

943  
SUCCESS
;

945 
	}
}

960 
	$gc_dúe˘_îa£
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
) {

961 
lv_dõ
 = 0, 
lv_∂™e
 = 0;

962 
öãæóvî_Êag
 = 
FALSE
, 
muût_∂™e_Êag
 = FALSE;

963 
n‹mÆ_îa£_Êag
 = 
TRUE
;

965 
dúe˘_îa£
 *
dúe˘_îa£_node1
 = 
NULL
;

966 
dúe˘_îa£
 *
dúe˘_îa£_node2
 = 
NULL
;

968 
dúe˘_îa£_node1
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
îa£_node
;

969 i‡(
dúe˘_îa£_node1
 =
NULL
) {

970  
FAILURE
;

977 i‡((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_TWOPLANE
) == AD_TWOPLANE) {

978 
lv_∂™e
 = 0;Üv_∂™ê< 
ssd
->
∑ømëî
->
∂™e_dõ
;Üv_plane++) {

979 
dúe˘_îa£_node2
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
îa£_node
;

980 i‡((
lv_∂™e
 !
∂™e
Ë&& (
dúe˘_îa£_node2
 !
NULL
)) {

981 i‡((
dúe˘_îa£_node1
->
block
Ë=(
dúe˘_îa£_node2
->block)) {

982 
muût_∂™e_Êag
 = 
TRUE
;

993 i‡((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) == AD_INTERLEAVE) {

994 
lv_dõ
 = 0;Üv_dõ < 
ssd
->
∑ømëî
->
dõ_chù
;Üv_die++) {

995 i‡(
lv_dõ
 !
dõ
) {

996 
lv_∂™e
 = 0;Üv_∂™ê< 
ssd
->
∑ømëî
->
∂™e_dõ
;Üv_plane++) {

997 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
îa£_node
 !
NULL
) {

998 
öãæóvî_Êag
 = 
TRUE
;

1003 i‡(
öãæóvî_Êag
 =
TRUE
) {

1015 i‡((
muût_∂™e_Êag
 =
TRUE
Ë&& (
öãæóvî_Êag
 == TRUE) &&

1016 ((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_TWOPLANE
) == AD_TWOPLANE) &&

1017 ((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) == AD_INTERLEAVE)) {

1018 i‡(
	`îa£_∂™es
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
INTERLEAVE_TWO_PLANE
Ë=
SUCCESS
) {

1019  
SUCCESS
;

1021 } i‡((
öãæóvî_Êag
 =
TRUE
Ë&& ((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_INTERLEAVE
) == AD_INTERLEAVE)) {

1022 i‡(
	`îa£_∂™es
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
INTERLEAVE
Ë=
SUCCESS
) {

1023  
SUCCESS
;

1025 } i‡((
muût_∂™e_Êag
 =
TRUE
Ë&& ((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_TWOPLANE
) == AD_TWOPLANE)) {

1026 i‡(
	`îa£_∂™es
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
TWO_PLANE
Ë=
SUCCESS
) {

1027  
SUCCESS
;

1031 i‡((
n‹mÆ_îa£_Êag
 ==

1032 
TRUE
))

1034 i‡(
	`îa£_∂™es
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
NORMAL
Ë=
SUCCESS
) {

1035  
SUCCESS
;

1037  
FAILURE
;

1040  
SUCCESS
;

1041 
	}
}

1044 
Sètus
 
	$move_∑ge
(
ssd_öfo
 *
ssd
, 
loˇl
 *
loˇti⁄
, *
å™s„r_size
) {

1045 
loˇl
 *
√w_loˇti⁄
 = 
NULL
;

1046 
‰ì_°©e
 = 0, 
vÆid_°©e
 = 0;

1047 
Õn
 = 0, 
ﬁd_µn
 = 0, 
µn
 = 0;

1049 
Õn
 = 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].lpn;

1050 
vÆid_°©e
 = 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].valid_state;

1051 
‰ì_°©e
 = 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].free_state;

1052 
ﬁd_µn
 = 
	`föd_µn
(
ssd
, 
loˇti⁄
->
ch™√l
,Üoˇti⁄->
chù
,Üoˇti⁄->
dõ
,Üoˇti⁄->
∂™e
,Üoˇti⁄->
block
,

1053 
loˇti⁄
->
∑ge
);

1054 
µn
 = 
	`gë_µn_f‹_gc
(
ssd
, 
loˇti⁄
->
ch™√l
,Üoˇti⁄->
chù
,Üoˇti⁄->
dõ
,

1055 
loˇti⁄
->
∂™e
);

1057 
√w_loˇti⁄
 = 
	`föd_loˇti⁄
(
ssd
,

1058 
µn
);

1060 i‡((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_COPYBACK
) == AD_COPYBACK) {

1061 i‡(
ssd
->
∑ømëî
->
gªed_CB_ad
 ==

1064 
ssd
->
c›y_back_cou¡
++;

1065 
ssd
->
gc_c›y_back
++;

1066 
ﬁd_µn
 % 2 !
µn
 % 2) {

1067 
ssd
->
ch™√l_hód
[
√w_loˇti⁄
->
ch™√l
].
chù_hód
[√w_loˇti⁄->
chù
].
dõ_hód
[√w_loˇti⁄->
dõ
].
∂™e_hód
[√w_loˇti⁄->
∂™e
].
blk_hód
[√w_loˇti⁄->
block
].
∑ge_hód
[√w_loˇti⁄->
∑ge
].
‰ì_°©e
 = 0;

1068 
ssd
->
ch™√l_hód
[
√w_loˇti⁄
->
ch™√l
].
chù_hód
[√w_loˇti⁄->
chù
].
dõ_hód
[√w_loˇti⁄->
dõ
].
∂™e_hód
[√w_loˇti⁄->
∂™e
].
blk_hód
[√w_loˇti⁄->
block
].
∑ge_hód
[√w_loˇti⁄->
∑ge
].
Õn
 = 0;

1069 
ssd
->
ch™√l_hód
[
√w_loˇti⁄
->
ch™√l
].
chù_hód
[√w_loˇti⁄->
chù
].
dõ_hód
[√w_loˇti⁄->
dõ
].
∂™e_hód
[√w_loˇti⁄->
∂™e
].
blk_hód
[√w_loˇti⁄->
block
].
∑ge_hód
[√w_loˇti⁄->
∑ge
].
vÆid_°©e
 = 0;

1070 
ssd
->
ch™√l_hód
[
√w_loˇti⁄
->
ch™√l
].
chù_hód
[√w_loˇti⁄->
chù
].
dõ_hód
[√w_loˇti⁄->
dõ
].
∂™e_hód
[√w_loˇti⁄->
∂™e
].
blk_hód
[√w_loˇti⁄->
block
].
övÆid_∑ge_num
++;

1072 
	`‰ì
(
√w_loˇti⁄
);

1073 
√w_loˇti⁄
 = 
NULL
;

1075 
µn
 = 
	`gë_µn_f‹_gc
(
ssd
, 
loˇti⁄
->
ch™√l
,Üoˇti⁄->
chù
,Üoˇti⁄->
dõ
,

1076 
loˇti⁄
->
∂™e
);

1077 
ssd
->
¥ogøm_cou¡
--;

1078 
ssd
->
wrôe_Êash_cou¡
--;

1079 
ssd
->
wa°e_∑ge_cou¡
++;

1081 i‡(
√w_loˇti⁄
 =
NULL
) {

1082 
√w_loˇti⁄
 = 
	`föd_loˇti⁄
(
ssd
, 
µn
);

1085 
ssd
->
ch™√l_hód
[
√w_loˇti⁄
->
ch™√l
].
chù_hód
[√w_loˇti⁄->
chù
].
dõ_hód
[√w_loˇti⁄->
dõ
].
∂™e_hód
[√w_loˇti⁄->
∂™e
].
blk_hód
[√w_loˇti⁄->
block
].
∑ge_hód
[√w_loˇti⁄->
∑ge
].
‰ì_°©e
 = free_state;

1086 
ssd
->
ch™√l_hód
[
√w_loˇti⁄
->
ch™√l
].
chù_hód
[√w_loˇti⁄->
chù
].
dõ_hód
[√w_loˇti⁄->
dõ
].
∂™e_hód
[√w_loˇti⁄->
∂™e
].
blk_hód
[√w_loˇti⁄->
block
].
∑ge_hód
[√w_loˇti⁄->
∑ge
].
Õn
 =Üpn;

1087 
ssd
->
ch™√l_hód
[
√w_loˇti⁄
->
ch™√l
].
chù_hód
[√w_loˇti⁄->
chù
].
dõ_hód
[√w_loˇti⁄->
dõ
].
∂™e_hód
[√w_loˇti⁄->
∂™e
].
blk_hód
[√w_loˇti⁄->
block
].
∑ge_hód
[√w_loˇti⁄->
∑ge
].
vÆid_°©e
 = valid_state;

1089 i‡(
ﬁd_µn
 % 2 !
µn
 % 2) {

1090 (*
å™s„r_size
Ë+
	`size
(
vÆid_°©e
);

1093 
ssd
->
c›y_back_cou¡
++;

1094 
ssd
->
gc_c›y_back
++;

1098 #ifde‡
DEBUGONLYGC


1099 
	`¥ötf
("move_page hasÇo copyback operation\n");

1101 (*
å™s„r_size
Ë+
	`size
(
vÆid_°©e
);

1103 
ssd
->
ch™√l_hód
[
√w_loˇti⁄
->
ch™√l
].
chù_hód
[√w_loˇti⁄->
chù
].
dõ_hód
[√w_loˇti⁄->
dõ
].
∂™e_hód
[√w_loˇti⁄->
∂™e
].
blk_hód
[√w_loˇti⁄->
block
].
∑ge_hód
[√w_loˇti⁄->
∑ge
].
‰ì_°©e
 = free_state;

1104 
ssd
->
ch™√l_hód
[
√w_loˇti⁄
->
ch™√l
].
chù_hód
[√w_loˇti⁄->
chù
].
dõ_hód
[√w_loˇti⁄->
dõ
].
∂™e_hód
[√w_loˇti⁄->
∂™e
].
blk_hód
[√w_loˇti⁄->
block
].
∑ge_hód
[√w_loˇti⁄->
∑ge
].
Õn
 =Üpn;

1105 
ssd
->
ch™√l_hód
[
√w_loˇti⁄
->
ch™√l
].
chù_hód
[√w_loˇti⁄->
chù
].
dõ_hód
[√w_loˇti⁄->
dõ
].
∂™e_hód
[√w_loˇti⁄->
∂™e
].
blk_hód
[√w_loˇti⁄->
block
].
∑ge_hód
[√w_loˇti⁄->
∑ge
].
vÆid_°©e
 = valid_state;

1108 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].
‰ì_°©e
 = 0;

1109 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].
Õn
 = 0;

1110 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
∑ge_hód
[loˇti⁄->
∑ge
].
vÆid_°©e
 = 0;

1111 
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
dõ_hód
[loˇti⁄->
dõ
].
∂™e_hód
[loˇti⁄->
∂™e
].
blk_hód
[loˇti⁄->
block
].
övÆid_∑ge_num
++;

1113 i‡(
ﬁd_µn
 =
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
≤
)

1115 
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
≤
 = 
µn
;

1118 #ifde‡
DEBUGONLYGC


1119 
	`¥ötf
("ö GC, oldÜoˇti⁄: ch™√»%d, chù %d, dõ %d,Öœ√ %d, block %d,Öagê%d ch™gêtÿ√wÜoˇti⁄: ch™√»%d, chù %d, dõ %d,Öœ√ %d, block %d,Öagê%d \n", 
loˇti⁄
->
ch™√l
,Üoˇti⁄->
chù
,Üoˇti⁄->
dõ
,Üoˇti⁄->
∂™e
,Üoˇti⁄->
block
,Üoˇti⁄->
∑ge
, 
√w_loˇti⁄
->channel,Çew_location->chip,Çew_location->die,Çew_location->plane,Çew_location->block,Çew_location->page );

1121 
	`‰ì
(
√w_loˇti⁄
);

1122 
√w_loˇti⁄
 = 
NULL
;

1124  
SUCCESS
;

1125 
	}
}

1230 
	$unöãºu±_gc
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
) {

1231 
i
 = 0, 
övÆid_∑ge
 = 0;

1232 
block
, 
a˘ive_block
, 
å™s„r_size
, 
‰ì_∑ge
, 
∑ge_move_cou¡
 = 0;

1233 
loˇl
 *
loˇti⁄
 = 
NULL
;

1234 
tŸÆ_övÆid_∑ge_num
 = 0;

1236 
gc_›î©i⁄
 *
gc_node
 = 
NULL
;

1237 
gc_node
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
gc_comm™d
;

1238 
cuºít_°©e
 = 0, 
√xt_°©e
 = 0;

1239 
√xt_°©e_¥edi˘_time
 = 0;

1242 if(
ssd
->
debug_sign
 == 1){

1253 #ifde‡
DEBUG


1254 
	`¥ötf
("begin go into uninterrupt_gc\n");

1259 i‡(
gc_node
 !
NULL
) {

1260 #ifde‡
DEBUG


1261 
	`¥ötf
("gc must be unNULL sinceÅhis isÅhe channel gc.\n");

1264 
cuºít_°©e
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
gc_node
->
chù
].current_state;

1265 
√xt_°©e
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
gc_node
->
chù
].next_state;

1266 
√xt_°©e_¥edi˘_time
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
gc_node
->
chù
].next_state_predict_time;

1277 if(
gc_node
->
vi˘im_block_numbî
 == -1){

1278 i‡(
	`föd_a˘ive_block
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
) !=

1279 
SUCCESS
)

1281 
	`¥ötf
("\n\n Error in uninterrupt_gc().\n");

1282  
ERROR
;

1284 
a˘ive_block
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].active_block;

1286 
övÆid_∑ge
 = 0;

1287 
å™s„r_size
 = 0;

1288 
block
 = -1;

1289 
i
 = 0; i <

1290 
ssd
->
∑ømëî
->
block_∂™e
; 
i
++)

1292 
tŸÆ_övÆid_∑ge_num
 +
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
i
].
övÆid_∑ge_num
;

1293 i‡((
a˘ive_block
 !
i
) &&

1294 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
i
].
övÆid_∑ge_num
 >

1295 
övÆid_∑ge
)) {

1296 
övÆid_∑ge
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
i
].
övÆid_∑ge_num
;

1297 
block
 = 
i
;

1301 #ifde‡
DEBUGONLYGC


1302 
	`¥ötf
("evîyGC o∆y choo£ on˚ block f‹ vi˘im.thi†block i¿ ch™√»%d, chù %d, dõ %d,Öœ√ %d, block %d, ha† invÆid_∑ge_num %d\n", 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
i
, 
övÆid_∑ge
);

1308 i‡(
block
 == -1) {

1311 
gc_node
->
vi˘im_block_numbî
 = 
block
;

1312 
gc_node
->
block
 = block;

1315 #ifde‡
DEBUGONLYGC


1316 
	`¥ötf_gc_node_öf‹m©i⁄
 (
gc_node
);

1322 i‡((
gc_node
->
ªad_wrôe_íd
 !0Ë&& ((
cuºít_°©e
 =
CHIP_IDLE
Ë|| ((
√xt_°©e
 =CHIP_IDLEË&& (
√xt_°©e_¥edi˘_time
 <
ssd
->
cuºít_time
)))){

1325 if–(
gc_node
->
ªad
 =1Ë&& (gc_node->
wrôe
 =0Ë&& (gc_node->
gc_ªad_ö√r
 == -1)) {

1327 
gc_node
->
c›y_∑ge_numbî
 ++;

1328 #ifde‡
DEBUG


1329 
	`¥ötf
("hîêªad wû»begöáÇewÖage, sÿ∑gênumbî ++ ,thê√wÖagêi†%d\n",
gc_node
->
c›y_∑ge_numbî
);

1331 
i
 = 
gc_node
->
c›y_∑ge_numbî
; i <

1332 
ssd
->
∑ømëî
->
∑ge_block
; 
i
++ )

1336 i‡((
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
gc_node
->
vi˘im_block_numbî
].
∑ge_hód
[
i
].
‰ì_°©e
 &

1337 
PG_SUB
) == 0xffffffff) {

1338 
gc_node
->
vi˘im_block_‰ì∑ge_°©i°ic
 ++;

1340 i‡(
gc_node
->
vi˘im_block_‰ì∑ge_°©i°ic
 != -1) {

1341 
	`¥ötf
("\¡oÿmuch fªê∑ge. \à%d\à.%d\t%d\t%d\t%d\t\n", 
gc_node
->
vi˘im_block_‰ì∑ge_°©i°ic
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
);

1343 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
gc_node
->
vi˘im_block_numbî
].
∑ge_hód
[
i
].
vÆid_°©e
 >

1361 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_GC
;

1362 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

1363 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

1364 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_GC_RW_BUSY
;

1365 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

1366 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_GC_RW_BUSY
;

1367 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 = ssd->
cuºít_time
 + (7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
);

1368 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 = ssd->channel_head[channel].next_state_predict_time ;

1371 
gc_node
->
c›y_vÆid_numbî
 = 
i
;

1372 
gc_node
->
c›y_∑ge_numbî
 = gc_node->
c›y_vÆid_numbî
 ;

1373 
gc_node
->
gc_ªad_ö√r
 = 0;

1374 #ifde‡
DEBUG


1375 
	`¥ötf
("evîytimêthêvi˘im ch™√»%d,chù %d, dõ %d,Öœ√ %d, block %dÖagê%d, , vÆid_°©ê%d\n",
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
block
, 
i
, 
ssd
->
ch™√l_hód
[ch™√l].
chù_hód
[chù].
dõ_hód
[dõ].
∂™e_hód
[∂™e].
blk_hód
[
gc_node
->
vi˘im_block_numbî
].
∑ge_hód
[i].
vÆid_°©e
);

1378 if(
i
 =((
ssd
->
∑ømëî
->
∑ge_block
) - 1)){

1379 
gc_node
->
œ°_∑ge_ö_vi˘im_dól
 = 0;

1390 if(
i
 =((
ssd
->
∑ømëî
->
∑ge_block
) - 1)){

1393 
gc_node
->
ªad_wrôe_íd
 = 0;

1394 #ifde‡
DEBUG


1395 
	`¥ötf
("òi†%d, món†thêœ° fªïage,d⁄'àdÿc›yback,Çow gÿtÿthêbegöög o‡îa£\n", 
i
);

1407 if–(
gc_node
->
ªad
 =0Ë&& (gc_node->
wrôe
 =1Ë&& (gc_node->
gc_wrôe_ö√r
 == -1)) {

1408 #ifde‡
DEBUG


1409 
	`¥ötf
("g¯wrôêpha£, wrôêôî©i⁄†i†%d,\n", 
gc_node
->
wrôe
);

1411 
i
 = 
gc_node
->
c›y_∑ge_numbî
;

1414 #ifde‡
DEBUG


1415 
	`¥ötf
("GCwrôêch™√»%d, chù %d, dõ %d,Öœ√ %d, block %d,Öagê%d, vÆid_°©êi†%d\n", 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
gc_node
->
vi˘im_block_numbî
, gc_node->
c›y_vÆid_numbî
,
ssd
->
ch™√l_hód
[ch™√l].
chù_hód
[chù].
dõ_hód
[dõ].
∂™e_hód
[∂™e].
blk_hód
[gc_node->vi˘im_block_numbî].
∑ge_hód
[gc_node->c›y_vÆid_numbî].
vÆid_°©e
 );

1419 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
gc_node
->
vi˘im_block_numbî
].
∑ge_hód
[gc_node->
c›y_vÆid_numbî
].
vÆid_°©e
 >

1436 #ifde‡
DEBUG


1437 
	`¥ötf
("gc_node->c›y_∑ge_numbî i†%d, i i†%d,theyáªÅhêßme\n",
gc_node
->
c›y_∑ge_numbî
, 
i
);

1442 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_GC
;

1443 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

1444 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

1445 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_GC_RW_BUSY
;

1446 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

1447 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_GC_RW_BUSY
;

1448 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 = ssd->
cuºít_time
 + (7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
);

1449 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 = ssd->channel_head[channel].next_state_predict_time ;

1451 
gc_node
->
gc_wrôe_ö√r
 = 0;

1468 i‡–(
cuºít_°©e
 =
CHIP_IDLE
Ë|| ((
√xt_°©e
 =CHIP_IDLEË&& (
√xt_°©e_¥edi˘_time
 <
ssd
->
cuºít_time
))){

1469 i‡(
gc_node
->
ªad_wrôe_íd
 == 0) {

1471 if(
gc_node
->
îa£
 == -1) {

1472 #ifde‡
DEBUG


1473 
	`¥ötf
("g¯îa£Öha£,Éø£ iãøti⁄†i†%d,\n", 
gc_node
->
îa£
);

1489 #ifde‡
DEBUG


1490 
	`¥ötf
("gc_node->c›y_∑ge_numbî i†%d, iài†thêíd o‡ªad_å™s„r_wrôê™dÅhêbegö o‡thêîa£Çow\n",
gc_node
->
c›y_∑ge_numbî
);

1493 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_GC
;

1494 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

1495 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

1496 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_ERASE_BUSY
;

1497 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

1498 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_ERASE_BUSY
;

1499 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 = ssd->
cuºít_time
 + (5 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
);

1500 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 = ssd->channel_head[channel].next_state_predict_time ;

1504 
gc_node
->
îa£
 = 0;

1517 
	}
}

1624 
	$öãºu±_gc
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
,

1625 
gc_›î©i⁄
 *
gc_node
) {

1626 
i
, 
block
, 
a˘ive_block
, 
å™s„r_size
, 
övÆid_∑ge
 = 0;

1627 
loˇl
 *
loˇti⁄
;

1629 
a˘ive_block
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].active_block;

1630 
å™s„r_size
 = 0;

1631 i‡(
gc_node
->
block
 >
ssd
->
∑ømëî
->
block_∂™e
) {

1632 
i
 = 0; i < 
ssd
->
∑ømëî
->
block_∂™e
; i++) {

1633 i‡((
a˘ive_block
 !
i
) &&

1634 (
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
i
].
övÆid_∑ge_num
 >

1635 
övÆid_∑ge
)) {

1636 
övÆid_∑ge
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
i
].
övÆid_∑ge_num
;

1637 
block
 = 
i
;

1640 
gc_node
->
block
 = block;

1643 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
gc_node
->
block
].
övÆid_∑ge_num
 !=

1644 
ssd
->
∑ømëî
->
∑ge_block
)

1646 
i
 = 
gc_node
->
∑ge
; i < 
ssd
->
∑ømëî
->
∑ge_block
; i++) {

1647 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
gc_node
->
block
].
∑ge_hód
[
i
].
vÆid_°©e
 >

1649 
loˇti⁄
 = (
loˇl
 *Ë
	`mÆloc
((local));

1650 
	`Æloc_as£π
(
loˇti⁄
, "location");

1651 
	`mem£t
(
loˇti⁄
, 0, (
loˇl
));

1653 
loˇti⁄
->
ch™√l
 = channel;

1654 
loˇti⁄
->
chù
 = chip;

1655 
loˇti⁄
->
dõ
 = die;

1656 
loˇti⁄
->
∂™e
 =Ölane;

1657 
loˇti⁄
->
block
 = block;

1658 
loˇti⁄
->
∑ge
 = 
i
;

1659 
å™s„r_size
 = 0;

1661 
	`move_∑ge
(
ssd
, 
loˇti⁄
, &
å™s„r_size
);

1663 
	`‰ì
(
loˇti⁄
);

1664 
loˇti⁄
 = 
NULL
;

1666 
gc_node
->
∑ge
 = 
i
 + 1;

1667 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
dõ_hód
[
dõ
].
∂™e_hód
[
∂™e
].
blk_hód
[
gc_node
->
block
].
övÆid_∑ge_num
++;

1668 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_C_A_TRANSFER
;

1669 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

1670 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

1671 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_COPYBACK_BUSY
;

1672 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

1673 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

1675 i‡((
ssd
->
∑ømëî
->
adv™˚d_comm™ds
 & 
AD_COPYBACK
) == AD_COPYBACK) {

1676 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 =

1677 
ssd
->
cuºít_time
 + 7 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

1678 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
 + 7 * ssd->∑ømëî->time_ch¨a˘îi°ics.
tWC
;

1679 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

1680 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 +

1681 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG
;

1683 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 = ssd->
cuºít_time
 +

1684 (7 + 
å™s„r_size
 * 
SECTOR
) *

1685 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
 +

1686 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tR
 +

1687 (7 + 
å™s„r_size
 * 
SECTOR
) *

1688 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

1689 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

1690 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 +

1691 
ssd
->
∑ømëî
->
time_ch¨a˘îi°ics
.
tPROG
;

1697 
	`îa£_›î©i⁄
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
, 
gc_node
->
block
);

1699 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_°©e
 = 
CHANNEL_C_A_TRANSFER
;

1700 
ssd
->
ch™√l_hód
[
ch™√l
].
cuºít_time
 = ssd->current_time;

1701 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e
 = 
CHANNEL_IDLE
;

1702 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 =

1703 
ssd
->
cuºít_time
 + 5 * ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tWC
;

1705 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_°©e
 = 
CHIP_ERASE_BUSY
;

1706 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
cuºít_time
 = ssd->current_time;

1707 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e
 = 
CHIP_IDLE
;

1708 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
chù
].
√xt_°©e_¥edi˘_time
 =

1709 
ssd
->
ch™√l_hód
[
ch™√l
].
√xt_°©e_¥edi˘_time
 + ssd->
∑ømëî
->
time_ch¨a˘îi°ics
.
tBERS
;

1714 
	`¥ötf
("there isáÖroblem in interrupt_gc\n");

1716 
	}
}

1721 
	$dñëe_gc_node
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
gc_›î©i⁄
 *
gc_node
) {

1722 
gc_›î©i⁄
 *
gc_¥e
 = 
NULL
;

1723 i‡(
gc_node
 =
NULL
) {

1724  
ERROR
;

1727 i‡(
gc_node
 =
ssd
->
ch™√l_hód
[
ch™√l
].
gc_comm™d
) {

1728 #ifde‡
DEBUGONLYGC


1729 
	`¥ötf
("channel gc only one,so here\n");

1731 
ssd
->
ch™√l_hód
[
ch™√l
].
gc_comm™d
 = 
gc_node
->
√xt_node
;

1733 
gc_¥e
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
gc_comm™d
;

1734 
gc_¥e
->
√xt_node
 !
NULL
) {

1735 i‡(
gc_¥e
->
√xt_node
 =
gc_node
) {

1736 
gc_¥e
->
√xt_node
 = 
gc_node
->next_node;

1739 
gc_¥e
 = gc_¥e->
√xt_node
;

1744 #ifde‡
DEBUG


1745 
	`¥ötf
("ch™√»%d, dñëêgc_nodêaddªs†%d\n", 
ch™√l
, 
gc_node
);

1749 
	`‰ì
(
gc_node
);

1750 
gc_node
 = 
NULL
;

1751 
ssd
->
gc_ªque°
--;

1752  
SUCCESS
;

1753 
	}
}

1758 
Sètus
 
	$gc_f‹_ch™√l
(
ssd_öfo
 *
ssd
, 
ch™√l
) {

1759 
Êag_dúe˘_îa£
 = 1, 
Êag_gc
 = 1, 
Êag_övoke_gc
 = 1;

1760 
chù
, 
dõ
, 
∂™e
, 
Êag_¥i‹ôy
 = 0;

1761 
cuºít_°©e
 = 0, 
√xt_°©e
 = 0;

1762 
√xt_°©e_¥edi˘_time
 = 0;

1763 
gc_›î©i⁄
 *
gc_node
 = 
NULL
, *
gc_p
 = NULL;

1770 
gc_node
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
gc_comm™d
;

1786 i‡(
gc_node
->
¥i‹ôy
 =
GC_UNINTERRUPT
)

1788 
Êag_¥i‹ôy
 = 1;

1790 #ifde‡
DEBUG


1791 
	`¥ötf
("gc_nodêi†%x,ánd fœg_¥i‹ôy(mu° bê1Ëi†%d.gc_nodêmu°n'àbêNULL\n", *
gc_node
, 
Êag_¥i‹ôy
);

1794 i‡(
Êag_¥i‹ôy
 != 1)

1796 #ifde‡
DEBUG


1797 
	`¥ötf
("errors happend in gc1 !!!\n");

1800 
gc_node
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
gc_comm™d
;

1801 
gc_node
 !
NULL
) {

1802 
cuºít_°©e
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
gc_node
->
chù
].current_state;

1803 
√xt_°©e
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
gc_node
->
chù
].next_state;

1804 
√xt_°©e_¥edi˘_time
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
chù_hód
[
gc_node
->
chù
].next_state_predict_time;

1812 
gc_node
 = gc_node->
√xt_node
;

1817 i‡(
gc_node
 =
NULL
) {

1818  
FAILURE
;

1821 
chù
 = 
gc_node
->chip;

1822 
dõ
 = 
gc_node
->die;

1823 
∂™e
 = 
gc_node
->plane;

1825 i‡(
gc_node
->
¥i‹ôy
 =
GC_UNINTERRUPT
) {

1827 #ifde‡
DEBUG


1828 
	`¥ötf
("everyÅime gc only happen here\n");

1831 
	`unöãºu±_gc
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
);

1833  
SUCCESS
;

1859 
Êag_övoke_gc
 = 
	`decide_gc_övoke
(
ssd
,

1860 
ch™√l
);

1862 i‡(
Êag_övoke_gc
 == 1) {

1863 
Êag_dúe˘_îa£
 = 
	`gc_dúe˘_îa£
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
);

1864 i‡(
Êag_dúe˘_îa£
 == -1) {

1865 
Êag_gc
 = 
	`öãºu±_gc
(
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
,

1866 
gc_node
);

1867 i‡(
Êag_gc
 == 1) {

1868 
	`dñëe_gc_node
(
ssd
, 
ch™√l
, 
gc_node
);

1870 } i‡(
Êag_dúe˘_îa£
 == 1) {

1871 
	`dñëe_gc_node
(
ssd
, 
ch™√l
, 
gc_node
);

1873  
SUCCESS
;

1875  
FAILURE
;

1878 
	}
}

1890 
	$gc
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
Êag
) {

1891 
i
;

1892 
Êag_dúe˘_îa£
 = 1, 
Êag_gc
 = 1, 
Êag_övoke_gc
 = 1;

1893 
Êag_¥i‹ôy
 = 0;

1894 
gc_›î©i⁄
 *
gc_node
 = 
NULL
, *
gc_p
 = NULL;

1896 i‡(
Êag
 == 1)

1898 
i
 = 0; i < 
ssd
->
∑ømëî
->
ch™√l_numbî
; i++) {

1899 
Êag_¥i‹ôy
 = 0;

1900 
Êag_dúe˘_îa£
 = 1;

1901 
Êag_gc
 = 1;

1902 
Êag_övoke_gc
 = 1;

1903 
gc_node
 = 
NULL
;

1904 
gc_p
 = 
NULL
;

1905 i‡((
ssd
->
ch™√l_hód
[
i
].
cuºít_°©e
 =
CHANNEL_IDLE
) ||

1906 (
ssd
->
ch™√l_hód
[
i
].
√xt_°©e
 =
CHANNEL_IDLE
 &&

1907 
ssd
->
ch™√l_hód
[
i
].
√xt_°©e_¥edi˘_time
 <ssd->
cuºít_time
)) {

1908 
ch™√l
 = 
i
;

1909 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
gc_comm™d
 !
NULL
) {

1910 
	`gc_f‹_ch™√l
(
ssd
, 
ch™√l
);

1914  
SUCCESS
;

1927 i‡((
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 == 1) ||

1928 ((
ssd
->
∑ømëî
->
Æloˇti⁄_scheme
 =0Ë&& (ssd->∑ømëî->
dy«mic_Æloˇti⁄
 == 1))) {

1935 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
gc_comm™d
 !
NULL
) {

1936 
	`gc_f‹_ch™√l
(
ssd
, 
ch™√l
);

1938  
SUCCESS
;

1940 
	}
}

1947 
	$decide_gc_övoke
(
ssd_öfo
 *
ssd
, 
ch™√l
) {

1948 
sub_ªque°
 *
sub
;

1949 
loˇl
 *
loˇti⁄
;

1951 i‡((
ssd
->
ch™√l_hód
[
ch™√l
].
subs_r_hód
 =
NULL
) &&

1952 (
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 =
NULL
))

1956 i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
subs_w_hód
 !
NULL
) {

1958 } i‡(
ssd
->
ch™√l_hód
[
ch™√l
].
subs_r_hód
 !
NULL
) {

1959 
sub
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_r_hód
;

1960 
sub
 !
NULL
) {

1961 i‡(
sub
->
cuºít_°©e
 ==

1962 
SR_WAIT
)

1964 
loˇti⁄
 = 
	`föd_loˇti⁄
(
ssd
, 
sub
->
µn
);

1965 i‡((
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
cuºít_°©e
 =
CHIP_IDLE
) ||

1966 ((
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e
 =
CHIP_IDLE
) &&

1967 (
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 <=

1968 
ssd
->
cuºít_time
))) {

1969 
	`‰ì
(
loˇti⁄
);

1970 
loˇti⁄
 = 
NULL
;

1973 
	`‰ì
(
loˇti⁄
);

1974 
loˇti⁄
 = 
NULL
;

1975 } i‡(
sub
->
√xt_°©e
 =
SR_R_DATA_TRANSFER
) {

1976 
loˇti⁄
 = 
	`föd_loˇti⁄
(
ssd
, 
sub
->
µn
);

1977 i‡(
ssd
->
ch™√l_hód
[
loˇti⁄
->
ch™√l
].
chù_hód
[loˇti⁄->
chù
].
√xt_°©e_¥edi˘_time
 <=

1978 
ssd
->
cuºít_time
) {

1979 
	`‰ì
(
loˇti⁄
);

1980 
loˇti⁄
 = 
NULL
;

1983 
	`‰ì
(
loˇti⁄
);

1984 
loˇti⁄
 = 
NULL
;

1986 
sub
 = sub->
√xt_node
;

1991 
	}
}

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/pagemap.h

18 #i‚de‡
PAGEMAP_H


19 
	#PAGEMAP_H
 10000

	)

21 
	~<sys/ty≥s.h
>

22 
	~"öôülize.h
"

24 
	#MAX_INT64
 0x7ffffffffffffffÊl

	)

26 
fûe_as£π
(
îr‹
, *
s
);

28 
Æloc_as£π
(*
p
, *
s
);

30 
åa˚_as£π
(
öt64_t
 
time_t
, 
devi˚
, 
l¢
, 
size
, 
›e
);

32 
loˇl
 *
föd_loˇti⁄
(
ssd_öfo
 *
ssd
, 
µn
);

35 
föd_µn
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
,

36 
block
, 
∑ge
);

38 
ssd_öfo
 *
¥e_¥o˚ss_∑ge
(ssd_öfÿ*
ssd
);

40 
gë_µn_f‹_¥e_¥o˚ss
(
ssd_öfo
 *
ssd
, 
l¢
);

42 
ssd_öfo
 *

43 
gë_µn
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
,

44 
sub_ªque°
 *
sub
);

46 
gc
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
Êag
);

49 
gc_dúe˘_îa£
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
);

51 
unöãºu±_gc
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
);

53 
öãºu±_gc
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
,

54 
gc_›î©i⁄
 *
gc_node
);

56 
decide_gc_övoke
(
ssd_öfo
 *
ssd
, 
ch™√l
);

58 
£t_íåy_°©e
(
ssd_öfo
 *
ssd
, 
l¢
, 
size
);

61 
gë_µn_f‹_gc
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
);

63 
îa£_›î©i⁄
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
,

64 
block
);

66 
îa£_∂™es
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ1
, 
∂™e1
,

67 
comm™d
);

69 
move_∑ge
(
ssd_öfo
 *
ssd
, 
loˇl
 *
loˇti⁄
, *
å™s„r_size
);

71 
gc_f‹_ch™√l
(
ssd_öfo
 *
ssd
, 
ch™√l
);

73 
dñëe_gc_node
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
gc_›î©i⁄
 *
gc_node
);

77 
gë_µn_ö_dif„ª¡_ˇ£
(
ssd_öfo
* 
ssd
, 
ch™√l
, 
chù
,
dõ
,
∂™e
,
block
,
∑ge
);

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/ssd.c

18 
	~"ssd.h
"

19 
	#WRITE_RATIO_IN_REQUEST_QUEUE
 0.3

	)

22 
	$Êush_m≠pögèbÀ_öto_fûes
(
ssd_öfo
 *
ssd
, * 
fûíame
)

24 
∑ge_numbîs
=0;

25 
døm_öfo
 *
døm
 = 
ssd
->dram;

27 
ãmp_i
 = 0;

31 
FILE
* 
Â
 = 
	`f›í
(
fûíame
, "w");

34 
∑ge_num
 = 
ssd
->
∑ømëî
->
∑ge_block
 * ssd->∑ømëî->
block_∂™e
 * ssd->∑ømëî->
∂™e_dõ
 * ssd->∑ømëî->
dõ_chù
 * ssd->∑ømëî->
chù_num
;

36 
	`¥ötf
("∑ge_num i†%d\n", 
∑ge_num
);

38 
íåy
 *
m≠_íåy
;

40 
≤
;

42 
ãmp_i
 = 0;Åemp_ò< 
∑ge_num
;Åemp_i ++){

44 
	`Ârötf
(
Â
, "%d ", 
døm
->
m≠
->
m≠_íåy
[
ãmp_i
].
≤
);

49 
loˇl
* 
loˇti⁄
 = 
NULL
;

50 if(
døm
->
m≠
->
m≠_íåy
[
ãmp_i
].
≤
 != 0){

51 
	`¥ötf
("Õ¿%d i†µ¿%d\¿", 
ãmp_i
, 
døm
->
m≠
->
m≠_íåy
[ãmp_i].
≤
);

53 
loˇti⁄
 = 
	`föd_loˇti⁄
(
ssd
, 
døm
->
m≠
->
m≠_íåy
[
ãmp_i
].
≤
);

54 
	`ssdsim_msg
("ch™√»%d, chù %d, dõ %d,Öœ√ %d, block %d,Öagê%d", 
loˇti⁄
->
ch™√l
,Üoˇti⁄->
chù
,Üoˇti⁄->
dõ
,Üoˇti⁄->
∂™e
,Üoˇti⁄->
block
,Üoˇti⁄->
∑ge
);

61 
	`f˛o£
(
Â
);

63 
	}
}

86 
	$¥ötf_gc_node_öf‹m©i⁄
(
gc_›î©i⁄
* 
gc_node
)

91 
	}
}

96 
	$¥ötf_evîy_chù_°©ic_subªque°
(
ssd_öfo
 *
ssd
)

98 
tmp_ch™√l
,
tmp_chù
, 
i
, 
j
;

99 
ãmp_chù_ªad_queue_Àngth
[100][100];

100 
ãmp_chù_wrôe_queue_Àngth
[100][100];

101 
sub_ªque°
 *
sub_f‹_queue
 = 
NULL
;

102 
sub_ªque°
 *
sub_f‹_ªad
 = 
NULL
;

103 
sub_ªque°
 *
sub_f‹_wrôe
 = 
NULL
;

104 #ifde‡
DEBUG


108 
i
 = 0; i < 100; i++ ){

109 
j
 = 0; j < 100; j++ ){

110 
ãmp_chù_ªad_queue_Àngth
[
i
][
j
] = 0;

111 
ãmp_chù_wrôe_queue_Àngth
[
i
][
j
] = 0;

115 
i
 = 0; i < 
ssd
->
∑ømëî
->
ch™√l_numbî
; i++ ){

117 
sub_f‹_ªad
 = 
ssd
->
ch™√l_hód
[
i
].
subs_r_hód
;

118 
sub_f‹_ªad
 !
NULL
){

119 
tmp_ch™√l
 = 
sub_f‹_ªad
->
loˇti⁄
->
ch™√l
;

120 
tmp_chù
 = 
sub_f‹_ªad
->
loˇti⁄
->
chù
;

121 
ãmp_chù_ªad_queue_Àngth
[
tmp_ch™√l
][
tmp_chù
] ++;

124 
sub_f‹_ªad
 = sub_f‹_ªad->
√xt_node
;

129 
sub_f‹_wrôe
 = 
ssd
->
ch™√l_hód
[
i
].
subs_w_hód
;

130 
sub_f‹_wrôe
 !
NULL
){

131 #ifde‡
DEBUG


136 
tmp_ch™√l
 = 
sub_f‹_wrôe
->
loˇti⁄
->
ch™√l
;

137 
tmp_chù
 = 
sub_f‹_wrôe
->
loˇti⁄
->
chù
;

138 
ãmp_chù_wrôe_queue_Àngth
[
tmp_ch™√l
][
tmp_chù
] ++;

141 
sub_f‹_wrôe
 = sub_f‹_wrôe->
√xt_node
;

146 
tmp_ch™√l
 = 
ssd
->
∑ømëî
->
ch™√l_numbî
;

147 
tmp_chù
 = 
ssd
->
∑ømëî
->
chù_num
 / ssd->∑ømëî->
ch™√l_numbî
;

149 
i
 = 0; i < 
tmp_ch™√l
; i++ ){

150 #ifde‡
DEBUG


151 
	`¥ötf
("ch™√»%d '†sub_r_èûáddªs†i†%Œd\n", 
i
, 
ssd
->
ch™√l_hód
[i].
subs_r_èû
);

152 
	`¥ötf
("ch™√»%d '†sub_r_hódáddªs†i†%Œd\n", 
i
, 
ssd
->
ch™√l_hód
[i].
subs_r_hód
);

153 
	`¥ötf
("ch™√»%d '†sub_w_hódáddªs†i†%Œd\n", 
i
, 
ssd
->
ch™√l_hód
[i].
subs_w_hód
);

154 
	`¥ötf
("ch™√»%d '†sub_w_èûáddªs†i†%Œd\n", 
i
, 
ssd
->
ch™√l_hód
[i].
subs_w_èû
);

156 
j
 = 0; j < 
tmp_chù
; j++ ){

160 
	`¥ötf
("0, %d, %d, %d\n", 
i
, 
j
, 
ãmp_chù_wrôe_queue_Àngth
[i][j]);

161 
	`¥ötf
("1, %d, %d, %d\n", 
i
, 
j
, 
ãmp_chù_ªad_queue_Àngth
[i][j]);

164 #ifde‡
DEBUGQUEUE


174 
sub_f‹_queue
 = 
ssd
->
ch™√l_hód
[
i
].
subs_r_hód
;

176 
sub_f‹_queue
 !
NULL
){

177 if(
sub_f‹_queue
->
loˇti⁄
->
chù
 =
j
){

180 
sub_f‹_queue
 = sub_f‹_queue->
√xt_node
;

182 if(
sub_f‹_queue
 !
NULL
){

183 
	`¥ötf
("cﬁÀ˘i⁄2 ch™√»%d, chù %d, fú° hód sub_ªad_ªque° sèã %d\n", 
i
, 
j
, 
sub_f‹_queue
->
cuºít_°©e
);

185 
	`¥ötf
("cﬁÀ˘i⁄2 ch™√»%d, chù %d, ha†nÿsub_ªad_ªque°Çow\n", 
i
, 
j
);

189 
sub_f‹_queue
 = 
ssd
->
ch™√l_hód
[
i
].
subs_w_hód
;

191 
sub_f‹_queue
 !
NULL
){

192 if(
sub_f‹_queue
->
loˇti⁄
->
chù
 =
j
){

195 
sub_f‹_queue
 = sub_f‹_queue->
√xt_node
;

197 if(
sub_f‹_queue
 !
NULL
){

198 
	`¥ötf
("cﬁÀ˘i⁄2 ch™√»%d, chù %d, fú° hód sub_wrôe_ªque° sèã %d\n", 
i
, 
j
, 
sub_f‹_queue
->
cuºít_°©e
);

200 
	`¥ötf
("cﬁÀ˘i⁄2 ch™√»%d, chù %d, ha†nÿsub_wrôe_ªque°Çow\n", 
i
, 
j
);

205 if(
ãmp_chù_ªad_queue_Àngth
[
i
][
j
] !
ssd
->
ch™√l_hód
[i].
chù_hód
[j].
chù_ªad_queue_Àngth
) {

206 
	`¥ötf
("lxc,readÜength is wrong here\n");

208 if(
ãmp_chù_wrôe_queue_Àngth
[
i
][
j
] !
ssd
->
ch™√l_hód
[i].
chù_hód
[j].
chù_wrôe_queue_Àngth
) {

209 
	`¥ötf
("lxc,writeÜength is wrong here\n");

213 
	}
}

216 
	$¥ötf_evîy_chù_ªad_subªque°
(
ssd_öfo
 *
ssd
)

218 
tmp_ch™√l
,
tmp_chù
, 
i
, 
j
;

219 
ãmp_chù_ªad_queue_Àngth
[100][100];

220 
ãmp_chù_wrôe_queue_Àngth
[100][100];

221 
sub_ªque°
 *
sub_f‹_queue
 = 
NULL
;

222 
sub_ªque°
 *
sub_f‹_ªad
 = 
NULL
;

223 
sub_ªque°
 *
sub_f‹_wrôe
 = 
NULL
;

224 #ifde‡
DEBUG


228 
i
 = 0; i < 100; i++ ){

229 
j
 = 0; j < 100; j++ ){

230 
ãmp_chù_ªad_queue_Àngth
[
i
][
j
] = 0;

231 
ãmp_chù_wrôe_queue_Àngth
[
i
][
j
] = 0;

235 
i
 = 0; i < 
ssd
->
∑ømëî
->
ch™√l_numbî
; i++ ){

237 
sub_f‹_ªad
 = 
ssd
->
ch™√l_hód
[
i
].
subs_r_hód
;

238 
sub_f‹_ªad
 !
NULL
){

239 
tmp_ch™√l
 = 
sub_f‹_ªad
->
loˇti⁄
->
ch™√l
;

240 
tmp_chù
 = 
sub_f‹_ªad
->
loˇti⁄
->
chù
;

241 
ãmp_chù_ªad_queue_Àngth
[
tmp_ch™√l
][
tmp_chù
] ++;

244 
sub_f‹_ªad
 = sub_f‹_ªad->
√xt_node
;

249 
sub_f‹_wrôe
 = 
ssd
->
ch™√l_hód
[
i
].
subs_w_hód
;

250 
sub_f‹_wrôe
 !
NULL
){

256 
tmp_ch™√l
 = 
sub_f‹_wrôe
->
loˇti⁄
->
ch™√l
;

257 
tmp_chù
 = 
sub_f‹_wrôe
->
loˇti⁄
->
chù
;

258 
ãmp_chù_wrôe_queue_Àngth
[
tmp_ch™√l
][
tmp_chù
] ++;

261 
sub_f‹_wrôe
 = sub_f‹_wrôe->
√xt_node
;

266 
tmp_ch™√l
 = 
ssd
->
∑ømëî
->
ch™√l_numbî
;

267 
tmp_chù
 = 
ssd
->
∑ømëî
->
chù_num
 / ssd->∑ømëî->
ch™√l_numbî
;

269 
i
 = 0; i < 
tmp_ch™√l
; i++ ){

270 #ifde‡
DEBUG


271 
	`¥ötf
("ch™√»%d '†sub_r_èûáddªs†i†%Œd\n", 
i
, 
ssd
->
ch™√l_hód
[i].
subs_r_èû
);

272 
	`¥ötf
("ch™√»%d '†sub_r_hódáddªs†i†%Œd\n", 
i
, 
ssd
->
ch™√l_hód
[i].
subs_r_hód
);

273 
	`¥ötf
("ch™√»%d '†sub_w_hódáddªs†i†%Œd\n", 
i
, 
ssd
->
ch™√l_hód
[i].
subs_w_hód
);

274 
	`¥ötf
("ch™√»%d '†sub_w_èûáddªs†i†%Œd\n", 
i
, 
ssd
->
ch™√l_hód
[i].
subs_w_èû
);

276 
j
 = 0; j < 
tmp_chù
; j++ ){

278 if(
ãmp_chù_ªad_queue_Àngth
[
i
][
j
] > 0){

317 if(
ãmp_chù_ªad_queue_Àngth
[
i
][
j
] !
ssd
->
ch™√l_hód
[i].
chù_hód
[j].
chù_ªad_queue_Àngth
) {

318 
	`¥ötf
("lxc,ªadÜígth i†wr⁄g hîe,ÇewÅem∞Àngth i†%d. wrôêö old chù i†%d \n",
ãmp_chù_ªad_queue_Àngth
[
i
][
j
], 
ssd
->
ch™√l_hód
[i].
chù_hód
[j].
chù_ªad_queue_Àngth
);

320 if(
ãmp_chù_wrôe_queue_Àngth
[
i
][
j
] !
ssd
->
ch™√l_hód
[i].
chù_hód
[j].
chù_wrôe_queue_Àngth
) {

323 
	`¥ötf
("lxc,wrôêÀngth i†wr⁄g hîe,ÇewÅem∞Àngth i†%d. wrôêö old chù i†%d \n",
ãmp_chù_wrôe_queue_Àngth
[
i
][
j
], 
ssd
->
ch™√l_hód
[i].
chù_hód
[j].
chù_wrôe_queue_Àngth
);

327 
	}
}

332 
	$judgög_ªad_ö_gc_chù
(
ssd_öfo
 *
ssd
, 
ch™√l
)

333 { 
tmp_chù
;

334 
gc_›î©i⁄
 *
gc_node
;

335 
sub_ªque°
 *
sub_f‹_ªad
 = 
NULL
;

336 if(
ssd
->
ch™√l_hód
[
ch™√l
].
gc_comm™d
 !
NULL
){

338 
tmp_chù
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
gc_comm™d
->
chù
;

339 
sub_f‹_ªad
 = 
ssd
->
ch™√l_hód
[
ch™√l
].
subs_r_hód
;

341 
sub_f‹_ªad
 !
NULL
){

342 i‡(
sub_f‹_ªad
->
loˇti⁄
->
chù
 =
tmp_chù
){

348 
sub_f‹_ªad
 = sub_f‹_ªad->
√xt_node
;

351 if(
sub_f‹_ªad
 =
NULL
){

357 
	}
}

361 
	$¥ötf_ssd_gc_node
(
ssd_öfo
 *
ssd
)

381 
	}
}

386 
	$¥ötf_ssd_ªque°_queue
(
ssd_öfo
 *
ssd
)

388 
ªque°
* 
ãmp_ªque°
;

389 
ãmp_num_ªque°
 = 
ssd
->
ªque°_queue_Àngth
;

390 if(
ãmp_num_ªque°
 == 0){

391 
	`¥ötf
("ssdÑequest_queue hasÇone\n");

393 
ãmp_ªque°
 = 
ssd
->
ªque°_queue
;

394 
	`¥ötf
("ssdÑeque°_queuê°©us:Ñeque°_Àngth i†%d,\n", 
ssd
->
ªque°_queue_Àngth
);

395 
ãmp_ªque°
 !
NULL
){

396 
	`¥ötf
("ssdÑeque°_queuê,Ü¢ : %d, sizê: %d, o≥øti⁄ :%d ***1ªad,0wrôe,com∂ëe_l¢_cou¡ :%d, di°ri_Êag :%d, begö_timê:%Œu\n",
ãmp_ªque°
->
l¢
,ãmp_ªque°->
size
,ãmp_ªque°->
›î©i⁄
,ãmp_ªque°->
com∂ëe_l¢_cou¡
,ãmp_ªque°->
di°ri_Êag
,ãmp_ªque°->
begö_time
);

397 if(
ãmp_ªque°
 =
ssd
->
ªque°_èû
){

400 
ãmp_ªque°
 =Åemp_ªque°->
√xt_node
;

405 
	}
}

408 
	$¥ötf_⁄e_ªque°_subªque°s
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñequest)

410 
ªque°
* 
ãmp_ªque°
 =Ñequest;

411 
sub_ªque°
* 
ãmp_sub
 = 
ªque°
->
subs
;

412 if(
ãmp_ªque°
 =
NULL
){

413 
	`¥ötf
("wrong inÖrintf_one_request_subrequests\n");

418 if(
ãmp_sub
 =
NULL
){

419 
	`¥ötf
("wrong inÖrintf_one_request_subrequests\n");

425 
ãmp_sub
 !
NULL
){

426 
	`¥ötf
("sub_ªque°áddªs†%Œd\n", 
ãmp_sub
);

427 
ãmp_sub
 =Åemp_sub->
√xt_subs
;

432 
	}
}

437 
	$¥ötf_m≠pögèbÀ_ªÀv™t_subªque°_ö_dif„ª¡_¥o˚ss
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
)

439 
ªque°
* 
ãmp_ªque°
;

446 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1)&&(‘eq->
tŸÆ_waô_evi˘
 =1))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =0))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 == 0) ){

447 
	`¥ötf
("%dÑeque°áddªs†%Œd, shouldÉvi˘ subªque°†¨ê:", 
ªq
->
›î©i⁄
,Ñeq);

448 
	`¥ötf_⁄e_ªque°_subªque°s
(
ssd
,
ªq
);

453 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1)&&(‘eq->
tŸÆ_waô_evi˘
 =1))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =1))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 == 0) ){

455 
	`¥ötf
("%dÑeque°áddªs†%Œd,á·îÉvi˘ög :", 
ªq
->
›î©i⁄
,Ñeq);

456 if(
ªq
->
subs
 =
NULL
){

457 
	`¥ötf
("OK,Çow finishedánd deletedÑequest'sÉvicting mappingÅable subrequests\n");

459 
	`¥ötf
("wrong inÖollingánd checkingÉvict finishing\n");

468 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1)&&(‘eq->
tŸÆ_waô_evi˘
 =0))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =0))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 == 0) ){

469 
	`¥ötf
("%dÑeque°áddªs†%Œd, fëchög m≠pögèbÀÑñev™àsubªque°†¨ê:", 
ªq
->
›î©i⁄
,Ñeq);

470 
	`¥ötf_⁄e_ªque°_subªque°s
(
ssd
,
ªq
);

478 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1)&&(‘eq->
tŸÆ_waô_evi˘
 =0))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =0))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 == 1) ){

483 
	`¥ötf
("%dÑeque°áddªs†%Œd,á·î föishög fëchög :", 
ªq
->
›î©i⁄
,Ñeq);

484 if(
ªq
->
subs
 =
NULL
){

485 
	`¥ötf
("OK,Çow finishedánd deletedÑequest'sÉvicting mappingÅable subrequests\n");

487 
	`¥ötf
("wrong inÖollingánd checking fetch finishing\n");

498 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =0)&&(‘eq->
tŸÆ_waô_evi˘
 =0))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =0))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 =0)&&Ñeq->
¸óã_‹_nŸyë_n‹mÆ_subªque°s
 == 0 ){

499 
	`¥ötf
("%dÑeque°áddªs†%Œd,a·î m≠pögèbÀ dólög,ÅhíÇ‹mÆ subªque°s: \n", 
ªq
->
›î©i⁄
,Ñeq);

500 
	`¥ötf_⁄e_ªque°_subªque°s
(
ssd
,
ªq
);

505 
	}
}

510 
	$¥ötfsub_ªque°_°©us
(
ssd_öfo
 *
ssd
)

571 
	}
}

671 
	$gë_size_‰om_com¥essi⁄_to_uncom¥essi⁄
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñequest)

673 
i
 = 0, 
size
 = 0, 
ãmp_Àn
, 
ãmp_Õn
;

674 
_bi_node
* 
ãmp_node
 ;

675 
ãmp_Àn
 = 
ªque°
->
com¥essi⁄_to_uncom¥essi⁄
->
Àn
;

676 
ãmp_node
 = 
ªque°
->
com¥essi⁄_to_uncom¥essi⁄
->
node_hód
;

677 
ãmp_Õn
 = 
ãmp_node
->
Õn_™d_°©e
[0];

678 if(
ãmp_Àn
 == 0){

681 
i
 = 0; i < 
ãmp_Àn
; i++){

683 if(
ãmp_node
 =
NULL
){

684 
	`ssdsim_msg
("wrong in get_size_from_compression_to_uncompression");

689 
size
 +
ssd
->
døm
->
mt
->
com¥essi⁄_size
[
ãmp_Õn
];

690 
ãmp_node
 =Åemp_node->
√xtNode
;

691 
ãmp_Õn
 = 
ãmp_node
->
Õn_™d_°©e
[0];

694  
size
;

696 
	}
}

701 
	$make_ªÆ_evi˘_∑ges_f‹_com¥essi⁄_∑π
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñeque°, 
should_evi˘_size
)

703 
buf„r_DFTL_exi°ög_void_size
;

704 
buf„r_group
* 
ãmp_èû
;

705 
ãmp_Õn
, 
ãmp_°©e
;

706 
ãmp_èû
 = 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
;

708 
should_evi˘_size
 > 0){

710 
ãmp_Õn
 = 
ãmp_èû
->
group
;

711 
ãmp_°©e
 = 
ãmp_èû
->
°‹ed
;

712 
	`≠≥nd_⁄_ªque°_evi˘_ö_DFTL_buf„r_Õn_d©a
(
ªque°
, 
ãmp_Õn
, 
ãmp_°©e
);

713 
should_evi˘_size
 -
ssd
->
døm
->
mt
->
com¥essi⁄_size
[
ãmp_Õn
];

714 
ãmp_èû
 =Åemp_èû->
LRU_lök_√xt
;

718 
	`≠≥nd_⁄_ªque°_evi˘_ö_DFTL_buf„r_Õn_d©a
(
ªque°
, 
ãmp_Õn
, 
ãmp_°©e
);

720 
	}
}

725 
	$gë_uncom¥essi⁄_èû_∑ge_com¥es£d_size
(
ssd_öfo
* 
ssd
, 
off_£t
)

727 
ãmp_Õn
, 
ãmp_dúty
, 
i
, 
ãmp_size
;

728 
buf„r_group
* 
ãmp_node
;

729 
ãmp_node
 = 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_èû
;

731 if(
off_£t
 == 0){

732 
ãmp_node
 = 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_èû
;

736 
ãmp_node
 = 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_èû
;

737 
i
 = 0; i < 
off_£t
; i++){

738 
ãmp_node
 =Åemp_node->
LRU_lök_¥e
;

742 
ãmp_Õn
 = 
ãmp_node
->
group
;

743 
ãmp_dúty
 = 
ssd
->
døm
->
mt
->
com¥essi⁄_dúty
[
ãmp_Õn
];

744 if(
ãmp_dúty
 == 1) {

746 
ãmp_size
 = 
ssd
->
døm
->
mt
->
com¥essi⁄_size
[
ãmp_Õn
];

753 
ãmp_size
 = 
ssd
->
døm
->
mt
->
com¥essi⁄_size
[
ãmp_Õn
];

755  
ãmp_size
;

757 
	}
}

762 
	$com¥essi⁄_com∑ª_DFTL_buf„r_ªmaödî_•a˚_wôh_com¥essi⁄_¨ó_comög
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñequest)

764 
_bi_li°
* 
bûi°
 = 
ªque°
->
missög_ö_DFTL_buf„r_Õn_d©a
;

765 
i
 = 0, 
evi˘_numbî
;

766 
buf„r_group
* 
ãmp_èû
;

767 
ãmp_Õn
, 
ãmp_°©e
;

768 
exi°ög_•a˚_öByã
 = (
ssd
->
døm
->
mt
->
max_ˇched_dú_¶Ÿs_sizeö_byã
Ë- (ssd->døm->mt->
now_ˇched_dú_¶Ÿs_sizeö_byã
);

769 
com¥essi⁄_to_uncom¥essi⁄_size
, 
uncom¥essi⁄_exi°ög_void_size
, 
uncom¥essi⁄_öcomög_∑ge_numbî
, 
¥edi˘i⁄_∑ge_size
, 
addög_size_ö_com¥essi⁄
, 
com¥essi⁄_∑π_exi°ög_void_size
, 
evi˘ög_∑gíumbî_‰om_uncom¥essi⁄_∑π
 , 
evi˘ög_size_‰om_uncom¥essi⁄_∑π
 ;

777 
com¥essi⁄_to_uncom¥essi⁄_size
 = 
	`gë_size_‰om_com¥essi⁄_to_uncom¥essi⁄
(
ssd
, 
ªque°
);

779 
uncom¥essi⁄_exi°ög_void_size
 = 
ssd
->
døm
->
mt
->
uncom¥essi⁄_max_ˇched_dú_¶Ÿs_sizeö_byã
 - ssd->døm->mt->
uncom¥essi⁄_now_ˇched_dú_¶Ÿs_sizeö_byã
;

780 
com¥essi⁄_∑π_exi°ög_void_size
 = 
ssd
->
døm
->
mt
->
max_ˇched_dú_¶Ÿs_sizeö_byã
 - ssd->døm->mt->
now_ˇched_dú_¶Ÿs_sizeö_byã
;

781 
uncom¥essi⁄_öcomög_∑ge_numbî
 = 
bûi°
->
Àn
 + 
ªque°
->
com¥essi⁄_to_uncom¥essi⁄
->len;

783 if(
uncom¥essi⁄_öcomög_∑ge_numbî
 != 0){

784 
evi˘ög_size_‰om_uncom¥essi⁄_∑π
 = 
uncom¥essi⁄_öcomög_∑ge_numbî
 * (
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
Ë- 
uncom¥essi⁄_exi°ög_void_size
;

787 if((
com¥essi⁄_to_uncom¥essi⁄_size
 > 0 )||(
evi˘ög_size_‰om_uncom¥essi⁄_∑π
 > 0)){

789 
ªque°
->
if_√ed_movemít_bëwìn_com_™d_uncom_Êag_™d_∑ge_numbîs
 = 
bûi°
->
Àn
 + (
evi˘ög_size_‰om_uncom¥essi⁄_∑π
 / 
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
);

790 
ªque°
->
the_numbî_of_evi˘ög_‰om_uncom_to_com
 = (
evi˘ög_size_‰om_uncom¥essi⁄_∑π
 / 
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
);

793 if(
evi˘ög_size_‰om_uncom¥essi⁄_∑π
 <= 0){

799 
evi˘ög_∑gíumbî_‰om_uncom¥essi⁄_∑π
 = 
evi˘ög_size_‰om_uncom¥essi⁄_∑π
 / 
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
;

800 if(
evi˘ög_size_‰om_uncom¥essi⁄_∑π
 % 
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
 != 0){

801 
	`ssdsim_msg
("wrong in getÉvicting_size_from_uncompression_part");

806 
i
 = 0; i < 
evi˘ög_∑gíumbî_‰om_uncom¥essi⁄_∑π
 ; i++){

808 
¥edi˘i⁄_∑ge_size
 +
	`gë_uncom¥essi⁄_èû_∑ge_com¥es£d_size
(
ssd
, 
i
);

812 if(
¥edi˘i⁄_∑ge_size
 < 
com¥essi⁄_to_uncom¥essi⁄_size
 ){

815 if((
¥edi˘i⁄_∑ge_size
 - 
com¥essi⁄_to_uncom¥essi⁄_size
Ë> 
com¥essi⁄_∑π_exi°ög_void_size
 ){

817 
	`make_ªÆ_evi˘_∑ges_f‹_com¥essi⁄_∑π
(
ssd
, 
ªque°
, (
¥edi˘i⁄_∑ge_size
-
com¥essi⁄_to_uncom¥essi⁄_size
 - 
com¥essi⁄_∑π_exi°ög_void_size
));

827 
	}
}

838 
	$com∑ª_DFTL_buf„r_ªmaödî_•a˚_wôh_missög_ö_DFTL_buf„r
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñequest)

840 
_bi_li°
* 
bûi°
 = 
ªque°
->
missög_ö_DFTL_buf„r_Õn_d©a
;

841 
i
 = 0, 
evi˘_numbî
;

842 
buf„r_group
* 
ãmp_èû
;

843 
ãmp_Õn
, 
ãmp_°©e
;

847 #ifde‡
TRANSLATION_PAGE_UNIT


848 
exi°ög_•a˚_öByã
 = (
ssd
->
døm
->
mt
->
max_ˇched_dú_¶Ÿs_sizeö_byã
Ë- (ssd->døm->mt->
now_ˇched_dú_¶Ÿs_sizeö_byã
);

852 
	`åa˚Tøn¶©i⁄buf„r_msg
("now, com∑rög DFTL_buf„∏sizêf‹Évi˘ög.Çow cached sizêi†%d,Éxi°ög_•a˚ sizêöByã i†%d", (
ssd
->
døm
->
mt
->
now_ˇched_dú_¶Ÿs_sizeö_byã
),
exi°ög_•a˚_öByã
);

858 
evi˘_numbî
 = (
bûi°
->
Àn
Ë- (
exi°ög_•a˚_öByã
 / 
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
) ;

859 if((
exi°ög_•a˚_öByã
 % 
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
) != 0){

860 
evi˘_numbî
 += 1;

863 if(
evi˘_numbî
 <= 0) {

864 
	`åa˚Tøn¶©i⁄buf„r_msg
("enough space,ÇoÉvict");

870 
	`åa˚Tøn¶©i⁄buf„r_msg
("needÉvictÅranslationÖageÇumber is:");

871 
ãmp_èû
 = 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
;

873 
i
 = 0; i < 
evi˘_numbî
; i++){

874 
ãmp_Õn
 = 
ãmp_èû
->
group
;

875 
ãmp_°©e
 = 
ãmp_èû
->
°‹ed
;

876 
	`≠≥nd_⁄_ªque°_evi˘_ö_DFTL_buf„r_Õn_d©a
(
ªque°
, 
ãmp_Õn
, 
ãmp_°©e
);

877 
ãmp_èû
 =Åemp_èû->
LRU_lök_¥e
;

879 
	`åa˚Tøn¶©i⁄buf„r_msg
("%d", 
ãmp_Õn
);

889 #ifde‡
ENTRY_UNIT


893 
i
 = 0;

894 
buf„r_group
* 
ãmp_èû
;

895 
ãmp_Õn
, 
ãmp_°©e
;

896 
evi˘_numbî
 = (
bûi°
->
Àn
Ë- (((
ssd
->
døm
->
mt
->
max_ˇched_íåõs_sizeö_byã
Ë- (ssd->døm->mt->
now_ˇched_íåõs_sizeö_byã
)Ë/ ssd->døm->mt->
m≠pög_íåy_size
) ;

900 
	`åa˚E¡rybuf„r_msg
("now, com∑rög DFTL_buf„∏sizêf‹Évi˘ög.Çow cached sizêi†%d,Éxi°ög_•a˚ sizêöByã i†%d", (
ssd
->
døm
->
mt
->
now_ˇched_íåõs_sizeö_byã
), ((ssd->døm->mt->
max_ˇched_íåõs_sizeö_byã
) - (ssd->dram->mt->now_cached_entries_sizein_byte)));

902 if(
evi˘_numbî
 <= 0) {

903 
	`åa˚E¡rybuf„r_msg
("enough space,ÇoÉvict");

904 
ªåun
 1;

909 
	`åa˚E¡rybuf„r_msg
("nowÉvict,ÉntriesÜpnáre :");

910 
ãmp_èû
 = 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
;

912 
i
 = 0; i < 
evi˘_numbî
; i++){

913 
ãmp_Õn
 = 
ãmp_èû
->
group
;

914 
ãmp_°‹ed
 = 
ãmp_èû
->
°‹ed
;

915 
	`≠≥nd_⁄_ªque°_evi˘_ö_DFTL_buf„r_Õn_d©a
(
ªque°
, 
ãmp_Õn
, 
ãmp_°‹ed
);

916 
ãmp_èû
 =Åemp_èû->
¥evNode
;

920 
	`åa˚E¡rybuf„r_msg
("%d", 
ãmp_Õn
);

929 
	}
}

941 
	$gë_å™¶©i⁄_numbî_by_d©a_Õn
(
d©a_Õn
)

943 
ãmp_å™¶©i⁄_∑ge
 = 
d©a_Õn
 / 
NUM_ENTRIES_PER_DIR
;

944  
ãmp_å™¶©i⁄_∑ge
;

946 
	}
}

950 
buf„r_group
* 
	$node_i¢Ÿ_ö_two_DIFF_DFTL_buf„r
(
ssd_öfo
* 
ssd
, 
Õn
, * 
sign
)

953 
ãmp_å™¶©i⁄_∑ge
 = -1;

954 
buf„r_group
* 
buf„r_node
, 
key
;

955 
ãmp_å™¶©i⁄_∑ge
 = 
	`gë_å™¶©i⁄_numbî_by_d©a_Õn
(
Õn
);

957 
key
.
group
 = 
ãmp_å™¶©i⁄_∑ge
;

958 
buf„r_node
 = (
buf„r_group
 *Ë
	`avlTªeFöd
(
ssd
->
døm
->
mt
->
buf„r_DFTL
,

959 (
TREE_NODE
 *Ë&
key
);

960 if(
buf„r_node
 =
NULL
){

963 
buf„r_node
 = (
buf„r_group
 *Ë
	`avlTªeFöd
(
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
,

964 (
TREE_NODE
 *Ë&
key
);

965 if(
buf„r_node
 =
NULL
){

967  
buf„r_node
;

969 *
sign
 = 2;

970  
buf„r_node
;

974 *
sign
 = 1;

975  
buf„r_node
;

977 
	}
}

981 
buf„r_group
* 
	$node_i¢Ÿ_ö_DFTL_buf„r
(
ssd_öfo
* 
ssd
, 
Õn
)

985 #ifde‡
TRANSLATION_PAGE_UNIT


986 
ãmp_å™¶©i⁄_∑ge
 = -1;

987 
buf„r_group
* 
buf„r_node
, 
key
;

988 
ãmp_å™¶©i⁄_∑ge
 = 
	`gë_å™¶©i⁄_numbî_by_d©a_Õn
(
Õn
);

990 
key
.
group
 = 
ãmp_å™¶©i⁄_∑ge
;

991 
buf„r_node
 = (
buf„r_group
 *Ë
	`avlTªeFöd
(
ssd
->
døm
->
mt
->
buf„r_DFTL
,

992 (
TREE_NODE
 *Ë&
key
);

993  
buf„r_node
;

997 #ifde‡
ENTRY_UNIT


998 
buf„r_group
 
key
;

1000 
key
.
group
 = 
Õn
;

1001 
buf„r_node
 = (
buf„r_group
 *Ë
	`avlTªeFöd
(
ssd
->
døm
->
mt
->
buf„r_DFTL
,

1002 (
TREE_NODE
 *Ë&
key
);

1005  
buf„r_node
;

1010 
	}
}

1014 
	$If_hôInBUf„r_move_theNode_ahód_ö_wrôîeque°
(
ssd_öfo
* 
ssd
,
buf„r_öfo
* 
buf„r
, 
buf„r_group
* 
buf„r_node
)

1016 if(
buf„r
 =
ssd
->
døm
->
mt
->
buf„r_DFTL
){

1017 i‡(
buf„r
->
buf„r_hód
 !
buf„r_node
) {

1018 i‡(
buf„r
->
buf„r_èû
 =
buf„r_node
) {

1019 
buf„r
->
buf„r_èû
 = 
buf„r_node
->
LRU_lök_¥e
;

1020 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = 
NULL
;

1021 } i‡(
buf„r_node
 !
buf„r
->
buf„r_hód
) {

1022 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = buffer_node->LRU_link_next;

1023 
buf„r_node
->
LRU_lök_√xt
->
LRU_lök_¥e
 = buffer_node->LRU_link_pre;

1025 
buf„r_node
->
LRU_lök_√xt
 = 
buf„r
->
buf„r_hód
;

1026 
buf„r
->
buf„r_hód
->
LRU_lök_¥e
 = 
buf„r_node
;

1027 
buf„r_node
->
LRU_lök_¥e
 = 
NULL
;

1028 
buf„r
->
buf„r_hód
 = 
buf„r_node
;

1032 if(
buf„r
 =
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
){

1033 i‡(
buf„r
->
buf„r_hód
 !
buf„r_node
) {

1034 i‡(
buf„r
->
buf„r_èû
 =
buf„r_node
) {

1035 
buf„r
->
buf„r_èû
 = 
buf„r_node
->
LRU_lök_¥e
;

1036 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = 
NULL
;

1037 } i‡(
buf„r_node
 !
buf„r
->
buf„r_hód
) {

1038 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = buffer_node->LRU_link_next;

1039 
buf„r_node
->
LRU_lök_√xt
->
LRU_lök_¥e
 = buffer_node->LRU_link_pre;

1041 
buf„r_node
->
LRU_lök_√xt
 = 
buf„r
->
buf„r_hód
;

1042 
buf„r
->
buf„r_hód
->
LRU_lök_¥e
 = 
buf„r_node
;

1043 
buf„r_node
->
LRU_lök_¥e
 = 
NULL
;

1044 
buf„r
->
buf„r_hód
 = 
buf„r_node
;

1050 
buf„r
->
wrôe_hô
++;

1052 
	}
}

1061 
	$If_hôInBUf„r_move_theNode_ahód_ö_ªadªque°
(
ssd_öfo
* 
ssd
, 
buf„r_öfo
* 
buf„r
, 
buf„r_group
* 
buf„r_node
)

1064 if(
buf„r
 =
ssd
->
døm
->
mt
->
buf„r_DFTL
){

1065 i‡(
buf„r
->
buf„r_hód
 !
buf„r_node
) {

1066 i‡(
buf„r
->
buf„r_èû
 =
buf„r_node
) {

1067 
buf„r
->
buf„r_èû
 = 
buf„r_node
->
LRU_lök_¥e
;

1068 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = 
NULL
;

1069 } i‡(
buf„r_node
 !
buf„r
->
buf„r_hód
) {

1070 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = buffer_node->LRU_link_next;

1071 
buf„r_node
->
LRU_lök_√xt
->
LRU_lök_¥e
 = buffer_node->LRU_link_pre;

1073 
buf„r_node
->
LRU_lök_√xt
 = 
buf„r
->
buf„r_hód
;

1074 
buf„r
->
buf„r_hód
->
LRU_lök_¥e
 = 
buf„r_node
;

1075 
buf„r_node
->
LRU_lök_¥e
 = 
NULL
;

1076 
buf„r
->
buf„r_hód
 = 
buf„r_node
;

1080 if(
buf„r
 =
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
){

1081 i‡(
buf„r
->
buf„r_hód
 !
buf„r_node
) {

1082 i‡(
buf„r
->
buf„r_èû
 =
buf„r_node
) {

1083 
buf„r
->
buf„r_èû
 = 
buf„r_node
->
LRU_lök_¥e
;

1084 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = 
NULL
;

1085 } i‡(
buf„r_node
 !
buf„r
->
buf„r_hód
) {

1086 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = buffer_node->LRU_link_next;

1087 
buf„r_node
->
LRU_lök_√xt
->
LRU_lök_¥e
 = buffer_node->LRU_link_pre;

1089 
buf„r_node
->
LRU_lök_√xt
 = 
buf„r
->
buf„r_hód
;

1090 
buf„r
->
buf„r_hód
->
LRU_lök_¥e
 = 
buf„r_node
;

1091 
buf„r_node
->
LRU_lök_¥e
 = 
NULL
;

1092 
buf„r
->
buf„r_hód
 = 
buf„r_node
;

1098 
buf„r
->
ªad_hô
++;

1100 
	}
}

1105 
	$COMPRESSION_ªad_vÆue_ªque°_DFTL_∑ømëîs
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
)

1107 
i
 = 0;

1108 * 
sign
 = 
NULL
;

1109 
_bi_node
* 
ãmp_node
 = 
NULL
;

1110 
_bi_node
* 
ãmp_node1
 = 
NULL
;

1111 
_bi_li°
* 
ãmp_li°
 = 
NULL
;

1112 
ãmp_node_Õn
 = -1;

1113 
ãmp_node_°©e
 = -1;

1114 
buf„r_group
* 
buf„r_node
 = 
NULL
;

1118 
√ed_di°b_Êag
 = 0, 
l¢
, 
Õn
,
œ°_Õn
, 
fú°_Õn
, 
ödex
;

1119 
l¢
 = 
ªq
->lsn;

1120 
Õn
 = 
ªq
->
l¢
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

1121 
œ°_Õn
 = (
ªq
->
l¢
 +Ñeq->
size
 - 1Ë/ 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

1122 
fú°_Õn
 = 
ªq
->
l¢
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

1129 if(
ªq
->
›î©i⁄
 != 1){

1130 
	`¥ötf
("logicalÉrror\n");

1137 if(*(
ªq
->
√ed_di°r_Êag
) == 0){

1139 
ªq
->
tŸÆ_waô_evi˘
 = 0;

1140 
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 = 0;

1141 
ªq
->
¸óã_‹_nŸyë_evi˘_subªque°s
 = 0;

1142 
ªq
->
¸óã_‹_nŸyë_„tch_subªque°s
 = 0;

1143 
ªq
->
¸óã_‹_nŸyë_n‹mÆ_subªque°s
 = 1;

1147 
Õn
 <
œ°_Õn
){

1149 * 
ãmp
;

1150 
ödex
 = (
Õn
 - 
fú°_Õn
Ë/ (32 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
);

1153 
√ed_di°b_Êag
 = 
ªq
->
√ed_di°r_Êag
[
ödex
] & ( (0x0000000‡<< ( ((
Õn
 - 
fú°_Õn
Ë%(32 /
ssd
->
∑ømëî
->
sub∑ge_∑ge
)) * ssd->parameter->subpage_page) ));

1154 if(
√ed_di°b_Êag
 != 0){

1162 
	`≠≥nd_⁄_ªque°_missög_ö_d©a_buf„r_Õn_d©a
–
ªq
, 
Õn
, 
√ed_di°b_Êag
);

1166 
Õn
++;

1171 
ãmp_li°
 = 
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
;

1172 
ãmp_node
 = 
ãmp_li°
->
node_èû
;

1174 if(
ãmp_li°
->
Àn
 != 0){

1176 
i
 = 0; i < 
ãmp_li°
->
Àn
; i++){

1178 
ãmp_node_Õn
 = 
ãmp_node
->
Õn_™d_°©e
[0];

1179 
ãmp_node_°©e
 = 
ãmp_node
->
Õn_™d_°©e
[1];

1181 
buf„r_node
 = 
	`node_i¢Ÿ_ö_two_DIFF_DFTL_buf„r
(
ssd
, 
ãmp_node_Õn
, 
sign
);

1183 if(
buf„r_node
 =
NULL
){

1184 
	`≠≥nd_⁄_ªque°_missög_ö_DFTL_buf„r_Õn_d©a
(
ªq
, 
ãmp_node_Õn
, 
ãmp_node_°©e
);

1187 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
ªad_miss_hô
 ++;

1191 if(*
sign
 == 1){

1193 
	`If_hôInBUf„r_move_theNode_ahód_ö_ªadªque°
(
ssd
, ssd->
døm
->
mt
->
buf„r_DFTL
, 
buf„r_node
);

1196 
	`≠≥nd_⁄_ªque°_com¥essi⁄_to_uncom¥essi⁄_Õn_d©a
–
ªq
, 
ãmp_node_Õn
, 
ãmp_node_°©e
);

1199 if(*
sign
 != 2){

1200 
	`ssdsim_msg
("wrong in valueÑeadÑequestÖarameter");

1206 
	`If_hôInBUf„r_move_theNode_ahód_ö_ªadªque°
(
ssd
, ssd->
døm
->
mt
->
buf„r_DFTL_UNCOM
, 
buf„r_node
);

1208 
ªq
->
hô_ö_uncom¥essi⁄_buf„r_numbî
 ++;

1215 if(
ãmp_node
 =
NULL
){

1216 
	`¥ötf
("bi_list wrong inÑead_value_request_DFTL_parameters, missing_in_data_buffer_lpnÑead wrong,Åhen stop\n");

1224 
ãmp_node
 =Åemp_node->
¥evNode
;

1231 
	`ssdsim_msg
("here will beÇever happen in CMPRESSION_read_value_request_DFTL_parameters");

1239 
ãmp_li°
 = 
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
;

1240 
ãmp_node
 = 
ãmp_li°
->
node_hód
;

1243 
	`com¥essi⁄_com∑ª_DFTL_buf„r_ªmaödî_•a˚_wôh_com¥essi⁄_¨ó_comög
(
ssd
, 
ªq
);

1251 if(
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
->
Àn
 != 0){

1253 
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 = 1;

1254 
ssd
->
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
 = 1;

1257 if(
ªq
->
should_evi˘_Õn_d©a
->
Àn
 != 0){

1258 
ªq
->
tŸÆ_waô_evi˘
 = 1;

1261 
ªq
->
¸óã_‹_nŸyë_evi˘_subªque°s
 = 0;

1262 
ªq
->
¸óã_‹_nŸyë_„tch_subªque°s
 = 0;

1268 
	}
}

1273 
	$ªad_vÆue_ªque°_DFTL_∑ømëîs
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
)

1275 
i
 = 0, 
j
 = 0, 
k
 = 0;

1277 
_bi_node
* 
ãmp_node
 = 
NULL
;

1278 
_bi_node
* 
ãmp_node1
 = 
NULL
;

1279 
_bi_li°
* 
ãmp_li°
 = 
NULL
;

1280 
ãmp_node_Õn
 = -1;

1281 
ãmp_node_°©e
 = -1;

1282 
buf„r_group
* 
buf„r_node
 = 
NULL
;

1286 
√ed_di°b_Êag
 = 0, 
l¢
, 
œ°_Õn
, 
fú°_Õn
, 
ödex
;

1288 
°¨t
, 
íd
, 
fú°_l¢
, 
œ°_l¢
, 
Õn
, 
Êag
 = 0, 
Êag_©èched
 = 0, 
fuŒ_∑ge
;

1289 
sub_size
;

1290 
sub_ªque°
 *
sub
;

1291 *
com∂t
;

1293 
fuŒ_∑ge
 = ~(0xfffffff‡<< 
ssd
->
∑ømëî
->
sub∑ge_∑ge
);

1306 if(
ªq
->
›î©i⁄
 != 1){

1307 
	`¥ötf
("logicalÉrror\n");

1357 
	`ssdsim_msg
("1 i¿ªad vÆuêªque°ê∑ømëîs,Ñeq->l¢ %d", 
ªq
->
l¢
);

1358 i‡(
ªq
 !
NULL
) {

1359 i‡(
ªq
->
di°ri_Êag
 == 0) {

1361 i‡(
ªq
->
com∂ëe_l¢_cou¡
 !
ssd
->
ªque°_èû
->
size
) {

1363 
	`ssdsim_msg
("2 i¿ªad vÆuêªque°ê∑ømëîs,Ñeq->l¢ %d", 
ªq
->
l¢
);

1364 
fú°_l¢
 = 
ªq
->
l¢
;

1365 
œ°_l¢
 = 
fú°_l¢
 + 
ªq
->
size
;

1366 
com∂t
 = 
ªq
->
√ed_di°r_Êag
;

1367 
°¨t
 = 
fú°_l¢
 - fú°_l¢ % 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

1368 
íd
 = (
œ°_l¢
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 + 1) * ssd->parameter->subpage_page;

1369 
i
 = (
íd
 - 
°¨t
) / 32;

1375 
i
 >= 0) {

1382 
j
 = 0; j < 32 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
; j++) {

1383 
k
 = (
com∂t
[((
íd
 - 
°¨t
Ë/ 32 - 
i
)] >> (
ssd
->
∑ømëî
->
sub∑ge_∑ge
 * 
j
)Ë& 
fuŒ_∑ge
;

1385 
	`ssdsim_msg
("0áµíd o¿missög i¿d©a_buf„∏k i†%d", 
k
);

1386 i‡(
k
 != 0) {

1387 
Õn
 = 
°¨t
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 +

1388 ((
íd
 - 
°¨t
Ë/ 32 - 
i
Ë* 32 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 + 
j
;

1390 
	`ssdsim_msg
("1áµíd o¿missög i¿d©a_buf„∏Õ¿i†%d", 
Õn
);

1391 
sub_size
 = 
	`å™s„r_size
(
ssd
, 
k
, 
Õn
, 
ªq
);

1393 
	`ssdsim_msg
("sub_sizêi†%d", 
sub_size
);

1394 i‡(
sub_size
 == 0) {

1399 
	`≠≥nd_⁄_ªque°_missög_ö_d©a_buf„r_Õn_d©a
–
ªq
, 
Õn
, 15);

1400 
	`ssdsim_msg
("2áµíd o¿missög i¿d©a_buf„∏Õ¿i†%d", 
Õn
);

1405 
i
 = i - 1;

1418 
ªq
->
ª•⁄£_time
 = 
ssd
->
cuºít_time
 + 1000;

1419 
ªq
->
tŸÆ_waô_evi˘
 = 0;

1420 
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 = 0;

1421 
ªq
->
¸óã_‹_nŸyë_evi˘_subªque°s
 = 0;

1422 
ªq
->
¸óã_‹_nŸyë_„tch_subªque°s
 = 0;

1423 
ªq
->
¸óã_‹_nŸyë_„tch_subªque°s
 = 0;

1424 
ªq
->
¸óã_‹_nŸyë_n‹mÆ_subªque°s
 = 1;

1425 
	`ssdsim_msg
("ªq %Œd ha†bì¿£àthê¸óã_‹_nŸyë_n‹mÆ sig¿%d", 
ªq
,Ñeq->
¸óã_‹_nŸyë_n‹mÆ_subªque°s
);

1437 
ãmp_li°
 = 
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
;

1438 
ãmp_node
 = 
ãmp_li°
->
node_èû
;

1439 
	`ssdsim_msg
("ªadÑeque°áddªs†%Œd,Ü¢ %d,Üígth i¿missög d©®buf„∏i†%d,", 
ªq
,Ñeq->
l¢
, 
ãmp_li°
->
Àn
);

1441 if(
ãmp_li°
->
Àn
 != 0){

1442 
i
 = 0; i < 
ãmp_li°
->
Àn
; i++){

1444 
ãmp_node_Õn
 = 
ãmp_node
->
Õn_™d_°©e
[0];

1445 
ãmp_node_°©e
 = 
ãmp_node
->
Õn_™d_°©e
[1];

1447 
buf„r_node
 = 
	`node_i¢Ÿ_ö_DFTL_buf„r
(
ssd
, 
ãmp_node_Õn
);

1449 if(
buf„r_node
 =
NULL
){

1450 #ifde‡
SET_INTO_LIMITTED_BUFFER


1451 
	`≠≥nd_⁄_ªque°_missög_ö_DFTL_buf„r_Õn_d©a
(
ªq
, 
ãmp_node_Õn
, 
ãmp_node_°©e
);

1454 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
ªad_miss_hô
 ++;

1458 #ifde‡
SET_INTO_LIMITTED_BUFFER


1460 
	`If_hôInBUf„r_move_theNode_ahód_ö_ªadªque°
(
ssd
, ssd->
døm
->
mt
->
buf„r_DFTL
, 
buf„r_node
);

1462 
	`åa˚E¡rybuf„r_msg
("ªadÑeque° hôtög, ssd ju° movêôÅÿhódî,É¡ryÜ≤ i†%d", 
buf„r_node
->
group
);

1463 
	`åa˚Tøn¶©i⁄buf„r_msg
("ªadÑeque° hôtög,ssd ju° movêôÅÿthêhódî, vÆuênumbî i†%d ", 
buf„r_node
->
group
);

1465 if(
buf„r_node
 !
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
){

1467 
	`ssdsim_msg
("wrôêªque° movögÅhênode'†vÆuê%dÅÿDFTL_buf„∏hód∏i†wr⁄g ", 
buf„r_node
->
group
);

1475 if(
ãmp_node
 =
NULL
){

1476 
	`¥ötf
("readÑeqeust bi_list wrong inÑead_value_request_DFTL_parameters, missing_in_data_buffer_lpnÑead wrong,Åhen stop\n");

1484 
ãmp_node
 =Åemp_node->
¥evNode
;

1502 
ãmp_li°
 = 
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
;

1503 
ãmp_node
 = 
ãmp_li°
->
node_hód
;

1505 if(
ãmp_li°
->
Àn
 != 0){

1522 
	`com∑ª_DFTL_buf„r_ªmaödî_•a˚_wôh_missög_ö_DFTL_buf„r
(
ssd
, 
ªq
);

1528 if(
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
->
Àn
 != 0){

1530 
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 = 1;

1531 
ssd
->
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
 = 1;

1534 if(
ªq
->
should_evi˘_Õn_d©a
->
Àn
 != 0){

1535 
ªq
->
tŸÆ_waô_evi˘
 = 1;

1538 
ªq
->
¸óã_‹_nŸyë_evi˘_subªque°s
 = 0;

1539 
ªq
->
¸óã_‹_nŸyë_„tch_subªque°s
 = 0;

1547 if(
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
->
Àn
 == 0){

1548 if–(
ªq
->
tŸÆ_waô_evi˘
 !0Ë|| (Ñeq->
tŸÆ_waô_„tch_m≠pögèbÀ
 !0Ë|| (
ssd
->
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
 != 0) ){

1549 
	`ssdsim_msg
("1 wrong inÑead valueÑequest DFTL ");

1557 if(
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
->
Àn
 == 0){

1558 if–(
ªq
->
tŸÆ_waô_evi˘
 !0Ë|| (Ñeq->
tŸÆ_waô_„tch_m≠pögèbÀ
 !0Ë|| (
ssd
->
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
 != 0) ){

1559 
	`ssdsim_msg
("2 wrong inÑead valueÑequest DFTL ");

1566 if(
ªq
->
should_evi˘_Õn_d©a
->
Àn
 == 0){

1567 if(
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
->
Àn
 != 0){

1568 if–(
ªq
->
tŸÆ_waô_evi˘
 !0Ë|| (
ssd
->
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
 == 0) ){

1569 
	`ssdsim_msg
("3 wrong inÑead valueÑequest DFTL ");

1577 
	`ssdsim_msg
("finishÑead valueÖarameters check");

1579 
	`ssdsim_msg
("bef‹êoutsidêªadÑeque°áddªs†%Œd,Ü¢ %d,Üígth i¿missög d©®buf„∏i†%d,", 
ªq
,Ñeq->
l¢
,Ñeq->
missög_ö_d©a_buf„r_Õn_d©a
->
Àn
);

1580 
	}
}

1584 
	$COMPRESSION_wrôe_vÆue_ªque°_DFTL_∑ømëîs
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
)

1587 
i
 = 0;

1588 * 
sign
 = 
NULL
;

1589 
_bi_node
* 
ãmp_node
 = 
NULL
;

1590 
_bi_node
* 
ãmp_node1
 = 
NULL
;

1591 
_bi_li°
* 
ãmp_li°
 = 
NULL
;

1592 
ãmp_node_Õn
 = -1;

1593 
ãmp_node_°©e
 = -1;

1594 
buf„r_group
* 
buf„r_node
 = 
NULL
;

1596 if(
ªq
->
›î©i⁄
 != 0){

1597 
	`¥ötf
("logicalÉrror\n");

1605 
ãmp_li°
 = 
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
;

1607 
ãmp_node
 = 
ãmp_li°
->
node_èû
;

1609 if(
ãmp_li°
->
Àn
 == 0){

1610 
ªq
->
tŸÆ_waô_evi˘
 = 0;

1611 
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 = 0;

1612 
ªq
->
¸óã_‹_nŸyë_evi˘_subªque°s
 = 0;

1613 
ªq
->
¸óã_‹_nŸyë_„tch_subªque°s
 = 0;

1614 
ªq
->
¸óã_‹_nŸyë_n‹mÆ_subªque°s
 = 1;

1622 if(
ãmp_li°
->
Àn
 != 0){

1624 
i
 = 0; i < 
ãmp_li°
->
Àn
; i++){

1626 
ãmp_node_Õn
 = 
ãmp_node
->
Õn_™d_°©e
[0];

1627 
ãmp_node_°©e
 = 
ãmp_node
->
Õn_™d_°©e
[1];

1629 
buf„r_node
 = 
	`node_i¢Ÿ_ö_two_DIFF_DFTL_buf„r
(
ssd
, 
ãmp_node_Õn
, 
sign
);

1631 if(
buf„r_node
 =
NULL
){

1632 
	`≠≥nd_⁄_ªque°_missög_ö_DFTL_buf„r_Õn_d©a
(
ªq
, 
ãmp_node_Õn
, 
ãmp_node_°©e
);

1635 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
wrôe_miss_hô
 ++;

1639 if(*
sign
 == 1){

1641 
	`If_hôInBUf„r_move_theNode_ahód_ö_wrôîeque°
(
ssd
, ssd->
døm
->
mt
->
buf„r_DFTL
, 
buf„r_node
);

1644 
	`≠≥nd_⁄_ªque°_com¥essi⁄_to_uncom¥essi⁄_Õn_d©a
–
ªq
, 
ãmp_node_Õn
, 
ãmp_node_°©e
);

1647 if(*
sign
 != 2){

1648 
	`ssdsim_msg
("wrong in valueÑeadÑequestÖarameter");

1654 
	`If_hôInBUf„r_move_theNode_ahód_ö_wrôîeque°
(
ssd
, ssd->
døm
->
mt
->
buf„r_DFTL_UNCOM
, 
buf„r_node
);

1656 
ªq
->
hô_ö_uncom¥essi⁄_buf„r_numbî
 ++;

1663 if(
ãmp_node
 =
NULL
){

1664 
	`¥ötf
("bi_list wrong inÑead_value_request_DFTL_parameters, missing_in_data_buffer_lpnÑead wrong,Åhen stop\n");

1672 
ãmp_node
 =Åemp_node->
¥evNode
;

1680 
ãmp_li°
 = 
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
;

1681 
ãmp_node
 = 
ãmp_li°
->
node_hód
;

1684 
	`com¥essi⁄_com∑ª_DFTL_buf„r_ªmaödî_•a˚_wôh_com¥essi⁄_¨ó_comög
(
ssd
, 
ªq
);

1692 if(
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
->
Àn
 != 0){

1694 
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 = 1;

1695 
ssd
->
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
 = 1;

1698 if(
ªq
->
should_evi˘_Õn_d©a
->
Àn
 != 0){

1699 
ªq
->
tŸÆ_waô_evi˘
 = 1;

1702 
ªq
->
¸óã_‹_nŸyë_evi˘_subªque°s
 = 0;

1703 
ªq
->
¸óã_‹_nŸyë_„tch_subªque°s
 = 0;

1710 
	}
}

1712 
	$wrôe_vÆue_ªque°_DFTL_∑ømëîs
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
)

1716 
i
 = 0;

1718 
_bi_node
* 
ãmp_node
 = 
NULL
;

1719 
_bi_node
* 
ãmp_node1
 = 
NULL
;

1720 
_bi_li°
* 
ãmp_li°
 = 
NULL
;

1721 
ãmp_node_Õn
 = -1;

1722 
ãmp_node_°©e
 = -1;

1724 
buf„r_group
* 
buf„r_node
 = 
NULL
;

1726 if(
ªq
->
›î©i⁄
 != 0){

1727 
	`¥ötf
("logicalÉrror\n");

1734 
ãmp_li°
 = 
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
;

1736 
ãmp_node
 = 
ãmp_li°
->
node_hód
;

1738 if(
ãmp_li°
->
Àn
 == 0){

1739 
ªq
->
tŸÆ_waô_evi˘
 = 0;

1740 
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 = 0;

1741 
ªq
->
¸óã_‹_nŸyë_evi˘_subªque°s
 = 0;

1742 
ªq
->
¸óã_‹_nŸyë_„tch_subªque°s
 = 0;

1743 
ªq
->
¸óã_‹_nŸyë_n‹mÆ_subªque°s
 = 1;

1750 
	`ssdsim_msg
("wrôêªque°áddªs†%Œd,Ü¢ %d,Üígth i¿missög d©®buf„∏i†%d,", 
ªq
,Ñeq->
l¢
, 
ãmp_li°
->
Àn
);

1752 if(
ãmp_li°
->
Àn
 != 0){

1754 
i
 = 0; i < 
ãmp_li°
->
Àn
; i++){

1756 
ãmp_node_Õn
 = 
ãmp_node
->
Õn_™d_°©e
[0];

1757 
ãmp_node_°©e
 = 
ãmp_node
->
Õn_™d_°©e
[1];

1758 
buf„r_node
 = 
	`node_i¢Ÿ_ö_DFTL_buf„r
(
ssd
, 
ãmp_node_Õn
);

1761 if(
buf„r_node
 =
NULL
){

1763 #ifde‡
SET_INTO_LIMITTED_BUFFER


1764 
	`≠≥nd_⁄_ªque°_missög_ö_DFTL_buf„r_Õn_d©a
(
ªq
, 
ãmp_node_Õn
, 
ãmp_node_°©e
);

1767 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
wrôe_miss_hô
 ++;

1771 #ifde‡
SET_INTO_LIMITTED_BUFFER


1773 
	`If_hôInBUf„r_move_theNode_ahód_ö_wrôîeque°
(
ssd
, ssd->
døm
->
mt
->
buf„r_DFTL
, 
buf„r_node
);

1774 
	`åa˚E¡rybuf„r_msg
("wrôêªque° hôtög, ssd ju° movêôÅÿhódî,É¡ryÜ≤ i†%d", 
buf„r_node
->
group
);

1775 
	`åa˚Tøn¶©i⁄buf„r_msg
("wrôêªque° hôtög,ssd ju° movêôÅÿthêhódî, vÆuênumbî i†%d ", 
buf„r_node
->
group
);

1777 if(
buf„r_node
 !
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
){

1779 
	`ssdsim_msg
("wrôêªque° movögÅhênode'†vÆuê%dÅÿDFTL_buf„∏hód∏i†wr⁄g ", 
buf„r_node
->
group
);

1789 if(
ãmp_node
 =
NULL
){

1790 
	`¥ötf
("writeÑequest bi_list wrong inÑead_value_request_DFTL_parameters, missing_in_data_buffer_lpnÑead wrong,Åhen stop\n");

1796 
ãmp_node
 =Åemp_node->
√xtNode
;

1799 if(
ãmp_node
 !
NULL
){

1800 
	`¥ötf
("bi_list wrong inÑead_value_request_DFTL_parameters,Åhen stop\n");

1809 
	`ssdsim_msg
("here will beÇever happen in write_value_request_DFTL_parameters");

1818 
ãmp_li°
 = 
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
;

1819 
ãmp_node
 = 
ãmp_li°
->
node_hód
;

1821 if(
ãmp_li°
->
Àn
 != 0){

1838 
	`com∑ª_DFTL_buf„r_ªmaödî_•a˚_wôh_missög_ö_DFTL_buf„r
(
ssd
, 
ªq
);

1844 if(
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
->
Àn
 != 0){

1846 
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 = 1;

1847 
ssd
->
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
 = 1;

1850 if(
ªq
->
should_evi˘_Õn_d©a
->
Àn
 != 0){

1851 
ªq
->
tŸÆ_waô_evi˘
 = 1;

1854 
ªq
->
¸óã_‹_nŸyë_evi˘_subªque°s
 = 0;

1855 
ªq
->
¸óã_‹_nŸyë_„tch_subªque°s
 = 0;

1860 if(
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
->
Àn
 == 0){

1861 if–(
ªq
->
tŸÆ_waô_evi˘
 !0Ë|| (Ñeq->
tŸÆ_waô_„tch_m≠pögèbÀ
 !0Ë|| (
ssd
->
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
 != 0) ){

1862 
	`ssdsim_msg
("1 wrong in write valueÑequest DFTL ");

1870 if(
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
->
Àn
 == 0){

1871 if–(
ªq
->
tŸÆ_waô_evi˘
 !0Ë|| (Ñeq->
tŸÆ_waô_„tch_m≠pögèbÀ
 !0Ë|| (
ssd
->
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
 != 0) ){

1872 
	`ssdsim_msg
("2 wrong in write valueÑequest DFTL ");

1879 if(
ªq
->
should_evi˘_Õn_d©a
->
Àn
 == 0){

1880 if(
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
->
Àn
 != 0){

1881 if–(
ªq
->
tŸÆ_waô_evi˘
 !0Ë|| (
ssd
->
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
 == 0) ){

1882 
	`ssdsim_msg
("3 wrong in write valueÑequest DFTL ");

1894 
	}
}

1899 
	$¥ötf_ªque°s_basic_∑ømãrs_vÆue
 (
ssd_öfo
* 
ssd
,
ªque°
* 
√w_ªque°
)

1901 
i
, 
Àn
;

1902 
_bi_node
* 
ãmp_node
 = 
NULL
;

1903 
_bi_li°
* 
ãmp_li°
 = 
NULL
;

1904 
	`¥ötf
("after getállÅheÑequestÖarameters value\n");

1907 
	`¥ötf
("/*************whether missing_in_data_buffer_lpn_dataÖart************/\n");

1908 
ãmp_li°
 = 
√w_ªque°
->
missög_ö_d©a_buf„r_Õn_d©a
;

1909 
ãmp_node
 = 
ãmp_li°
->
node_hód
;

1911 if(
ãmp_li°
->
Àn
 != 0){

1913 
	`¥ötf
("%dÑeque°ádªss: %Œd, ha†nÿhô,ÇohôÇumbî i†%d\n", 
√w_ªque°
->
›î©i⁄
,Çew_ªque°, 
ãmp_li°
->
Àn
);

1914 
i
 = 0; i < 
ãmp_li°
->
Àn
; i ++){

1915 
	`¥ötf
("%d ",
ãmp_node
->
Õn_™d_°©e
[0]);

1916 if(
ãmp_node
 =
NULL
){

1917 
	`¥ötf
("wrong inÖrintf_requests_basic_paramters_value \n");

1923 
ãmp_node
 =Åemp_node->
√xtNode
;

1925 
	`¥ötf
("\n");

1927 
	`¥ötf
("%dÑeque°ádªss: %Œd,Çÿmissög i¿d©a_buf„r\n",
√w_ªque°
->
›î©i⁄
,Çew_request);

1933 
	`¥ötf
("/*************whether missing_in_DFTL_buffer_lpn_data************/\n");

1935 
ãmp_li°
 = 
√w_ªque°
->
missög_ö_DFTL_buf„r_Õn_d©a
;

1936 
ãmp_node
 = 
ãmp_li°
->
node_hód
;

1938 if(
ãmp_li°
->
Àn
 != 0){

1940 
	`¥ötf
("%dÑeque°ádªss: %Œd, ha†nÿhô,ÇohôÇumbî i†%d\n",
√w_ªque°
->
›î©i⁄
,Çew_ªque°, 
ãmp_li°
->
Àn
);

1941 
i
 = 0; i < 
ãmp_li°
->
Àn
; i ++){

1942 
	`¥ötf
("%d ",
ãmp_node
->
Õn_™d_°©e
[0]);

1943 if(
ãmp_node
 =
NULL
){

1944 
	`¥ötf
("wrong inÖrintf_requests_basic_paramters_value \n");

1950 
ãmp_node
 =Åemp_node->
√xtNode
;

1952 
	`¥ötf
("\n");

1954 
	`¥ötf
("%dÑeque°ádªss: %Œd,Çÿmissög i¿DFTL_buf„r\n",
√w_ªque°
->
›î©i⁄
,Çew_request);

1960 
	`¥ötf
("/*************whether should_evict_lpn_data*************/\n");

1962 
ãmp_li°
 = 
√w_ªque°
->
should_evi˘_Õn_d©a
;

1963 
ãmp_node
 = 
ãmp_li°
->
node_hód
;

1965 if(
ãmp_li°
->
Àn
 != 0){

1967 
	`¥ötf
("%dÑeque°ádªss: %Œd, ha†nÿhô,ÇohôÇumbî i†%d\n",
√w_ªque°
->
›î©i⁄
,Çew_ªque°, 
ãmp_li°
->
Àn
);

1968 
i
 = 0; i < 
ãmp_li°
->
Àn
; i ++){

1969 
	`¥ötf
("%d ",
ãmp_node
->
Õn_™d_°©e
[0]);

1970 if(
ãmp_node
 =
NULL
){

1971 
	`¥ötf
("printf_requests_basic_paramters_value \n");

1977 
ãmp_node
 =Åemp_node->
√xtNode
;

1979 
	`¥ötf
("\n");

1981 
	`¥ötf
("%dÑeque°ádªss: %Œd,Çÿevi˘Ü≤ should dÿö DFTL buf„r\n",
√w_ªque°
->
›î©i⁄
,Çew_request);

1985 
	}
}

1992 
ssd_öfo
* 
	$vÆue_ªque°_DFTL_∑ømëîs_f‹_di°ribuã_subªque°s
(
ssd_öfo
* 
ssd
)

1994 
ªque°
* 
ªq
;

1995 
sub_ªque°
* 
sub
;

1996 
ªq
 = 
ssd
->
ªque°_èû
;

1998 if(
ªq
 =
NULL
){

1999 
	`¥ötf
("nowÇoányÑequest in ssd\n");

2007 if(
ªq
->
›î©i⁄
 =
READ
 ){

2009 #ifde‡
COMPRESSION_MAPPING


2010 
	`COMPRESSION_ªad_vÆue_ªque°_DFTL_∑ømëîs
(
ssd
, 
ªq
);

2012 
	`ªad_vÆue_ªque°_DFTL_∑ømëîs
(
ssd
, 
ªq
);

2016 
	`ssdsim_msg
("outsidêªadÑeque°áddªs†%Œd,Ü¢ %d,Üígth i¿missög d©®buf„∏i†%d,", 
ªq
,Ñeq->
l¢
,Ñeq->
missög_ö_d©a_buf„r_Õn_d©a
->
Àn
);

2017 #ifde‡
com¥essi⁄_ªÀv™t


2018 
	`¥ötf_ªque°s_basic_∑ømãrs_vÆue
(
ssd
, 
ªq
);

2023 #ifde‡
COMPRESSION_MAPPING


2024 
	`COMPRESSION_wrôe_vÆue_ªque°_DFTL_∑ømëîs
(
ssd
, 
ªq
);

2026 
	`wrôe_vÆue_ªque°_DFTL_∑ømëîs
(
ssd
, 
ªq
);

2029 #ifde‡
com¥essi⁄_ªÀv™t


2030 
	`¥ötf_ªque°s_basic_∑ømãrs_vÆue
(
ssd
, 
ªq
);

2035  
ssd
;

2038 
	}
}

2043 
	$dñëe_subs_ö_this_ªq
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
)

2046 
sub_ªque°
 * 
ãmp_sub
 = 
NULL
, *
ãmp_sub1
 = NULL;

2047 
i
 = 0, 
j
0, 
k
 = 0;

2051 * 
ãmp_¨ø
 = (*)
	`mÆloc
(()*
i
);

2052 * 
ãmp_¨ø1
 = (*)
	`mÆloc
(()*
i
);

2054 
bef‹e_com¥essi⁄_size
 = 
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
;

2055 * 
å™¶©i⁄_∑ge_d©a_bef‹e_com¥essi⁄
 = (*Ë
	`mÆloc
 (()* 
NUM_ENTRIES_PER_DIR
);

2056 * 
å™¶©i⁄_∑ge_d©a_a·î_com¥essi⁄
 = (*Ë
	`mÆloc
 (()* 
NUM_ENTRIES_PER_DIR
);

2057 
	`mem£t
(
å™¶©i⁄_∑ge_d©a_bef‹e_com¥essi⁄
 , 0, ()* 
NUM_ENTRIES_PER_DIR
 );

2058 
	`mem£t
(
å™¶©i⁄_∑ge_d©a_a·î_com¥essi⁄
 , 0, ()* 
NUM_ENTRIES_PER_DIR
 );

2062 #ifde‡
COMPRESSION_MAPPING


2063 if(
ªq
->
›î©i⁄
 == 0){

2064 if(
ªq
->
subs
 !
NULL
){

2065 if(
ªq
->
subs
->
waô_„tch_m≠pögèbÀ_sign
 != 1){

2067 
ãmp_sub
 = 
ªq
->
subs
;

2068 
ãmp_sub
 !
NULL
){

2070 
i
++;

2071 
ãmp_sub
 =Åemp_sub->
√xt_subs
;

2076 
ãmp_sub
 = 
ªq
->
subs
;

2077 
j
 = 0; j < 
i
; j++){

2078 
ãmp_¨ø
[
j
] = 
ãmp_sub
->
Õn
;

2079 
ãmp_sub
 =Åemp_sub->
√xt_subs
;

2083 if(
i
 > 0){

2084 
ãmp_¨ø1
[0] = 
ãmp_¨ø
[0] / 
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
;

2086 if(
i
 > 1){

2087 
j
 = 0; j < 
i
; j++){

2088 
ãmp_vÆue
 = 
ãmp_¨ø
[
j
] / 
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
;

2089 
Êag
 = 0;

2091 
k
 = 0; k < 
j
; k++){

2092 if(
ãmp_vÆue
 =
ãmp_¨ø
[
k
]/ 
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
){

2093 
Êag
 = 1;

2097 if(
Êag
 == 1){

2098 
ãmp_¨ø1
[
j
] = -1;

2102 
ãmp_¨ø1
[
j
] = 
ãmp_¨ø
[j] /
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
;

2112 
j
 = 0; j < 
i
; j ++){

2113 if(
ãmp_¨ø1
[
j
] != -1){

2114 * 
å™¶©i⁄_∑ge_d©a_bef‹e_com¥essi⁄
;

2116 
k
 = 0; k < 
NUM_ENTRIES_PER_DIR
; k ++){

2117 *(
å™¶©i⁄_∑ge_d©a_bef‹e_com¥essi⁄
 + (
NUM_ENTRIES_PER_DIR
 * 
i
 + 
j
)Ë
ssd
->
døm
->
m≠
->
m≠_íåy
[(NUM_ENTRIES_PER_DIR * i + j)].
≤
;

2119 
ssd
->
døm
->
mt
->
com¥essi⁄_size
[
ãmp_¨ø1
[
j
]] = 
	`xm©chCom¥ess
((*)
å™¶©i⁄_∑ge_d©a_bef‹e_com¥essi⁄
, 
bef‹e_com¥essi⁄_size
, (*)
å™¶©i⁄_∑ge_d©a_a·î_com¥essi⁄
);

2124 
	`‰ì
(
ãmp_¨ø
);

2125 
	`‰ì
(
ãmp_¨ø1
);

2126 
	`‰ì
(
å™¶©i⁄_∑ge_d©a_bef‹e_com¥essi⁄
);

2127 
	`‰ì
(
å™¶©i⁄_∑ge_d©a_a·î_com¥essi⁄
);

2131 
ãmp_sub
 = 
ªq
->
subs
;

2132 
i
 = 0;

2133 
ãmp_sub
 !
NULL
){

2134 
ãmp_sub1
 = 
ãmp_sub
->
√xt_subs
;

2136 if(
ãmp_sub
->
upd©e
 !
NULL
){

2137 
	`‰ì
(
ãmp_sub
->
upd©e
->
loˇti⁄
);

2138 
ãmp_sub
->
upd©e
->
loˇti⁄
 = 
NULL
;

2139 
	`‰ì
(
ãmp_sub
->
upd©e
);

2140 
ãmp_sub
->
upd©e
 = 
NULL
;

2142 
	`‰ì
(
ãmp_sub
->
loˇti⁄
);

2143 
ãmp_sub
->
loˇti⁄
 = 
NULL
;

2144 
	`‰ì
(
ãmp_sub
);

2145 
ãmp_sub
 = 
NULL
;

2146 
ãmp_sub
 = 
ãmp_sub1
;

2148 
i
++;

2150 
ªq
->
subs
 = 
NULL
;

2151 
	`åa˚Eº‹_msg
("now, föishÅhêdñëög o‡ªq->sub†%Œd", 
ªq
->
subs
);

2152  
i
;

2153 
	}
}

2158 
	$dñëe_subs_bûi°_ö_this_ªq
(
ªque°
* 
ªq
, 
_bi_li°
* 
«me
)

2160 
numbî
 = 0;

2161 
numbî
 = (
«me
)->
Àn
;

2162 if(–
«me
)->
Àn
 != 0){

2163 
	`dñ_bi_li°
(
«me
);

2169 
	`åa˚Eº‹_msg
("now föishÅhêdñëög o‡subbûi° %Œd,Üí i†0?", 
ªq
);

2170  
numbî
;

2172 
	`ssdsim_msg
("wrong in deletingÅhe subs_bilist");

2177 
	}
}

2184 
	$dñëe_„tch_subªque°_‰om_this_ªq
(
ssd_öfo
* 
ssd
)

2186 
subs_numbî1
 = 0;

2187 
subs_numbî2
 = 0;

2188 
ªque°
 *
ªq
;

2189 
sub_ªque°
 *
sub
 = 
NULL
;

2190 
sub_ªque°
 * 
ãmp_sub
 = 
NULL
;

2191 
ªq
 = 
ssd
->
ªque°_èû
;

2192 if(
ªq
 =
NULL
){

2193 
	`ssdsim_msg
("wrong inÑunning delete_fetch_subrequest_from_this_req");

2198 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1)&&(‘eq->
tŸÆ_waô_evi˘
 =0))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =0))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 == 1) ){

2201 
subs_numbî1
 = 
	`dñëe_subs_ö_this_ªq
(
ssd
, 
ªq
);

2204 
subs_numbî2
 = 
	`dñëe_subs_bûi°_ö_this_ªq
(
ªq
,ªq->
missög_ö_DFTL_buf„r_Õn_d©a
);

2205 
	`‰ì
(
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
);

2206 
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
 = 
NULL
;

2208 if(
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
 !
NULL
){

2209 
	`¥ötf
("nowáfter deleting, wrong in deleting missing\n");

2216 if(
subs_numbî1
 !
subs_numbî2
){

2217 
	`ssdsim_msg
("wrong in deletingÅhe subs");

2223  
subs_numbî1
;

2224 
	}
}

2232 
	$dñëe_evi˘_subªque°_‰om_this_ªq
(
ssd_öfo
* 
ssd
)

2234 
subs_numbî1
 = 0;

2235 
subs_numbî2
 = 0;

2236 
ªque°
 *
ªq
;

2237 
sub_ªque°
 *
sub
 = 
NULL
;

2238 
sub_ªque°
 * 
ãmp_sub
 = 
NULL
;

2239 
ªq
 = 
ssd
->
ªque°_èû
;

2240 if(
ªq
 =
NULL
){

2241 
	`ssdsim_msg
("wrong inÑunning");

2246 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1)&&(‘eq->
tŸÆ_waô_evi˘
 =1))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =1))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 == 0) ){

2249 
subs_numbî1
 = 
	`dñëe_subs_ö_this_ªq
(
ssd
, 
ªq
);

2252 
subs_numbî2
 = 
	`dñëe_subs_bûi°_ö_this_ªq
(
ªq
,ªq->
should_evi˘_Õn_d©a
);

2253 
	`‰ì
(
ªq
->
should_evi˘_Õn_d©a
);

2254 
ªq
->
should_evi˘_Õn_d©a
 = 
NULL
;

2255 if(
ªq
->
should_evi˘_Õn_d©a
 !
NULL
){

2256 
	`¥ötf
("nowáfter deleting, wrong in deleting shouldÉvict \n");

2262 if(
subs_numbî1
 !
subs_numbî2
){

2263 
	`ssdsim_msg
("wrong in deletingÅhe subs");

2269  
subs_numbî1
;

2270 
	}
}

2273 
	$pﬁlög_whëhî_föish_evi˘_subªque°s
(
ssd_öfo
* 
ssd
)

2275 
ªque°
 *
ªq
;

2276 
sub_ªque°
 *
sub
;

2277 
ãmp_föish_Êag
 = 1;

2278 
ªq
 = 
ssd
->
ªque°_èû
;

2279 if(
ªq
 =
NULL
){

2280 
	`ssdsim_msg
("wrong inÑunning");

2285 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1)&&(‘eq->
tŸÆ_waô_evi˘
 =1))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =1))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 == 0) ){

2286 
sub
 = 
ªq
->
subs
;

2287 
sub
 !
NULL
){

2288 if–(
sub
->
waô_evi˘_sign_föished
 =0)&&(sub->
waô_evi˘_sign
 == 1)){

2289 
ãmp_föish_Êag
 = 0;

2292 
sub
 = sub->
√xt_subs
;

2295 if(
ãmp_föish_Êag
 == 1){

2296 
	`ssdsim_msg
("polling_polling_whether_finish_evict_subrequests finished!!can goÇext step");

2298  
ãmp_föish_Êag
;

2302 
	`ssdsim_msg
("wrong inÖolling_whether_finish_evict_subrequestsÑunning");

2307 
	}
}

2312 
	$pﬁlög_whëhî_föish_„tch_subªque°s
(
ssd_öfo
* 
ssd
)

2314 
ªque°
 *
ªq
;

2315 
sub_ªque°
 *
sub
;

2316 
ãmp_föish_Êag
 = 1, 
i
;

2317 
ªq
 = 
ssd
->
ªque°_èû
;

2318 if(
ªq
 =
NULL
){

2319 
	`ssdsim_msg
("wrong inÑunningÖolling_whether_finish_fetch");

2326 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1)&&(‘eq->
tŸÆ_waô_evi˘
 =0))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =0))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 == 1) ){

2328 
sub
 = 
ªq
->
subs
;

2329 
i
 = 0; i < 
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
->
Àn
; i++){

2331 if–(
sub
->
waô_„tch_m≠pögèbÀ_sign_föished
 =0)&&(sub->
waô_„tch_m≠pögèbÀ_sign
 == 1)){

2332 
ãmp_föish_Êag
 = 0;

2335 if(
sub
 =
NULL
){

2336 
	`ssdsim_msg
("wrong inÑunningÖolling_whether_finish_fetch");

2342 
sub
 = sub->
√xt_subs
;

2345 if(
ãmp_föish_Êag
 == 1){

2346 
	`ssdsim_msg
("polling_whether_finish_fetch_subrequests finished!!can goÇext step");

2348  
ãmp_föish_Êag
;

2352 
	`ssdsim_msg
("wrong inÖolling_whether_finish_evict_subrequestsÑunning");

2357 
	}
}

2362 
ssd_öfo
* 
	$¸óã_„tch_m≠pögèbÀ_subªque°s
(
ssd_öfo
* 
ssd
)

2365 
ªque°
 *
ªq
;

2366 
sub_ªque°
 *
sub
;

2367 
ãmp_i
 = 0;

2368 
ªq
 = 
ssd
->
ªque°_èû
;

2369 
_bi_node
* 
ãmp_node
 = 
NULL
;

2370 
_bi_li°
* 
ãmp_bûi°
 = 
NULL
;

2371 if(
ªq
 =
NULL
){

2372 
	`ssdsim_msg
("wrong inÑunning in fetch_mappingtable");

2376 if(
ªq
->
subs
 !
NULL
){

2377 
	`ssdsim_msg
("req subs should be NULL before fetching mappingtable");

2382 if(
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
->
Àn
 == 0){

2383 
	`ssdsim_msg
(" wrong inÑunning missing_in_DFTL_buffer_lpn_data");

2390 #ifde‡
TRANSLATION_PAGE_UNIT


2392 
ãmp_bûi°
 = 
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
;

2393 
ãmp_node
 = 
ãmp_bûi°
->
node_hód
;

2395 
ãmp_i
 = 0;Åemp_ò< 
ãmp_bûi°
->
Àn
;Åemp_i++){

2398 
	`¸ót_sub_ªque°
(
ssd
,
ãmp_node
->
Õn_™d_°©e
[0],4, 0xf, 
ªq
, 
MAPPINGTABLE_READ
);

2399 
ãmp_node
 =Åemp_node->
√xtNode
;

2410 #ifde‡
ENTRY_UNIT


2412 
ãmp_bûi°
 = 
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
;

2413 
ãmp_node
 = 
ãmp_bûi°
->
node_hód
;

2415 * 
ãmp_ouçut_¨øy
 = (*)
	`mÆloc
(()*(
ãmp_bûi°
->
Àn
));

2416 
	`mem£t
(
ãmp_ouçut_¨øy
, -1, (()*
ãmp_bûi°
->
Àn
) );

2418 
	`gë_no_ª≥©_∑ges_numbî_‰om_Õns
(
ssd
, 
ªq
, 
ãmp_bûi°
, 
ãmp_ouçut_¨øy
);

2422 
ãmp_i
 = 0;Åemp_ò< 
ãmp_bûi°
->
Àn
;Åemp_i++){

2425 if(
ãmp_out_¨øy
[
ãmp_i
] != -1){

2426 
	`¸ót_sub_ªque°
(
ssd
, 
ãmp_out_¨øy
[
ãmp_i
], 4, 0xf, 
ªq
, 
MAPPINGTABLE_READ
);

2438 
	}
}

2444 
	$¸óã_n‹mÆ_subªque°s
(
ssd_öfo
* 
ssd
)

2446 
ªque°
* 
ªq
;

2447 
ªq
 = 
ssd
->
ªque°_èû
;

2450 
_bi_node
* 
ãmp_node
 = 
NULL
;

2451 
_bi_li°
* 
ãmp_li°
 = 
NULL
;

2452 
i
 = 0;

2454 if(
ªq
->
subs
 !
NULL
){

2455 
	`ssdsim_msg
("ªqáddªs†%Œd, sub†addªs†%Œd, sub†should bêNULL bef‹ê¸ótögÇ‹mÆ subªque°,ÇŸ m≠pögèbÀÖages", 
ªq
,Ñeq->
subs
);

2461 
	`åa˚Eº‹_msg
("nowÑeque° %ŒdÑe•⁄£_timê%Œd", 
ªq
,Ñeq->
ª•⁄£_time
);

2462 if(
ªq
->
ª•⁄£_time
 == 0){

2464 if(
ªq
->
›î©i⁄
 =
READ
){

2466 
	`di°ribuã
(
ssd
);

2470 if–(
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
)->
Àn
 != 0){

2471 
ãmp_li°
 = 
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
;

2472 
ãmp_node
 = 
ãmp_li°
->
node_hód
;

2473 
i
 = 0; i < 
ãmp_li°
->
Àn
; i++){

2474 
	`¸ót_sub_ªque°
(
ssd
, 
ãmp_node
->
Õn_™d_°©e
[0], 
	`size
—emp_node->Õn_™d_°©e[1]),Åemp_node->Õn_™d_°©e[1], 
ªq
, 
WRITE
);

2475 if(
ãmp_node
 =
NULL
){

2476 
	`ssdsim_msg
("wrong in create_normal_subrequests");

2480 
ãmp_node
 =Åemp_node->
√xtNode
;

2486 
	`åa˚Eº‹_msg
("nowÑeque° %Œd sîvi˚d i¿d©abuf„∏dúe˘ly", 
ªq
);

2490 
	}
}

2495 
	$gë_no_ª≥©_∑ges_numbî_‰om_Õns
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
,
_bi_li°
* 
ãmp_bûi°
, * 
öput
)

2497 
_bi_node
 * 
ãmp_sub
 = 
NULL
, *
ãmp_sub1
 = NULL;

2498 
i
 = 0, 
j
0, 
k
 = 0;

2500 
i
 = 
ãmp_bûi°
->
Àn
;

2501 * 
ãmp_¨ø
 = (*)
	`mÆloc
(()*
i
);

2502 * 
ãmp_¨ø1
 = (*)
	`mÆloc
(()*
i
);

2504 
ãmp_sub
 = 
ãmp_bûi°
->
node_hód
;

2506 
j
 = 0; j < 
i
; j++){

2507 
ãmp_¨ø
[
j
] = 
ãmp_sub
->
Õn_™d_°©e
[0];

2508 
ãmp_sub
 =Åemp_sub->
√xtNode
;

2511 
öput
[0] = 
ãmp_¨ø
[0] /
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
;

2512 if(
ãmp_bûi°
->
Àn
 > 1){

2513 
j
 = 1; j < 
i
; j++){

2514 
ãmp_vÆue
 = 
ãmp_¨ø
[
j
] /
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
;

2515 
Êag
 = 0;

2517 
k
 = 0; k < 
j
; k++){

2518 if(
ãmp_vÆue
 =
ãmp_¨ø
[
k
]/
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
){

2519 
Êag
 = 1;

2523 if(
Êag
 == 1){

2525 
öput
[
j
] = -1;

2530 
öput
[
j
] = 
ãmp_¨ø
[j] /
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
;

2534 
	}
}

2540 
ssd_öfo
* 
	$¸óã_evi˘_m≠pögèbÀ_subªque°s
(
ssd_öfo
* 
ssd
)

2543 
ªque°
 *
ªq
;

2544 
sub_ªque°
 *
sub
;

2545 
ãmp_i
 = 0;

2546 
ªq
 = 
ssd
->
ªque°_èû
;

2547 
_bi_node
* 
ãmp_node
 = 
NULL
;

2548 
_bi_li°
* 
ãmp_bûi°
 = 
NULL
;

2549 if(
ªq
 =
NULL
){

2550 
	`ssdsim_msg
("wrong inÑunningÉvict_mappingtable");

2554 if(
ªq
->
should_evi˘_Õn_d©a
->
Àn
 == 0){

2555 
	`ssdsim_msg
("2 wrong inÑunningÉvict_mappingtable");

2564 #ifde‡
TRANSLATION_PAGE_UNIT


2566 
ãmp_bûi°
 = 
ªq
->
should_evi˘_Õn_d©a
;

2567 
ãmp_node
 = 
ãmp_bûi°
->
node_hód
;

2569 
ãmp_i
 = 0;Åemp_ò< 
ãmp_bûi°
->
Àn
;Åemp_i++){

2572 
	`¸ót_sub_ªque°
(
ssd
,
ãmp_node
->
Õn_™d_°©e
[0],4, 0xf, 
ªq
, 
MAPPINGTABLE_WRITE
);

2573 
ãmp_node
 =Åemp_node->
√xtNode
;

2584 #ifde‡
ENTRY_UNIT


2587 
ãmp_bûi°
 = 
ªq
->
should_evi˘_Õn_d©a
;

2588 
ãmp_node
 = 
ãmp_bûi°
->
node_hód
;

2589 * 
ãmp_ouçut_¨øy
 = (*)
	`mÆloc
(()*(
ãmp_bûi°
->
Àn
));

2590 
	`mem£t
(
ãmp_ouçut_¨øy
, -1, (()*
ãmp_bûi°
->
Àn
) );

2592 
	`gë_no_ª≥©_∑ges_numbî_‰om_Õns
(
ssd
, 
ªq
, 
ãmp_bûi°
, 
ãmp_ouçut_¨øy
);

2596 
ãmp_i
 = 0;Åemp_ò< 
ãmp_bûi°
->
Àn
;Åemp_i++){

2599 if(
ãmp_out_¨øy
[
ãmp_i
] != -1){

2600 
	`¸ót_sub_ªque°
(
ssd
, 
ãmp_out_¨øy
[
ãmp_i
], 4, 0xf, 
ªq
, 
MAPPINGTABLE_WRITE
);

2606 
	}
}

2610 
	$gë_ªÆsize_öbyã_byposôi⁄_ö_mt
(
ssd_öfo
* 
ssd
, 
Õn
)

2613 
size
 = 0;

2615 #ifde‡
ENTRY_UNIT


2616  
ssd
->
døm
->
mt
->
m≠pög_íåy_size
;

2621 #ifde‡
TRANSLATION_PAGE_UNIT


2624 #ifde‡
COMPRESSION_MAPPING


2627 
size
 = 
ssd
->
døm
->
mt
->
com¥essi⁄_size
[
Õn
];

2629  
size
;

2633  
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
;

2640 
	}
}

2645 
	$ö£π2DFTL_UNCOM_buf„r
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
)

2648 
buf„r_group
 *
buf„r_node
 = 
NULL
, *
±
, *
√w_node
 = NULL, 
key
;

2649 
_bi_node
* 
ãmp_node
 = 
NULL
;

2650 
_bi_li°
* 
ãmp_bûi°
 = 
NULL
;

2651 
i
;

2652 
ãmp_bûi°
 = 
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
;

2653 
ãmp_node
 = 
ãmp_bûi°
->
node_hód
;

2655 if(
ãmp_bûi°
->
Àn
 == 0){

2656 
	`ssdsim_msg
("noány inserted subrequest, why do insert2DFTL_buffer");

2662 #ifde‡
TRANSLATION_PAGE_UNIT


2663 
i
 = 0; i < 
ãmp_bûi°
->
Àn
; i ++){

2669 
√w_node
 = 
NULL
;

2670 
√w_node
 = (
buf„r_group
 *Ë
	`mÆloc
((buffer_group));

2671 
	`Æloc_as£π
(
√w_node
, "buffer_group_node");

2672 
	`mem£t
(
√w_node
, 0, (
buf„r_group
));

2674 
√w_node
->
group
 = 
ãmp_node
->
Õn_™d_°©e
[0];

2675 
√w_node
->
°‹ed
 = 
ãmp_node
->
Õn_™d_°©e
[1];

2676 
√w_node
->
dúty_˛ón
 = 
ãmp_node
->
Õn_™d_°©e
[1];

2677 
√w_node
->
LRU_lök_¥e
 = 
NULL
;

2678 
√w_node
->
LRU_lök_√xt
 = 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_hód
;

2679 i‡(
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_hód
 !
NULL
) {

2680 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_hód
->
LRU_lök_¥e
 = 
√w_node
;

2682 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_èû
 = 
√w_node
;

2684 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_hód
 = 
√w_node
;

2685 
√w_node
->
LRU_lök_¥e
 = 
NULL
;

2687 
	`avlTªeAdd
(
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
, (
TREE_NODE
 *Ë
√w_node
);

2691 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_£˘‹_cou¡
 += 1 ;

2692 
ssd
->
døm
->
mt
->
uncom¥essi⁄_now_ˇched_dú_¶Ÿs_sizeö_byã
 +ssd->
∑ømëî
->
∑ge_ˇ∑côy
;

2695 
ãmp_node
 =Åemp_node->
√xtNode
;

2701 
	}
}

2712 
	$ö£π2DFTL_buf„r
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
)

2715 
buf„r_group
 *
buf„r_node
 = 
NULL
, *
±
, *
√w_node
 = NULL, 
key
;

2716 
_bi_node
* 
ãmp_node
 = 
NULL
;

2717 
_bi_li°
* 
ãmp_bûi°
 = 
NULL
;

2718 
i
;

2719 
ãmp_bûi°
 = 
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
;

2720 
ãmp_node
 = 
ãmp_bûi°
->
node_hód
;

2722 if(
ãmp_bûi°
->
Àn
 == 0){

2723 
	`ssdsim_msg
("noány inserted subrequest, why do insert2DFTL_buffer");

2729 #ifde‡
TRANSLATION_PAGE_UNIT


2730 
i
 = 0; i < 
ãmp_bûi°
->
Àn
; i ++){

2736 
√w_node
 = 
NULL
;

2737 
√w_node
 = (
buf„r_group
 *Ë
	`mÆloc
((buffer_group));

2738 
	`Æloc_as£π
(
√w_node
, "buffer_group_node");

2739 
	`mem£t
(
√w_node
, 0, (
buf„r_group
));

2741 
√w_node
->
group
 = 
ãmp_node
->
Õn_™d_°©e
[0];

2742 
√w_node
->
°‹ed
 = 
ãmp_node
->
Õn_™d_°©e
[1];

2743 
√w_node
->
dúty_˛ón
 = 
ãmp_node
->
Õn_™d_°©e
[1];

2744 
√w_node
->
LRU_lök_¥e
 = 
NULL
;

2745 
√w_node
->
LRU_lök_√xt
 = 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
;

2746 i‡(
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
 !
NULL
) {

2747 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
->
LRU_lök_¥e
 = 
√w_node
;

2749 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
 = 
√w_node
;

2751 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
 = 
√w_node
;

2752 
√w_node
->
LRU_lök_¥e
 = 
NULL
;

2754 
	`avlTªeAdd
(
ssd
->
døm
->
mt
->
buf„r_DFTL
, (
TREE_NODE
 *Ë
√w_node
);

2758 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_£˘‹_cou¡
 += 1 ;

2759 
ssd
->
døm
->
mt
->
now_ˇched_dú_¶Ÿs_sizeö_byã
 +
	`gë_ªÆsize_öbyã_byposôi⁄_ö_mt
(ssd,
ãmp_node
->
Õn_™d_°©e
[0]);

2762 
	`åa˚Tøn¶©i⁄buf„r_msg
("å™¶©i⁄Öagêsizê⁄˚áddög sizêi†%d,Çow cached sizêi†%d,áŒ i¿byã", 
	`gë_ªÆsize_öbyã_byposôi⁄_ö_mt
(
ssd
,
ãmp_node
->
Õn_™d_°©e
[0]Ë, ssd->
døm
->
mt
->
now_ˇched_dú_¶Ÿs_sizeö_byã
 );

2766 
ãmp_node
 =Åemp_node->
√xtNode
;

2769  
ãmp_bûi°
->
Àn
;

2773 #ifde‡
ENTRY_UNIT


2775 
i
 = 0; i < 
ãmp_bûi°
->
Àn
; i ++){

2781 
√w_node
 = 
NULL
;

2782 
√w_node
 = (
buf„r_group
 *Ë
	`mÆloc
((buffer_group));

2783 
	`Æloc_as£π
(
√w_node
, "buffer_group_node");

2784 
	`mem£t
(
√w_node
, 0, (
buf„r_group
));

2786 
√w_node
->
group
 = 
ãmp_node
->
Õn_™d_°©e
[0];

2787 
√w_node
->
°‹ed
 = 
ãmp_node
->
Õn_™d_°©e
[1];

2788 
√w_node
->
dúty_˛ón
 = 
ãmp_node
->
Õn_™d_°©e
[1];

2789 
√w_node
->
LRU_lök_¥e
 = 
NULL
;

2790 
√w_node
->
LRU_lök_√xt
 = 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
;

2791 i‡(
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
 !
NULL
) {

2792 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
->
LRU_lök_¥e
 = 
√w_node
;

2794 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
 = 
√w_node
;

2796 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
 = 
√w_node
;

2797 
√w_node
->
LRU_lök_¥e
 = 
NULL
;

2799 
	`avlTªeAdd
(
ssd
->
døm
->
mt
->
buf„r_DFTL
, (
TREE_NODE
 *Ë
√w_node
);

2803 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_£˘‹_cou¡
 += 1 ;

2804 
ssd
->
døm
->
mt
->
now_ˇched_íåõs_sizeö_byã
 +
	`gë_ªÆsize_öbyã_byposôi⁄_ö_mt
(ssd,
ãmp_node
->
Õn_™d_°©e
[0]);

2807 
	`åa˚Tøn¶©i⁄buf„r_msg
("íåy sizê⁄˚áddög sizêi†%d,Çow cached sizêi†%d,áŒ i¿byã",
	`gë_ªÆsize_öbyã_byposôi⁄_ö_mt
(
ssd
,
ãmp_node
->
Õn_™d_°©e
[0]), ssd->
døm
->
mt
->
now_ˇched_íåõs_sizeö_byã
);

2810 
ãmp_node
 =Åemp_node->
√xtNode
;

2814  
ãmp_bûi°
->
Àn
;

2818 
	}
}

2823 
	$P›_DFTL_buf„r
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
)

2827 
buf„r_group
 *
buf„r_node
 = 
NULL
, *
±
, *
√w_node
 = NULL, 
key
;

2828 
_bi_node
* 
ãmp_node
 = 
NULL
;

2829 
_bi_li°
* 
ãmp_bûi°
 = 
NULL
;

2830 
i
;

2831 
ãmp_bûi°
 = 
ªq
->
should_evi˘_Õn_d©a
;

2832 
ãmp_node
 = 
ãmp_bûi°
->
node_hód
;

2834 if(
ãmp_bûi°
->
Àn
 == 0){

2835 
	`ssdsim_msg
("noány inserted subrequest, why doÖop_DFTL_buffer");

2843 #ifde‡
TRANSLATION_PAGE_UNIT


2844 
i
 = 0; i < 
ãmp_bûi°
->
Àn
; i ++){

2846 if–(
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
 =
NULL
 )&&(ssd->døm->mt->buf„r_DFTL->
buf„r_èû
 = NULL) ){

2847 
	`ssdsim_msg
("noány subrequests in DFTL_buffer, why doÖop_DFTL_buffer");

2853 
	`åa˚Tøn¶©i⁄buf„r_msg
("dñëêthêDFTL_buf„∏å™¶©i⁄Öagênumbî i†%d", 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
->
group
);

2855 
±
 = 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
;

2857 if(
±
->
group
 !
ãmp_node
->
Õn_™d_°©e
[0]){

2858 
	`ssdsim_msg
("theÑecordÉvict cannot matchÅhe bufferÅail");

2864 
	`avlTªeDñ
(
ssd
->
døm
->
mt
->
buf„r_DFTL
, (
TREE_NODE
 *Ë
±
);

2865 i‡(
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
->
LRU_lök_√xt
 =
NULL
) {

2866 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
 = 
NULL
;

2867 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
 = 
NULL
;

2869 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
 = ssd->døm->mt->buf„r_DFTL->buf„r_èû->
LRU_lök_¥e
;

2870 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
->
LRU_lök_√xt
 = 
NULL
;

2872 
±
->
LRU_lök_√xt
 = 
NULL
;

2873 
±
->
LRU_lök_¥e
 = 
NULL
;

2874 
	`AVL_TREENODE_FREE
(
ssd
->
døm
->
mt
->
buf„r_DFTL
, (
TREE_NODE
 *Ë
±
);

2875 
±
 = 
NULL
;

2886 
ssd
->
døm
->
mt
->
now_ˇched_dú_¶Ÿs_sizeö_byã
 -
	`gë_ªÆsize_öbyã_byposôi⁄_ö_mt
(ssd,
ãmp_node
->
Õn_™d_°©e
[0]);

2887 
	`åa˚Tøn¶©i⁄buf„r_msg
("⁄˚ dñëi⁄ sizêi†%d,Çow cached sizêi†%d,áŒ i¿byã", 
	`gë_ªÆsize_öbyã_byposôi⁄_ö_mt
(
ssd
,
ãmp_node
->
Õn_™d_°©e
[0]Ë, ssd->
døm
->
mt
->
now_ˇched_dú_¶Ÿs_sizeö_byã
 );

2890 if(
ãmp_node
 =
NULL
){

2891 
	`ssdsim_msg
("wrong inÖop_DFTL_buffer");

2896 
ãmp_node
 =Åemp_node->
√xtNode
;

2900  
ãmp_bûi°
->
Àn
;

2905 #ifde‡
ENTRY_UNIT


2907 
i
 = 0; i < 
ãmp_bûi°
->
Àn
; i ++){

2909 if–(
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
 =
NULL
 )&&(ssd->døm->mt->buf„r_DFTL->
buf„r_èû
 = NULL) ){

2910 
	`ssdsim_msg
("noány subrequests in DFTL_buffer, why doÖop_DFTL_buffer");

2916 
	`åa˚E¡rybuf„r_msg
("dñëêthêDFTL_buf„∏íåyÜ≤ i†%d", 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
->
group
);

2918 
±
 = 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
;

2920 if(
±
->
group
 !
ãmp_node
->
Õn_™d_°©e
[0]){

2921 
	`ssdsim_msg
("theÑecordÉvict cannot matchÅhe bufferÅail");

2927 
	`avlTªeDñ
(
ssd
->
døm
->
mt
->
buf„r_DFTL
, (
TREE_NODE
 *Ë
±
);

2928 i‡(
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
->
LRU_lök_√xt
 =
NULL
) {

2929 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
 = 
NULL
;

2930 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
 = 
NULL
;

2932 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
 = ssd->døm->mt->buf„r_DFTL->buf„r_èû->
LRU_lök_¥e
;

2933 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
->
LRU_lök_√xt
 = 
NULL
;

2935 
±
->
LRU_lök_√xt
 = 
NULL
;

2936 
±
->
LRU_lök_¥e
 = 
NULL
;

2937 
	`AVL_TREENODE_FREE
(
ssd
->
døm
->
mt
->
buf„r_DFTL
, (
TREE_NODE
 *Ë
±
);

2938 
±
 = 
NULL
;

2949 
ssd
->
døm
->
mt
->
now_ˇched_íåõs_sizeö_byã
 -
	`gë_ªÆsize_öbyã_byposôi⁄_ö_mt
(ssd,
ãmp_node
->
Õn_™d_°©e
[0]);

2951 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_£˘‹_cou¡
 += 1 ;

2952 
	`åa˚Tøn¶©i⁄buf„r_msg
("íåy sizê⁄˚ dñëi⁄ sizêi†%d,Çow cached sizêi†%d,áŒ i¿byã",
	`gë_ªÆsize_öbyã_byposôi⁄_ö_mt
(
ssd
,
ãmp_node
->
Õn_™d_°©e
[0]), ssd->
døm
->
mt
->
now_ˇched_íåõs_sizeö_byã
);

2955 if(
ãmp_node
 =
NULL
){

2956 
	`ssdsim_msg
("wrong inÖop_DFTL_buffer");

2961 
ãmp_node
 =Åemp_node->
√xtNode
;

2965  
ãmp_bûi°
->
Àn
;

2970 
	}
}

2973 
	$move_∑ges_‰om_uncom¥essi⁄_to_com¥essi⁄
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñequest)

2975 
i
, 
ãmp_Õn
, 
ãmp_°©e
;

2976 
buf„r_group
* 
ãmp_èû
, *
√w_node
 = 
NULL
, *
ãmp_èû_√xt
 ;

2978 
ãmp_èû
 = 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_èû
;

2979 if(
ªque°
->
the_numbî_of_evi˘ög_‰om_uncom_to_com
 != 0){

2981 
i
 = 0; i < 
ªque°
->
the_numbî_of_evi˘ög_‰om_uncom_to_com
; i++){

2989 
√w_node
 = 
NULL
;

2990 
√w_node
 = (
buf„r_group
 *Ë
	`mÆloc
((buffer_group));

2991 
	`Æloc_as£π
(
√w_node
, "buffer_group_node");

2992 
	`mem£t
(
√w_node
, 0, (
buf„r_group
));

2994 
√w_node
->
group
 = 
ãmp_èû
->group;

2995 
√w_node
->
°‹ed
 = 
ãmp_èû
->stored;

2996 
√w_node
->
dúty_˛ón
 = 
ãmp_èû
->dirty_clean;

2997 
√w_node
->
LRU_lök_¥e
 = 
NULL
;

2998 
√w_node
->
LRU_lök_√xt
 = 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
;

2999 i‡(
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
 !
NULL
) {

3000 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
->
LRU_lök_¥e
 = 
√w_node
;

3002 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
 = 
√w_node
;

3004 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
 = 
√w_node
;

3005 
√w_node
->
LRU_lök_¥e
 = 
NULL
;

3007 
	`avlTªeAdd
(
ssd
->
døm
->
mt
->
buf„r_DFTL
, (
TREE_NODE
 *Ë
√w_node
);

3011 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_£˘‹_cou¡
 += 1 ;

3012 
ssd
->
døm
->
mt
->
now_ˇched_dú_¶Ÿs_sizeö_byã
 +ssd->døm->mt->
com¥essi⁄_size
[
ãmp_èû
->
group
];

3015 
ãmp_èû_√xt
 = 
ãmp_èû
->
LRU_lök_¥e
;

3017 
	`avlTªeDñ
(
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
, (
TREE_NODE
 *Ë
ãmp_èû
);

3018 i‡(
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_hód
->
LRU_lök_√xt
 =
NULL
) {

3019 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_hód
 = 
NULL
;

3020 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_èû
 = 
NULL
;

3022 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_èû
 = ssd->døm->mt->buf„r_DFTL_UNCOM->buf„r_èû->
LRU_lök_¥e
;

3023 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_èû
->
LRU_lök_√xt
 = 
NULL
;

3025 
ãmp_èû
->
LRU_lök_√xt
 = 
NULL
;

3026 
ãmp_èû
->
LRU_lök_¥e
 = 
NULL
;

3027 
	`AVL_TREENODE_FREE
(
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
, (
TREE_NODE
 *Ë
ãmp_èû
);

3030 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_£˘‹_cou¡
 -= 1 ;

3031 
ssd
->
døm
->
mt
->
uncom¥essi⁄_now_ˇched_dú_¶Ÿs_sizeö_byã
 -ssd->
∑ømëî
->
∑ge_ˇ∑côy
;

3035 
ãmp_èû
 = 
ãmp_èû_√xt
;

3038  
i
;

3039 
	}
}

3042 
	$move_∑ges_‰om_com¥essi⁄_to_uncom¥essi⁄
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñequest)

3045 
i
;

3046 
buf„r_group
 
key
, *
buf„r_node
 = 
NULL
, *
√w_node
 ;

3047 
_bi_node
* 
ãmp_böode
 = 
NULL
, *
ãmp_böode_¥e
 = NULL;

3048 
_bi_li°
* 
ãmp_bûi°
 = 
NULL
;

3049 
ãmp_bûi°
 = 
ªque°
->
com¥essi⁄_to_uncom¥essi⁄
;

3050 
ãmp_böode
 = 
ãmp_bûi°
->
node_èû
;

3053 
i
 = 0; i < 
ãmp_bûi°
->
Àn
; i ++){

3054 
key
.
group
 = 
ãmp_böode
->
Õn_™d_°©e
[0];

3055 
buf„r_node
 = (
buf„r_group
 *Ë
	`avlTªeFöd
(
ssd
->
døm
->
mt
->
buf„r_DFTL
,

3056 (
TREE_NODE
 *Ë&
key
);

3057 if(
buf„r_node
 =
NULL
){

3058 
	`ssdsim_msg
("wrong in moveÖages from compressionÅo uncompression");

3072 
√w_node
 = 
NULL
;

3073 
√w_node
 = (
buf„r_group
 *Ë
	`mÆloc
((buffer_group));

3074 
	`Æloc_as£π
(
√w_node
, "buffer_group_node");

3075 
	`mem£t
(
√w_node
, 0, (
buf„r_group
));

3077 
√w_node
->
group
 = 
ãmp_böode
->
Õn_™d_°©e
[0];

3078 
√w_node
->
°‹ed
 = 
ãmp_böode
->
Õn_™d_°©e
[1];

3079 
√w_node
->
dúty_˛ón
 = 
ãmp_böode
->
Õn_™d_°©e
[1];

3080 
√w_node
->
LRU_lök_¥e
 = 
NULL
;

3081 
√w_node
->
LRU_lök_√xt
 = 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_hód
;

3082 i‡(
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_hód
 !
NULL
) {

3083 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_hód
->
LRU_lök_¥e
 = 
√w_node
;

3085 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_èû
 = 
√w_node
;

3087 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_hód
 = 
√w_node
;

3088 
√w_node
->
LRU_lök_¥e
 = 
NULL
;

3090 
	`avlTªeAdd
(
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
, (
TREE_NODE
 *Ë
√w_node
);

3094 
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
buf„r_£˘‹_cou¡
 += 1 ;

3095 
ssd
->
døm
->
mt
->
uncom¥essi⁄_now_ˇched_dú_¶Ÿs_sizeö_byã
 +ssd->
∑ømëî
->
∑ge_ˇ∑côy
;

3098 
ãmp_böode_¥e
 = 
ãmp_böode
->
¥evNode
 ;

3100 
	`avlTªeDñ
(
ssd
->
døm
->
mt
->
buf„r_DFTL
, (
TREE_NODE
 *Ë
buf„r_node
);

3101 i‡(
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
->
LRU_lök_√xt
 =
NULL
) {

3102 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_hód
 = 
NULL
;

3103 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
 = 
NULL
;

3105 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
 = ssd->døm->mt->buf„r_DFTL->buf„r_èû->
LRU_lök_¥e
;

3106 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_èû
->
LRU_lök_√xt
 = 
NULL
;

3108 
buf„r_node
->
LRU_lök_√xt
 = 
NULL
;

3109 
buf„r_node
->
LRU_lök_¥e
 = 
NULL
;

3110 
	`AVL_TREENODE_FREE
(
ssd
->
døm
->
mt
->
buf„r_DFTL
, (
TREE_NODE
 *)
buf„r_node
);

3113 
ssd
->
døm
->
mt
->
buf„r_DFTL
->
buf„r_£˘‹_cou¡
 -= 1 ;

3114 
ssd
->
døm
->
mt
->
uncom¥essi⁄_now_ˇched_dú_¶Ÿs_sizeö_byã
 -=ssd->døm->mt->
com¥essi⁄_size
[
ãmp_böode
->
Õn_™d_°©e
[0]];

3119 
ãmp_böode
 = 
ãmp_böode_¥e
;

3123  
i
;

3124 
	}
}

3129 
	$move_bëwìn_com¥essi⁄_™d_uncom¥essi⁄
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñequest)

3132 if(
ªque°
->
the_numbî_of_evi˘ög_‰om_uncom_to_com
 != 0){

3133 if(
	`move_∑ges_‰om_uncom¥essi⁄_to_com¥essi⁄
(
ssd
, 
ªque°
Ë!ªque°->
the_numbî_of_evi˘ög_‰om_uncom_to_com
){

3134 
	`ssdsim_msg
("wrong in move_between_compression_and_uncompression");

3144 if(
ªque°
->
com¥essi⁄_to_uncom¥essi⁄
->
Àn
 != 0){

3145 if(
	`move_∑ges_‰om_com¥essi⁄_to_uncom¥essi⁄
(
ssd
, 
ªque°
Ë!ªque°->
com¥essi⁄_to_uncom¥essi⁄
->
Àn
){

3146 
	`ssdsim_msg
("wrong in move_between_compression_and_uncompression");

3153 
	}
}

3159 
ssd_öfo
* 
	$COMPRESSION_DFTL_dól_ö_di°ributög_subªque°s
(
ssd_öfo
* 
ssd
)

3163 
ªque°
 *
ªq
;

3164 
sub_ªque°
 *
sub
;

3165 
evi˘_numbî
, 
„tch_numbî
, 
ãmp_numbî_now
;

3166 
com¥essi⁄_co°_sign_ö_sub∑ge
;

3167 
föished_movemít_bëwìn_com_™d_uncom_Êag
 = 0;

3168 
ªq
 = 
ssd
->
ªque°_èû
;

3169 if(
ªq
 =
NULL
){

3170 if(
ssd
->
ªque°_queue_Àngth
 != 0)

3171 
	`ssdsim_msg
("nowÇoányÑequest in ssd");

3176 if–(
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
 !
NULL
Ë&& (Ñeq->
missög_ö_DFTL_buf„r_Õn_d©a
 !NULLË&& (Ñeq->
should_evi˘_Õn_d©a
 !=NULL) ){

3177 
	`ssdsim_msg
("bef‹êdi°ributög subªque°s,ÉvîyvÆue:Ñeque°addªs†%Œd, ha†tŸÆ_waô_„tch_m≠pögèbÀ i†%d,ÅŸÆ_waô_evi˘ i†%d, cª©e_‹_nŸyë_„tch i†%d, cª©e_‹_nŸyë_evi˘ i†%d, missög_d©a_buf„r_Àngth %d, missög_DFTL_buf„r_Àngth %d, should_evi˘_Õ¿numbî %d", 
ªq
,Ñeq->
tŸÆ_waô_„tch_m≠pögèbÀ
,ªq->
¸óã_‹_nŸyë_„tch_subªque°s
,Ñeq->
¸óã_‹_nŸyë_evi˘_subªque°s
,Ñeq->
missög_ö_d©a_buf„r_Õn_d©a
->
Àn
,Ñeq->
missög_ö_DFTL_buf„r_Õn_d©a
->Àn,Ñeq->
should_evi˘_Õn_d©a
->len);

3201 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1)&&(‘eq->
tŸÆ_waô_evi˘
 =1))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =0))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 == 0) ){

3203 
	`¸óã_evi˘_m≠pögèbÀ_subªque°s
(
ssd
);

3204 
ªq
->
¸óã_‹_nŸyë_evi˘_subªque°s
 = 1;

3211 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1)&&(‘eq->
tŸÆ_waô_evi˘
 =1))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =1))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 == 0) ){

3213 if(
	`pﬁlög_whëhî_föish_evi˘_subªque°s
(
ssd
)){

3216 
evi˘_numbî
 = 
	`P›_DFTL_buf„r
(
ssd
, 
ªq
);

3218 
ãmp_numbî_now
 = 
	`dñëe_evi˘_subªque°_‰om_this_ªq
(
ssd
);

3219 
ªq
->
¸óã_‹_nŸyë_evi˘_subªque°s
 = 0;

3220 
ªq
->
tŸÆ_waô_evi˘
 = 0;

3224 if(
evi˘_numbî
 !
ãmp_numbî_now
){

3225 
	`ssdsim_msg
("evictÇumber in DFTL buffer is wrong with delete");

3231 if(
ªq
->
if_√ed_movemít_bëwìn_com_™d_uncom_Êag_™d_∑ge_numbîs
 != 0){

3232 
	`move_bëwìn_com¥essi⁄_™d_uncom¥essi⁄
(
ssd
, 
ªq
);

3233 
föished_movemít_bëwìn_com_™d_uncom_Êag
 = 1;

3239 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1)&&(‘eq->
tŸÆ_waô_evi˘
 =0))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =0))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 == 0) ){

3241 
	`¸óã_„tch_m≠pögèbÀ_subªque°s
(
ssd
);

3242 
ªq
->
¸óã_‹_nŸyë_„tch_subªque°s
 = 1;

3250 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1)&&(‘eq->
tŸÆ_waô_evi˘
 =0))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =0))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 == 1) ){

3252 if(
	`pﬁlög_whëhî_föish_„tch_subªque°s
(
ssd
)){

3257 
„tch_numbî
 = 
	`ö£π2DFTL_UNCOM_buf„r
(
ssd
, 
ªq
);

3259 
ãmp_numbî_now
 = 
	`dñëe_„tch_subªque°_‰om_this_ªq
(
ssd
);

3260 
ªq
->
¸óã_‹_nŸyë_„tch_subªque°s
 = 0;

3261 
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 = 0;

3264 if(
„tch_numbî
 !
ãmp_numbî_now
){

3265 
	`ssdsim_msg
("fetchÇumber in DFTL buffer is wrong with delete");

3270 if((
föished_movemít_bëwìn_com_™d_uncom_Êag
 =0Ë&& (
ªq
->
if_√ed_movemít_bëwìn_com_™d_uncom_Êag_™d_∑ge_numbîs
 !=0)){

3271 
	`move_bëwìn_com¥essi⁄_™d_uncom¥essi⁄
(
ssd
, 
ªq
);

3272 
föished_movemít_bëwìn_com_™d_uncom_Êag
 = 1;

3281 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =0)&&(‘eq->
tŸÆ_waô_evi˘
 =0))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =0))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 == 0) ){

3283 if(
föished_movemít_bëwìn_com_™d_uncom_Êag
 == 1){

3284 
ªq
->
if_√ed_movemít_bëwìn_com_™d_uncom_Êag_™d_∑ge_numbîs
 = 0;

3285 
	`¸óã_n‹mÆ_subªque°s
(
ssd
);

3290 
	`¸óã_n‹mÆ_subªque°s
(
ssd
);

3292 
ssd
->
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
 = 0;

3296 
	}
}

3301 
ssd_öfo
* 
	$DFTL_dól_ö_di°ributög_subªque°s
(
ssd_öfo
* 
ssd
)

3303 
ªque°
 *
ªq
;

3304 
sub_ªque°
 *
sub
;

3305 
evi˘_numbî
, 
„tch_numbî
, 
ãmp_numbî_now
;

3306 
ªq
 = 
ssd
->
ªque°_èû
;

3307 if(
ªq
 =
NULL
){

3308 
	`ssdsim_msg
("nowÇoányÑequest in ssd");

3309 if(
ssd
->
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
 != 0){

3310 
	`ssdsim_msg
("noányÑequest, but cannot getÇewÑequest here");

3314  
ssd
;

3317 if(
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
->
Àn
 == 0){

3318 
	`ssdsim_msg
("ªqÜ¢ %d,Ñeqáddªs†%Œd,Åhîêi†nÿmissög i¿d©abuf„r, sÿd⁄à√edány di°ributög subªque°†hîe.", 
ªq
->
l¢
,Ñeq);

3320 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1Ë|| (ªq->
tŸÆ_waô_evi˘
 == 1) ){

3322 
	`ssdsim_msg
("serious wrong inÜogically");

3327  
ssd
;

3332 if(
ªq
->
¸óã_‹_nŸyë_n‹mÆ_subªque°s
 == 1){

3333 if(
ssd
->
ªque°_queue
 !
NULL
){

3334 
ªque°
* 
ãmp
 = 
ssd
->
ªque°_queue
;

3335 
ãmp
 !
NULL
){

3336 
	`ssdsim_msg
("gÿouàhîe, sö˚ föishÅhê¸ótög o‡n‹mÆ subªque°,ÑeqÜ¢ %d,Ñeq %Œd,Ñeq->›î©i⁄ %d , whëhî c™ gëÇewÑeque°†%d,Ñeq'†ª•⁄£timê%Œd", 
ãmp
->
l¢
,Åemp,Åemp->
›î©i⁄
, 
ssd
-> 
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
,Åemp->
ª•⁄£_time
);

3337 if(
ãmp
->
ª•⁄£_time
 != 0){

3338 
	`ssdsim_msg
("stop here,ÜogicalÉrror happening!,afterÅraceoutput,Åhere isÇo finishedÑequestÉxisting here");

3343 
ãmp
 =Åemp->
√xt_node
;

3349  
ssd
;

3354 if–(
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
 !
NULL
Ë&& (Ñeq->
missög_ö_DFTL_buf„r_Õn_d©a
 !NULLË&& (Ñeq->
should_evi˘_Õn_d©a
 !=NULL) ){

3356 
	`ssdsim_msg
(" %dÑeque° ,bef‹êdi°ributög subªque°s,ÉvîyvÆue:Ñeque°addªs†%Œd, ha†tŸÆ_waô_„tch_m≠pögèbÀ i†%d,ÅŸÆ_waô_evi˘ i†%d, cª©e_‹_nŸyë_„tch i†%d, cª©e_‹_nŸyë_evi˘ i†%d, missög_d©a_buf„r_Àngth %d, missög_DFTL_buf„r_Àngth %d, should_evi˘_Õ¿numbî %d", 
ªq
->
›î©i⁄
,ªq,Ñeq->
tŸÆ_waô_„tch_m≠pögèbÀ
,Ñeq->
tŸÆ_waô_evi˘
,Ñeq->
¸óã_‹_nŸyë_„tch_subªque°s
,Ñeq->
¸óã_‹_nŸyë_evi˘_subªque°s
,Ñeq->
missög_ö_d©a_buf„r_Õn_d©a
->
Àn
,Ñeq->
missög_ö_DFTL_buf„r_Õn_d©a
->Àn,Ñeq->
should_evi˘_Õn_d©a
->len);

3362 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1)&&(‘eq->
tŸÆ_waô_evi˘
 =1))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =0))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 == 0) ){

3364 
	`¸óã_evi˘_m≠pögèbÀ_subªque°s
(
ssd
);

3365 #ifde‡
com¥essi⁄_ªÀv™t


3367 
	`¥ötf_m≠pögèbÀ_ªÀv™t_subªque°_ö_dif„ª¡_¥o˚ss
(
ssd
, 
ªq
);

3369 
ªq
->
¸óã_‹_nŸyë_evi˘_subªque°s
 = 1;

3375 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1)&&‘eq->
tŸÆ_waô_evi˘
 =1)&&‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =1)&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 == 0) ){

3377 if(
	`pﬁlög_whëhî_föish_evi˘_subªque°s
(
ssd
)){

3379 
	`ssdsim_msg
("hîêha†föishedÅhêevi˘ wrôêsubªque°, cuºít_timêi†%d\n", 
ssd
->
cuºít_time
);

3380 
evi˘_numbî
 = 
	`P›_DFTL_buf„r
(
ssd
, 
ªq
);

3382 
ãmp_numbî_now
 = 
	`dñëe_evi˘_subªque°_‰om_this_ªq
(
ssd
);

3383 if(
ªq
->
subs
 !
NULL
){

3384 
	`åa˚Eº‹_msg
("deleting inÉvict subs wrong");

3390 #ifde‡
com¥essi⁄_ªÀv™t


3392 
	`¥ötf_m≠pögèbÀ_ªÀv™t_subªque°_ö_dif„ª¡_¥o˚ss
(
ssd
, 
ªq
);

3395 
ªq
->
¸óã_‹_nŸyë_evi˘_subªque°s
 = 0;

3396 
ªq
->
tŸÆ_waô_evi˘
 = 0;

3400 if(
evi˘_numbî
 !
ãmp_numbî_now
){

3401 
	`ssdsim_msg
("evictÇumber in DFTL buffer is wrong with delete");

3411 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1)&&(‘eq->
tŸÆ_waô_evi˘
 =0))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =0))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 == 0) ){

3413 
	`¸óã_„tch_m≠pögèbÀ_subªque°s
(
ssd
);

3414 #ifde‡
com¥essi⁄_ªÀv™t


3416 
	`¥ötf_m≠pögèbÀ_ªÀv™t_subªque°_ö_dif„ª¡_¥o˚ss
(
ssd
, 
ªq
);

3419 
ªq
->
¸óã_‹_nŸyë_„tch_subªque°s
 = 1;

3427 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1)&&(‘eq->
tŸÆ_waô_evi˘
 =0))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =0))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 == 1) ){

3429 if(
	`pﬁlög_whëhî_föish_„tch_subªque°s
(
ssd
)){

3434 
„tch_numbî
 = 
	`ö£π2DFTL_buf„r
(
ssd
, 
ªq
);

3435 
ãmp_numbî_now
 = 
	`dñëe_„tch_subªque°_‰om_this_ªq
(
ssd
);

3436 if(
ªq
->
subs
 !
NULL
){

3437 
	`åa˚Eº‹_msg
("deleting in fetch_subrequest wrong");

3442 #ifde‡
com¥essi⁄_ªÀv™t


3444 
	`¥ötf_m≠pögèbÀ_ªÀv™t_subªque°_ö_dif„ª¡_¥o˚ss
(
ssd
, 
ªq
);

3449 
ªq
->
¸óã_‹_nŸyë_„tch_subªque°s
 = 0;

3450 
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 = 0;

3453 if(
„tch_numbî
 !
ãmp_numbî_now
){

3454 
	`ssdsim_msg
("fetchÇumber in DFTL buffer is wrong with delete");

3464 if–(
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =0)&&(‘eq->
tŸÆ_waô_evi˘
 =0))&&(‘eq->
¸óã_‹_nŸyë_evi˘_subªque°s
 =0))&&‘eq->
¸óã_‹_nŸyë_„tch_subªque°s
 =0Ë&&Ñeq->
¸óã_‹_nŸyë_n‹mÆ_subªque°s
 == 0 ){

3466 if(
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
->
Àn
 == 0){

3467  
ssd
;

3471 if–(
	`¸óã_n‹mÆ_subªque°s
(
ssd
Ë=1Ë&& (
ªq
->
subs
 !
NULL
 )){

3472 
ªq
->
¸óã_‹_nŸyë_n‹mÆ_subªque°s
 = 1;

3473 #ifde‡
com¥essi⁄_ªÀv™t


3475 
	`¥ötf_m≠pögèbÀ_ªÀv™t_subªque°_ö_dif„ª¡_¥o˚ss
(
ssd
, 
ªq
);

3478 if(
ssd
->
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
 == 1){

3479 
ssd
->
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
 = 0;

3480 
	`åa˚Eº‹_msg
("a·î dólög wôh m≠pögèbÀ†o‡ªque°áddªss: %Œd, wêÆlowÅÿgëÇewÑeque° by vÆuêmissög_m≠pög_™d_ˇ¬Ÿ_xxÅÿ0ágaö", 
ªq
);

3489 
	}
}

3494 
	$gë_com¥essi⁄_å™¶©i⁄_∑ge_size
(
ssd_öfo
* 
ssd
)

3496 
i
,
j
, 
∑ge_num
, 
å™¶©i⁄_∑ge_num
, 
bef‹e_com¥essi⁄_size
;

3497 
⁄e_∑ge_com¥essi⁄_size
;

3498 * 
å™¶©i⁄_∑ge_d©a_bef‹e_com¥essi⁄
, *
å™¶©i⁄_∑ge_d©a_a·î_com¥essi⁄
;

3499 
∑ge_num
 = 
ssd
->
∑ømëî
->
∑ge_block
 * ssd->∑ømëî->
block_∂™e
 * ssd->∑ømëî->
∂™e_dõ
 * ssd->∑ømëî->
dõ_chù
 * ssd->∑ømëî->
chù_num
;

3500 
bef‹e_com¥essi⁄_size
 = 
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
;

3501 
	`ssdsim_msg
("⁄ê∑gêsizêi†%d", 
ssd
->
∑ømëî
->
∑ge_ˇ∑côy
);

3502 
å™¶©i⁄_∑ge_num
 = 
∑ge_num
 / 
NUM_ENTRIES_PER_DIR
;

3503 
å™¶©i⁄_∑ge_d©a_bef‹e_com¥essi⁄
 = (*Ë
	`mÆloc
 (()* 
NUM_ENTRIES_PER_DIR
);

3504 
å™¶©i⁄_∑ge_d©a_a·î_com¥essi⁄
 = (*Ë
	`mÆloc
 (()* 
NUM_ENTRIES_PER_DIR
);

3505 
	`mem£t
(
å™¶©i⁄_∑ge_d©a_bef‹e_com¥essi⁄
 , 0, ()* 
NUM_ENTRIES_PER_DIR
 );

3506 
	`mem£t
(
å™¶©i⁄_∑ge_d©a_a·î_com¥essi⁄
 , 0, ()* 
NUM_ENTRIES_PER_DIR
 );

3508 
i
 = 0; i < 
å™¶©i⁄_∑ge_num
; i ++){

3509 
j
 = 0;j < 
NUM_ENTRIES_PER_DIR
; j ++){

3511 
å™¶©i⁄_∑ge_d©a_bef‹e_com¥essi⁄
[
j
] = 
ssd
->
døm
->
m≠
->
m≠_íåy
[(
NUM_ENTRIES_PER_DIR
 * 
i
 + j)].
≤
;

3514 
⁄e_∑ge_com¥essi⁄_size
 = 
	`xm©chCom¥ess
((*)
å™¶©i⁄_∑ge_d©a_bef‹e_com¥essi⁄
, 
bef‹e_com¥essi⁄_size
, (*)
å™¶©i⁄_∑ge_d©a_a·î_com¥essi⁄
);

3515 if(
⁄e_∑ge_com¥essi⁄_size
 != 16){

3516 
	`ssdsim_msg
("å™¶©i⁄Öagê%d com¥essi⁄ sizêi†%d", 
i
, 
⁄e_∑ge_com¥essi⁄_size
);

3522 if(
∑ge_num
 % 
NUM_ENTRIES_PER_DIR
 != 0){

3523 
j
 = (
∑ge_num
 - (∑ge_num % 
NUM_ENTRIES_PER_DIR
)); j <Öage_num; j ++){

3524 *(
å™¶©i⁄_∑ge_d©a_bef‹e_com¥essi⁄
 + 
j
Ë
ssd
->
døm
->
m≠
->
m≠_íåy
[j].
≤
;

3528 
⁄e_∑ge_com¥essi⁄_size
 = 
	`xm©chCom¥ess
((*)
å™¶©i⁄_∑ge_d©a_bef‹e_com¥essi⁄
, 
bef‹e_com¥essi⁄_size
, (*)
å™¶©i⁄_∑ge_d©a_a·î_com¥essi⁄
);

3530 
ssd
->
døm
->
mt
->
com¥essi⁄_size
[
å™¶©i⁄_∑ge_num
] = 
⁄e_∑ge_com¥essi⁄_size
 ;

3531 
ssd
->
døm
->
mt
->
com¥essi⁄_°©e
[
å™¶©i⁄_∑ge_num
] = 1;

3535 
	`‰ì
(
å™¶©i⁄_∑ge_d©a_bef‹e_com¥essi⁄
);

3536 
	`‰ì
(
å™¶©i⁄_∑ge_d©a_a·î_com¥essi⁄
);

3537 
	`ssdsim_msg
("here finishÅhe compression");

3539 
	}
}

3550 
	$maö
() {

3551 
i
, 
j
, 
k
;

3552 
ssd_öfo
 *
ssd
;

3557 
FILE
* 
Â_numbî_subªque°s_txt
 = 
	`f›í
("number_subrequests.txt", "w");

3559 #ifde‡
DEBUG


3560 
	`¥ötf
("enter main\n");

3561 
	`¥ötf
("forÅest\n");

3563 
ssd
 = (
ssd_öfo
 *Ë
	`mÆloc
((ssd_info));

3564 
	`Æloc_as£π
(
ssd
, "ssd");

3565 
	`mem£t
(
ssd
, 0, (
ssd_öfo
));

3566 
ssd
 = 
	`öôüti⁄
(ssd);

3567 #ifde‡
DEBUG


3568 
	`¥ötf
("this is in main()");

3569 
	`¥ötfsub_ªque°_°©us
(
ssd
);

3571 
	`make_aged
(
ssd
);

3572 
	`¥e_¥o˚ss_∑ge
(
ssd
);

3574 #ifde‡ 
COMPRESSION_MAPPING


3575 
	`gë_com¥essi⁄_å™¶©i⁄_∑ge_size
(
ssd
);

3578 
i
 = 0; i < 
ssd
->
∑ømëî
->
ch™√l_numbî
; i++) {

3579 
j
 = 0; j < 
ssd
->
∑ømëî
->
dõ_chù
; j++) {

3580 
k
 = 0; k < 
ssd
->
∑ømëî
->
∂™e_dõ
; k++) {

3581 
	`¥ötf
("%d,0,%d,%d: %5d\n", 
i
, 
j
, 
k
,

3582 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[0].
dõ_hód
[
j
].
∂™e_hód
[
k
].
‰ì_∑ge
);

3586 
	`Ârötf
(
ssd
->
ouçutfûe
, "\t\t\t\t\t\t\t\t\tOUTPUT\n");

3587 
	`Ârötf
(
ssd
->
ouçutfûe
, "****************** TRACE INFO ******************\n");

3589 
ssd
 = 
	`simuœã
(ssd);

3592 
	`°©i°ic_ouçut
(
ssd
);

3595 
	`¥ötf
("\n");

3596 
	`¥ötf
("the simulation is completed!\n");

3601 
	}
}

3611 
ssd_öfo
 *
	$simuœã
(
ssd_öfo
 *
ssd
) {

3612 
Êag
 = 1, 
Êag1
 = 0;

3613 
ouçut_°ï
 = 0;

3614 
a
 = 0, 
b
 = 0;

3617 
	`¥ötf
("\n");

3618 
	`¥ötf
("begin simulating.......................\n");

3619 
	`¥ötf
("\n");

3620 
	`¥ötf
("\n");

3621 
	`¥ötf
(" ^o^ OK,Ölease waitá moment,ándÉnjoy musicánd coffee ^o^ \n");

3623 
ssd
->
åa˚fûe
 = 
	`f›í
(ssd->
åa˚fûíame
, "r");

3624 i‡(
ssd
->
åa˚fûe
 =
NULL
) {

3625 
	`¥ötf
("theÅrace file can't open\n");

3626  
NULL
;

3629 
	`Ârötf
(
ssd
->
ouçutfûe
,

3631 
	`fÊush
(
ssd
->
ouçutfûe
);

3632 
i
 = 0;

3633 
Êag
 != 100) {

3637 if(
ssd
->
debug_sign
 == 1){

3648 
Êag
 = 
	`gë_ªque°s
(
ssd
);

3651 
	`åa˚Eº‹_msg
–"now fœg i†%d, 1 món†gëtögÇewÑeque° \n" ,
Êag
);

3652 #ifde‡
DEBUG


3653 
	`¥ötf
–"Êag i†%d\n" ,
Êag
);

3655 i‡(
Êag
 == 1) {

3657 
	`åa˚Eº‹_msg
("now wêˇ¿dúe˘ly di°ribuãÇewÑeque°ádªs†i†%Œd", 
ssd
->
ªque°_èû
);

3661 i‡(
ssd
->
∑ømëî
->
døm_ˇ∑côy
 != 0) {

3663 #ifde‡
PFTL


3664 
	`buf„r_m™agemít
(
ssd
);

3665 
	`di°ribuã
(
ssd
);

3667 #ifde‡
DFTL


3668 
	`DFTL_buf„r_m™agemít
(
ssd
);

3672 
	`no_buf„r_di°ribuã
(
ssd
);

3676 
	`åa˚Eº‹_msg
(":œ°Ñeque°Çìd gë m≠pögèbÀ, hîêˇ¡ gëÇewÑeque° dólögÜa°Ñeque° i†%Œd", 
ssd
->
ªque°_èû
);

3679 #ifde‡
DFTL


3681 #ifde‡
COMPRESSION_MAPPING


3682 
	`COMPRESSION_DFTL_dól_ö_di°ributög_subªque°s
(
ssd
);

3684 
	`DFTL_dól_ö_di°ributög_subªque°s
(
ssd
);

3690 
	`¥o˚ss
(
ssd
);

3691 
	`åa˚_ouçut
(
ssd
);

3692 
	`ã°_föish_dñëi⁄
(
ssd
);

3693 
	`ssdsim_msg
("gë ouà‰omÅø˚_ouçut, cuºíàtime:%Œd\n",
ssd
->
cuºít_time
);

3696 i‡(
Êag
 == 0 )

3697 
Êag
 = 100;

3700 
	`f˛o£
(
ssd
->
åa˚fûe
);

3701  
ssd
;

3702 
	}
}

3716 
	$gë_ªque°s
(
ssd_öfo
 *
ssd
) {

3717 
buf„r
[200];

3719 
öt64_t
 
œrge_l¢
, 
l¢
 = 0;

3720 
devi˚
, 
size
, 
›e
, 
i
 = 0, 
j
 = 0;

3721 
ªque°
 *
ªque°1
;

3722 
sub_ªque°
 *
ãmp_sub
;

3723 
Êag
 = 1;

3724 
fûïoöt
;

3726 
öt64_t
 
l¢_f‹_ªc‹d
 = 0;

3727 
öt64_t
 
time_t
 = 0;

3728 
öt64_t
 
√¨e°_evít_time
;

3729 #ifde‡
DEBUG_CURR_TIME


3730 
	`¥ötf
("DEBUG_CURR_TIME i†%Œd i¿gë_ªque° fun˘i⁄\n",
ssd
->
cuºít_time
);

3736 if(
ssd
->
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
 == 1){

3737 
	`åa˚Eº‹_msg
("1: in getting mappingÅable sub-requests,Çow waiting forÅhe missing ofÅranslation mappingÖages!");

3741 
√¨e°_evít_time
 = 
	`föd_√¨e°_evít
(
ssd
);

3742 i‡(
√¨e°_evít_time
 < 
MAX_INT64
){

3744 
ssd
->
cuºít_time
 = 
√¨e°_evít_time
;

3745 if(
ssd
->
cuºít_time
 > 
√¨e°_evít_time
){

3746 
	`ssdsim_msg
("missing_mapping_and_cannot_get_traceline wrong in getÑequestsÇow");

3756 i‡(
	`„of
(
ssd
->
åa˚fûe
)){

3757 if(
ssd
->
ªque°_queue_Àngth
 > 0){

3758 
	`¥ötf
("here is dealingÉnd ofÅrace\n");

3759 
√¨e°_evít_time
 = 
	`föd_√¨e°_evít
(
ssd
);

3761 i‡(
√¨e°_evít_time
 =
MAX_INT64
) {

3764 i‡(
√¨e°_evít_time
 < 
MAX_INT64
){

3766 
ssd
->
cuºít_time
 = 
√¨e°_evít_time
;

3773 
fûïoöt
 = 
	`·ñl
(
ssd
->
åa˚fûe
);

3774 
	`fgës
(
buf„r
, 200, 
ssd
->
åa˚fûe
);

3775 
	`ssˇnf
(
buf„r
, "%Œd %d %Œd %d %d", &
time_t
, &
devi˚
, &
l¢
, &
size
, &
›e
);

3777 i‡((
devi˚
 < 0Ë&& (
l¢
 < 0Ë&& (
size
 < 0Ë&& (
›e
 < 0)) {

3781 
l¢_f‹_ªc‹d
 = 
l¢
;

3782 #ifde‡
DEBUG


3783 
	`¥ötf
("íã∏gë_ªque°s, ssd->mö_l¢ %d, ssd->max_l¢ %d\n",
ssd
->
mö_l¢
,ssd->
max_l¢
);

3785 
	`¥ötf
–"time_à%Œd, devi˚ %d,Ü¢ %d,sizê%d ,›ê%d\n" , 
time_t
, 
devi˚
, 
l¢
, 
size
, 
›e
);

3789 i‡(
l¢
 < 
ssd
->
mö_l¢
)

3790 
ssd
->
mö_l¢
 = 
l¢
;

3791 i‡(
l¢
 > 
ssd
->
max_l¢
)

3792 
ssd
->
max_l¢
 = 
l¢
;

3799 
œrge_l¢
 = (Ë((
ssd
->
∑ømëî
->
sub∑ge_∑ge
 * ssd->∑ømëî->
∑ge_block
 * ssd->∑ømëî->
block_∂™e
 *

3800 
ssd
->
∑ømëî
->
∂™e_dõ
 * ssd->∑ømëî->
dõ_chù
 * ssd->∑ømëî->
chù_num
) *

3801 (1 - 
ssd
->
∑ømëî
->
ovî¥ovide
));

3802 
l¢
 =Ü¢ % 
œrge_l¢
;

3804 
√¨e°_evít_time
 = 
	`föd_√¨e°_evít
(
ssd
);

3805 #ifde‡
DEBUG


3806 
	`¥ötf
("√¨e°_evít_timêi†%Œd\n",
√¨e°_evít_time
 );

3809 i‡(
√¨e°_evít_time
 =
MAX_INT64
) {

3812 if(
ssd
->
ªque°_queue_Àngth
 >0){

3813 
	`¥ötf
("only gcÖrocessing can happen\n");

3815 if(
ssd
->
ªque°_queue_Àngth
 =ssd->
∑ømëî
->
queue_Àngth
){

3818 
	`¥ötf
("full ofÑequests in queueÇow!!\n");

3819 
	`f£ek
(
ssd
->
åa˚fûe
, 
fûïoöt
, 0);

3852 if(
ssd
->
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
 == 1){

3853 
	`åa˚Eº‹_msg
("1: in getting mappingÅable sub-requests,Çow waiting forÅhe missing ofÅranslation mappingÖages!");

3854 
	`f£ek
(
ssd
->
åa˚fûe
, 
fûïoöt
, 0);

3857 
ssd
->
cuºít_time
 = 
time_t
;

3863 #ifde‡
DEBUG


3872 i‡(
√¨e°_evít_time
 < 
time_t
) {

3881 #ifde‡
DEBUG


3882 
	`¥ötf
("enterÇearest_event_time <time_t\n" );

3885 
	`f£ek
(
ssd
->
åa˚fûe
, 
fûïoöt
, 0);

3886 i‡(
ssd
->
cuºít_time
 <
√¨e°_evít_time
){

3889 
ssd
->
cuºít_time
 = 
√¨e°_evít_time
;

3891 #ifde‡
DEBUG_CURR_TIME


3892 
	`¥ötf
("ssdcuºíâimêDEBUG_CURR_TIME i†%Œd i¿gë_ªque°†fun˘i⁄\n",
ssd
->
cuºít_time
);

3898 #ifde‡
DEBUG


3899 
	`¥ötf
("enterÇearest_event_time >Åime_t\n" );

3902 i‡(
ssd
->
ªque°_queue_Àngth
 >ssd->
∑ømëî
->
queue_Àngth
) {

3905 
	`f£ek
(
ssd
->
åa˚fûe
, 
fûïoöt
, 0);

3906 
ssd
->
cuºít_time
 = 
√¨e°_evít_time
;

3907 #ifde‡
DEBUG_CURR_TIME


3908 
	`¥ötf
("ssdcuºíâimê DEBUG_CURR_TIME i†%Œd i¿gë_ªque°†fun˘i⁄ándÑeque°_queue>ı¨amëî queue_Àngth\n",
ssd
->
cuºít_time
);

4059 if(
ssd
->
missög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
 == 1){

4060 
	`åa˚Eº‹_msg
("2: in gettingÑequests,Çow waiting forÅhe missing ofÅranslation mappingÖages!!");

4061 
	`f£ek
(
ssd
->
åa˚fûe
, 
fûïoöt
, 0);

4066 
ssd
->
cuºít_time
 = 
time_t
;

4067 #ifde‡
DEBUG_CURR_TIME


4068 
	`¥ötf
("ssdcuºíâimê DEBUG_CURR_TIME i†%Œd i¿gë_ªque°†fun˘i⁄Ñeque°_queue<ı¨amëî queue_Àngth \n",
ssd
->
cuºít_time
);

4075 i‡(
time_t
 < 0) {

4076 
	`¥ötf
("error!\n");

4080 i‡(
	`„of
(
ssd
->
åa˚fûe
)) {

4081 
ªque°1
 = 
NULL
;

4085 
ªque°1
 = (
ªque°
 *Ë
	`mÆloc
((request));

4086 
	`Æloc_as£π
(
ªque°1
, "request");

4087 
	`mem£t
(
ªque°1
, 0, (
ªque°
));

4089 
ªque°1
->
time
 = 
time_t
;

4090 
ªque°1
->
l¢
 =Üsn;

4091 
ªque°1
->
size
 = size;

4092 
ªque°1
->
›î©i⁄
 = 
›e
;

4093 
ªque°1
->
begö_time
 = 
time_t
;

4094 
ªque°1
->
ª•⁄£_time
 = 0;

4095 
ªque°1
->
íîgy_c⁄sum±i⁄
 = 0;

4096 
ªque°1
->
√xt_node
 = 
NULL
;

4097 
ªque°1
->
di°ri_Êag
 = 0;

4098 
ªque°1
->
subs
 = 
NULL
;

4099 
ªque°1
->
√ed_di°r_Êag
 = 
NULL
;

4100 
ªque°1
->
com∂ëe_l¢_cou¡
 = 0;

4101 
fûïoöt
 = 
	`·ñl
(
ssd
->
åa˚fûe
);

4103 
ªque°1
->
tŸÆ_waô_evi˘
 = 0;

4104 
ªque°1
->
tŸÆ_waô_„tch_m≠pögèbÀ
 = 0;

4106 
ªque°1
->
should_evi˘_Õn_d©a
 = 
	`¸óã_™d_öô_bi_li°
();

4107 
ªque°1
->
missög_ö_d©a_buf„r_Õn_d©a
 = 
	`¸óã_™d_öô_bi_li°
();

4108 if(
ªque°1
->
missög_ö_d©a_buf„r_Õn_d©a
 =
NULL
){

4109 
	`ssdsim_msg
("wrong in create missing_in_data_buffer");

4114 
ªque°1
->
missög_ö_DFTL_buf„r_Õn_d©a
 = 
	`¸óã_™d_öô_bi_li°
();

4115 
ªque°1
->
¸óã_‹_nŸyë_evi˘_subªque°s
 = 0;

4116 
ªque°1
->
¸óã_‹_nŸyë_„tch_subªque°s
 = 0;

4117 #ifde‡
COMPRESSION_MAPPING


4119 
ªque°1
->
if_√ed_movemít_bëwìn_com_™d_uncom_Êag_™d_∑ge_numbîs
 = 0;

4120 
ªque°1
->
the_numbî_of_evi˘ög_‰om_uncom_to_com
 = 0;

4121 
ªque°1
->
hô_ö_uncom¥essi⁄_buf„r_numbî
 = 0;

4122 
ªque°1
->
com¥essi⁄_to_uncom¥essi⁄
 = 
	`¸óã_™d_öô_bi_li°
();

4125 
ªque°1
->
if_√ed_movemít_bëwìn_com_™d_uncom_Êag_™d_∑ge_numbîs
 = 0;

4126 
ªque°1
->
the_numbî_of_evi˘ög_‰om_uncom_to_com
 = 0;

4127 
ªque°1
->
hô_ö_uncom¥essi⁄_buf„r_numbî
 = 0;

4128 
ªque°1
->
com¥essi⁄_to_uncom¥essi⁄
 = 
NULL
;

4133 #ifde‡
DEBUG


4134 
	`¥ötf
("before insert into ssd-request queue\n");

4135 
	`¥ötf_ssd_ªque°_queue
(
ssd
);

4140 
	`åa˚Eº‹_msg
("© ssdcuºíàtimê%d, gëtögÇewÑeque°_queuêaddªss:%Œd,Ü¢ : %d, sizê: %d, o≥øti⁄ :%d ***1ªad,0wrôe,com∂ëe_l¢_cou¡ :%d, di°ri_Êag :%d, begö_timê:%Œu",
ssd
->
cuºít_time
,
ªque°1
,Ñeque°1->
l¢
,ªque°1->
size
,ªque°1->
›î©i⁄
,ªque°1->
com∂ëe_l¢_cou¡
,ªque°1->
di°ri_Êag
,ªque°1->
begö_time
);

4142 i‡(
ssd
->
ªque°_queue
 =
NULL
)

4144 if(
ssd
->
ªque°_queue_Àngth
 != 0){

4145 
	`ssdsim_msg
("1 wrong inádding ssd'sÑequest ");

4149 if(
ssd
->
ªque°_èû
 !
NULL
){

4150 
	`ssdsim_msg
("2 wrong inádding ssd'sÑequest ");

4154 
ssd
->
ªque°_queue
 = 
ªque°1
;

4155 
ssd
->
ªque°_èû
 = 
ªque°1
;

4156 
ssd
->
ªque°_queue_Àngth
++;

4158 (
ssd
->
ªque°_èû
)->
√xt_node
 = 
ªque°1
;

4159 
ssd
->
ªque°_èû
 = 
ªque°1
;

4160 
ssd
->
ªque°_queue_Àngth
++;

4169 #ifde‡
DEBUG


4170 
	`¥ötf
("after inserted into ssd-request queue\n");

4171 
	`¥ötf_ssd_ªque°_queue
(
ssd
);

4173 i‡(
ªque°1
->
›î©i⁄
 == 1)

4175 
ssd
->
ave_ªad_size
 =

4176 (
ssd
->
ave_ªad_size
 * ssd->
ªad_ªque°_cou¡
 + 
ªque°1
->
size
) / (ssd->read_request_count + 1);

4178 
ssd
->
ave_wrôe_size
 =

4179 (
ssd
->
ave_wrôe_size
 * ssd->
wrôe_ªque°_cou¡
 + 
ªque°1
->
size
) / (ssd->write_request_count + 1);

4183 
fûïoöt
 = 
	`·ñl
(
ssd
->
åa˚fûe
);

4184 
	`fgës
(
buf„r
, 200, 
ssd
->
åa˚fûe
);

4185 
	`ssˇnf
(
buf„r
, "%Œd %d %Œd %d %d", &
time_t
, &
devi˚
, &
l¢
, &
size
, &
›e
);

4186 
ssd
->
√xt_ªque°_time
 = 
time_t
;

4187 
	`f£ek
(
ssd
->
åa˚fûe
, 
fûïoöt
, 0);

4190 
	}
}

4192 
	$no_gªedy_RF_su•ísi⁄
(
ssd_öfo
 *
ssd
)

4200 
ãmp_ch™√l
,
ãmp_chù
, 
ãmp_i
, 
ãmp_j
, 
ãmp_num_wrôe
;

4201 
sub_ªque°
 *
ãmp_sub_f‹_wrôe
 = 
NULL
;

4202 
gc_›î©i⁄
* 
ãmp_gc_node
;

4203 
chù_has_wrôe
 = 0;

4204 
ãmp_Àngth
 = 0;

4205 
ãmp_ch™√l
 = 
ssd
->
∑ømëî
->
ch™√l_numbî
;

4206 
ãmp_chù
 = 
ssd
->
∑ømëî
->
chù_num
 / ssd->∑ømëî->
ch™√l_numbî
;

4207 
ãmp_Àngth
 = 
WRITE_RATIO_IN_REQUEST_QUEUE
 * 
ssd
->
∑ømëî
->
queue_Àngth
;

4212 
ãmp_num_wrôe
 = 
	`°©i°ic_wrôe_ªque°_numbî
(
ssd
);

4213 if(
ãmp_num_wrôe
 =
ssd
->
ªque°_queue_Àngth
){

4216 
	`¥ötf
("ãmp_num_wrôêi†%d,ánd sëtög wrôêÀngth i†%d,ándÜ⁄ge°Üígth i†%d\n", 
ãmp_num_wrôe
, 
ãmp_Àngth
, 
ssd
->
∑ømëî
->
queue_Àngth
);

4217 if–
ãmp_num_wrôe
 >
ãmp_Àngth
 ){

4224 
ãmp_i
 = 0;Åemp_ò< 
ãmp_ch™√l
;Åemp_i ++ ){

4226 
ãmp_j
 = 0;

4227 
ãmp_gc_node
 = 
ssd
->
ch™√l_hód
[
ãmp_i
].
gc_comm™d
;

4230 if(
ãmp_gc_node
 !
NULL
){

4234 
ãmp_j
 < 
ãmp_chù
){

4236 
ãmp_sub_f‹_wrôe
 = 
ssd
->
ch™√l_hód
[
ãmp_i
].
subs_w_hód
;

4237 
	`¥ötf
("chù i†%d\n", 
ãmp_j
);

4238 
ãmp_sub_f‹_wrôe
 !
NULL
){

4240 if(
ssd
->
ch™√l_hód
[
ãmp_i
].
chù_hód
[
ãmp_j
].
chù_ªad_°›
 == 1){

4241 
chù_has_wrôe
 = 1;

4242 
ãmp_j
 ++;

4248 if(
ãmp_sub_f‹_wrôe
->
loˇti⁄
->
chù
 =
ãmp_j
){

4251 
ssd
->
ch™√l_hód
[
ãmp_i
].
chù_hód
[
ãmp_j
].
chù_wrôe_ªc‹d_begö
 = ssd->ch™√l_hód[ãmp_i].chù_hód[ãmp_j].
num_w_cy˛e
;

4252 
ssd
->
ch™√l_hód
[
ãmp_i
].
chù_hód
[
ãmp_j
].
chù_ªad_°›
 = 1;

4253 
chù_has_wrôe
 = 1;

4254 
	`¥ötf
("ch™√»%d, chù %d, ha†ªc‹d begö i†%d\n", 
ãmp_i
, 
ãmp_j
, 
ssd
->
ch™√l_hód
[ãmp_i].
chù_hód
[ãmp_j].
num_w_cy˛e
);

4257 
ãmp_j
 ++;

4261 
ãmp_sub_f‹_wrôe
 =Åemp_sub_f‹_wrôe->
√xt_node
;

4265 
	`¥ötf
("2222\n");

4268 if(
chù_has_wrôe
 == 1){

4269 
chù_has_wrôe
 = 0;

4271 
ãmp_j
 ++;

4275 
	`¥ötf
("11111\n");

4290 
	}
}

4293 
	$°©i°ic_wrôe_ªque°_numbî
(
ssd_öfo
 *
ssd
)

4295 
ªque°
* 
ãmp_ªque°
;

4296 
ãmp_num_wrôe_ªque°
 = 0;

4298 
ãmp_ªque°
 = 
ssd
->
ªque°_queue
;

4300 if(
ssd
->
ªque°_queue_Àngth
 != 0){

4302 
ãmp_ªque°
 !
NULL
){

4304 if(
ãmp_ªque°
->
›î©i⁄
 == 0){

4306 
ãmp_num_wrôe_ªque°
 ++;

4307 if(
ãmp_ªque°
 =
ssd
->
ªque°_èû
){

4311 
ãmp_ªque°
 =Åemp_ªque°->
√xt_node
;

4314 if(
ãmp_ªque°
 =
ssd
->
ªque°_èû
){

4317 
ãmp_ªque°
 =Åemp_ªque°->
√xt_node
;

4321 
	`¥ötf
("3333\n");

4324  
ãmp_num_wrôe_ªque°
;

4325 
	}
}

4330 
	$≠≥nd_⁄_ªque°_com¥essi⁄_to_uncom¥essi⁄_Õn_d©a
(
ªque°
* 
ªq
, 
Õn
, 
°©e
)

4333 
	`Õush
(
ªq
->
com¥essi⁄_to_uncom¥essi⁄
, 
Õn
, 
°©e
);

4336 
	}
}

4343 
	$≠≥nd_⁄_ªque°_evi˘_ö_DFTL_buf„r_Õn_d©a
(
ªque°
* 
ªq
, 
Õn
, 
°©e
)

4346 
	`Õush
(
ªq
->
should_evi˘_Õn_d©a
, 
Õn
, 
°©e
);

4349 
	}
}

4356 
	$≠≥nd_⁄_ªque°_missög_ö_d©a_buf„r_Õn_d©a
(
ªque°
* 
ªq
, 
Õn
, 
°©e
)

4359 
	`Õush
(
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
, 
Õn
, 
°©e
);

4361 
	}
}

4364 
	$i¢Ÿ_ª≥©_ö_bûi°
(
_bi_li°
* 
bûi°
, 
Õn
)

4366 
_bi_node
* 
ãmp_node
 = 
bûi°
->
node_hód
;

4367 
i
 = 0;

4368 if(
bûi°
->
Àn
 > 0){

4369 
i
 = 0; i < 
bûi°
->
Àn
; i++){

4370 if(
ãmp_node
->
Õn_™d_°©e
[0] =
Õn
){

4373 
ãmp_node
 =Åemp_node->
√xtNode
;

4382 
	}
}

4385 
	$≠≥nd_⁄_ªque°_missög_ö_DFTL_buf„r_Õn_d©a
(
ªque°
* 
ªq
, 
Õn
, 
°©e
)

4389 #ifde‡
TRANSLATION_PAGE_UNIT


4391 
ãmp_å™¶©i⁄_∑ge
 = 
Õn
 / 
NUM_ENTRIES_PER_DIR
;

4394 if(
	`i¢Ÿ_ª≥©_ö_bûi°
(
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
, 
ãmp_å™¶©i⁄_∑ge
)){

4396 
	`Õush
(
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
, 
ãmp_å™¶©i⁄_∑ge
, 
°©e
);

4397 
	`åa˚Tøn¶©i⁄buf„r_msg
("nÿhôtög,ssd buf„∏ju° wû»add buf„∏vÆuênumbî i†%d i¿thêfutuª", 
ãmp_å™¶©i⁄_∑ge
);

4404 #ifde‡
ENTRY_UNIT


4407 
	`Õush
(
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
, 
Õn
, 
°©e
);

4408 
	`åa˚E¡rybuf„r_msg
("nÿhôtög, ssd buf„∏ju° wû»add buf„∏íåyÜ≤ i†%d, i¿thêfutuª", 
Õn
);

4414 
	}
}

4422 
ssd_öfo
* 
	$wrôe_ªque°_gë_missög_ö_d©abuf„r
(
ssd_öfo
* 
ssd
, 
Õn
, 
°©e
, 
ªque°
* 
ªq
)

4424 
wrôe_back_cou¡
, 
Êag
 = 0;

4425 
i
, 
l¢
, 
hô_Êag
, 
add_Êag
, 
£˘‹_cou¡
, 
a˘ive_ªgi⁄_Êag
 = 0, 
‰ì_£˘‹
 = 0;

4426 
buf„r_group
 *
buf„r_node
 = 
NULL
, *
±
, *
√w_node
 = NULL, 
key
;

4427 
sub_ªque°
 *
sub_ªq
 = 
NULL
, *
upd©e
 = NULL;

4428 
sub_ªq_°©e
 = 0, 
sub_ªq_size
 = 0, 
sub_ªq_Õn
 = 0;

4432 
£˘‹_cou¡
 = 
	`size
(
°©e
);

4433 
key
.
group
 = 
Õn
;

4434 
buf„r_node
 = (
buf„r_group
 *Ë
	`avlTªeFöd
(
ssd
->
døm
->
buf„r
,

4435 (
TREE_NODE
 *Ë&
key
);

4446 #ifde‡
DEBUG


4447 
	`¥ötf
("buf„r_nodêi†%d\n",
buf„r_node
);

4449 i‡(
buf„r_node
 =
NULL
) {

4451 
	`ssdsim_msg
("f‹ wrôêªque° %Œd, buf„r_nodêha†nŸ bì¿hôãd i¿d©abuf„r", 
ªq
);

4452 #ifde‡
DEBUG


4453 
	`¥ötf
("buffer_node hasÇot been hitted\n");

4456 
‰ì_£˘‹
 = 
ssd
->
døm
->
buf„r
->
max_buf„r_£˘‹
 - ssd->døm->buf„r->
buf„r_£˘‹_cou¡
;

4457 i‡(
‰ì_£˘‹
 >
£˘‹_cou¡
) {

4458 
Êag
 = 1;

4460 i‡(
Êag
 == 0) {

4461 #ifde‡
DEBUG


4462 
	`¥ötf
("buf„∏nŸ hô, fªe_£˘‹Ñemaöed i†%d,√ed wrôêötÿ£˘‹_cou¡ i†%d\n",
‰ì_£˘‹
, 
£˘‹_cou¡
);

4465 
wrôe_back_cou¡
 = 
£˘‹_cou¡
 - 
‰ì_£˘‹
;

4466 if(
wrôe_back_cou¡
 > 0){

4467 
ssd
->
døm
->
buf„r
->
wrôe_miss_hô
 = ssd->døm->buf„r->wrôe_miss_hô + 
wrôe_back_cou¡
;

4469 
wrôe_back_cou¡
 > 0) {

4470 
sub_ªq
 = 
NULL
;

4471 
sub_ªq_°©e
 = 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
°‹ed
;

4472 #ifde‡
DEBUG


4473 
	`¥ötf
("next is write back buffer sizeámount.\n");

4475 
sub_ªq_size
 = 
	`size
(
ssd
->
døm
->
buf„r
->
buf„r_èû
->
°‹ed
);

4476 
sub_ªq_Õn
 = 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
group
;

4480 
	`≠≥nd_⁄_ªque°_missög_ö_d©a_buf„r_Õn_d©a
(
ªq
,
ssd
->
døm
->
buf„r
->
buf„r_èû
->
group
, ssd->døm->buf„r->buf„r_èû->
°‹ed
);

4482 
	`ssdsim_msg
("now, f‹ wrôesubªque° i¿d©abuf„∏≠≥ndögÜ≤ is: %d", 
sub_ªq_Õn
);

4491 i‡(
ªq
 !
NULL
) {

4493 #ifde‡
DEBUG


4494 
	`¥ötf
("opps,Çever happen \n");

4509 
ssd
->
døm
->
buf„r
->
buf„r_£˘‹_cou¡
 = ssd->døm->buf„r->buf„r_£˘‹_cou¡ - 
sub_ªq_size
;

4511 
±
 = 
ssd
->
døm
->
buf„r
->
buf„r_èû
;

4512 
	`avlTªeDñ
(
ssd
->
døm
->
buf„r
, (
TREE_NODE
 *Ë
±
);

4513 i‡(
ssd
->
døm
->
buf„r
->
buf„r_hód
->
LRU_lök_√xt
 =
NULL
) {

4514 
ssd
->
døm
->
buf„r
->
buf„r_hód
 = 
NULL
;

4515 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = 
NULL
;

4517 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = ssd->døm->buf„r->buf„r_èû->
LRU_lök_¥e
;

4518 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
LRU_lök_√xt
 = 
NULL
;

4520 
±
->
LRU_lök_√xt
 = 
NULL
;

4521 
±
->
LRU_lök_¥e
 = 
NULL
;

4522 
	`AVL_TREENODE_FREE
(
ssd
->
døm
->
buf„r
, (
TREE_NODE
 *Ë
±
);

4523 
±
 = 
NULL
;

4525 
wrôe_back_cou¡
 =

4527 
wrôe_back_cou¡
 - 
sub_ªq_size
;

4528 #ifde‡
DEBUG


4529 
	`¥ötf
("⁄˚ wrôêö£π i¡ÿbuf„∏buàwrôeback fú°,áŒÇìd wrôêötÿ£˘‹êi†%d, buàthi†timêwrôeback i¡ÿ£˘‹ i†%d \n", 
wrôe_back_cou¡
, 
sub_ªq_size
);

4534 
	`ssdsim_msg
("enough data buffer space forÅhe coming write sub_request, soÇoádding in databuffer hit missing");

4540 
	`ssdsim_msg
("ö wrôê¥o˚ss, wêevîyÅimê,thêd©abuf„r, hîêmakê®buf„r-nodê™d in£π i¡ÿbuf„∏åì. shouldÖröt‡hîe, %d \n", 
Õn
);

4541 
√w_node
 = 
NULL
;

4542 
√w_node
 = (
buf„r_group
 *Ë
	`mÆloc
((buffer_group));

4543 
	`Æloc_as£π
(
√w_node
, "buffer_group_node");

4544 
	`mem£t
(
√w_node
, 0, (
buf„r_group
));

4546 
√w_node
->
group
 = 
Õn
;

4547 
√w_node
->
°‹ed
 = 
°©e
;

4548 
√w_node
->
dúty_˛ón
 = 
°©e
;

4549 
√w_node
->
LRU_lök_¥e
 = 
NULL
;

4550 
√w_node
->
LRU_lök_√xt
 = 
ssd
->
døm
->
buf„r
->
buf„r_hód
;

4551 i‡(
ssd
->
døm
->
buf„r
->
buf„r_hód
 !
NULL
) {

4552 
ssd
->
døm
->
buf„r
->
buf„r_hód
->
LRU_lök_¥e
 = 
√w_node
;

4554 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = 
√w_node
;

4556 
ssd
->
døm
->
buf„r
->
buf„r_hód
 = 
√w_node
;

4557 
√w_node
->
LRU_lök_¥e
 = 
NULL
;

4558 
	`avlTªeAdd
(
ssd
->
døm
->
buf„r
, (
TREE_NODE
 *Ë
√w_node
);

4559 
ssd
->
døm
->
buf„r
->
buf„r_£˘‹_cou¡
 +
£˘‹_cou¡
;

4567 #ifde‡
DEBUG


4568 
	`¥ötf
("buffer_node hit\n");

4571 
i
 = 0; i < 
ssd
->
∑ømëî
->
sub∑ge_∑ge
; i++) {

4576 i‡((
°©e
 >> 
i
) % 2 != 0) {

4577 
l¢
 = 
Õn
 * 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 + 
i
;

4578 
hô_Êag
 = 0;

4579 
hô_Êag
 = (
buf„r_node
->
°‹ed
Ë& (0x00000001 << 
i
);

4581 i‡(
hô_Êag
 !=

4584 
a˘ive_ªgi⁄_Êag
 = 1;

4586 i‡(
ªq
 !
NULL
) {

4587 i‡(
ssd
->
døm
->
buf„r
->
buf„r_hód
 !
buf„r_node
) {

4588 i‡(
ssd
->
døm
->
buf„r
->
buf„r_èû
 =
buf„r_node
) {

4589 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = 
buf„r_node
->
LRU_lök_¥e
;

4590 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = 
NULL
;

4591 } i‡(
buf„r_node
 !
ssd
->
døm
->
buf„r
->
buf„r_hód
) {

4592 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = buffer_node->LRU_link_next;

4593 
buf„r_node
->
LRU_lök_√xt
->
LRU_lök_¥e
 = buffer_node->LRU_link_pre;

4595 
buf„r_node
->
LRU_lök_√xt
 = 
ssd
->
døm
->
buf„r
->
buf„r_hód
;

4596 
ssd
->
døm
->
buf„r
->
buf„r_hód
->
LRU_lök_¥e
 = 
buf„r_node
;

4597 
buf„r_node
->
LRU_lök_¥e
 = 
NULL
;

4598 
ssd
->
døm
->
buf„r
->
buf„r_hód
 = 
buf„r_node
;

4600 
ssd
->
døm
->
buf„r
->
wrôe_hô
++;

4601 
ªq
->
com∂ëe_l¢_cou¡
++;

4614 
ssd
->
døm
->
buf„r
->
wrôe_miss_hô
++;

4616 i‡(
ssd
->
døm
->
buf„r
->
buf„r_£˘‹_cou¡
 >ssd->døm->buf„r->
max_buf„r_£˘‹
) {

4617 i‡(
buf„r_node
 ==

4618 
ssd
->
døm
->
buf„r
->
buf„r_èû
)

4620 
±
 = 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
LRU_lök_¥e
;

4621 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
LRU_lök_¥e
 = 
±
->LRU_link_pre;

4622 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
LRU_lök_¥e
->
LRU_lök_√xt
 = ssd->dram->buffer->buffer_tail;

4623 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
LRU_lök_√xt
 = 
±
;

4624 
±
->
LRU_lök_√xt
 = 
NULL
;

4625 
±
->
LRU_lök_¥e
 = 
ssd
->
døm
->
buf„r
->
buf„r_èû
;

4626 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = 
±
;

4629 
sub_ªq
 = 
NULL
;

4630 
sub_ªq_°©e
 = 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
°‹ed
;

4631 
sub_ªq_size
 = 
	`size
(
ssd
->
døm
->
buf„r
->
buf„r_èû
->
°‹ed
);

4632 
sub_ªq_Õn
 = 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
group
;

4635 
	`≠≥nd_⁄_ªque°_missög_ö_d©a_buf„r_Õn_d©a
(
ªq
, 
sub_ªq_Õn
, 
sub_ªq_°©e
);

4637 
	`ssdsim_msg
("now,ö hôÖ¨t,nÿhômis†∑π, f‹ wrôesubªque° i¿d©abuf„∏≠≥ndögÜ≤ is: %d", 
sub_ªq_Õn
);

4641 i‡(
ªq
 !
NULL
) {

4643 } i‡(
ªq
 =
NULL
) {

4652 
ssd
->
døm
->
buf„r
->
buf„r_£˘‹_cou¡
 = ssd->døm->buf„r->buf„r_£˘‹_cou¡ - 
sub_ªq_size
;

4653 
±
 = 
ssd
->
døm
->
buf„r
->
buf„r_èû
;

4654 
	`avlTªeDñ
(
ssd
->
døm
->
buf„r
, (
TREE_NODE
 *Ë
±
);

4660 i‡(
ssd
->
døm
->
buf„r
->
buf„r_hód
->
LRU_lök_√xt
 =
NULL
) {

4661 
ssd
->
døm
->
buf„r
->
buf„r_hód
 = 
NULL
;

4662 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = 
NULL
;

4664 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = ssd->døm->buf„r->buf„r_èû->
LRU_lök_¥e
;

4665 
ssd
->
døm
->
buf„r
->
buf„r_èû
->
LRU_lök_√xt
 = 
NULL
;

4667 
±
->
LRU_lök_√xt
 = 
NULL
;

4668 
±
->
LRU_lök_¥e
 = 
NULL
;

4669 
	`AVL_TREENODE_FREE
(
ssd
->
døm
->
buf„r
, (
TREE_NODE
 *Ë
±
);

4670 
±
 = 
NULL
;

4674 
add_Êag
 = 0x00000001 << (
l¢
 % 
ssd
->
∑ømëî
->
sub∑ge_∑ge
);

4676 i‡(
ssd
->
døm
->
buf„r
->
buf„r_hód
 !=

4677 
buf„r_node
)

4679 i‡(
ssd
->
døm
->
buf„r
->
buf„r_èû
 =
buf„r_node
) {

4680 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = 
NULL
;

4681 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = 
buf„r_node
->
LRU_lök_¥e
;

4683 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = buffer_node->LRU_link_next;

4684 
buf„r_node
->
LRU_lök_√xt
->
LRU_lök_¥e
 = buffer_node->LRU_link_pre;

4686 
buf„r_node
->
LRU_lök_√xt
 = 
ssd
->
døm
->
buf„r
->
buf„r_hód
;

4687 
ssd
->
døm
->
buf„r
->
buf„r_hód
->
LRU_lök_¥e
 = 
buf„r_node
;

4688 
buf„r_node
->
LRU_lök_¥e
 = 
NULL
;

4689 
ssd
->
døm
->
buf„r
->
buf„r_hód
 = 
buf„r_node
;

4691 
buf„r_node
->
°‹ed
 = buf„r_node->°‹ed | 
add_Êag
;

4692 
buf„r_node
->
dúty_˛ón
 = buf„r_node->dúty_˛ó¿| 
add_Êag
;

4693 
ssd
->
døm
->
buf„r
->
buf„r_£˘‹_cou¡
++;

4700  
ssd
;

4707 
	}
}

4711 
	$¥ötf_ªad_ªque°_√ed_di°r_Êag_vÆue_™d_ûlu°i⁄
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
)

4714 
i
, 
l¢
, 
Õn
,
œ°_Õn
, 
fú°_Õn
, 
ödex
;

4715 
√ed_di°b_Êag
;

4716 
l¢
 = 
ªq
->lsn;

4717 
Õn
 = 
ªq
->
l¢
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

4719 
œ°_Õn
 = (
ªq
->
l¢
 +Ñeq->
size
 - 1Ë/ 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

4720 
fú°_Õn
 = 
ªq
->
l¢
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

4723 
	`¥ötf
("ªadáddªss: %ŒdÇìd_di°r_Êag i†‰omÅaûÅÿhód,%d, begöÜ¢ i† %d \n", 
ªq
,Ñeq->
l¢
);

4724 
Õn
 <
œ°_Õn
){

4726 * 
ãmp
;

4727 
ödex
 = (
Õn
 - 
fú°_Õn
Ë/ (32 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
);

4729 
√ed_di°b_Êag
 = 
ªq
->
√ed_di°r_Êag
[
ödex
] & ( (0x0000000‡<< ( ((
Õn
 - 
fú°_Õn
Ë%(32 /
ssd
->
∑ømëî
->
sub∑ge_∑ge
)) * ssd->parameter->subpage_page) ));

4730 
	`¥ötf
("⁄lyÜa° 4 bôs: %x, index %d,Ü≤ %d\n", 
√ed_di°b_Êag
, 
ödex
, 
Õn
);

4732 
Õn
++;

4734 
	`¥ötf
("\¿™dÑeqÅŸÆÜ≤Çumbî i†%d , 0 món†hô,Çìdög di°ributög\n", 
œ°_Õn
 - 
fú°_Õn
 + 1);

4735 
	}
}

4740 
	$¥ötf_wrôe_ªque°_√ed_di°r_Êag_vÆue_™d_ûlu°i⁄
(
ssd_öfo
* 
ssd
,
ªque°
* 
√w_ªque°
)

4742 
i
, 
Àn
;

4743 
_bi_node
* 
ãmp_node
 = 
NULL
;

4744 
ãmp_node
 = 
√w_ªque°
->
missög_ö_d©a_buf„r_Õn_d©a
->
node_hód
;

4745 if(
√w_ªque°
->
missög_ö_d©a_buf„r_Õn_d©a
->
Àn
 != 0){

4747 
	`¥ötf
("wrôêªque°ádªss: %Œd, ha†nÿhô,ÇohôÇumbî i†%d\n", 
√w_ªque°
,Çew_ªque°->
missög_ö_d©a_buf„r_Õn_d©a
->
Àn
);

4748 
i
 = 0; i < 
√w_ªque°
->
missög_ö_d©a_buf„r_Õn_d©a
->
Àn
; i ++){

4749 
	`¥ötf
("%d ",
ãmp_node
->
Õn_™d_°©e
[0]);

4750 if(
ãmp_node
 =
NULL
){

4751 
	`¥ötf
("wrong inÖrintf_write_request_need_distr_flag\n");

4756 
ãmp_node
 =Åemp_node->
√xtNode
;

4758 
	`¥ötf
("\n");

4760 
	`¥ötf
("wrôêªque°ádªss: %Œd,áŒ hô i¿d©®buf„r\n", 
√w_ªque°
);

4763 
	}
}

4768 
ssd_öfo
 *
	$DFTL_buf„r_m™agemít
(
ssd_öfo
 *
ssd
)

4770 
j
, 
l¢
, 
Õn
, 
œ°_Õn
, 
fú°_Õn
, 
ödex
, 
com∂ëe_Êag
 = 0, 
°©e
, 
fuŒ_∑ge
;

4771 
Êag
 = 0, 
√ed_di°b_Êag
, 
l¢_Êag
, 
Êag1
 = 1, 
a˘ive_ªgi⁄_Êag
 = 0;

4772 
ö_ödex_off£t
 = 0;

4773 
ªque°
 *
√w_ªque°
;

4774 
buf„r_group
 *
buf„r_node
, 
key
;

4775 
mask
 = 0, 
off£t1
 = 0, 
off£t2
 = 0;

4776 #ifde‡
DEBUG_CURR_TIME


4777 
	`¥ötf
("DEBUG_CURR_TIME i†%Œd i¿buf„r_m™agemíàfun˘i⁄ \n",
ssd
->
cuºít_time
);

4780 
ssd
->
døm
->
cuºít_time
 = ssd->current_time;

4781 
fuŒ_∑ge
 = ~(0xfffffff‡<< 
ssd
->
∑ømëî
->
sub∑ge_∑ge
);

4783 
√w_ªque°
 = 
ssd
->
ªque°_èû
;

4784 if(
√w_ªque°
 =
NULL
){

4785 
	`¥ötf
("nowÇoÑequests in ssd\n");

4786  
ssd
;

4788 
l¢
 = 
√w_ªque°
->lsn;

4789 
Õn
 = 
√w_ªque°
->
l¢
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

4790 
œ°_Õn
 = (
√w_ªque°
->
l¢
 +Çew_ªque°->
size
 - 1Ë/ 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

4791 
fú°_Õn
 = 
√w_ªque°
->
l¢
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

4793 
√w_ªque°
->
√ed_di°r_Êag
 = (*Ë
	`mÆloc
(

4794 (Ë* ((
œ°_Õn
 - 
fú°_Õn
 + 1Ë* 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 / 32 + 1));

4796 
	`Æloc_as£π
(
√w_ªque°
->
√ed_di°r_Êag
, "new_request->need_distr_flag");

4797 
	`mem£t
(
√w_ªque°
->
√ed_di°r_Êag
, 0,

4798 (Ë* ((
œ°_Õn
 - 
fú°_Õn
 + 1Ë* 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 / 32 + 1));

4799 #ifde‡
DEBUG


4800 
	`¥ötf
("yes, hîêi†thêªque°_èû f‹Çew_ªque° ,ô†l¢ i†%d, sizêi†%d, o≥øti⁄ i†%d\n",
√w_ªque°
->
l¢
,Çew_ªque°->
size
,Çew_ªque°->
›î©i⁄
);

4803 i‡(
√w_ªque°
->
›î©i⁄
 =
READ
) {

4804 
Õn
 <
œ°_Õn
) {

4809 
	`ssdsim_msg
("öÑódÑeque° föd i¿d©abuf„r,Ü≤ i†%d", 
Õn
);

4810 
√ed_di°b_Êag
 = 
fuŒ_∑ge
;

4811 
key
.
group
 = 
Õn
;

4812 
buf„r_node
 = (
buf„r_group
 *Ë
	`avlTªeFöd
(
ssd
->
døm
->
buf„r
,

4813 (
TREE_NODE
 *Ë&
key
);

4815 
	`ssdsim_msg
("öÑód, buf„r_nodêi†%Œd", 
buf„r_node
);

4817 (
buf„r_node
 !
NULL
Ë&& (
l¢
 < (
Õn
 + 1Ë* 
ssd
->
∑ømëî
->
sub∑ge_∑ge
) &&

4818 (
l¢
 <(
√w_ªque°
->l¢ +Çew_ªque°->
size
 - 1))) {

4819 #ifde‡
DEBUG


4820 
	`¥ötf
("buffer_node isÇotÇull, find in TreeÅhe buffer_node information is :\n");

4822 
	`¥ötf
("buf„r_node. grou∞%d, st‹ed %d, dúty_˛ó¿%d, fœg %d\n", 
buf„r_node
->
group
, buf„r_node->
°‹ed
, buf„r_node->
dúty_˛ón
, buf„r_node->
Êag
);

4826 
l¢_Êag
 = 
fuŒ_∑ge
;

4827 
mask
 = 1 << (
l¢
 % 
ssd
->
∑ømëî
->
sub∑ge_∑ge
);

4828 i‡(
mask
 > 31) {

4829 
	`¥ötf
("the subpageÇumber isÜargerÅhan 32!add some cases");

4830 
	`gëch¨
();

4831 } i‡((
buf„r_node
->
°‹ed
 & 
mask
) == mask) {

4832 
Êag
 = 1;

4833 
l¢_Êag
 =Ü¢_Êag & (~
mask
);

4834 #ifde‡
DEBUG


4835 
	`¥ötf
("l¢_Êag i†0x%x, buf„r_node->°‹edÔºüÔºüÔºüwhîêi†hﬁêi†0x%x, mask i†0x%x\n",
l¢_Êag
, 
buf„r_node
->
°‹ed
,
mask
);

4841 i‡(
Êag
 == 1) {

4842 i‡(
ssd
->
døm
->
buf„r
->
buf„r_hód
 !
buf„r_node
) {

4843 i‡(
ssd
->
døm
->
buf„r
->
buf„r_èû
 =
buf„r_node
) {

4844 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = 
NULL
;

4845 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = 
buf„r_node
->
LRU_lök_¥e
;

4847 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = buffer_node->LRU_link_next;

4848 
buf„r_node
->
LRU_lök_√xt
->
LRU_lök_¥e
 = buffer_node->LRU_link_pre;

4850 
buf„r_node
->
LRU_lök_√xt
 = 
ssd
->
døm
->
buf„r
->
buf„r_hód
;

4851 
ssd
->
døm
->
buf„r
->
buf„r_hód
->
LRU_lök_¥e
 = 
buf„r_node
;

4852 
buf„r_node
->
LRU_lök_¥e
 = 
NULL
;

4853 
ssd
->
døm
->
buf„r
->
buf„r_hód
 = 
buf„r_node
;

4855 
ssd
->
døm
->
buf„r
->
ªad_hô
++;

4856 
√w_ªque°
->
com∂ëe_l¢_cou¡
++;

4857 } i‡(
Êag
 == 0) {

4858 
ssd
->
døm
->
buf„r
->
ªad_miss_hô
++;

4859 #ifde‡
DEBUG


4861 
	`¥ötf
("buf„r->ªad_miss_hô++ i†%d\n",
ssd
->
døm
->
buf„r
->
ªad_miss_hô
);

4865 
√ed_di°b_Êag
 =Çìd_di°b_Êag & 
l¢_Êag
;

4867 
Êag
 = 0;

4868 
l¢
++;

4871 
ödex
 = (
Õn
 - 
fú°_Õn
Ë/ (32 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
);

4872 
√w_ªque°
->
√ed_di°r_Êag
[
ödex
] =Çew_ªque°->√ed_di°r_Êag[ödex] | (
√ed_di°b_Êag


4873 << (((
Õn
 - 
fú°_Õn
Ë% (32 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
)) * ssd->parameter->subpage_page));

4875 
	`åa˚Eº‹_msg
("√ed_di°b_Êag i†%d", 
√ed_di°b_Êag
);

4876 
Õn
++;

4881 #ifde‡
com¥essi⁄_ªÀv™t


4882 
	`¥ötf_ªad_ªque°_√ed_di°r_Êag_vÆue_™d_ûlu°i⁄
(
ssd
, 
√w_ªque°
);

4885 } i‡(
√w_ªque°
->
›î©i⁄
 =
WRITE
) {

4891 
Õn
 <
œ°_Õn
) {

4892 
√ed_di°b_Êag
 = 
fuŒ_∑ge
;

4893 
mask
 = ~(0xfffffff‡<< (
ssd
->
∑ømëî
->
sub∑ge_∑ge
));

4894 
°©e
 = 
mask
;

4896 i‡(
Õn
 =
fú°_Õn
) {

4897 
off£t1
 = 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 - ((
Õn
 + 1Ë* ssd->∑ømëî->sub∑ge_∑gê- 
√w_ªque°
->
l¢
);

4898 
°©e
 = sèã & (0xfffffff‡<< 
off£t1
);

4900 i‡(
Õn
 =
œ°_Õn
) {

4901 
off£t2
 = 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 -

4902 ((
Õn
 + 1Ë* 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 - (
√w_ªque°
->
l¢
 +Çew_ªque°->
size
));

4903 
°©e
 = sèã & (~(0xfffffff‡<< 
off£t2
));

4905 #ifde‡ 
DEBUG


4906 
	`¥ötf
("wrôêÕ¿°©êi†0x%x, off£t1 i†0x%x, off£t2 i†0x%x\n",
°©e
,
off£t1
, 
off£t2
 );

4911 
	`ssdsim_msg
("bef‹êthêjudgög o‡≠≥ndög o‡thêmissög i¿d©abuf„r,Ü≤ i†%d", 
Õn
);

4912 
	`wrôe_ªque°_gë_missög_ö_d©abuf„r
(
ssd
, 
Õn
, 
°©e
, 
√w_ªque°
);

4914 
Õn
++;

4919 #ifde‡
com¥essi⁄_ªÀv™t


4920 
	`¥ötf_wrôe_ªque°_√ed_di°r_Êag_vÆue_™d_ûlu°i⁄
(
ssd
, 
√w_ªque°
);

4926 if(
√w_ªque°
->
›î©i⁄
 =
READ
){

4927 
com∂ëe_Êag
 = 1;

4928 
j
 = 0; j <(
œ°_Õn
 - 
fú°_Õn
 + 1Ë* 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 / 32; j++) {

4929 i‡(
√w_ªque°
->
√ed_di°r_Êag
[
j
] != 0) {

4930 
com∂ëe_Êag
 = 0;

4933 i‡(
com∂ëe_Êag
 == 1) {

4935 
√w_ªque°
->
ª•⁄£_time
 = 
ssd
->
cuºít_time
 + 1000;

4938 
	`åa˚Eº‹_msg
("ªadÑeque° %ŒdÑe•⁄£_timê%Œd", 
√w_ªque°
,Çew_ªque°->
ª•⁄£_time
);

4940 if(
√w_ªque°
->
›î©i⁄
 =
WRITE
){

4942 
	`åa˚Eº‹_msg
(" wrôêªque° %Œd, missög_ö_d©a_buf„r_Õn_d©a->À¿i†%d", 
√w_ªque°
,Çew_ªque°->
missög_ö_d©a_buf„r_Õn_d©a
->
Àn
);

4944 i‡(
√w_ªque°
->
missög_ö_d©a_buf„r_Õn_d©a
->
Àn
 == 0) {

4947 
√w_ªque°
->
ª•⁄£_time
 = 
ssd
->
cuºít_time
 + 1000;

4950 
	`åa˚Eº‹_msg
(" wrôêªque° %Œd, xxxxxxx_missög_ö_d©a_buf„r_Õn_d©a->À¿i†%d", 
√w_ªque°
,Çew_ªque°->
missög_ö_d©a_buf„r_Õn_d©a
->
Àn
);

4953 
	`åa˚Eº‹_msg
("wrôêªque° %ŒdÑe•⁄£_timê%Œd", 
√w_ªque°
,Çew_ªque°->
ª•⁄£_time
);

4958 #ifde‡
DEBUG


4959 
	`¥ötf
("com∂ëe_Êag i†%d, (0 indiˇã†th©ÇŸ bêtŸÆly sevi˚d by buf„∏dúe˘ñy)\n", 
com∂ëe_Êag
);

4977 #ifde‡
COMPRESSION_MAPPING


4978 
	`COMPRESSION_vÆue_ªque°_DFTL_∑ømëîs_f‹_di°ribuã_subªque°s
(
ssd
);

4980 
	`vÆue_ªque°_DFTL_∑ømëîs_f‹_di°ribuã_subªque°s
(
ssd
);

4984 
	`Ârötf
(
ssd
->
Â_numbî_subªque°s_txt
, "%dÑeque°Ü¢ %d, subªque°nubmî i†%d\n", 
√w_ªque°
->
›î©i⁄
,Çew_ªque°->
l¢
,Çew_ªque°->
missög_ö_d©a_buf„r_Õn_d©a
->
Àn
);

4987  
ssd
;

4988 
	}
}

5003 
ssd_öfo
 *
	$buf„r_m™agemít
(
ssd_öfo
 *
ssd
) {

5004 
j
, 
l¢
, 
Õn
, 
œ°_Õn
, 
fú°_Õn
, 
ödex
, 
com∂ëe_Êag
 = 0, 
°©e
, 
fuŒ_∑ge
;

5005 
Êag
 = 0, 
√ed_di°b_Êag
, 
l¢_Êag
, 
Êag1
 = 1, 
a˘ive_ªgi⁄_Êag
 = 0;

5006 
ªque°
 *
√w_ªque°
;

5007 
buf„r_group
 *
buf„r_node
, 
key
;

5008 
mask
 = 0, 
off£t1
 = 0, 
off£t2
 = 0;

5009 #ifde‡
DEBUG_CURR_TIME


5010 
	`¥ötf
("DEBUG_CURR_TIME i†%Œd i¿buf„r_m™agemíàfun˘i⁄ \n",
ssd
->
cuºít_time
);

5013 
ssd
->
døm
->
cuºít_time
 = ssd->current_time;

5014 
fuŒ_∑ge
 = ~(0xfffffff‡<< 
ssd
->
∑ømëî
->
sub∑ge_∑ge
);

5016 
√w_ªque°
 = 
ssd
->
ªque°_èû
;

5017 
l¢
 = 
√w_ªque°
->lsn;

5018 
Õn
 = 
√w_ªque°
->
l¢
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

5019 
œ°_Õn
 = (
√w_ªque°
->
l¢
 +Çew_ªque°->
size
 - 1Ë/ 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

5020 
fú°_Õn
 = 
√w_ªque°
->
l¢
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

5022 
√w_ªque°
->
√ed_di°r_Êag
 = (*Ë
	`mÆloc
(

5023 (Ë* ((
œ°_Õn
 - 
fú°_Õn
 + 1Ë* 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 / 32 + 1));

5025 
	`Æloc_as£π
(
√w_ªque°
->
√ed_di°r_Êag
, "new_request->need_distr_flag");

5026 
	`mem£t
(
√w_ªque°
->
√ed_di°r_Êag
, 0,

5027 (Ë* ((
œ°_Õn
 - 
fú°_Õn
 + 1Ë* 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 / 32 + 1));

5028 #ifde‡
DEBUG


5029 
	`¥ötf
("yes, hîêi†thêªque°_èû f‹Çew_ªque° ,ô†l¢ i†%d, sizêi†%d, o≥øti⁄ i†%d\n",
√w_ªque°
->
l¢
,Çew_ªque°->
size
,Çew_ªque°->
›î©i⁄
);

5032 i‡(
√w_ªque°
->
›î©i⁄
 =
READ
) {

5033 
Õn
 <
œ°_Õn
) {

5038 
√ed_di°b_Êag
 = 
fuŒ_∑ge
;

5039 
key
.
group
 = 
Õn
;

5040 
buf„r_node
 = (
buf„r_group
 *Ë
	`avlTªeFöd
(
ssd
->
døm
->
buf„r
,

5041 (
TREE_NODE
 *Ë&
key
);

5045 (
buf„r_node
 !
NULL
Ë&& (
l¢
 < (
Õn
 + 1Ë* 
ssd
->
∑ømëî
->
sub∑ge_∑ge
) &&

5046 (
l¢
 <(
√w_ªque°
->l¢ +Çew_ªque°->
size
 - 1))) {

5047 #ifde‡
DEBUG


5048 
	`¥ötf
("buffer_node isÇotÇull, find in TreeÅhe buffer_node information is :\n");

5050 
	`¥ötf
("buf„r_node. grou∞%d, st‹ed %d, dúty_˛ó¿%d, fœg %d\n", 
buf„r_node
->
group
, buf„r_node->
°‹ed
, buf„r_node->
dúty_˛ón
, buf„r_node->
Êag
);

5054 
l¢_Êag
 = 
fuŒ_∑ge
;

5055 
mask
 = 1 << (
l¢
 % 
ssd
->
∑ømëî
->
sub∑ge_∑ge
);

5056 i‡(
mask
 > 31) {

5057 
	`¥ötf
("the subpageÇumber isÜargerÅhan 32!add some cases");

5058 
	`gëch¨
();

5059 } i‡((
buf„r_node
->
°‹ed
 & 
mask
) == mask) {

5060 
Êag
 = 1;

5061 
l¢_Êag
 =Ü¢_Êag & (~
mask
);

5062 #ifde‡
DEBUG


5063 
	`¥ötf
("l¢_Êag i†0x%x, buf„r_node->°‹edÔºüÔºüÔºüwhîêi†hﬁêi†0x%x, mask i†0x%x\n",
l¢_Êag
, 
buf„r_node
->
°‹ed
,
mask
);

5069 i‡(
Êag
 == 1) {

5070 i‡(
ssd
->
døm
->
buf„r
->
buf„r_hód
 !
buf„r_node
) {

5071 i‡(
ssd
->
døm
->
buf„r
->
buf„r_èû
 =
buf„r_node
) {

5072 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = 
NULL
;

5073 
ssd
->
døm
->
buf„r
->
buf„r_èû
 = 
buf„r_node
->
LRU_lök_¥e
;

5075 
buf„r_node
->
LRU_lök_¥e
->
LRU_lök_√xt
 = buffer_node->LRU_link_next;

5076 
buf„r_node
->
LRU_lök_√xt
->
LRU_lök_¥e
 = buffer_node->LRU_link_pre;

5078 
buf„r_node
->
LRU_lök_√xt
 = 
ssd
->
døm
->
buf„r
->
buf„r_hód
;

5079 
ssd
->
døm
->
buf„r
->
buf„r_hód
->
LRU_lök_¥e
 = 
buf„r_node
;

5080 
buf„r_node
->
LRU_lök_¥e
 = 
NULL
;

5081 
ssd
->
døm
->
buf„r
->
buf„r_hód
 = 
buf„r_node
;

5083 
ssd
->
døm
->
buf„r
->
ªad_hô
++;

5084 
√w_ªque°
->
com∂ëe_l¢_cou¡
++;

5085 } i‡(
Êag
 == 0) {

5086 
ssd
->
døm
->
buf„r
->
ªad_miss_hô
++;

5087 #ifde‡
DEBUG


5089 
	`¥ötf
("buf„r->ªad_miss_hô++ i†%d\n",
ssd
->
døm
->
buf„r
->
ªad_miss_hô
);

5093 
√ed_di°b_Êag
 =Çìd_di°b_Êag & 
l¢_Êag
;

5095 
Êag
 = 0;

5096 
l¢
++;

5099 
ödex
 = (
Õn
 - 
fú°_Õn
Ë/ (32 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
);

5100 
√w_ªque°
->
√ed_di°r_Êag
[
ödex
] =Çew_ªque°->√ed_di°r_Êag[ödex] | (
√ed_di°b_Êag


5101 << (((
Õn
 - 
fú°_Õn
Ë% (32 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
)) * ssd->parameter->subpage_page));

5102 
Õn
++;

5105 } i‡(
√w_ªque°
->
›î©i⁄
 =
WRITE
) {

5106 
Õn
 <
œ°_Õn
) {

5107 
√ed_di°b_Êag
 = 
fuŒ_∑ge
;

5108 
mask
 = ~(0xfffffff‡<< (
ssd
->
∑ømëî
->
sub∑ge_∑ge
));

5109 
°©e
 = 
mask
;

5111 i‡(
Õn
 =
fú°_Õn
) {

5112 
off£t1
 = 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 - ((
Õn
 + 1Ë* ssd->∑ømëî->sub∑ge_∑gê- 
√w_ªque°
->
l¢
);

5113 
°©e
 = sèã & (0xfffffff‡<< 
off£t1
);

5115 i‡(
Õn
 =
œ°_Õn
) {

5116 
off£t2
 = 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 -

5117 ((
Õn
 + 1Ë* 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 - (
√w_ªque°
->
l¢
 +Çew_ªque°->
size
));

5118 
°©e
 = sèã & (~(0xfffffff‡<< 
off£t2
));

5120 #ifde‡ 
DEBUG


5121 
	`¥ötf
("wrôêÕ¿°©êi†0x%x, off£t1 i†0x%x, off£t2 i†0x%x\n",
°©e
,
off£t1
, 
off£t2
 );

5123 
ssd
 = 
	`ö£π2buf„r
(ssd, 
Õn
, 
°©e
, 
NULL
, 
√w_ªque°
);

5124 
Õn
++;

5127 
com∂ëe_Êag
 = 1;

5128 
j
 = 0; j <(
œ°_Õn
 - 
fú°_Õn
 + 1Ë* 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 / 32; j++) {

5129 i‡(
√w_ªque°
->
√ed_di°r_Êag
[
j
] != 0) {

5130 
com∂ëe_Êag
 = 0;

5133 #ifde‡
DEBUG


5134 
	`¥ötf
("com∂ëe_Êag i†%d, (0 indiˇã†th©ÇŸ bêtŸÆly sevi˚d by buf„∏dúe˘ñy)\n", 
com∂ëe_Êag
);

5140 i‡((
com∂ëe_Êag
 =1Ë&& (
√w_ªque°
->
subs
 =
NULL
)) {

5141 
√w_ªque°
->
begö_time
 = 
ssd
->
cuºít_time
;

5142 
√w_ªque°
->
ª•⁄£_time
 = 
ssd
->
cuºít_time
 + 1000;

5145  
ssd
;

5146 
	}
}

5151 
	$Õn2µn
(
ssd_öfo
 *
ssd
, 
l¢
) {

5152 
Õn
, 
µn
;

5153 
íåy
 *
p_m≠
 = 
ssd
->
døm
->
m≠
->
m≠_íåy
;

5154 #ifde‡
DEBUG_CURR_TIME


5155 
	`¥ötf
("íã∏Õn2µn, cuºíàtime:%Œd\n",
ssd
->
cuºít_time
);

5158 
Õn
 = 
l¢
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

5159 
µn
 = (
p_m≠
[
Õn
]).
≤
;

5160  
µn
;

5161 
	}
}

5169 
ssd_öfo
 * 
	$di°ribuã
(
ssd_öfo
 *
ssd
) {

5170 
°¨t
, 
íd
, 
fú°_l¢
, 
œ°_l¢
, 
Õn
, 
Êag
 = 0, 
Êag_©èched
 = 0, 
fuŒ_∑ge
;

5171 
j
, 
k
, 
sub_size
;

5172 
i
 = 0;

5173 
ªque°
 *
ªq
;

5174 
sub_ªque°
 *
sub
;

5175 *
com∂t
;

5177 #ifde‡
DEBUG_CURR_TIME


5178 
	`¥ötf
("íã∏di°ribuã, cuºíàtime:%Œd\n",
ssd
->
cuºít_time
);

5179 
	`¥ötf_ssd_ªque°_queue
(
ssd
);

5181 
fuŒ_∑ge
 = ~(0xfffffff‡<< 
ssd
->
∑ømëî
->
sub∑ge_∑ge
);

5183 
ªq
 = 
ssd
->
ªque°_èû
;

5184 i‡(
ªq
->
ª•⁄£_time
 != 0) {

5185 #ifde‡
DEBUG


5186 
	`¥ötf
("req->response_time !=0\n");

5188  
ssd
;

5190 i‡(
ªq
->
›î©i⁄
 =
WRITE
) {

5191 #ifde‡
DEBUG


5192 
	`¥ötf
("ssd->req_tail's operation is write\n");

5194  
ssd
;

5197 i‡(
ªq
 !
NULL
) {

5198 i‡(
ªq
->
di°ri_Êag
 == 0) {

5200 i‡(
ªq
->
com∂ëe_l¢_cou¡
 !
ssd
->
ªque°_èû
->
size
) {

5201 
fú°_l¢
 = 
ªq
->
l¢
;

5202 
œ°_l¢
 = 
fú°_l¢
 + 
ªq
->
size
;

5203 
com∂t
 = 
ªq
->
√ed_di°r_Êag
;

5204 
°¨t
 = 
fú°_l¢
 - fú°_l¢ % 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

5205 
íd
 = (
œ°_l¢
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 + 1) * ssd->parameter->subpage_page;

5206 
i
 = (
íd
 - 
°¨t
) / 32;

5212 
i
 >= 0) {

5219 
j
 = 0; j < 32 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
; j++) {

5220 
k
 = (
com∂t
[((
íd
 - 
°¨t
Ë/ 32 - 
i
)] >> (
ssd
->
∑ømëî
->
sub∑ge_∑ge
 * 
j
)Ë& 
fuŒ_∑ge
;

5221 i‡(
k
 != 0) {

5222 
Õn
 = 
°¨t
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 +

5223 ((
íd
 - 
°¨t
Ë/ 32 - 
i
Ë* 32 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 + 
j
;

5224 
sub_size
 = 
	`å™s„r_size
(
ssd
, 
k
, 
Õn
, 
ªq
);

5225 i‡(
sub_size
 == 0) {

5228 
sub
 = 
	`¸ót_sub_ªque°
(
ssd
, 
Õn
, 
sub_size
, 0, 
ªq
,Ñeq->
›î©i⁄
);

5234 
i
 = i - 1;

5245 
ªq
->
begö_time
 = 
ssd
->
cuºít_time
;

5246 
ªq
->
ª•⁄£_time
 = 
ssd
->
cuºít_time
 + 1000;

5251  
ssd
;

5252 
	}
}

5256 
	$ˇlc_ªq_¶ack_time
(
ªque°
 * 
ªq
)

5258 
ch™√l_max
, 
chù_max
;

5259 
sub_ªque°
 *
sub
;

5260 
sub_ªque°
 *
ãmp_sub
;

5261 
öt64_t
 
ãmp_time
;

5262 
sub
 = 
ªq
->
subs
;

5263 
ãmp_time
 = 0;

5265 
sub
 !
NULL
){

5266 if(
ãmp_time
 < 
sub
->
£rvi˚d_time
){

5268 
ãmp_time
 = 
sub
->
£rvi˚d_time
;

5269 
ch™√l_max
 = 
sub
->
loˇti⁄
->
ch™√l
;

5270 
chù_max
 = 
sub
->
loˇti⁄
->
chù
 ;

5271 
ãmp_sub
 = 
sub
;

5273 
sub
 = sub->
√xt_subs
;

5278 
ãmp_sub
->
œ°_sign
 = 1;

5280 
sub
 = 
ªq
->
subs
;

5281 
sub
 !
NULL
){

5283 
sub
->
¶ack_time
 = 
ãmp_time
 - sub->
£rvi˚d_time
;

5284 #ifde‡
DEBUG


5285 
	`¥ötf
("ªq %u, sub sœck_timêi†%d\n", 
ªq
, 
sub
->
¶ack_time
);

5288 
sub
 = sub->
√xt_subs
;

5289 #ifde‡
DEBUG


5290 if(
sub
->
¶ack_time
 == 0) {

5292 
	`¥ötf
("ch™√l_max %d, chù_max %d, sub->loˇti⁄->ch™√»%d, sub->loˇti⁄->chù %d,Åheyáª should bêthêßme\n", 
ch™√l_max
, 
chù_max
, 
sub
->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
);

5298 
	}
}

5303 
	$ª‹dîög_ªq
(
ªque°
 * 
ªq
 )

5337 
	}
}

5348 
	$dñëe_ªque°_wôhout_subs
(
ªque°
* 
ªq
)

5350 if(
ªq
->
subs
 !
NULL
){

5351 
	`ssdsim_msg
("wrong in deletingÅheÑequestÖart, before deleting,Åhere shouldÇo subs");

5357 
	`‰ì
(
ªq
->
√ed_di°r_Êag
);

5358 
ªq
->
√ed_di°r_Êag
 = 
NULL
;

5360 if(
ªq
->
evi˘_sub_ªque°
 !
NULL
){

5361 
	`ssdsim_msg
("wrong in deletingÉvict_sub_request.");

5367 if(
ªq
->
„tch_sub_ªque°
 !
NULL
){

5368 
	`ssdsim_msg
("wrong in deleting fetch_sub_request.");

5376 if(
ªq
->
should_evi˘_Õn_d©a
 !
NULL
){

5377 if(
ªq
->
should_evi˘_Õn_d©a
->
Àn
 == 0){

5378 
	`dñ_bi_li°
(
ªq
->
should_evi˘_Õn_d©a
);

5379 
ªq
->
should_evi˘_Õn_d©a
 = 
NULL
;

5382 
	`ssdsim_msg
("wrong in deleting should_evict_lpn_data.");

5392 if(
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
 !
NULL
){

5394 if(
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
->
Àn
 == 0){

5395 
	`dñ_bi_li°
(
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
);

5396 
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
 = 
NULL
;

5399 
	`ssdsim_msg
("wr⁄g i¿dñëög missög_ö_DFTL_buf„r_Õn_d©®Àngth i†%d",
ªq
->
missög_ö_DFTL_buf„r_Õn_d©a
->
Àn
);

5409 if(
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
 !
NULL
){

5411 
	`dñ_bi_li°
(
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
);

5412 
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
 = 
NULL
;

5419 
	`‰ì
(
ªq
);

5421 
	}
}

5426 
	$ã°_föish_dñëi⁄
(
ssd_öfo
* 
ssd
)

5428 
Êag
 = 1;

5429 
öt64_t
 
°¨t_time
, 
íd_time
;

5430 
ªque°
 *
ªq
, *
¥e_node
;

5431 
sub_ªque°
 *
sub
, *
tmp
;

5434 
	`ssdsim_msg
("íã∏ã°_föish_dñëi⁄.cuºít_time:%Œd\n",
ssd
->
cuºít_time
);

5435 
ªq
 = 
ssd
->
ªque°_queue
;

5436 
¥e_node
 = 
ªq
;

5437 
°¨t_time
 = 0;

5438 
íd_time
 = 0;

5440 i‡(
ªq
 =
NULL
){

5441 #ifde‡
DEBUG


5442 
	`¥ötf
("ssd->request_queue is NULL\n");

5448 
ªq
 !
NULL
) {

5455 if((
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1 )||‘eq->
tŸÆ_waô_evi˘
 =1Ë|| (ªq->
¸óã_‹_nŸyë_n‹mÆ_subªque°s
 == 0)){

5456 if(
ssd
->
ªque°_queue_Àngth
 == 1){

5459 
¥e_node
 = 
ªq
;

5460 
ªq
 =Ñeq->
√xt_node
;

5466 if(
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
->
Àn
 != 0){

5467 if(
ªq
->
ª•⁄£_time
 != 0){

5468 
	`ssdsim_msg
("wr⁄g i¿ªque°Ñe•⁄£ÅimêvÆuêªq o≥øti⁄ %d,áddªs†i†%Œd", 
ªq
->
›î©i⁄
,Ñeq);

5485 i‡(
ªq
->
ª•⁄£_time
 != 0) {

5637 
	`ssdsim_msg
("now st› i¿ã°,Ñeq %Œd", 
ªq
);

5653 
	`ssdsim_msg
("íã∏hassubªque°Ö¨ànow, cuºíàtime:%Œd\n",
ssd
->
cuºít_time
);

5654 
Êag
 = 1;

5655 
°¨t_time
 = 0;

5656 
íd_time
 = 0;

5659 
sub
 = 
ªq
->
subs
;

5670 
sub
 !
NULL
) {

5671 i‡(
°¨t_time
 == 0)

5672 
°¨t_time
 = 
sub
->
begö_time
;

5673 i‡(
°¨t_time
 > 
sub
->
begö_time
)

5674 
°¨t_time
 = 
sub
->
begö_time
;

5675 i‡(
íd_time
 < 
sub
->
com∂ëe_time
)

5676 
íd_time
 = 
sub
->
com∂ëe_time
;

5677 i‡((
sub
->
cuºít_°©e
 =
SR_COMPLETE
Ë|| ((sub->
√xt_°©e
 == SR_COMPLETE) &&

5678 (
sub
->
√xt_°©e_¥edi˘_time
 <=

5679 
ssd
->
cuºít_time
)))

5681 #ifde‡
DEBUGSUSPEND


5682 
	`¥ötf
("sub begö_timêi†%Œd, com∂ëe_timêi†%Œd,sub->√xà°©ê%d, sub_√xt_timê%Œd,Åhi†ªque°'†sub, o∆yÜôéê⁄êsub, o≥øti⁄[%d] 0 i†wrôe,Õ¿[%d],ch™√l[%d], chù[%d], dõ[%d], block[%d],Öage[%d],hîêha†bì¿föished\n",
sub
->
begö_time
, sub->
com∂ëe_time
, sub->
√xt_°©e
, sub->
√xt_°©e_¥edi˘_time
, sub->
›î©i⁄
, sub->
Õn
, sub->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
block
, sub->loˇti⁄->
∑ge
);

5685 
sub
 = sub->
√xt_subs
;

5687 
Êag
 = 0;

5696 #ifde‡
DEBUGSUSPEND


5697 
	`¥ötf
("Êag hîêi†%d, *** 1 món†föished.0Ço\n",
Êag
);

5699 i‡(
Êag
 == 1) {

5789 
	`ssdsim_msg
("°› hîê2 wr⁄g h≠≥ns,Ñeq %Œd", 
ªq
);

5799 
ªq
 =Ñeq->
√xt_node
;

5806 
	`ssdsim_msg
("íã∏åa˚_ouçut,°ï 3.5 checkÇow, cuºíàtime:%Œd\n",
ssd
->
cuºít_time
);

5807 if(
ssd
->
ªque°_queue
 =
NULL
){

5808 if(
ssd
->
ªque°_èû
 !
NULL
){

5809 
ssd
->
ªque°_èû
 !
NULL
;

5810 
	`ssdsim_msg
("1 deletion inÑequests, has subrequests'Ñequests wrong");

5817 if(
ssd
->
ªque°_èû
 !
NULL
){

5818 if(
ssd
->
ªque°_èû
->
√xt_node
 !
NULL
){

5819 
	`ssdsim_msg
("2 deletion inÑequests, has subrequests'Ñequests wrong");

5825 if(
ssd
->
ªque°_queue_Àngth
 == 0){

5826 if–(
ssd
->
ªque°_queue
 !
NULL
Ë|| (ssd->
ªque°_èû
 != NULL) ){

5827 
	`ssdsim_msg
("3 deletion inÑequests, has subrequests'Ñequests wrong");

5836 if(
ssd
->
ªque°_queue_Àngth
 != 0){

5837 if–(
ssd
->
ªque°_queue
 =
NULL
Ë|| (ssd->
ªque°_èû
 == NULL) ){

5838 
	`ssdsim_msg
("4 deletion inÑequests, has subrequests'Ñequests wrong");

5853 
	`ssdsim_msg
("now gÿouàã°_föish_dñëi⁄.cuºít_time:%Œd\n",
ssd
->
cuºít_time
);

5854 
	}
}

5869 
	$åa˚_ouçut
(
ssd_öfo
 *
ssd
) {

5870 
Êag
 = 1;

5871 
öt64_t
 
°¨t_time
, 
íd_time
;

5872 
ªque°
 *
ªq
, *
¥e_node
;

5873 
sub_ªque°
 *
sub
, *
tmp
;

5876 
	`ssdsim_msg
("íã∏åa˚_ouçut, cuºíàtime:%Œd\n",
ssd
->
cuºít_time
);

5877 
ªq
 = 
ssd
->
ªque°_queue
;

5878 
¥e_node
 = 
ªq
;

5879 
°¨t_time
 = 0;

5880 
íd_time
 = 0;

5882 i‡(
ªq
 =
NULL
){

5883 #ifde‡
DEBUG


5884 
	`¥ötf
("ssd->request_queue is NULL\n");

5890 
ªq
 !
NULL
) {

5891 
	`ssdsim_msg
("⁄êítúêªque° begö judgög whëhî föishmíàhîê,ªqáddªs†i†%Œd",
ªq
);

5898 if((
ªq
->
tŸÆ_waô_„tch_m≠pögèbÀ
 =1 )||‘eq->
tŸÆ_waô_evi˘
 =1Ë|| (ªq->
¸óã_‹_nŸyë_n‹mÆ_subªque°s
 == 0)){

5899 if(
ssd
->
ªque°_queue_Àngth
 == 1){

5902 
¥e_node
 = 
ªq
;

5903 
ªq
 =Ñeq->
√xt_node
;

5909 if(
ªq
->
missög_ö_d©a_buf„r_Õn_d©a
->
Àn
 != 0){

5910 if(
ªq
->
ª•⁄£_time
 != 0){

5911 
	`ssdsim_msg
("wr⁄g i¿ªque°Ñe•⁄£ÅimêvÆuêªq o≥øti⁄ %d,áddªs†i†%Œd", 
ªq
->
›î©i⁄
,Ñeq);

5928 i‡(
ªq
->
ª•⁄£_time
 != 0) {

5934 
	`ssdsim_msg
("xxxxxxxdebugxxxxxx%16Œd %10d %6d %2d %16Œd %16Œd %10Œd\n", 
ªq
->
time
,Ñeq->
l¢
,Ñeq->
size
,Ñeq->
›î©i⁄
,Ñeq->
begö_time
,Ñeq->
ª•⁄£_time
,Ñeq->response_time -Ñeq->time);

5940 #ifde‡
DEBUGTRACE_OUT


5941 
	`¥ötf
("only hasÉntireÑeq->response_time oneÅime,dont careÑeq's subrequest. \n");

5946 #ifde‡
DEBUGSUSPEND


5947 
	`¥ötf
("%16Œd %10d %6d %2d %16Œd %16Œd %10Œd\n", 
ªq
->
time
,Ñeq->
l¢
,Ñeq->
size
,Ñeq->
›î©i⁄
,Ñeq->
begö_time
,Ñeq->
ª•⁄£_time
,Ñeq->response_time -Ñeq->time);

5950 
	`Ârötf
(
ssd
->
ouçutfûe
, "%16Œd %10d %6d %2d %16Œd %16Œd %10Œd\n", 
ªq
->
time
,Ñeq->
l¢
,Ñeq->
size
,

5951 
ªq
->
›î©i⁄
,Ñeq->
begö_time
,Ñeq->
ª•⁄£_time
,Ñeq->ª•⁄£_timê-Ñeq->
time
);

5952 
	`fÊush
(
ssd
->
ouçutfûe
);

5954 i‡(
ªq
->
ª•⁄£_time
 -Ñeq->
begö_time
 == 0) {

5955 
	`¥ötf
("theÑesponseÅime is 0?? \n");

5956 
	`gëch¨
();

5962 i‡(
ªq
->
›î©i⁄
 =
READ
) {

5963 
ssd
->
ªad_ªque°_cou¡
++;

5964 
ssd
->
ªad_avg
 = ssd->ªad_avg + (
ªq
->
ª•⁄£_time
 -Ñeq->
time
);

5966 
ssd
->
wrôe_ªque°_cou¡
++;

5967 
ssd
->
wrôe_avg
 = ssd->wrôe_avg + (
ªq
->
ª•⁄£_time
 -Ñeq->
time
);

5976 if(
ªq
 =
ssd
->
ªque°_queue
){

5979 
¥e_node
 =¥e_node->
√xt_node
;

5980 
ssd
->
ªque°_queue
 = 
¥e_node
;

5982 
	`‰ì
(
ªq
->
√ed_di°r_Êag
);

5983 
ªq
->
√ed_di°r_Êag
 = 
NULL
;

5984 
	`‰ì
(
ªq
);

5985 
ssd
->
ªque°_queue_Àngth
--;

5988 
ªq
 = 
¥e_node
;

5990 if(
ssd
->
ªque°_queue
 =
NULL
){

5991 
ssd
->
ªque°_èû
 = 
NULL
;

6001 i‡(
ªq
 =
ssd
->
ªque°_èû
){

6003 
¥e_node
->
√xt_node
 = 
ªq
->next_node;

6004 if(
¥e_node
->
√xt_node
 !
NULL
){

6005 
	`ssdsim_msg
("1Üogic wrong inÑequestÅail");

6010 
ssd
->
ªque°_èû
 = 
¥e_node
;

6012 
	`‰ì
(
ªq
->
√ed_di°r_Êag
);

6013 
ªq
->
√ed_di°r_Êag
 = 
NULL
;

6014 
	`‰ì
(
ªq
);

6015 
ªq
 = 
NULL
;

6017 
ssd
->
ªque°_queue_Àngth
--;

6024 
¥e_node
->
√xt_node
 = 
ªq
->next_node;

6026 
	`‰ì
(
ªq
->
√ed_di°r_Êag
);

6027 
ªq
->
√ed_di°r_Êag
 = 
NULL
;

6028 
	`‰ì
(
ªq
);

6030 
ªq
 = 
¥e_node
->
√xt_node
;

6031 
ssd
->
ªque°_queue_Àngth
--;

6040 if(
ssd
->
ªque°_queue
 =
NULL
){

6041 if(
ssd
->
ªque°_èû
 !
NULL
){

6042 
	`ssdsim_msg
("1 deletion inÑequests,Ço subrequests'Ñequests wrong");

6049 if(
ssd
->
ªque°_èû
 !
NULL
){

6050 if(
ssd
->
ªque°_èû
->
√xt_node
 !
NULL
){

6051 
	`ssdsim_msg
("2 deletion inÑequests,Ço subrequests'Ñequests wrong");

6058 if(
ssd
->
ªque°_queue_Àngth
 == 0){

6059 if–(
ssd
->
ªque°_queue
 !
NULL
Ë|| (ssd->
ªque°_èû
 != NULL) ){

6060 
	`ssdsim_msg
("3 deletion inÑequests,Ço subrequests'Ñequests wrong");

6069 if(
ssd
->
ªque°_queue_Àngth
 != 0){

6070 if–(
ssd
->
ªque°_queue
 =
NULL
Ë|| (ssd->
ªque°_èû
 == NULL) ){

6071 
	`ssdsim_msg
("4 deletion inÑequests,Ço subrequests'Ñequests wrong");

6093 
	`ssdsim_msg
("íã∏åa˚_ouçut,°ï 3Çow, cuºíàtime:%Œd\n",
ssd
->
cuºít_time
);

6094 
Êag
 = 1;

6095 
°¨t_time
 = 0;

6096 
íd_time
 = 0;

6099 
sub
 = 
ªq
->
subs
;

6102 #ifde‡
DEBUGSUSPEND


6103 
	`¥ötf
("respondingÅime hasÇo valueÉnterÉlse,haveÅo considerÅhe subÑequest here.\n");

6104 
	`¥ötf
("sub begö_timêi†%Œd, com∂ëe_timêi†%Œd,sub->√xà°©ê%d, sub_√xt_timê%Œd,Åhi†ªque°'†sub, o∆yÜôéê⁄êsub, o≥øti⁄[%d] 0 i†wrôe,Õ¿[%d],ch™√l[%d], chù[%d], dõ[%d], block[%d],Öage[%d]\n", 
sub
->
begö_time
, sub->
com∂ëe_time
, sub->
√xt_°©e
, sub->
√xt_°©e_¥edi˘_time
, sub->
›î©i⁄
, sub->
Õn
, sub->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
block
, sub->loˇti⁄->
∑ge
);

6110 
sub
 !
NULL
) {

6111 i‡(
°¨t_time
 == 0)

6112 
°¨t_time
 = 
sub
->
begö_time
;

6113 i‡(
°¨t_time
 > 
sub
->
begö_time
)

6114 
°¨t_time
 = 
sub
->
begö_time
;

6115 i‡(
íd_time
 < 
sub
->
com∂ëe_time
)

6116 
íd_time
 = 
sub
->
com∂ëe_time
;

6117 i‡((
sub
->
cuºít_°©e
 =
SR_COMPLETE
Ë|| ((sub->
√xt_°©e
 == SR_COMPLETE) &&

6118 (
sub
->
√xt_°©e_¥edi˘_time
 <=

6119 
ssd
->
cuºít_time
)))

6121 #ifde‡
DEBUGSUSPEND


6122 
	`¥ötf
("sub begö_timêi†%Œd, com∂ëe_timêi†%Œd,sub->√xà°©ê%d, sub_√xt_timê%Œd,Åhi†ªque°'†sub, o∆yÜôéê⁄êsub, o≥øti⁄[%d] 0 i†wrôe,Õ¿[%d],ch™√l[%d], chù[%d], dõ[%d], block[%d],Öage[%d],hîêha†bì¿föished\n",
sub
->
begö_time
, sub->
com∂ëe_time
, sub->
√xt_°©e
, sub->
√xt_°©e_¥edi˘_time
, sub->
›î©i⁄
, sub->
Õn
, sub->
loˇti⁄
->
ch™√l
, sub->loˇti⁄->
chù
, sub->loˇti⁄->
dõ
, sub->loˇti⁄->
block
, sub->loˇti⁄->
∑ge
);

6125 
sub
 = sub->
√xt_subs
;

6127 
Êag
 = 0;

6136 #ifde‡
DEBUGSUSPEND


6137 
	`¥ötf
("Êag hîêi†%d, *** 1 món†föished.0Ço\n",
Êag
);

6139 i‡(
Êag
 == 1) {

6142 
	`ssdsim_msg
("now begöÅÿ˛ó∏ha†subªque°s' ssd->ªq. %16Œd %10d %6d %2d %16Œd %16Œd %10Œd\n", 
ªq
->
time
,Ñeq->
l¢
,Ñeq->
size
,

6143 
ªq
->
›î©i⁄
, 
°¨t_time
, 
íd_time
,Énd_timê-Ñeq->
time
);

6145 
	`Ârötf
(
ssd
->
ouçutfûe
, "%16Œd %10d %6d %2d %16Œd %16Œd %10Œd\n", 
ªq
->
time
,Ñeq->
l¢
,Ñeq->
size
,

6146 
ªq
->
›î©i⁄
, 
°¨t_time
, 
íd_time
,Énd_timê-Ñeq->
time
);

6147 
	`fÊush
(
ssd
->
ouçutfûe
);

6149 i‡(
íd_time
 - 
°¨t_time
 == 0) {

6150 
	`¥ötf
("theÑesponseÅime is 0?? \n");

6156 i‡(
ªq
->
›î©i⁄
 =
READ
) {

6157 
ssd
->
ªad_ªque°_cou¡
++;

6158 
ssd
->
ªad_avg
 = ssd->ªad_avg + (
íd_time
 - 
ªq
->
time
);

6160 
ssd
->
wrôe_ªque°_cou¡
++;

6161 
ssd
->
wrôe_avg
 = ssd->wrôe_avg + (
íd_time
 - 
ªq
->
time
);

6168 
	`dñëe_subs_ö_this_ªq
(
ssd
, 
ªq
);

6170 if(
ªq
 =
ssd
->
ªque°_queue
){

6172 
¥e_node
 =¥e_node->
√xt_node
;

6173 
ssd
->
ªque°_queue
 = 
¥e_node
;

6176 
	`‰ì
(
ªq
->
√ed_di°r_Êag
);

6177 
ªq
->
√ed_di°r_Êag
 = 
NULL
;

6178 
	`‰ì
(
ªq
);

6179 
ssd
->
ªque°_queue_Àngth
--;

6181 
ªq
 = 
¥e_node
;

6183 if(
ssd
->
ªque°_queue
 =
NULL
){

6184 
ssd
->
ªque°_èû
 = 
NULL
;

6191 i‡(
ªq
 =
ssd
->
ªque°_èû
){

6193 
¥e_node
->
√xt_node
 = 
ªq
->next_node;

6194 if(
¥e_node
->
√xt_node
 !
NULL
){

6195 
	`ssdsim_msg
("1Üogic wrong inÑequestÅail");

6201 
ssd
->
ªque°_èû
 = 
¥e_node
;

6203 
	`‰ì
(
ªq
->
√ed_di°r_Êag
);

6204 
ªq
->
√ed_di°r_Êag
 = 
NULL
;

6205 
	`‰ì
(
ªq
);

6206 
ªq
 = 
NULL
;

6207 
ssd
->
ªque°_queue_Àngth
--;

6213 
¥e_node
->
√xt_node
 = 
ªq
->next_node;

6215 
	`‰ì
(
ªq
->
√ed_di°r_Êag
);

6216 
ªq
->
√ed_di°r_Êag
 = 
NULL
;

6217 
	`‰ì
(
ªq
);

6219 
ªq
 = 
¥e_node
->
√xt_node
;

6220 
ssd
->
ªque°_queue_Àngth
--;

6234 
¥e_node
 = 
ªq
;

6235 
ªq
 =Ñeq->
√xt_node
;

6242 
	`ssdsim_msg
("íã∏åa˚_ouçut,°ï 3.5 checkÇow, cuºíàtime:%Œd\n",
ssd
->
cuºít_time
);

6243 if(
ssd
->
ªque°_queue
 =
NULL
){

6244 if(
ssd
->
ªque°_èû
 !
NULL
){

6245 
ssd
->
ªque°_èû
 !
NULL
;

6246 
	`ssdsim_msg
("1 deletion inÑequests, has subrequests'Ñequests wrong");

6253 if(
ssd
->
ªque°_èû
 !
NULL
){

6254 if(
ssd
->
ªque°_èû
->
√xt_node
 !
NULL
){

6255 
	`ssdsim_msg
("2 deletion inÑequests, has subrequests'Ñequests wrong");

6261 if(
ssd
->
ªque°_queue_Àngth
 == 0){

6262 if–(
ssd
->
ªque°_queue
 !
NULL
Ë|| (ssd->
ªque°_èû
 != NULL) ){

6263 
	`ssdsim_msg
("3 deletion inÑequests, has subrequests'Ñequests wrong");

6272 if(
ssd
->
ªque°_queue_Àngth
 != 0){

6273 if–(
ssd
->
ªque°_queue
 =
NULL
Ë|| (ssd->
ªque°_èû
 == NULL) ){

6274 
	`ssdsim_msg
("4 deletion inÑequests, has subrequests'Ñequests wrong");

6288 
	}
}

6679 
	$°©i°ic_ouçut
(
ssd_öfo
 *
ssd
) {

6680 
Õn_cou¡
 = 0, 
i
, 
j
, 
k
, 
l
, 
m
, 
îa£
 = 0, 
∂™e_îa£
 = 0, 
ãmp_chù_ch™√l
 = 0;

6681 
gc_íîgy
 = 0.0;

6682 #ifde‡
DEBUG_CURR_TIME


6683 
	`¥ötf
("íã∏°©i°ic_ouçut, cuºíàtime:%Œd\n",
ssd
->
cuºít_time
);

6685 
ãmp_chù_ch™√l
 = 
ssd
->
∑ømëî
->
chù_num
 / ssd->∑ømëî->
ch™√l_numbî
;

6688 
i
 = 0; i < 
ssd
->
∑ømëî
->
ch™√l_numbî
; i++) {

6689 
l
 = 0;Ü < 
ãmp_chù_ch™√l
;Ü++) {

6690 
j
 = 0; j < 
ssd
->
∑ømëî
->
dõ_chù
; j++) {

6691 
k
 = 0; k < 
ssd
->
∑ømëî
->
∂™e_dõ
; k++) {

6692 
∂™e_îa£
 = 0;

6693 
m
 = 0; m < 
ssd
->
∑ømëî
->
block_∂™e
; m++) {

6694 i‡(
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
l
].
dõ_hód
[
j
].
∂™e_hód
[
k
].
blk_hód
[
m
].
îa£_cou¡
 > 0) {

6695 
îa£
 =Érase +

6696 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
l
].
dõ_hód
[
j
].
∂™e_hód
[
k
].
blk_hód
[
m
].
îa£_cou¡
;

6697 
∂™e_îa£
 +
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
l
].
dõ_hód
[
j
].
∂™e_hód
[
k
].
blk_hód
[
m
].
îa£_cou¡
;

6700 
	`Ârötf
(
ssd
->
ouçutfûe
, "thê%d ch™√l, %d chù, %d dõ, %dÖœ√ ha†: %13dÉø£ o≥øti⁄s\n", 
i
, 
l
, 
j
, 
k
, 
∂™e_îa£
);

6701 
	`Ârötf
(
ssd
->
°©i°icfûe
, "the %d channel, %d chip, %d die, %dÖlane has : %13dÉrase operations\n",

6702 
i
, 
l
, 
j
, 
k
, 
∂™e_îa£
);

6710 
	`Êush_m≠pögèbÀ_öto_fûes
(
ssd
, "map_after_run.txt");

6712 
	`f˛o£
(
ssd
->
Â_numbî_subªque°s_txt
);

6714 
	`Ârötf
(
ssd
->
ouçutfûe
, "\n");

6715 
	`Ârötf
(
ssd
->
ouçutfûe
, "\n");

6716 
	`Ârötf
(
ssd
->
ouçutfûe
, "---------------------------statistic data---------------------------\n");

6717 
	`Ârötf
(
ssd
->
ouçutfûe
, "g¯su•ídÅimes: %13d\n", ssd->
gc_su•íd_times
);

6718 
	`Ârötf
(
ssd
->
ouçutfûe
, "wrôêsu•ídÅimes: %13d\n", ssd->
wrôe_su•íd_times
);

6721 
	`Ârötf
(
ssd
->
ouçutfûe
, "möÜ¢: %13d\n", ssd->
mö_l¢
);

6722 
	`Ârötf
(
ssd
->
ouçutfûe
, "maxÜ¢: %13d\n", ssd->
max_l¢
);

6723 
	`Ârötf
(
ssd
->
ouçutfûe
, "ªad cou¡: %13d\n", ssd->
ªad_cou¡
);

6724 
	`Ârötf
(
ssd
->
ouçutfûe
, "¥ogøm cou¡: %13d", ssd->
¥ogøm_cou¡
);

6725 
	`Ârötf
(
ssd
->
ouçutfûe
, " includeÅhe flash write countÜeaded byÑeadÑequests\n");

6726 
	`Ârötf
(
ssd
->
ouçutfûe
, "thêªad o≥øti⁄Üóded by un-covîed upd©êcou¡: %13d\n", ssd->
upd©e_ªad_cou¡
);

6727 
	`Ârötf
(
ssd
->
ouçutfûe
, "îa£ cou¡: %13d\n", ssd->
îa£_cou¡
);

6728 
	`Ârötf
(
ssd
->
ouçutfûe
, "dúe˘Éø£ cou¡: %13d\n", ssd->
dúe˘_îa£_cou¡
);

6729 
	`Ârötf
(
ssd
->
ouçutfûe
, "c›y back cou¡: %13d\n", ssd->
c›y_back_cou¡
);

6730 
	`Ârötf
(
ssd
->
ouçutfûe
, "mu…i-∂™ê¥ogøm cou¡: %13d\n", ssd->
m_∂™e_¥og_cou¡
);

6731 
	`Ârötf
(
ssd
->
ouçutfûe
, "mu…i-∂™êªad cou¡: %13d\n", ssd->
m_∂™e_ªad_cou¡
);

6732 
	`Ârötf
(
ssd
->
ouçutfûe
, "öãæóvêwrôêcou¡: %13d\n", ssd->
öãæóve_cou¡
);

6733 
	`Ârötf
(
ssd
->
ouçutfûe
, "öãæóvêªad cou¡: %13d\n", ssd->
öãæóve_ªad_cou¡
);

6734 
	`Ârötf
(
ssd
->
ouçutfûe
, "öãæóvêtwÿ∂™ê™d o√Örogøm cou¡: %13d\n", ssd->
öãr_m∂™e_¥og_cou¡
);

6735 
	`Ârötf
(
ssd
->
ouçutfûe
, "öãæóvêtwÿ∂™êcou¡: %13d\n", ssd->
öãr_m∂™e_cou¡
);

6736 
	`Ârötf
(
ssd
->
ouçutfûe
, "g¯c›y back cou¡: %13d\n", ssd->
gc_c›y_back
);

6737 
	`Ârötf
(
ssd
->
ouçutfûe
, "wrôêÊash cou¡: %13d\n", ssd->
wrôe_Êash_cou¡
);

6738 
	`Ârötf
(
ssd
->
ouçutfûe
, "öãæóvêîa£ cou¡: %13d\n", ssd->
öãæóve_îa£_cou¡
);

6739 
	`Ârötf
(
ssd
->
ouçutfûe
, "mu…ùÀÖœ√Éø£ cou¡: %13d\n", ssd->
m∂™e_îa£_c⁄ut
);

6740 
	`Ârötf
(
ssd
->
ouçutfûe
, "öãæóvêmu…ùÀÖœ√Éø£ cou¡: %13d\n", ssd->
öãæóve_m∂™e_îa£_cou¡
);

6741 
	`Ârötf
(
ssd
->
ouçutfûe
, "ªadÑeque° cou¡: %13d\n", ssd->
ªad_ªque°_cou¡
);

6742 
	`Ârötf
(
ssd
->
ouçutfûe
, "wrôêªque° cou¡: %13d\n", ssd->
wrôe_ªque°_cou¡
);

6743 
	`Ârötf
(
ssd
->
ouçutfûe
, "ªadÑeque°ávîagêsize: %13f\n", ssd->
ave_ªad_size
);

6744 
	`Ârötf
(
ssd
->
ouçutfûe
, "wrôêªque°ávîagêsize: %13f\n", ssd->
ave_wrôe_size
);

6745 
	`Ârötf
(
ssd
->
ouçutfûe
, "ªadÑeque°ávîagêª•⁄£Åime: %Œd\n", ssd->
ªad_avg
 / ssd->
ªad_ªque°_cou¡
);

6746 
	`Ârötf
(
ssd
->
ouçutfûe
, "wrôêªque°ávîagêª•⁄£Åime: %Œd\n", ssd->
wrôe_avg
 / ssd->
wrôe_ªque°_cou¡
);

6747 #ifde‡
DFTL


6749 #ifde‡
COMPRESSION_MAPPING


6750 
	`Ârötf
(
ssd
->
ouçutfûe
, "com¥essi⁄Ö¨àbuf„r_DFTLÑódªque° hôs: %13d\n", ssd->
døm
->
mt
->
buf„r_DFTL
->
ªad_hô
);

6751 
	`Ârötf
(
ssd
->
ouçutfûe
, "com¥essi⁄Ö¨àbuf„r_DFTL wrôîeque° hôs: %13d\n", ssd->
døm
->
mt
->
buf„r_DFTL
->
wrôe_hô
);

6753 
	`Ârötf
(
ssd
->
ouçutfûe
, "tŸÆ buf„r_DFTLÑódªque° miss: %13d\n", ssd->
døm
->
mt
->
buf„r_DFTL
->
ªad_miss_hô
);

6754 
	`Ârötf
(
ssd
->
ouçutfûe
, "tŸÆ buf„r_DFTL wrôîeque° miss: %13d\n", ssd->
døm
->
mt
->
buf„r_DFTL
->
wrôe_miss_hô
);

6756 
	`Ârötf
(
ssd
->
ouçutfûe
, "⁄ly uncom¥essi⁄Ö¨t,buf„r_DFTLÑódªque° hôs: %13d\n", ssd->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
ªad_hô
);

6757 
	`Ârötf
(
ssd
->
ouçutfûe
, "⁄ly uncom¥essi⁄Ö¨t,buf„r_DFTL wrôîeque° hôs: %13d\n", ssd->
døm
->
mt
->
buf„r_DFTL_UNCOM
->
wrôe_hô
);

6762 
	`Ârötf
(
ssd
->
ouçutfûe
, "buf„r_DFTLÑódªque° hôs: %13d\n", ssd->
døm
->
mt
->
buf„r_DFTL
->
ªad_hô
);

6763 
	`Ârötf
(
ssd
->
ouçutfûe
, "buf„r_DFTLÑódªque° miss: %13d\n", ssd->
døm
->
mt
->
buf„r_DFTL
->
ªad_miss_hô
);

6764 
	`Ârötf
(
ssd
->
ouçutfûe
, "buf„r_DFTL wrôîeque° hôs: %13d\n", ssd->
døm
->
mt
->
buf„r_DFTL
->
wrôe_hô
);

6765 
	`Ârötf
(
ssd
->
ouçutfûe
, "buf„r_DFTL wrôîeque° miss: %13d\n", ssd->
døm
->
mt
->
buf„r_DFTL
->
wrôe_miss_hô
);

6773 
	`Ârötf
(
ssd
->
ouçutfûe
, "buf„∏ªad hôs: %13d\n", ssd->
døm
->
buf„r
->
ªad_hô
);

6774 
	`Ârötf
(
ssd
->
ouçutfûe
, "buf„∏ªad miss: %13d\n", ssd->
døm
->
buf„r
->
ªad_miss_hô
);

6775 
	`Ârötf
(
ssd
->
ouçutfûe
, "buf„∏wrôêhôs: %13d\n", ssd->
døm
->
buf„r
->
wrôe_hô
);

6776 
	`Ârötf
(
ssd
->
ouçutfûe
, "buf„∏wrôêmiss: %13d\n", ssd->
døm
->
buf„r
->
wrôe_miss_hô
);

6777 
	`Ârötf
(
ssd
->
ouçutfûe
, "îa£: %13d\n", 
îa£
);

6779 
	`Ârötf
(
ssd
->
ouçutfûe
, "dif‡bëwì¿FCFSánd RF i†%13d\n", ssd->
diff_bëwìn_FCFS_RF
);

6780 
	`Ârötf
(
ssd
->
ouçutfûe
, "‹igöÆÅŸÆÖage†i†%13d\n", ssd->
‹igöÆ_tŸÆ_∑ges_numbî
);

6781 
	`Ârötf
(
ssd
->
ouçutfûe
, "⁄lyÖª_¥o˚s£dÖage†numbî i†%13d\n", ssd->
a·î_¥e_¥o˚ss_∑ges_numbî
);

6782 
	`Ârötf
(
ssd
->
ouçutfûe
, "a·îÖª∞ro˚s£dÑódÖ¨à™dágedÖage†,ÅhíÜe·ÅhêavaûabÀÇumbî i†%13d\n", ssd->
a·î_¥e_¥o˚s£_™d_aged_∑ges_numbî
);

6784 
i
 = 0; i < 
ssd
->
∑ømëî
->
ch™√l_numbî
; i++){

6785 
l
 = 0;Ü < 
ãmp_chù_ch™√l
;Ü++) {

6786 
j
 = 0; j < 
ssd
->
∑ømëî
->
dõ_chù
; j++){

6787 
k
 = 0; k < 
ssd
->
∑ømëî
->
∂™e_dõ
; k++) {

6788 
	`Ârötf
(
ssd
->
ouçutfûe
, "ch™√»%d, chù:%d, dõ:%d,Öœ√:%d havê‰ìÖage: %d\n", 
i
, 
l
, 
j
, 
k
,

6789 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
l
].
dõ_hód
[
j
].
∂™e_hód
[
k
].
‰ì_∑ge
);

6790 
ssd
->
œ°_tŸÆ_avaûabÀ_∑ges_numbî
 +ssd->
ch™√l_hód
[
i
].
chù_hód
[
l
].
dõ_hód
[
j
].
∂™e_hód
[
k
].
‰ì_∑ge
;

6797 
	`Ârötf
(
ssd
->
ouçutfûe
, "œ°_tŸÆ_avaûabÀ_∑ge†numbî i†%13d\n", ssd->
œ°_tŸÆ_avaûabÀ_∑ges_numbî
);

6804 
	`fÊush
(
ssd
->
ouçutfûe
);

6806 
	`f˛o£
(
ssd
->
ouçutfûe
);

6809 
	`Ârötf
(
ssd
->
°©i°icfûe
, "\n");

6810 
	`Ârötf
(
ssd
->
°©i°icfûe
, "\n");

6811 
	`Ârötf
(
ssd
->
°©i°icfûe
, "---------------------------statistic data---------------------------\n");

6812 
	`Ârötf
(
ssd
->
°©i°icfûe
, "möÜ¢: %13d\n", ssd->
mö_l¢
);

6813 
	`Ârötf
(
ssd
->
°©i°icfûe
, "maxÜ¢: %13d\n", ssd->
max_l¢
);

6814 
	`Ârötf
(
ssd
->
°©i°icfûe
, "ªad cou¡: %13d\n", ssd->
ªad_cou¡
);

6815 
	`Ârötf
(
ssd
->
°©i°icfûe
, "¥ogøm cou¡: %13d", ssd->
¥ogøm_cou¡
);

6816 
	`Ârötf
(
ssd
->
°©i°icfûe
, " includeÅhe flash write countÜeaded byÑeadÑequests\n");

6817 
	`Ârötf
(
ssd
->
°©i°icfûe
, "thêªad o≥øti⁄Üóded by un-covîed upd©êcou¡: %13d\n", ssd->
upd©e_ªad_cou¡
);

6818 
	`Ârötf
(
ssd
->
°©i°icfûe
, "îa£ cou¡: %13d\n", ssd->
îa£_cou¡
);

6819 
	`Ârötf
(
ssd
->
°©i°icfûe
, "dúe˘Éø£ cou¡: %13d\n", ssd->
dúe˘_îa£_cou¡
);

6820 
	`Ârötf
(
ssd
->
°©i°icfûe
, "c›y back cou¡: %13d\n", ssd->
c›y_back_cou¡
);

6821 
	`Ârötf
(
ssd
->
°©i°icfûe
, "mu…i-∂™ê¥ogøm cou¡: %13d\n", ssd->
m_∂™e_¥og_cou¡
);

6822 
	`Ârötf
(
ssd
->
°©i°icfûe
, "mu…i-∂™êªad cou¡: %13d\n", ssd->
m_∂™e_ªad_cou¡
);

6823 
	`Ârötf
(
ssd
->
°©i°icfûe
, "öãæóvêcou¡: %13d\n", ssd->
öãæóve_cou¡
);

6824 
	`Ârötf
(
ssd
->
°©i°icfûe
, "öãæóvêªad cou¡: %13d\n", ssd->
öãæóve_ªad_cou¡
);

6825 
	`Ârötf
(
ssd
->
°©i°icfûe
, "öãæóvêtwÿ∂™ê™d o√Örogøm cou¡: %13d\n", ssd->
öãr_m∂™e_¥og_cou¡
);

6826 
	`Ârötf
(
ssd
->
°©i°icfûe
, "öãæóvêtwÿ∂™êcou¡: %13d\n", ssd->
öãr_m∂™e_cou¡
);

6827 
	`Ârötf
(
ssd
->
°©i°icfûe
, "g¯c›y back cou¡: %13d\n", ssd->
gc_c›y_back
);

6828 
	`Ârötf
(
ssd
->
°©i°icfûe
, "wrôêÊash cou¡: %13d\n", ssd->
wrôe_Êash_cou¡
);

6829 
	`Ârötf
(
ssd
->
°©i°icfûe
, "wa°ê∑gêcou¡: %13d\n", ssd->
wa°e_∑ge_cou¡
);

6830 
	`Ârötf
(
ssd
->
°©i°icfûe
, "öãæóvêîa£ cou¡: %13d\n", ssd->
öãæóve_îa£_cou¡
);

6831 
	`Ârötf
(
ssd
->
°©i°icfûe
, "mu…ùÀÖœ√Éø£ cou¡: %13d\n", ssd->
m∂™e_îa£_c⁄ut
);

6832 
	`Ârötf
(
ssd
->
°©i°icfûe
, "öãæóvêmu…ùÀÖœ√Éø£ cou¡: %13d\n", ssd->
öãæóve_m∂™e_îa£_cou¡
);

6833 
	`Ârötf
(
ssd
->
°©i°icfûe
, "ªadÑeque° cou¡: %13d\n", ssd->
ªad_ªque°_cou¡
);

6834 
	`Ârötf
(
ssd
->
°©i°icfûe
, "wrôêªque° cou¡: %13d\n", ssd->
wrôe_ªque°_cou¡
);

6835 
	`Ârötf
(
ssd
->
°©i°icfûe
, "ªadÑeque°ávîagêsize: %13f\n", ssd->
ave_ªad_size
);

6836 
	`Ârötf
(
ssd
->
°©i°icfûe
, "wrôêªque°ávîagêsize: %13f\n", ssd->
ave_wrôe_size
);

6837 
	`Ârötf
(
ssd
->
°©i°icfûe
, "ªadÑeque°ávîagêª•⁄£Åime: %Œd\n", ssd->
ªad_avg
 / ssd->
ªad_ªque°_cou¡
);

6838 
	`Ârötf
(
ssd
->
°©i°icfûe
, "writeÑequestáverageÑesponseÅime: %lld\n",

6839 
ssd
->
wrôe_avg
 / ssd->
wrôe_ªque°_cou¡
);

6840 
	`Ârötf
(
ssd
->
°©i°icfûe
, "buf„∏ªad hôs: %13d\n", ssd->
døm
->
buf„r
->
ªad_hô
);

6841 
	`Ârötf
(
ssd
->
°©i°icfûe
, "buf„∏ªad miss: %13d\n", ssd->
døm
->
buf„r
->
ªad_miss_hô
);

6842 
	`Ârötf
(
ssd
->
°©i°icfûe
, "buf„∏wrôêhôs: %13d\n", ssd->
døm
->
buf„r
->
wrôe_hô
);

6843 
	`Ârötf
(
ssd
->
°©i°icfûe
, "buf„∏wrôêmiss: %13d\n", ssd->
døm
->
buf„r
->
wrôe_miss_hô
);

6844 
	`Ârötf
(
ssd
->
°©i°icfûe
, "îa£: %13d\n", 
îa£
);

6847 
	`fÊush
(
ssd
->
°©i°icfûe
);

6849 
	`f˛o£
(
ssd
->
°©i°icfûe
);

6850 
	}
}

6856 
	$size
(
°‹ed
) {

6857 
i
, 
tŸÆ
 = 0, 
mask
 = 0x80000000;

6859 #ifde‡
DEBUG


6860 
	`¥ötf
("enter size\n");

6862 
i
 = 1; i <= 32; i++) {

6863 i‡(
°‹ed
 & 
mask
Ë
tŸÆ
++;

6864 
°‹ed
 <<= 1;

6866 #ifde‡
DEBUG


6867 
	`¥ötf
("ÀavêsizêtŸÆÜ¢Çumbî i¿ªque° : %d\n",
tŸÆ
);

6869  
tŸÆ
;

6870 
	}
}

6879 
	$å™s„r_size
(
ssd_öfo
 *
ssd
, 
√ed_di°ribuã
, 
Õn
, 
ªque°
 *
ªq
) {

6880 
fú°_Õn
, 
œ°_Õn
, 
°©e
, 
å™s_size
;

6881 
mask
 = 0, 
off£t1
 = 0, 
off£t2
 = 0;

6883 
fú°_Õn
 = 
ªq
->
l¢
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

6884 
œ°_Õn
 = (
ªq
->
l¢
 +Ñeq->
size
 - 1Ë/ 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

6886 
mask
 = ~(0xfffffff‡<< (
ssd
->
∑ømëî
->
sub∑ge_∑ge
));

6887 
°©e
 = 
mask
;

6888 i‡(
Õn
 =
fú°_Õn
) {

6889 
off£t1
 = 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 - ((
Õn
 + 1Ë* ssd->∑ømëî->sub∑ge_∑gê- 
ªq
->
l¢
);

6890 
°©e
 = sèã & (0xfffffff‡<< 
off£t1
);

6892 i‡(
Õn
 =
œ°_Õn
) {

6893 
off£t2
 = 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 - ((
Õn
 + 1Ë* ssd->∑ømëî->sub∑ge_∑gê- (
ªq
->
l¢
 +Ñeq->
size
));

6894 
°©e
 = sèã & (~(0xfffffff‡<< 
off£t2
));

6897 
å™s_size
 = 
	`size
(
°©e
 & 
√ed_di°ribuã
);

6899  
å™s_size
;

6900 
	}
}

6911 
öt64_t
 
	$föd_√¨e°_evít
(
ssd_öfo
 *
ssd
) {

6912 
i
, 
j
;

6913 
öt64_t
 
time
 = 
MAX_INT64
;

6914 
öt64_t
 
time1
 = 
MAX_INT64
;

6915 
öt64_t
 
time2
 = 
MAX_INT64
;

6916 #ifde‡
DEBUG_CURR_TIME


6917 
	`¥ötf
("íã∏föd_√¨e°_evít, ssd->cuºít_timêi†%Œd\n",
ssd
->
cuºít_time
);

6919 
i
 = 0; i < 
ssd
->
∑ømëî
->
ch™√l_numbî
; i++) {

6921 
	`¥ötf
("ch™√l[%d].√xt_°©êi†0x%x,ssd->ch™√l_hód[%d].√xt_°©e_¥edi˘_timêi†%Œd, ch™√l[%d].cuºít_°©êi†0x%x,ssd->ch™√l_hód[%d].cuºít_timêi†%Œd\n",
i
,
ssd
->
ch™√l_hód
[i].
√xt_°©e
,i,ssd->ch™√l_hód[i].
√xt_°©e_¥edi˘_time
 ,i,ssd->ch™√l_hód[i].
cuºít_°©e
,i,ssd->ch™√l_hód[i].
cuºít_time
 );

6923 
j
 = 0; j < 
ssd
->
∑ømëî
->
chù_ch™√l
[
i
]; j++) {

6925 
	`¥ötf
("ssd->ch™√l_hód[%d].chù_hód[%d].√xt_°©e_¥edi˘_timêi†%Œd, ssd->ch™√l_hód[%d].chù_hód[%d].√xt_°©êi†0x%x ssd->ch™√l_hód[%d].chù_hód[%d].cuºít_timêi†%Œd, ssd->ch™√l_hód[%d].chù_hód[%d].cuºít_°©êi†0x%x \n", 
i
,
j
,
ssd
->
ch™√l_hód
[i].
chù_hód
[j].
√xt_°©e_¥edi˘_time
 ,i,j,ssd->ch™√l_hód[i].chù_hód[j].
√xt_°©e
 , i,j,ssd->ch™√l_hód[i].chù_hód[j].
cuºít_time
 ,i,j,ssd->ch™√l_hód[i].chù_hód[j].
cuºít_°©e
 );

6934 
i
 = 0; i < 
ssd
->
∑ømëî
->
ch™√l_numbî
; i++) {

6935 i‡(
ssd
->
ch™√l_hód
[
i
].
√xt_°©e
 =
CHANNEL_IDLE
)

6936 i‡(
time1
 > 
ssd
->
ch™√l_hód
[
i
].
√xt_°©e_¥edi˘_time
)

6937 i‡(
ssd
->
ch™√l_hód
[
i
].
√xt_°©e_¥edi˘_time
 > ssd->
cuºít_time
)

6938 
time1
 = 
ssd
->
ch™√l_hód
[
i
].
√xt_°©e_¥edi˘_time
;

6939 
j
 = 0; j < 
ssd
->
∑ømëî
->
chù_ch™√l
[
i
]; j++) {

6944 i‡(
time2
 > 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
√xt_°©e_¥edi˘_time
)

6945 i‡(
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
√xt_°©e_¥edi˘_time
 > ssd->
cuºít_time
)

6946 
time2
 = 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
√xt_°©e_¥edi˘_time
;

6957 #ifde‡
DEBUG


6958 
	`¥ötf
("ªsu…Åime1 i†%Œd,Åime2 i†%Œd\n", 
time1
, 
time2
);

6962 
time
 = (
time1
 > 
time2
) ?Åime2 :Åime1;

6963  
time
;

6964 
	}
}

6969 
	$‰ì_Æl_node
(
ssd_öfo
 *
ssd
) {

6970 
i
, 
j
, 
k
, 
l
, 
n
;

6971 
buf„r_group
 *
±
 = 
NULL
;

6972 
dúe˘_îa£
 *
îa£_node
 = 
NULL
;

6973 
i
 = 0; i < 
ssd
->
∑ømëî
->
ch™√l_numbî
; i++) {

6974 
j
 = 0; j < 
ssd
->
∑ømëî
->
chù_ch™√l
[0]; j++) {

6975 
k
 = 0; k < 
ssd
->
∑ømëî
->
dõ_chù
; k++) {

6976 
l
 = 0;Ü < 
ssd
->
∑ømëî
->
∂™e_dõ
;Ü++) {

6977 
n
 = 0;Ç < 
ssd
->
∑ømëî
->
block_∂™e
;Ç++) {

6978 
	`‰ì
(
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
[
k
].
∂™e_hód
[
l
].
blk_hód
[
n
].
∑ge_hód
);

6979 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
[
k
].
∂™e_hód
[
l
].
blk_hód
[
n
].
∑ge_hód
 = 
NULL
;

6981 
	`‰ì
(
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
[
k
].
∂™e_hód
[
l
].
blk_hód
);

6982 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
[
k
].
∂™e_hód
[
l
].
blk_hód
 = 
NULL
;

6983 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
[
k
].
∂™e_hód
[
l
].
îa£_node
 !
NULL
) {

6984 
îa£_node
 = 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
[
k
].
∂™e_hód
[
l
].erase_node;

6985 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
[
k
].
∂™e_hód
[
l
].
îa£_node
 =Éø£_node->
√xt_node
;

6986 
	`‰ì
(
îa£_node
);

6987 
îa£_node
 = 
NULL
;

6991 
	`‰ì
(
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
[
k
].
∂™e_hód
);

6992 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
[
k
].
∂™e_hód
 = 
NULL
;

6994 
	`‰ì
(
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
);

6995 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
 = 
NULL
;

6997 
	`‰ì
(
ssd
->
ch™√l_hód
[
i
].
chù_hód
);

6998 
ssd
->
ch™√l_hód
[
i
].
chù_hód
 = 
NULL
;

7000 
	`‰ì
(
ssd
->
ch™√l_hód
);

7001 
ssd
->
ch™√l_hód
 = 
NULL
;

7003 
	`avlTªeDe°roy
(
ssd
->
døm
->
buf„r
);

7004 
ssd
->
døm
->
buf„r
 = 
NULL
;

7007 
	`avlTªeDe°roy
(
ssd
->
døm
->
mt
->
buf„r_DFTL
);

7008 
ssd
->
døm
->
mt
->
buf„r_DFTL
 = 
NULL
;

7009 
	`avlTªeDe°roy
(
ssd
->
døm
->
mt
->
buf„r_DFTL_UNCOM
);

7011 
	`‰ì
(
ssd
->
døm
->
m≠
->
m≠_íåy
);

7012 
ssd
->
døm
->
m≠
->
m≠_íåy
 = 
NULL
;

7013 
	`‰ì
(
ssd
->
døm
->
m≠
);

7014 
ssd
->
døm
->
m≠
 = 
NULL
;

7015 
	`‰ì
(
ssd
->
døm
);

7016 
ssd
->
døm
 = 
NULL
;

7017 
	`‰ì
(
ssd
->
∑ømëî
);

7018 
ssd
->
∑ømëî
 = 
NULL
;

7020 
	`‰ì
(
ssd
);

7021 
ssd
 = 
NULL
;

7022 
	}
}

7029 
ssd_öfo
 *
	$make_aged
(
ssd_öfo
 *
ssd
) {

7030 
i
, 
j
, 
k
, 
l
, 
m
, 
n
, 
µn
;

7031 
thªshould
, 
Êag
 = 0;

7033 i‡(
ssd
->
∑ømëî
->
aged
 == 1) {

7035 
thªshould
 = (Ë(
ssd
->
∑ømëî
->
block_∂™e
 * ssd->∑ømëî->
∑ge_block
 * ssd->∑ømëî->
aged_øtio
);

7036 
i
 = 0; i < 
ssd
->
∑ømëî
->
ch™√l_numbî
; i++)

7037 
j
 = 0; j < 
ssd
->
∑ømëî
->
chù_ch™√l
[
i
]; j++)

7038 
k
 = 0; k < 
ssd
->
∑ømëî
->
dõ_chù
; k++)

7039 
l
 = 0;Ü < 
ssd
->
∑ømëî
->
∂™e_dõ
;Ü++) {

7040 
Êag
 = 0;

7041 
m
 = 0; m < 
ssd
->
∑ømëî
->
block_∂™e
; m++) {

7042 i‡(
Êag
 >
thªshould
) {

7045 
n
 = 0;Ç < (
ssd
->
∑ømëî
->
∑ge_block
 * ssd->∑ømëî->
aged_øtio
 + 1);Ç++) {

7046 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
[
k
].
∂™e_hód
[
l
].
blk_hód
[
m
].
∑ge_hód
[
n
].
vÆid_°©e
 = 0;

7047 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
[
k
].
∂™e_hód
[
l
].
blk_hód
[
m
].
∑ge_hód
[
n
].
‰ì_°©e
 = 0;

7048 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
[
k
].
∂™e_hód
[
l
].
blk_hód
[
m
].
∑ge_hód
[
n
].
Õn
 = 0;

7049 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
[
k
].
∂™e_hód
[
l
].
blk_hód
[
m
].
‰ì_∑ge_num
--;

7050 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
[
k
].
∂™e_hód
[
l
].
blk_hód
[
m
].
övÆid_∑ge_num
++;

7051 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
[
k
].
∂™e_hód
[
l
].
blk_hód
[
m
].
œ°_wrôe_∑ge
++;

7052 
ssd
->
ch™√l_hód
[
i
].
chù_hód
[
j
].
dõ_hód
[
k
].
∂™e_hód
[
l
].
‰ì_∑ge
--;

7053 
Êag
++;

7055 
µn
 = 
	`föd_µn
(
ssd
, 
i
, 
j
, 
k
, 
l
, 
m
, 
n
);

7056 #ifde‡
DEBUGONLYGC


7064  
ssd
;

7067  
ssd
;

7068 
	}
}

7075 
ssd_öfo
 *
	$no_buf„r_di°ribuã
(
ssd_öfo
 *
ssd
)

7077 
l¢
, 
Õn
, 
œ°_Õn
, 
fú°_Õn
, 
com∂ëe_Êag
 = 0, 
°©e
;

7078 
Êag
 = 0, 
Êag1
 = 1, 
a˘ive_ªgi⁄_Êag
 = 0;

7079 
ªque°
 *
ªq
 = 
NULL
;

7080 
sub_ªque°
 *
sub
 = 
NULL
, *
sub_r
 = NULL, *
upd©e
 = NULL;

7081 
loˇl
 *
loc
 = 
NULL
;

7082 
ch™√l_öfo
 *
p_ch
 = 
NULL
;

7083 
mask
 = 0;

7084 
off£t1
 = 0, 
off£t2
 = 0;

7085 
sub_size
 = 0;

7086 
sub_°©e
 = 0;

7087 
ssd
->
døm
->
cuºít_time
 = ssd->current_time;

7089 #ifde‡
DEBUG_CURR_TIME


7090 
	`¥ötf
("cuºít_timêi†%Œd i¿no_buf„r_di°ribuã fun˘i⁄\n", 
ssd
->
cuºít_time
);

7092 
ªq
 = 
ssd
->
ªque°_èû
;

7093 
l¢
 = 
ªq
->lsn;

7094 
Õn
 = 
ªq
->
l¢
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

7095 
œ°_Õn
 = (
ªq
->
l¢
 +Ñeq->
size
 - 1Ë/ 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

7096 
fú°_Õn
 = 
ªq
->
l¢
 / 
ssd
->
∑ømëî
->
sub∑ge_∑ge
;

7098 i‡(
ªq
->
›î©i⁄
 =
READ
) {

7099 
Õn
 <
œ°_Õn
) {

7100 
sub_°©e
 = (
ssd
->
døm
->
m≠
->
m≠_íåy
[
Õn
].
°©e
 & 0x7fffffff);

7101 
sub_size
 = 
	`size
(
sub_°©e
);

7102 
sub
 = 
	`¸ót_sub_ªque°
(
ssd
, 
Õn
, 
sub_size
, 
sub_°©e
, 
ªq
,Ñeq->
›î©i⁄
);

7103 
Õn
++;

7105 } i‡(
ªq
->
›î©i⁄
 =
WRITE
) {

7106 
Õn
 <
œ°_Õn
) {

7107 
mask
 = ~(0xfffffff‡<< (
ssd
->
∑ømëî
->
sub∑ge_∑ge
));

7108 
°©e
 = 
mask
;

7109 i‡(
Õn
 =
fú°_Õn
) {

7110 
off£t1
 = 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 - ((
Õn
 + 1Ë* ssd->∑ømëî->sub∑ge_∑gê- 
ªq
->
l¢
);

7111 
°©e
 = sèã & (0xfffffff‡<< 
off£t1
);

7113 i‡(
Õn
 =
œ°_Õn
) {

7114 
off£t2
 = 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 -

7115 ((
Õn
 + 1Ë* 
ssd
->
∑ømëî
->
sub∑ge_∑ge
 - (
ªq
->
l¢
 +Ñeq->
size
));

7116 
°©e
 = sèã & (~(0xfffffff‡<< 
off£t2
));

7118 
sub_size
 = 
	`size
(
°©e
);

7120 
sub
 = 
	`¸ót_sub_ªque°
(
ssd
, 
Õn
, 
sub_size
, 
°©e
, 
ªq
,Ñeq->
›î©i⁄
);

7121 
Õn
++;

7125  
ssd
;

7126 
	}
}

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/ssd.h

18 
	~<°dlib.h
>

19 
	~<°dio.h
>

20 
	~<time.h
>

21 
	~<°rög.h
>

22 
	~<sys/ty≥s.h
>

23 
	~"öôülize.h
"

24 
	~"Êash.h
"

25 
	~"∑gem≠.h
"

27 
	~"debug.h
"

28 
	~"bi_li°.h
"

29 
	~"di˘i⁄¨y.h
"

30 
	~"diffXm©ch.h
"

31 
	~"js_li°.h
"

32 
	~"xm©chPro.h
"

34 
	#COMPRESSION_COST_TIME_ONE_PAGE
 100

35 
	#DFTL


38 
	#TRANSLATION_PAGE_UNIT


39 
	#COMP_VS_UNCOMP_IN_DFTL_BUFFER
 0.1

40 
	#COMP_PAGE_NUMBER_ONCE
 4

	)

41 
	#SET_INTO_LIMITTED_BUFFER


42 
	#MAX_INT64
 0x7ffffffffffffffÊl

	)

51 
¥ötfsub_ªque°_°©us
(
ssd_öfo
 *
ssd
);

52 
¥ötf_ssd_ªque°_queue
(
ssd_öfo
 *
ssd
);

54 
¥ötf_ssd_gc_node
(
ssd_öfo
 *
ssd
);

56 
judgög_ªad_ö_gc_chù
(
ssd_öfo
 *
ssd
, 
ch™√l
);

57 
¥ötf_evîy_chù_ªad_subªque°
(
ssd_öfo
 *
ssd
);

58 
¥ötf_evîy_chù_°©ic_subªque°
(
ssd_öfo
 *
ssd
);

60 
ˇlc_ªq_¶ack_time
(
ªque°
 * 
ªq
);

62 
¥ötf_gc_node_öf‹m©i⁄
(
gc_›î©i⁄
* 
gc_node
);

67 
°©i°ic_wrôe_ªque°_numbî
(
ssd_öfo
 *
ssd
);

68 
no_gªedy_RF_su•ísi⁄
(
ssd_öfo
 *
ssd
);

71 
Êush_m≠pögèbÀ_öto_fûes
(
ssd_öfo
 *
ssd
, * 
fûíame
);

72 
ssd_öfo
 *
simuœã
(ssd_info *);

74 
gë_ªque°s
(
ssd_öfo
 *);

76 
ssd_öfo
 *
buf„r_m™agemít
(ssd_info *);

80 
ssd_öfo
 *
DFTL_buf„r_m™agemít
(ssd_öfÿ* 
ssd
);

85 
Õn2µn
(
ssd_öfo
 *, 
l¢
);

87 
ssd_öfo
 *
di°ribuã
(ssd_info *);

89 
dñëe_evi˘_subªque°_‰om_this_ªq
(
ssd_öfo
* 
ssd
);

90 
pﬁlög_whëhî_föish_evi˘_subªque°s
(
ssd_öfo
* 
ssd
);

91 
ssd_öfo
* 
¸óã_evi˘_m≠pögèbÀ_subªque°s
(ssd_öfo* 
ssd
);

92 
dñëe_subs_ö_this_ªq
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

93 
dñëe_subs_bûi°_ö_this_ªq
(
ªque°
* 
ªq
, 
_bi_li°
* 
should_evi˘_Õn_d©a
);

94 
P›_DFTL_buf„r
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

95 
ssd_öfo
* 
¸óã_„tch_m≠pögèbÀ_subªque°s
(ssd_öfo* 
ssd
);

96 
pﬁlög_whëhî_föish_„tch_subªque°s
(
ssd_öfo
* 
ssd
);

97 
dñëe_„tch_subªque°_‰om_this_ªq
(
ssd_öfo
* 
ssd
);

98 
ö£π2DFTL_buf„r
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

99 
gë_ªÆsize_öbyã_byposôi⁄_ö_mt
(
ssd_öfo
* 
ssd
, 
Õn
);

100 
dñëe_ªque°_wôhout_subs
(
ªque°
* 
ªq
);

102 
If_hôInBUf„r_move_theNode_ahód_ö_ªadªque°
(
ssd_öfo
* 
ssd
, 
buf„r_öfo
* 
buf„r
, 
buf„r_group
* 
buf„r_node
);

103 
If_hôInBUf„r_move_theNode_ahód_ö_wrôîeque°
(
ssd_öfo
* 
ssd
, 
buf„r_öfo
* 
buf„r
, 
buf„r_group
* 
buf„r_node
);

105 
ssd_öfo
* 
COMPRESSION_DFTL_dól_ö_di°ributög_subªque°s
(ssd_öfo* 
ssd
);

106 
ssd_öfo
* 
DFTL_dól_ö_di°ributög_subªque°s
(ssd_öfo* 
ssd
);

107 
ssd_öfo
 *
DFTL_di°ribuã
(ssd_info *);

109 
≠≥nd_⁄_ªque°_com¥essi⁄_to_uncom¥essi⁄_Õn_d©a
(
ªque°
* 
ªq
, 
Õn
, 
°©e
);

110 
≠≥nd_⁄_ªque°_missög_ö_d©a_buf„r_Õn_d©a
(
ªque°
* 
ªq
, 
Õn
, 
°©e
);

111 
≠≥nd_⁄_ªque°_missög_ö_DFTL_buf„r_Õn_d©a
(
ªque°
* 
ªq
, 
Õn
, 
°©e
);

112 
ssd_öfo
* 
wrôe_ªque°_gë_missög_ö_d©abuf„r
(ssd_öfo* 
ssd
, 
Õn
, 
°©e
, 
ªque°
* 
ªq
);

114 
ssd_öfo
* 
vÆue_ªque°_DFTL_∑ømëîs_f‹_di°ribuã_subªque°s
(ssd_öfo* 
ssd
);

115 
ªad_vÆue_ªque°_DFTL_∑ømëîs
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

116 
wrôe_vÆue_ªque°_DFTL_∑ømëîs
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

117 
gë_å™¶©i⁄_numbî_by_d©a_Õn
(
d©a_Õn
);

118 
buf„r_group
* 
node_i¢Ÿ_ö_DFTL_buf„r
(
ssd_öfo
* 
ssd
, 
Õn
);

120 
≠≥nd_⁄_ªque°_evi˘_ö_DFTL_buf„r_Õn_d©a
(
ªque°
* 
ªq
, 
Õn
, 
°©e
);

123 
com∑ª_DFTL_buf„r_ªmaödî_•a˚_wôh_missög_ö_DFTL_buf„r
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñequest);

126 
buf„r_group
* 
node_i¢Ÿ_ö_two_DIFF_DFTL_buf„r
(
ssd_öfo
* 
ssd
, 
Õn
, * 
sign
);

127 
COMPRESSION_wrôe_vÆue_ªque°_DFTL_∑ømëîs
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

128 
COMPRESSION_ªad_vÆue_ªque°_DFTL_∑ømëîs
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

129 
com¥essi⁄_com∑ª_DFTL_buf„r_ªmaödî_•a˚_wôh_com¥essi⁄_¨ó_comög
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñequest);

130 
gë_com¥essi⁄_å™¶©i⁄_∑ge_size
(
ssd_öfo
* 
ssd
);

131 
gë_size_‰om_com¥essi⁄_to_uncom¥essi⁄
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñequest);

132 
make_ªÆ_evi˘_∑ges_f‹_com¥essi⁄_∑π
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñeque°, 
should_evi˘_size
);

133 
gë_uncom¥essi⁄_èû_∑ge_com¥es£d_size
(
ssd_öfo
* 
ssd
, 
off_£t
);

134 
move_∑ges_‰om_uncom¥essi⁄_to_com¥essi⁄
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñequest);

135 
ö£π2DFTL_UNCOM_buf„r
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

136 
¥ötf_ªad_ªque°_√ed_di°r_Êag_vÆue_™d_ûlu°i⁄
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

137 
¥ötf_wrôe_ªque°_√ed_di°r_Êag_vÆue_™d_ûlu°i⁄
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

138 
¥ötf_ªque°s_basic_∑ømãrs_vÆue
 (
ssd_öfo
* 
ssd
,
ªque°
* 
√w_ªque°
);

139 
¥ötf_m≠pögèbÀ_ªÀv™t_subªque°_ö_dif„ª¡_¥o˚ss
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

140 
¥ötf_⁄e_ªque°_subªque°s
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñequest);

141 
ã°_föish_dñëi⁄
(
ssd_öfo
* 
ssd
);

142 
gë_no_ª≥©_∑ges_numbî_‰om_Õns
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
,
_bi_li°
* 
ãmp_bûi°
, * 
öput
);

148 
åa˚_ouçut
(
ssd_öfo
 *);

150 
°©i°ic_ouçut
(
ssd_öfo
 *);

152 
size
();

154 
å™s„r_size
(
ssd_öfo
 *, , , 
ªque°
 *);

156 
öt64_t
 
föd_√¨e°_evít
(
ssd_öfo
 *);

158 
‰ì_Æl_node
(
ssd_öfo
 *);

160 
ssd_öfo
 *
make_aged
(ssd_info *);

162 
ssd_öfo
 *
no_buf„r_di°ribuã
(ssd_info *);

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/xmatchPro.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<°rög.h
>

4 
	~"xm©chPro.h
"

6 
	gm©chTy≥ToNumM©ch
[16] = {4, 3, 3, 2, 3, 2, 2, 0, 3, 2, 2, 0, 2, 0, 0, 0};

7 
	gvÆidByã
[16][4] = {

25 
	$xm©chCom¥ess
(* 
öput
, 
size
, * 
ouçut
)

27 
ªtVÆue
;

28 * 
‹gSize
 = (*Ë
ouçut
;

30 
xm©chC⁄ãxt
* 
compC⁄ãxt
 = (xm©chC⁄ãxt*Ë
	`mÆloc
((xmatchContext));

34 
	`¸óãXm©chC⁄ãxt
(
compC⁄ãxt
, 
öput
, 
size
, (
ouçut
 + 4));

35 (*
‹gSize
Ë
compC⁄ãxt
->
öputSize
;

37 
ªtVÆue
 = 
	`xm©chEncode
(
compC⁄ãxt
) + 4;

39 
	`de°royXm©chC⁄ãxt
(
compC⁄ãxt
);

41  
ªtVÆue
;

42 
	}
}

44 
	$xm©chDecom¥ess
(* 
öput
, 
size
, * 
ouçut
)

46 
ªtVÆue
;

47 * 
‹gSize
 = (*Ë
öput
;

49 
xm©chC⁄ãxt
* 
decompC⁄ãxt
 = (xm©chC⁄ãxt*Ë
	`mÆloc
((xmatchContext));

52 
	`¸óãXm©chC⁄ãxt
(
decompC⁄ãxt
, 
öput
 + 4, 
size
 - 4, 
ouçut
);

54 
ªtVÆue
 = 
	`xm©chDecode
(
decompC⁄ãxt
, *
‹gSize
);

56 
	`de°royXm©chC⁄ãxt
(
decompC⁄ãxt
);

58  
ªtVÆue
;

59 
	}
}

62 
	$¸óãXm©chC⁄ãxt
–
xm©chC⁄ãxt
* 
compC⁄ãxt
,

63 * 
öput
,

64 
size
,

65 * 
ouçut
)

67 
compC⁄ãxt
->
öput
 = (*) input;

68 
compC⁄ãxt
->
ouçut
 = (*) output;

70 
compC⁄ãxt
->
öputSize
 = 
size
 / 
NUM_BYTES_PER_TOKEN
;

71 if((
size
 % 
NUM_BYTES_PER_TOKEN
) != 0)

73 (
compC⁄ãxt
->
öputSize
)++;

76 
compC⁄ãxt
->
ªadC¡
 = 0;

77 
compC⁄ãxt
->
wrôeC¡
 = 0;

79 
compC⁄ãxt
->
di˘i⁄¨y
 = 
	`¸óãDi˘i⁄¨y
();

81 
compC⁄ãxt
->
bôBuf„r
 = 0;

82 
compC⁄ãxt
->
numVÆidBô
 = 0;

84 
compC⁄ãxt
->
ª≥tôiveC¡
 = 0;

85 
	}
}

87 
	$de°royXm©chC⁄ãxt
–
xm©chC⁄ãxt
* xmatchContext)

89 
	`de°royDi˘i⁄¨y
(
xm©chC⁄ãxt
->
di˘i⁄¨y
);

90 
	`‰ì
(
xm©chC⁄ãxt
);

91 
	}
}

94 
	$numM©ch
(
m©chTy≥
)

96  
m©chTy≥ToNumM©ch
[
m©chTy≥
];

97 
	}
}

100 
	$com∑ª
(
vÆueA
, 
vÆueB
)

102 
ªtVÆue
 = 0;

103 
i
;

104 
i
 = 3 ; i >= 0 ; i--)

106 
ªtVÆue
 = (ªtVÆuê<< 1Ë+ (((Ë(
vÆueA
 >> (8 * 
i
))Ë!((Ë(
vÆueB
 >> (8 * i))));

109  
ªtVÆue
;

110 
	}
}

115 
	$upd©eDi˘i⁄¨y
–
öput
,

116 * 
ödex
,

117 
xm©chC⁄ãxt
* 
compC⁄ãxt
)

119 
i
, 
ãmpM©chTy≥
, 
maxM©ch
 = 0, 
maxM©chTy≥
 = 
UNMATCHED
;

120 * 
ª≥tôiveC¡
 = (&
compC⁄ãxt
->repetitiveCnt);

122 
DICTIONARY
* 
di˘i⁄¨y
 = 
compC⁄ãxt
->dictionary;

123 
DIC_ENTRY
* 
curE¡ry
;

126 
i
 = 0, 
curE¡ry
 = 
	`gëE¡ry
(0, 
di˘i⁄¨y
); i < 
	`numE¡ry
(di˘i⁄¨yË; i++, curE¡ry = 
	`gëNextE¡ry
(curEntry))

128 
ãmpM©chTy≥
 = 
	`com∑ª
(
	`gëVÆueOfE¡ry
(
curE¡ry
), 
öput
);

129 if(
	`numM©ch
(
ãmpM©chTy≥
Ë> 
maxM©ch
)

131 (*
ödex
Ë
i
;

132 
maxM©chTy≥
 = 
ãmpM©chTy≥
;

133 
maxM©ch
 = 
	`numM©ch
(
ãmpM©chTy≥
);

136 if(
maxM©chTy≥
 =
COMPLETE_MATCHED
)

144 if(
maxM©chTy≥
 =
COMPLETE_MATCHED
)

147 if((*
ödex
) == 0)

150 if((*
ª≥tôiveC¡
Ë!
DICTIONARY_SIZE
)

153 (*
ª≥tôiveC¡
)++;

155 (*
ödex
Ë
DICTIONARY_SIZE
;

161 
	`moveFr⁄t
(
curE¡ry
, 
di˘i⁄¨y
);

168 if(
maxM©chTy≥
 =
UNMATCHED
)

170 (*
ödex
) = 0;

173 
	`ö£πE¡ry
(0, 
	`¸óãE¡ry
(
öput
), 
di˘i⁄¨y
);

176  
maxM©chTy≥
;

177 
	}
}

179 
	$ª°D©a
(
m©chTy≥
, 
√wE¡ry
)

181 
i
;

182 
ªtVÆue
 = 0;

183 * 
√wE¡ryCh¨
 = (*Ë&
√wE¡ry
;

185 
i
 = 0 ; i < 
NUM_BYTES_PER_TOKEN
 ; i++)

188 if(
vÆidByã
[
m©chTy≥
][
i
] == 1)

190 
ªtVÆue
 = (ªtVÆuê<< 8Ë| 
√wE¡ryCh¨
[
NUM_BYTES_PER_TOKEN
 - (
i
 + 1)];

193  
ªtVÆue
;

194 
	}
}

196 
	$xm©chEncode
(
xm©chC⁄ãxt
* 
compC⁄ãxt
)

198 
ödex
, 
m©chTy≥
, 
öputSize
 = 
compC⁄ãxt
->inputSize;

199 * 
ªadC¡
 = &(
compC⁄ãxt
->readCnt);

200 * 
ª≥tôiveC¡
 = (&
compC⁄ãxt
->repetitiveCnt);

201 * 
öput
 = 
compC⁄ãxt
->input;

202 
√wE¡ry
;

204 *
ªadC¡
 < 
öputSize
)

206 
√wE¡ry
 = 
öput
[(*
ªadC¡
)++];

208 
m©chTy≥
 = 
	`upd©eDi˘i⁄¨y
(
√wE¡ry
, &
ödex
, 
compC⁄ãxt
);

210 if(
ödex
 !
DICTIONARY_SIZE
)

213 if((*
ª≥tôiveC¡
) != 0)

216 
	`wrôeToOuçut
(
HEADER_LENGTH
, 
MATCHED_HEADER
, 
compC⁄ãxt
);

218 
	`wrôeToOuçut
(
LOG_DICTIONARY_SIZE
, 
DICTIONARY_SIZE
, 
compC⁄ãxt
);

220 
	`wrôeToOuçut
(
LOG_DICTIONARY_SIZE
, (*
ª≥tôiveC¡
), 
compC⁄ãxt
);

223 (*
ª≥tôiveC¡
) = 0;

226 if(
m©chTy≥
 =
UNMATCHED
)

229 
	`wrôeToOuçut
(
HEADER_LENGTH
, 
UNMATCHED_HEADER
, 
compC⁄ãxt
);

231 
	`wrôeToOuçut
(
NUM_BITS_PER_TOKEN
, 
√wE¡ry
, 
compC⁄ãxt
);

237 
	`wrôeToOuçut
(
HEADER_LENGTH
, 
MATCHED_HEADER
, 
compC⁄ãxt
);

239 
	`wrôeToOuçut
(
LOG_DICTIONARY_SIZE
, 
ödex
, 
compC⁄ãxt
);

241 
	`wrôeToOuçut
(
MATCHE_TYPE_LENGTH
, 
m©chTy≥
, 
compC⁄ãxt
);

243 if(
m©chTy≥
 !
COMPLETE_MATCHED
)

245 
	`wrôeToOuçut
(8*(
NUM_BYTES_PER_TOKEN
 - 
	`numM©ch
(
m©chTy≥
)), 
	`ª°D©a
(m©chTy≥, 
√wE¡ry
), 
compC⁄ãxt
);

251 if((*
ª≥tôiveC¡
) != 0)

254 
	`wrôeToOuçut
(
HEADER_LENGTH
, 
MATCHED_HEADER
, 
compC⁄ãxt
);

256 
	`wrôeToOuçut
(
LOG_DICTIONARY_SIZE
, 
DICTIONARY_SIZE
, 
compC⁄ãxt
);

258 
	`wrôeToOuçut
(
LOG_DICTIONARY_SIZE
, (*
ª≥tôiveC¡
), 
compC⁄ãxt
);

262 if(
compC⁄ãxt
->
numVÆidBô
 != 0)

264 
compC⁄ãxt
->
ouçut
[(compC⁄ãxt->
wrôeC¡
)++] = (compC⁄ãxt->
bôBuf„r
 << (
NUM_BITS_PER_TOKEN
 - compC⁄ãxt->
numVÆidBô
));

268  
NUM_BYTES_PER_TOKEN
*(
compC⁄ãxt
->
wrôeC¡
);

269 
	}
}

272 
	$wrôeToOuçut
–
numVÆidBôInD©a
,

273 
ícodedD©a
,

274 
xm©chC⁄ãxt
* 
compC⁄ãxt
)

276 * 
ouçut
 = 
compC⁄ãxt
->output;

277 * 
bôBuf„r
 = &(
compC⁄ãxt
->bitBuffer);

279 * 
wrôeC¡
 = &(
compC⁄ãxt
->writeCnt);

280 * 
numVÆidBôInBuf„r
 = &(
compC⁄ãxt
->
numVÆidBô
);

282 
ªmaöBôs
;

284 if((*
numVÆidBôInBuf„r
Ë=
NUM_BITS_PER_TOKEN
)

286 
ouçut
[(*
wrôeC¡
)++] = (*
bôBuf„r
);

287 (*
bôBuf„r
) = 0;

288 (*
numVÆidBôInBuf„r
) = 0;

291 
ªmaöBôs
 = 
NUM_BITS_PER_TOKEN
 - (*
numVÆidBôInBuf„r
);

294 if(
numVÆidBôInD©a
 > 
ªmaöBôs
)

297 
ouçut
[(*
wrôeC¡
)++] = ((*
bôBuf„r
Ë<< 
ªmaöBôs
) |

298 (
ícodedD©a
 >> (
numVÆidBôInD©a
 - 
ªmaöBôs
));

300 (*
bôBuf„r
Ë
ícodedD©a
;

301 (*
numVÆidBôInBuf„r
Ë(
numVÆidBôInD©a
 - 
ªmaöBôs
);

308 if(
numVÆidBôInD©a
 =
NUM_BITS_PER_TOKEN
)

310 
ouçut
[(*
wrôeC¡
)++] = 
ícodedD©a
;

315 (*
bôBuf„r
Ë(((*bôBuf„rË<< 
numVÆidBôInD©a
Ë| 
ícodedD©a
);

316 (*
numVÆidBôInBuf„r
Ë+
numVÆidBôInD©a
;

319 
	}
}

321 
	$xm©chDecode
(
xm©chC⁄ãxt
* 
decompC⁄ãxt
, 
‹gSize
)

323 *
ouçut
 = 
decompC⁄ãxt
->output;

324 * 
wrôeC¡
 = &(
decompC⁄ãxt
->writeCnt);

325 
DICTIONARY
* 
di˘i⁄¨y
 = 
decompC⁄ãxt
->dictionary;

327 
m©chTy≥
, 
isM©ch
, 
ödex
, 
ª≥tôiveC¡
 = 0;

329 
decodedD©a
;

331 (*
wrôeC¡
Ë< 
‹gSize
)

333 
isM©ch
 = 
	`ªadI≈ut
(
HEADER_LENGTH
, 
decompC⁄ãxt
);

334 if(
isM©ch
 =
UNMATCHED_HEADER
)

336 
m©chTy≥
 = 
UNMATCHED
;

337 
decodedD©a
 = 
	`ªadI≈ut
(
NUM_BITS_PER_TOKEN
, 
decompC⁄ãxt
);

341 
ödex
 = (Ë
	`ªadI≈ut
(
LOG_DICTIONARY_SIZE
, 
decompC⁄ãxt
);

342 if(
ödex
 =
DICTIONARY_SIZE
)

344 
ª≥tôiveC¡
 = (Ë
	`ªadI≈ut
(
LOG_DICTIONARY_SIZE
, 
decompC⁄ãxt
);

345 
decodedD©a
 = 
	`gëVÆueOfE¡ry
(
	`gëE¡ry
(0, 
di˘i⁄¨y
));

349 
m©chTy≥
 = (Ë
	`ªadI≈ut
(
MATCHE_TYPE_LENGTH
, 
decompC⁄ãxt
);

350 if(
m©chTy≥
 !
COMPLETE_MATCHED
)

352 
decodedD©a
 = 
	`ªadI≈ut
(8*(
NUM_BYTES_PER_TOKEN
 - 
	`numM©ch
(
m©chTy≥
)), 
decompC⁄ãxt
);

354 
decodedD©a
 = 
	`gëOrgD©a
(
m©chTy≥
, 
	`gëVÆueOfE¡ry
(
	`gëE¡ry
(
ödex
, 
di˘i⁄¨y
)), decodedData);

358 if(
ª≥tôiveC¡
 != 0)

360 
ª≥tôiveC¡
 != 0)

362 
ª≥tôiveC¡
--;

363 
ouçut
[(*
wrôeC¡
)++] = 
decodedD©a
;

368 
ouçut
[(*
wrôeC¡
)++] = 
decodedD©a
;

369 
	`ªbuûdDi˘i⁄¨y
(
decodedD©a
, 
ödex
, 
m©chTy≥
, 
di˘i⁄¨y
);

372  (*
wrôeC¡
)*
NUM_BYTES_PER_TOKEN
;

373 
	}
}

375 
	$ªadI≈ut
(
numBôsToRód
, 
xm©chC⁄ãxt
* 
decompC⁄ãxt
)

377 * 
öput
 = 
decompC⁄ãxt
->input;

378 * 
bôBuf„r
 = &(
decompC⁄ãxt
->bitBuffer);

379 * 
ªadC¡
 = &(
decompC⁄ãxt
->readCnt);

380 * 
numVÆidBô
 = &(
decompC⁄ãxt
->numValidBit);

381 
ªtVÆue
;

383 
	#MASK
(
n
Ë(0xFFFFFFFF>>(32-n))

	)

385 if(
numBôsToRód
 == 0)

390 if((*
numVÆidBô
) == 0)

392 (*
bôBuf„r
Ë
öput
[(*
ªadC¡
)++];

393 (*
numVÆidBô
) = 32;

396 if(
numBôsToRód
 =(*
numVÆidBô
))

398 
ªtVÆue
 = (
	`MASK
(
numBôsToRód
Ë& (*
bôBuf„r
));

399 (*
bôBuf„r
Ë
öput
[(*
ªadC¡
)++];

400 (*
numVÆidBô
) = 32;

402 if(
numBôsToRód
 < (*
numVÆidBô
))

404 
ªtVÆue
 = (
	`MASK
(
numBôsToRód
)Ë& ((*
bôBuf„r
Ë>> ((*
numVÆidBô
) -ÇumBitsToRead));

405 (*
numVÆidBô
Ë-
numBôsToRód
;

409 
ªtVÆue
 = (
	`MASK
(
NUM_BITS_PER_TOKEN
 - (*
numVÆidBô
)Ë& (*
bôBuf„r
));

410 
ªtVÆue
 <<(
numBôsToRód
 - (*
numVÆidBô
));

412 (*
bôBuf„r
Ë
öput
[(*
ªadC¡
)++];

413 (*
numVÆidBô
Ë
NUM_BITS_PER_TOKEN
 - (
numBôsToRód
 - (*numValidBit));

415 
ªtVÆue
 |((*
bôBuf„r
Ë>> (*
numVÆidBô
));

419  
ªtVÆue
;

420 
	}
}

422 
	$gëOrgD©a
(
m©chTy≥
, 
ªfVÆue
, 
uniqueVÆue
)

424 
i
;

425 
ªtVÆue
;

426 * 
ªfVÆueCh¨
 = (*Ë&
ªfVÆue
;

427 
√xtCh¨
 = (
	`numM©ch
(
m©chTy≥
Ë=2Ë? (Ë(
uniqueVÆue
 >> 8) : () uniqueValue;

429 if(
m©chTy≥
 =
COMPLETE_MATCHED
)

431 
ªtVÆue
 = 
ªfVÆue
;

435 
i
 = 0 ; i < 
NUM_BYTES_PER_TOKEN
 ; i++)

437 
ªtVÆue
 <<= 8;

438 if(
vÆidByã
[
m©chTy≥
][
i
] == 1)

440 
ªtVÆue
 |
√xtCh¨
;

441 
√xtCh¨
 = (Ë
uniqueVÆue
;

445 
ªtVÆue
 |
ªfVÆueCh¨
[
NUM_BYTES_PER_TOKEN
 - 1 - 
i
];

450  
ªtVÆue
;

451 
	}
}

453 
	$ªbuûdDi˘i⁄¨y
(
‹gD©a
, 
ödex
, 
m©chTy≥
, 
DICTIONARY
* 
di˘i⁄¨y
)

455 
DIC_ENTRY
* 
curE¡ry
 = 
	`gëE¡ry
(
ödex
, 
di˘i⁄¨y
);

456 if(
m©chTy≥
 =
COMPLETE_MATCHED
)

458 if(
ödex
 != 0)

460 
	`moveFr⁄t
(
curE¡ry
, 
di˘i⁄¨y
);

465 
	`ö£πE¡ry
(0, 
	`¸óãE¡ry
(
‹gD©a
), 
di˘i⁄¨y
);

467 
	}
}

469 
	$¥ötfBö¨y
(
öput
)

471 
i
;

472 
i
 = 0 ; i <
NUM_BITS_PER_TOKEN
 ; i++)

474 
	`¥ötf
("%d", ((
öput
 << 
i
Ë>> (
NUM_BITS_PER_TOKEN
 - 1)));

476 
	}
}

	@/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/xmatchPro.h

1 #i‚de‡
_XMATCHPRO_H_


2 
	#_XMATCHPRO_H_


	)

5 
	~"di˘i⁄¨y.h
"

6 
	~"diffXm©ch.h
"

7 
	~"js_li°.h
"

9 
	#HEADER_LENGTH
 1

	)

11 
	#COMPLETE_MATCHED
 0

	)

12 
	#UNMATCHED
 15

	)

14 
	#MATCHED_HEADER
 1

	)

15 
	#UNMATCHED_HEADER
 0

	)

17 
	#NUM_BYTES_PER_TOKEN
 4

	)

18 
	#MATCHE_TYPE_LENGTH
 
NUM_BYTES_PER_TOKEN


	)

19 
	#NUM_BITS_PER_TOKEN
 
NUM_BYTES_PER_TOKEN
*8

	)

22 
	sxm©chC⁄ãxt


25 * 
	möput
;

26 * 
	mouçut
;

28 
	möputSize
;

30 
	mªadC¡
;

31 
	mwrôeC¡
;

33 
DICTIONARY
* 
	mdi˘i⁄¨y
;

35 
	mbôBuf„r
;

36 
	mnumVÆidBô
;

38 
	mª≥tôiveC¡
;

42 
xm©chCom¥ess
(* 
öput
, 
size
, * 
ouçut
);

43 
xm©chDecom¥ess
(* 
öput
, 
size
, * 
ouçut
);

44 
¸óãXm©chC⁄ãxt
–
xm©chC⁄ãxt
* 
compC⁄ãxt
,

45 * 
öput
,

46 
size
,

47 * 
ouçut
);

48 
de°royXm©chC⁄ãxt
–
xm©chC⁄ãxt
* xmatchContext);

49 
numM©ch
(
m©chTy≥
);

50 
com∑ª
(
vÆueA
, 
vÆueB
);

51 
upd©eDi˘i⁄¨y
–
öput
,

52 * 
ödex
,

53 
xm©chC⁄ãxt
* 
compC⁄ãxt
);

54 
ª°D©a
(
m©chTy≥
, 
√wE¡ry
);

55 
xm©chEncode
(
xm©chC⁄ãxt
* 
compC⁄ãxt
);

56 
wrôeToOuçut
–
numVÆidBôInD©a
,

57 
ícodedD©a
,

58 
xm©chC⁄ãxt
* 
compC⁄ãxt
);

60 
xm©chDecode
(
xm©chC⁄ãxt
* 
decompC⁄ãxt
, 
‹gSize
);

61 
ªadI≈ut
(
numBôsToRód
, 
xm©chC⁄ãxt
* 
decompC⁄ãxt
);

62 
gëOrgD©a
(
m©chTy≥
, 
ªfVÆue
, 
uniqueVÆue
);

63 
ªbuûdDi˘i⁄¨y
(
‹gD©a
, 
ödex
, 
m©chTy≥
, 
DICTIONARY
* 
di˘i⁄¨y
);

64 
¥ötfBö¨y
(
öput
);

	@/usr/include/ctype.h

22 #i‚def 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<„©uªs.h
>

26 
	~<bôs/ty≥s.h
>

28 
	g__BEGIN_DECLS


30 #i‚de‡
_ISbô


39 
	~<ídün.h
>

40 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


41 
	#_ISbô
(
bô
Ë(1 << (bô))

	)

43 
	#_ISbô
(
bô
Ë((bôË< 8 ? ((1 << (bô)Ë<< 8Ë: ((1 << (bô)Ë>> 8))

	)

48 
	m_ISuµî
 = 
_ISbô
 (0),

49 
	m_ISlowî
 = 
_ISbô
 (1),

50 
	m_ISÆpha
 = 
_ISbô
 (2),

51 
	m_ISdigô
 = 
_ISbô
 (3),

52 
	m_ISxdigô
 = 
_ISbô
 (4),

53 
	m_IS•a˚
 = 
_ISbô
 (5),

54 
	m_IS¥öt
 = 
_ISbô
 (6),

55 
	m_ISgøph
 = 
_ISbô
 (7),

56 
	m_ISbœnk
 = 
_ISbô
 (8),

57 
	m_IS˙ål
 = 
_ISbô
 (9),

58 
	m_ISpun˘
 = 
_ISbô
 (10),

59 
	m_ISÆnum
 = 
_ISbô
 (11)

79 c⁄° **
	$__˘y≥_b_loc
 ()

80 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

81 c⁄° 
__öt32_t
 **
	$__˘y≥_tﬁowî_loc
 ()

82 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

83 c⁄° 
__öt32_t
 **
	$__˘y≥_touµî_loc
 ()

84 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

87 #i‚de‡
__˝lu•lus


88 
	#__is˘y≥
(
c
, 
ty≥
) \

89 ((*
	`__˘y≥_b_loc
 ())[(Ë(
c
)] & (Ë
ty≥
)

	)

90 #ñi‡
deföed
 
__USE_EXTERN_INLINES


91 
	#__is˘y≥_f
(
ty≥
) \

92 
__exã∫_ölöe
 \

93 
is
##
	`ty≥
 (
__c
Ë
__THROW
 \

95  (*
	`__˘y≥_b_loc
 ())[(Ë(
__c
)] & (Ë
_IS
##
ty≥
; \

96 
	}

	)
}

99 
	#__ißscii
(
c
Ë(((cË& ~0x7fË=0Ë

	)

100 
	#__tﬂscii
(
c
Ë((cË& 0x7fË

	)

102 
	#__ex˘y≥
(
«me
Ë
	`«me
 (Ë
__THROW


	)

104 
__BEGIN_NAMESPACE_STD


110 
__ex˘y≥
 (
iß um
);

111 
__ex˘y≥
 (
ißÕha
);

112 
__ex˘y≥
 (
is˙ål
);

113 
__ex˘y≥
 (
isdigô
);

114 
__ex˘y≥
 (
i¶owî
);

115 
__ex˘y≥
 (
isgøph
);

116 
__ex˘y≥
 (
i•röt
);

117 
__ex˘y≥
 (
i•un˘
);

118 
__ex˘y≥
 (
is•a˚
);

119 
__ex˘y≥
 (
isuµî
);

120 
__ex˘y≥
 (
isxdigô
);

124 
	$tﬁowî
 (
__c
Ë
__THROW
;

127 
	$touµî
 (
__c
Ë
__THROW
;

129 
__END_NAMESPACE_STD


133 #ifdef 
__USE_ISOC99


134 
__BEGIN_NAMESPACE_C99


136 
	`__ex˘y≥
 (
isbœnk
);

138 
__END_NAMESPACE_C99


141 #ifde‡
__USE_GNU


143 
	$is˘y≥
 (
__c
, 
__mask
Ë
__THROW
;

146 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


150 
	$ißscii
 (
__c
Ë
__THROW
;

154 
	$tﬂscii
 (
__c
Ë
__THROW
;

158 
	`__ex˘y≥
 (
_touµî
);

159 
	`__ex˘y≥
 (
_tﬁowî
);

163 
	#__tobody
(
c
, 
f
, 
a
, 
¨gs
) \

164 (
__exãnsi⁄__
 \

165 ({ 
__ªs
; \

166 i‡( (
c
) > 1) \

168 i‡(
	`__buûtö_c⁄°™t_p
 (
c
)) \

170 
__c
 = (
c
); \

171 
__ªs
 = 
__c
 < -128 || __¯> 255 ? __¯: (
a
)[__c]; \

174 
__ªs
 = 
f
 
¨gs
; \

177 
__ªs
 = (
a
)[(Ë(
c
)]; \

178 
__ªs
; 
	}
}))

	)

180 #i‡!
deföed
 
__NO_CTYPE


181 #ifde‡
__is˘y≥_f


182 
	$__is˘y≥_f
 (
Ænum
)

183 
	$__is˘y≥_f
 (
Æpha
)

184 
	$__is˘y≥_f
 (
˙ål
)

185 
	$__is˘y≥_f
 (
digô
)

186 
	$__is˘y≥_f
 (
lowî
)

187 
	$__is˘y≥_f
 (
gøph
)

188 
	$__is˘y≥_f
 (
¥öt
)

189 
	$__is˘y≥_f
 (
pun˘
)

190 
	$__is˘y≥_f
 (
•a˚
)

191 
	$__is˘y≥_f
 (
uµî
)

192 
	$__is˘y≥_f
 (
xdigô
)

193 #ifde‡
__USE_ISOC99


194 
	$__is˘y≥_f
 (
bœnk
)

196 #ñi‡
deföed
 
__is˘y≥


197 
	#iß um
(
c
Ë
	`__is˘y≥
((c), 
_ISÆnum
)

	)

198 
	#ißÕha
(
c
Ë
	`__is˘y≥
((c), 
_ISÆpha
)

	)

199 
	#is˙ål
(
c
Ë
	`__is˘y≥
((c), 
_IS˙ål
)

	)

200 
	#isdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISdigô
)

	)

201 
	#i¶owî
(
c
Ë
	`__is˘y≥
((c), 
_ISlowî
)

	)

202 
	#isgøph
(
c
Ë
	`__is˘y≥
((c), 
_ISgøph
)

	)

203 
	#i•röt
(
c
Ë
	`__is˘y≥
((c), 
_IS¥öt
)

	)

204 
	#i•un˘
(
c
Ë
	`__is˘y≥
((c), 
_ISpun˘
)

	)

205 
	#is•a˚
(
c
Ë
	`__is˘y≥
((c), 
_IS•a˚
)

	)

206 
	#isuµî
(
c
Ë
	`__is˘y≥
((c), 
_ISuµî
)

	)

207 
	#isxdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISxdigô
)

	)

208 #ifde‡
__USE_ISOC99


209 
	#isbœnk
(
c
Ë
	`__is˘y≥
((c), 
_ISbœnk
)

	)

213 #ifde‡
__USE_EXTERN_INLINES


214 
__exã∫_ölöe
 

215 
	`__NTH
 (
	$tﬁowî
 (
__c
))

217  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_tﬁowî_loc
 ())[__c] : __c;

218 
	}
}

220 
__exã∫_ölöe
 

221 
__NTH
 (
	$touµî
 (
__c
))

223  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_touµî_loc
 ())[__c] : __c;

224 
	}
}

227 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


228 
	#tﬁowî
(
c
Ë
	`__tobody
 (c, 
tﬁowî
, *
	`__˘y≥_tﬁowî_loc
 (), (c))

	)

229 
	#touµî
(
c
Ë
	`__tobody
 (c, 
touµî
, *
	`__˘y≥_touµî_loc
 (), (c))

	)

232 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


233 
	#ißscii
(
c
Ë
	`__ißscii
 (c)

	)

234 
	#tﬂscii
(
c
Ë
	`__tﬂscii
 (c)

	)

236 
	#_tﬁowî
(
c
Ë((Ë(*
	`__˘y≥_tﬁowî_loc
 ())[(Ë(c)])

	)

237 
	#_touµî
(
c
Ë((Ë(*
	`__˘y≥_touµî_loc
 ())[(Ë(c)])

	)

243 #ifde‡
__USE_XOPEN2K8


257 
	~<xloˇÀ.h
>

261 
	#__is˘y≥_l
(
c
, 
ty≥
, 
loˇÀ
) \

262 ((
loˇÀ
)->
__˘y≥_b
[(Ë(
c
)] & (Ë
ty≥
)

	)

264 
	#__ex˘y≥_l
(
«me
) \

265 
	`«me
 (, 
__loˇÀ_t
Ë
__THROW


	)

271 
__ex˘y≥_l
 (
iß um_l
);

272 
__ex˘y≥_l
 (
ißÕha_l
);

273 
__ex˘y≥_l
 (
is˙ål_l
);

274 
__ex˘y≥_l
 (
isdigô_l
);

275 
__ex˘y≥_l
 (
i¶owî_l
);

276 
__ex˘y≥_l
 (
isgøph_l
);

277 
__ex˘y≥_l
 (
i•röt_l
);

278 
__ex˘y≥_l
 (
i•un˘_l
);

279 
__ex˘y≥_l
 (
is•a˚_l
);

280 
__ex˘y≥_l
 (
isuµî_l
);

281 
__ex˘y≥_l
 (
isxdigô_l
);

283 
__ex˘y≥_l
 (
isbœnk_l
);

287 
	$__tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

288 
	$tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

291 
	$__touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

292 
	$touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

294 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


295 
	#__tﬁowî_l
(
c
, 
loˇÀ
) \

296 
	`__tobody
 (
c
, 
__tﬁowî_l
, (
loˇÀ
)->
__˘y≥_tﬁowî
, (c,ÜoˇÀ))

	)

297 
	#__touµî_l
(
c
, 
loˇÀ
) \

298 
	`__tobody
 (
c
, 
__touµî_l
, (
loˇÀ
)->
__˘y≥_touµî
, (c,ÜoˇÀ))

	)

299 
	#tﬁowî_l
(
c
, 
loˇÀ
Ë
	`__tﬁowî_l
 ((c), (loˇÀ))

	)

300 
	#touµî_l
(
c
, 
loˇÀ
Ë
	`__touµî_l
 ((c), (loˇÀ))

	)

304 #i‚de‡
__NO_CTYPE


305 
	#__iß um_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆnum
, (l))

	)

306 
	#__ißÕha_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆpha
, (l))

	)

307 
	#__is˙ål_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS˙ål
, (l))

	)

308 
	#__isdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISdigô
, (l))

	)

309 
	#__i¶owî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISlowî
, (l))

	)

310 
	#__isgøph_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISgøph
, (l))

	)

311 
	#__i•röt_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS¥öt
, (l))

	)

312 
	#__i•un˘_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISpun˘
, (l))

	)

313 
	#__is•a˚_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS•a˚
, (l))

	)

314 
	#__isuµî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISuµî
, (l))

	)

315 
	#__isxdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISxdigô
, (l))

	)

317 
	#__isbœnk_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISbœnk
, (l))

	)

319 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


320 
	#__ißscii_l
(
c
,
l
Ë(÷), 
	`__ißscii
 (c))

	)

321 
	#__tﬂscii_l
(
c
,
l
Ë(÷), 
	`__tﬂscii
 (c))

	)

324 
	#iß um_l
(
c
,
l
Ë
	`__iß um_l
 ((c), (l))

	)

325 
	#ißÕha_l
(
c
,
l
Ë
	`__ißÕha_l
 ((c), (l))

	)

326 
	#is˙ål_l
(
c
,
l
Ë
	`__is˙ål_l
 ((c), (l))

	)

327 
	#isdigô_l
(
c
,
l
Ë
	`__isdigô_l
 ((c), (l))

	)

328 
	#i¶owî_l
(
c
,
l
Ë
	`__i¶owî_l
 ((c), (l))

	)

329 
	#isgøph_l
(
c
,
l
Ë
	`__isgøph_l
 ((c), (l))

	)

330 
	#i•röt_l
(
c
,
l
Ë
	`__i•röt_l
 ((c), (l))

	)

331 
	#i•un˘_l
(
c
,
l
Ë
	`__i•un˘_l
 ((c), (l))

	)

332 
	#is•a˚_l
(
c
,
l
Ë
	`__is•a˚_l
 ((c), (l))

	)

333 
	#isuµî_l
(
c
,
l
Ë
	`__isuµî_l
 ((c), (l))

	)

334 
	#isxdigô_l
(
c
,
l
Ë
	`__isxdigô_l
 ((c), (l))

	)

336 
	#isbœnk_l
(
c
,
l
Ë
	`__isbœnk_l
 ((c), (l))

	)

338 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


339 
	#ißscii_l
(
c
,
l
Ë
	`__ißscii_l
 ((c), (l))

	)

340 
	#tﬂscii_l
(
c
,
l
Ë
	`__tﬂscii_l
 ((c), (l))

	)

347 
__END_DECLS


	@/usr/include/malloc.h

19 #i‚de‡
_MALLOC_H


20 
	#_MALLOC_H
 1

	)

22 
	~<„©uªs.h
>

23 
	~<°ddef.h
>

24 
	~<°dio.h
>

26 #ifde‡
_LIBC


27 
	#__MALLOC_HOOK_VOLATILE


	)

28 
	#__MALLOC_DEPRECATED


	)

30 
	#__MALLOC_HOOK_VOLATILE
 vﬁ©ûe

	)

31 
	#__MALLOC_DEPRECATED
 
__©åibuã_dïªˇãd__


	)

35 
__BEGIN_DECLS


38 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

41 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

42 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

49 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

50 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

53 
	$‰ì
 (*
__±r
Ë
__THROW
;

56 
	$c‰ì
 (*
__±r
Ë
__THROW
;

59 *
	$memÆign
 (
size_t
 
__Æignmít
, size_à
__size
)

60 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

63 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

67 *
	$pvÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

71 *(*
__m‹ec‹e
Ë(
±rdiff_t
 
__size
);

74 *
	$__deÁu…_m‹ec‹e
 (
±rdiff_t
 
__size
)

75 
__THROW
 
__©åibuã_mÆloc__
;

79 
	smÆlöfo


81 
¨ía
;

82 
‹dblks
;

83 
smblks
;

84 
hblks
;

85 
hblkhd
;

86 
usmblks
;

87 
fsmblks
;

88 
u‹dblks
;

89 
f‹dblks
;

90 
kìpco°
;

94 
mÆlöfo
 
	$mÆlöfo
 (Ë
__THROW
;

97 #i‚de‡
M_MXFAST


98 
	#M_MXFAST
 1

	)

100 #i‚de‡
M_NLBLKS


101 
	#M_NLBLKS
 2

	)

103 #i‚de‡
M_GRAIN


104 
	#M_GRAIN
 3

	)

106 #i‚de‡
M_KEEP


107 
	#M_KEEP
 4

	)

111 
	#M_TRIM_THRESHOLD
 -1

	)

112 
	#M_TOP_PAD
 -2

	)

113 
	#M_MMAP_THRESHOLD
 -3

	)

114 
	#M_MMAP_MAX
 -4

	)

115 
	#M_CHECK_ACTION
 -5

	)

116 
	#M_PERTURB
 -6

	)

117 
	#M_ARENA_TEST
 -7

	)

118 
	#M_ARENA_MAX
 -8

	)

121 
	$mÆl›t
 (
__∑øm
, 
__vÆ
Ë
__THROW
;

125 
	$mÆloc_åim
 (
size_t
 
__∑d
Ë
__THROW
;

129 
size_t
 
	$mÆloc_ußbÀ_size
 (*
__±r
Ë
__THROW
;

132 
	$mÆloc_°©s
 (Ë
__THROW
;

135 
	$mÆloc_öfo
 (
__›ti⁄s
, 
FILE
 *
__Â
Ë
__THROW
;

138 *
	$mÆloc_gë_°©e
 (Ë
__THROW
;

142 
	$mÆloc_£t_°©e
 (*
__±r
Ë
__THROW
;

147 (*
__MALLOC_HOOK_VOLATILE
 
__mÆloc_öôülize_hook
) ()

148 
__MALLOC_DEPRECATED
;

150 (*
__MALLOC_HOOK_VOLATILE
 
__‰ì_hook
Ë(*
__±r
,

152 
__MALLOC_DEPRECATED
;

153 *(*
__MALLOC_HOOK_VOLATILE
 
__mÆloc_hook
)(
size_t
 
__size
,

155 
__MALLOC_DEPRECATED
;

156 *(*
__MALLOC_HOOK_VOLATILE
 
__ªÆloc_hook
)(*
__±r
,

157 
size_t
 
__size
,

159 
__MALLOC_DEPRECATED
;

160 *(*
__MALLOC_HOOK_VOLATILE
 
__memÆign_hook
)(
size_t
 
__Æignmít
,

161 
size_t
 
__size
,

163 
__MALLOC_DEPRECATED
;

164 (*
__MALLOC_HOOK_VOLATILE
 
__a·î_m‹ec‹e_hook
) ();

167 
	$__mÆloc_check_öô
 (Ë
__THROW
 
__MALLOC_DEPRECATED
;

170 
__END_DECLS


	@/usr/include/stdio.h

23 #i‚de‡
_STDIO_H


25 #i‡!
deföed
 
__√ed_FILE
 && !deföed 
__√ed___FILE


26 
	#_STDIO_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


31 
	#__√ed_size_t


	)

32 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

35 
	~<bôs/ty≥s.h
>

36 
	#__√ed_FILE


	)

37 
	#__√ed___FILE


	)

41 #i‡!
deföed
 
__FILE_deföed
 && deföed 
__√ed_FILE


44 
	g_IO_FILE
;

46 
__BEGIN_NAMESPACE_STD


48 
_IO_FILE
 
	tFILE
;

49 
	g__END_NAMESPACE_STD


50 #i‡
deföed
 
__USE_LARGEFILE64
 || deföed 
__USE_SVID
 || deföed 
__USE_POSIX
 \

51 || 
deföed
 
	g__USE_BSD
 || deföed 
	g__USE_ISOC99
 || deföed 
	g__USE_XOPEN
 \

52 || 
deföed
 
__USE_POSIX2


53 
	$__USING_NAMESPACE_STD
(
FILE
)

56 
	#__FILE_deföed
 1

	)

58 #unde‡
__√ed_FILE


61 #i‡!
deföed
 
____FILE_deföed
 && deföed 
__√ed___FILE


64 
_IO_FILE
 
	t__FILE
;

66 
	#____FILE_deföed
 1

	)

68 #unde‡
__√ed___FILE


71 #ifdef 
_STDIO_H


72 
	#_STDIO_USES_IOSTREAM


	)

74 
	~<libio.h
>

76 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


77 #ifde‡
__GNUC__


78 #i‚de‡
_VA_LIST_DEFINED


79 
_G_va_li°
 
	tva_li°
;

80 
	#_VA_LIST_DEFINED


	)

83 
	~<°d¨g.h
>

87 #ifde‡
__USE_XOPEN2K8


88 #i‚de‡
__off_t_deföed


89 #i‚de‡
__USE_FILE_OFFSET64


90 
__off_t
 
	toff_t
;

92 
__off64_t
 
	toff_t
;

94 
	#__off_t_deföed


	)

96 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


97 
__off64_t
 
	toff64_t
;

98 
	#__off64_t_deföed


	)

101 #i‚de‡
__ssize_t_deföed


102 
__ssize_t
 
	tssize_t
;

103 
	#__ssize_t_deföed


	)

108 
__BEGIN_NAMESPACE_STD


109 #i‚de‡
__USE_FILE_OFFSET64


110 
_G_Âos_t
 
	tÂos_t
;

112 
_G_Âos64_t
 
	tÂos_t
;

114 
__END_NAMESPACE_STD


115 #ifde‡
__USE_LARGEFILE64


116 
_G_Âos64_t
 
	tÂos64_t
;

120 
	#_IOFBF
 0

	)

121 
	#_IOLBF
 1

	)

122 
	#_IONBF
 2

	)

126 #i‚de‡
BUFSIZ


127 
	#BUFSIZ
 
_IO_BUFSIZ


	)

133 #i‚de‡
EOF


134 
	#EOF
 (-1)

	)

140 
	#SEEK_SET
 0

	)

141 
	#SEEK_CUR
 1

	)

142 
	#SEEK_END
 2

	)

143 #ifde‡
__USE_GNU


144 
	#SEEK_DATA
 3

	)

145 
	#SEEK_HOLE
 4

	)

149 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


151 
	#P_tmpdú
 "/tmp"

	)

164 
	~<bôs/°dio_lim.h
>

168 
_IO_FILE
 *
°dö
;

169 
_IO_FILE
 *
°dout
;

170 
_IO_FILE
 *
°dîr
;

172 
	#°dö
 
°dö


	)

173 
	#°dout
 
°dout


	)

174 
	#°dîr
 
°dîr


	)

176 
__BEGIN_NAMESPACE_STD


178 
	$ªmove
 (c⁄° *
__fûíame
Ë
__THROW
;

180 
	$ª«me
 (c⁄° *
__ﬁd
, c⁄° *
__√w
Ë
__THROW
;

181 
__END_NAMESPACE_STD


183 #ifde‡
__USE_ATFILE


185 
	$ª«mót
 (
__ﬁdfd
, c⁄° *
__ﬁd
, 
__√wfd
,

186 c⁄° *
__√w
Ë
__THROW
;

189 
__BEGIN_NAMESPACE_STD


194 #i‚de‡
__USE_FILE_OFFSET64


195 
FILE
 *
	$tmpfûe
 (Ë
__wur
;

197 #ifde‡
__REDIRECT


198 
FILE
 *
	`__REDIRECT
 (
tmpfûe
, (), 
tmpfûe64
Ë
__wur
;

200 
	#tmpfûe
 
tmpfûe64


	)

204 #ifde‡
__USE_LARGEFILE64


205 
FILE
 *
	$tmpfûe64
 (Ë
__wur
;

209 *
	$tm≤am
 (*
__s
Ë
__THROW
 
__wur
;

210 
__END_NAMESPACE_STD


212 #ifde‡
__USE_MISC


215 *
	$tm≤am_r
 (*
__s
Ë
__THROW
 
__wur
;

219 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


227 *
	$ãm≤am
 (c⁄° *
__dú
, c⁄° *
__pfx
)

228 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

232 
__BEGIN_NAMESPACE_STD


237 
	`f˛o£
 (
FILE
 *
__°ªam
);

242 
	`fÊush
 (
FILE
 *
__°ªam
);

243 
__END_NAMESPACE_STD


245 #ifde‡
__USE_MISC


252 
	`fÊush_u∆ocked
 (
FILE
 *
__°ªam
);

255 #ifde‡
__USE_GNU


262 
	`f˛o£Æl
 ();

266 
__BEGIN_NAMESPACE_STD


267 #i‚de‡
__USE_FILE_OFFSET64


272 
FILE
 *
	$f›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

273 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

278 
FILE
 *
	$‰e›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

279 c⁄° *
__ª°ri˘
 
__modes
,

280 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

282 #ifde‡
__REDIRECT


283 
FILE
 *
	`__REDIRECT
 (
f›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

284 c⁄° *
__ª°ri˘
 
__modes
), 
f›í64
)

285 
__wur
;

286 
FILE
 *
	`__REDIRECT
 (
‰e›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

287 c⁄° *
__ª°ri˘
 
__modes
,

288 
FILE
 *
__ª°ri˘
 
__°ªam
), 
‰e›í64
)

289 
__wur
;

291 
	#f›í
 
f›í64


	)

292 
	#‰e›í
 
‰e›í64


	)

295 
__END_NAMESPACE_STD


296 #ifde‡
__USE_LARGEFILE64


297 
FILE
 *
	$f›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

298 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

299 
FILE
 *
	$‰e›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

300 c⁄° *
__ª°ri˘
 
__modes
,

301 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

304 #ifdef 
__USE_POSIX


306 
FILE
 *
	$fd›í
 (
__fd
, c⁄° *
__modes
Ë
__THROW
 
__wur
;

309 #ifdef 
__USE_GNU


312 
FILE
 *
	$f›ícookõ
 (*
__ª°ri˘
 
__magic_cookõ
,

313 c⁄° *
__ª°ri˘
 
__modes
,

314 
_IO_cookõ_io_fun˘i⁄s_t
 
__io_funcs
Ë
__THROW
 
__wur
;

317 #ifde‡
__USE_XOPEN2K8


319 
FILE
 *
	$fmem›í
 (*
__s
, 
size_t
 
__Àn
, c⁄° *
__modes
)

320 
__THROW
 
__wur
;

325 
FILE
 *
	$›í_mem°ªam
 (**
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
 
__wur
;

329 
__BEGIN_NAMESPACE_STD


332 
	$£tbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
Ë
__THROW
;

336 
	$£tvbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

337 
__modes
, 
size_t
 
__n
Ë
__THROW
;

338 
__END_NAMESPACE_STD


340 #ifdef 
__USE_BSD


343 
	$£tbuf„r
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

344 
size_t
 
__size
Ë
__THROW
;

347 
	$£éöebuf
 (
FILE
 *
__°ªam
Ë
__THROW
;

351 
__BEGIN_NAMESPACE_STD


356 
	`Ârötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

357 c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

362 
	`¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

364 
	$•rötf
 (*
__ª°ri˘
 
__s
,

365 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROWNL
;

371 
	`vÂrötf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

372 
_G_va_li°
 
__¨g
);

377 
	`v¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
);

379 
	$v•rötf
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

380 
_G_va_li°
 
__¨g
Ë
__THROWNL
;

381 
__END_NAMESPACE_STD


383 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


384 
__BEGIN_NAMESPACE_C99


386 
	$¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

387 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

388 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

390 
	$v¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

391 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

392 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

393 
__END_NAMESPACE_C99


396 #ifde‡
__USE_GNU


399 
	$va•rötf
 (**
__ª°ri˘
 
__±r
, c⁄° *__ª°ri˘ 
__f
,

400 
_G_va_li°
 
__¨g
)

401 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 0))Ë
__wur
;

402 
	$__a•rötf
 (**
__ª°ri˘
 
__±r
,

403 c⁄° *
__ª°ri˘
 
__fmt
, ...)

404 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

405 
	$a•rötf
 (**
__ª°ri˘
 
__±r
,

406 c⁄° *
__ª°ri˘
 
__fmt
, ...)

407 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

410 #ifde‡
__USE_XOPEN2K8


412 
	$vd¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
,

413 
_G_va_li°
 
__¨g
)

414 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

415 
	$d¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
, ...)

416 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

420 
__BEGIN_NAMESPACE_STD


425 
	$fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

426 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

431 
	$sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

433 
	$ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

434 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

436 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

437 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

438 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

439 #ifde‡
__REDIRECT


443 
	`__REDIRECT
 (
fsˇnf
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

444 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

445 
__isoc99_fsˇnf
Ë
__wur
;

446 
	`__REDIRECT
 (
sˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

447 
__isoc99_sˇnf
Ë
__wur
;

448 
	`__REDIRECT_NTH
 (
ssˇnf
, (c⁄° *
__ª°ri˘
 
__s
,

449 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

450 
__isoc99_ssˇnf
);

452 
	$__isoc99_fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

453 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

454 
	$__isoc99_sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

455 
	$__isoc99_ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

456 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

457 
	#fsˇnf
 
__isoc99_fsˇnf


	)

458 
	#sˇnf
 
__isoc99_sˇnf


	)

459 
	#ssˇnf
 
__isoc99_ssˇnf


	)

463 
__END_NAMESPACE_STD


465 #ifdef 
__USE_ISOC99


466 
__BEGIN_NAMESPACE_C99


471 
	$vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

472 
_G_va_li°
 
__¨g
)

473 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

479 
	$vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

480 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

483 
	$vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

484 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

485 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

487 #i‡!
deföed
 
__USE_GNU
 \

488 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

489 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

490 #ifde‡
__REDIRECT


494 
	`__REDIRECT
 (
vfsˇnf
,

495 (
FILE
 *
__ª°ri˘
 
__s
,

496 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
),

497 
__isoc99_vfsˇnf
)

498 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

499 
	`__REDIRECT
 (
vsˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
,

500 
_G_va_li°
 
__¨g
), 
__isoc99_vsˇnf
)

501 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

502 
	`__REDIRECT_NTH
 (
vssˇnf
,

503 (c⁄° *
__ª°ri˘
 
__s
,

504 c⁄° *
__ª°ri˘
 
__f‹m©
,

505 
_G_va_li°
 
__¨g
), 
__isoc99_vssˇnf
)

506 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

508 
	$__isoc99_vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
,

509 c⁄° *
__ª°ri˘
 
__f‹m©
,

510 
_G_va_li°
 
__¨g
Ë
__wur
;

511 
	$__isoc99_vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
,

512 
_G_va_li°
 
__¨g
Ë
__wur
;

513 
	$__isoc99_vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

514 c⁄° *
__ª°ri˘
 
__f‹m©
,

515 
_G_va_li°
 
__¨g
Ë
__THROW
;

516 
	#vfsˇnf
 
__isoc99_vfsˇnf


	)

517 
	#vsˇnf
 
__isoc99_vsˇnf


	)

518 
	#vssˇnf
 
__isoc99_vssˇnf


	)

522 
__END_NAMESPACE_C99


526 
__BEGIN_NAMESPACE_STD


531 
	`fgëc
 (
FILE
 *
__°ªam
);

532 
	`gëc
 (
FILE
 *
__°ªam
);

538 
	`gëch¨
 ();

539 
__END_NAMESPACE_STD


543 
	#gëc
(
_Â
Ë
	`_IO_gëc
 (_Â)

	)

545 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


550 
	`gëc_u∆ocked
 (
FILE
 *
__°ªam
);

551 
	`gëch¨_u∆ocked
 ();

554 #ifde‡
__USE_MISC


561 
	`fgëc_u∆ocked
 (
FILE
 *
__°ªam
);

565 
__BEGIN_NAMESPACE_STD


573 
	`Âutc
 (
__c
, 
FILE
 *
__°ªam
);

574 
	`putc
 (
__c
, 
FILE
 *
__°ªam
);

580 
	`putch¨
 (
__c
);

581 
__END_NAMESPACE_STD


585 
	#putc
(
_ch
, 
_Â
Ë
	`_IO_putc
 (_ch, _Â)

	)

587 #ifde‡
__USE_MISC


594 
	`Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

597 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


602 
	`putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

603 
	`putch¨_u∆ocked
 (
__c
);

607 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 \

608 || (
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

610 
	`gëw
 (
FILE
 *
__°ªam
);

613 
	`putw
 (
__w
, 
FILE
 *
__°ªam
);

617 
__BEGIN_NAMESPACE_STD


622 *
	$fgës
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

623 
__wur
;

625 #i‡!
deföed
 
__USE_ISOC11
 \

626 || (
deföed
 
__˝lu•lus
 && __cplusplus <= 201103L)

638 *
	$gës
 (*
__s
Ë
__wur
 
__©åibuã_dïªˇãd__
;

640 
__END_NAMESPACE_STD


642 #ifde‡
__USE_GNU


649 *
	$fgës_u∆ocked
 (*
__ª°ri˘
 
__s
, 
__n
,

650 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

654 #ifdef 
__USE_XOPEN2K8


665 
_IO_ssize_t
 
	$__gëdñim
 (**
__ª°ri˘
 
__löïå
,

666 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

667 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

668 
_IO_ssize_t
 
	$gëdñim
 (**
__ª°ri˘
 
__löïå
,

669 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

670 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

678 
_IO_ssize_t
 
	$gëlöe
 (**
__ª°ri˘
 
__löïå
,

679 
size_t
 *
__ª°ri˘
 
__n
,

680 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

684 
__BEGIN_NAMESPACE_STD


689 
	`Âuts
 (c⁄° *
__ª°ri˘
 
__s
, 
FILE
 *__ª°ri˘ 
__°ªam
);

695 
	`puts
 (c⁄° *
__s
);

702 
	`ungëc
 (
__c
, 
FILE
 *
__°ªam
);

709 
size_t
 
	$‰ód
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

710 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

715 
size_t
 
	`fwrôe
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

716 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__s
);

717 
__END_NAMESPACE_STD


719 #ifde‡
__USE_GNU


726 
	`Âuts_u∆ocked
 (c⁄° *
__ª°ri˘
 
__s
,

727 
FILE
 *
__ª°ri˘
 
__°ªam
);

730 #ifde‡
__USE_MISC


737 
size_t
 
	$‰ód_u∆ocked
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

738 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

739 
size_t
 
	`fwrôe_u∆ocked
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

740 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
);

744 
__BEGIN_NAMESPACE_STD


749 
	`f£ek
 (
FILE
 *
__°ªam
, 
__off
, 
__whí˚
);

754 
	$·ñl
 (
FILE
 *
__°ªam
Ë
__wur
;

759 
	`ªwöd
 (
FILE
 *
__°ªam
);

760 
__END_NAMESPACE_STD


767 #i‡
deföed
 
__USE_LARGEFILE
 || deföed 
__USE_XOPEN2K


768 #i‚de‡
__USE_FILE_OFFSET64


773 
	`f£eko
 (
FILE
 *
__°ªam
, 
__off_t
 
__off
, 
__whí˚
);

778 
__off_t
 
	$·ñlo
 (
FILE
 *
__°ªam
Ë
__wur
;

780 #ifde‡
__REDIRECT


781 
	`__REDIRECT
 (
f£eko
,

782 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
),

783 
f£eko64
);

784 
__off64_t
 
	`__REDIRECT
 (
·ñlo
, (
FILE
 *
__°ªam
), 
·ñlo64
);

786 
	#f£eko
 
f£eko64


	)

787 
	#·ñlo
 
·ñlo64


	)

792 
__BEGIN_NAMESPACE_STD


793 #i‚de‡
__USE_FILE_OFFSET64


798 
	`fgëpos
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos_t
 *__ª°ri˘ 
__pos
);

803 
	`f£ços
 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
);

805 #ifde‡
__REDIRECT


806 
	`__REDIRECT
 (
fgëpos
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

807 
Âos_t
 *
__ª°ri˘
 
__pos
), 
fgëpos64
);

808 
	`__REDIRECT
 (
f£ços
,

809 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
), 
f£ços64
);

811 
	#fgëpos
 
fgëpos64


	)

812 
	#f£ços
 
f£ços64


	)

815 
__END_NAMESPACE_STD


817 #ifde‡
__USE_LARGEFILE64


818 
	`f£eko64
 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
);

819 
__off64_t
 
	$·ñlo64
 (
FILE
 *
__°ªam
Ë
__wur
;

820 
	`fgëpos64
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos64_t
 *__ª°ri˘ 
__pos
);

821 
	`f£ços64
 (
FILE
 *
__°ªam
, c⁄° 
Âos64_t
 *
__pos
);

824 
__BEGIN_NAMESPACE_STD


826 
	$˛óªº
 (
FILE
 *
__°ªam
Ë
__THROW
;

828 
	$„of
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

830 
	$„º‹
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

831 
__END_NAMESPACE_STD


833 #ifde‡
__USE_MISC


835 
	$˛óªº_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
;

836 
	$„of_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

837 
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

841 
__BEGIN_NAMESPACE_STD


846 
	`≥º‹
 (c⁄° *
__s
);

847 
__END_NAMESPACE_STD


853 
	~<bôs/sys_îæi°.h
>

856 #ifdef 
__USE_POSIX


858 
	$fûío
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

861 #ifde‡
__USE_MISC


863 
	$fûío_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

867 #i‡(
deföed
 
__USE_POSIX2
 || deföed 
__USE_SVID
 || deföed 
__USE_BSD
 || \

868 
deföed
 
__USE_MISC
)

873 
FILE
 *
	$p›í
 (c⁄° *
__comm™d
, c⁄° *
__modes
Ë
__wur
;

879 
	`p˛o£
 (
FILE
 *
__°ªam
);

883 #ifdef 
__USE_POSIX


885 *
	$˘îmid
 (*
__s
Ë
__THROW
;

889 #ifde‡
__USE_XOPEN


891 *
	`cu£rid
 (*
__s
);

895 #ifdef 
__USE_GNU


896 
ob°ack
;

899 
	$ob°ack_¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

900 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

901 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

902 
	$ob°ack_v¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

903 c⁄° *
__ª°ri˘
 
__f‹m©
,

904 
_G_va_li°
 
__¨gs
)

905 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

909 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


913 
	$Êockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

917 
	$·rylockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

920 
	$fu∆ockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

923 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


927 
	#__√ed_gë›t


	)

928 
	~<gë›t.h
>

933 #ifde‡
__USE_EXTERN_INLINES


934 
	~<bôs/°dio.h
>

936 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


937 
	~<bôs/°dio2.h
>

939 #ifde‡
__LDBL_COMPAT


940 
	~<bôs/°dio-ldbl.h
>

943 
__END_DECLS


	@/usr/include/stdlib.h

22 #i‚def 
_STDLIB_H


24 
	~<„©uªs.h
>

27 
	#__√ed_size_t


	)

28 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


29 
	#__√ed_wch¨_t


	)

30 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

34 
	g__BEGIN_DECLS


36 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


37 
	#_STDLIB_H
 1

	)

39 #i‡(
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
Ë&& !deföed 
_SYS_WAIT_H


41 
	~<bôs/waôÊags.h
>

42 
	~<bôs/waô°©us.h
>

44 #ifde‡
__USE_BSD


49 #i‡
deföed
 
__GNUC__
 && !deföed 
__˝lu•lus


50 
	#__WAIT_INT
(
°©us
) \

51 (
	`__exãnsi⁄__
 (((uni⁄ { 
	`__ty≥of
(
°©us
Ë
__ö
; 
__i
; }) \

52 { .
__ö
 = (
°©us
Ë}).
__i
))

	)

54 
	#__WAIT_INT
(
°©us
Ë(*(*Ë&(°©us))

	)

62 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2 || deföed 
__˝lu•lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
waô
 *
	m__u±r
;

70 *
	m__ùå
;

71 } 
	t__WAIT_STATUS
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
°©us
Ë(°©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (°©us))

	)

85 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
 (
	`__WAIT_INT
 (°©us))

	)

86 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
 (
	`__WAIT_INT
 (°©us))

	)

87 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
 (
	`__WAIT_INT
 (°©us))

	)

88 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (°©us))

	)

89 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (°©us))

	)

90 #ifde‡
__WIFCONTINUED


91 
	#WIFCONTINUED
(
°©us
Ë
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (°©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquŸ
;

100 
	mªm
;

101 } 
	tdiv_t
;

104 #i‚de‡
__ldiv_t_deföed


107 
	mquŸ
;

108 
	mªm
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_deföed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__Œdiv_t_deföed


115 
__BEGIN_NAMESPACE_C99


117 
__exãnsi⁄__
 struct

119 
	mquŸ
;

120 
	mªm
;

121 } 
	tŒdiv_t
;

122 
	#__Œdiv_t_deföed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__˘y≥_gë_mb_cur_max
 ())

	)

139 
size_t
 
	$__˘y≥_gë_mb_cur_max
 (Ë
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (c⁄° *
__≈å
)

145 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

147 
	$©oi
 (c⁄° *
__≈å
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

150 
	$©ﬁ
 (c⁄° *
__≈å
)

151 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

152 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_ISOC99
 || deföed 
__USE_MISC


155 
__BEGIN_NAMESPACE_C99


157 
__exãnsi⁄__
 
	$©ﬁl
 (c⁄° *
__≈å
)

158 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$°πod
 (c⁄° *
__ª°ri˘
 
__≈å
,

165 **
__ª°ri˘
 
__íd±r
)

166 
__THROW
 
	`__n⁄nuŒ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$°πof
 (c⁄° *
__ª°ri˘
 
__≈å
,

173 **
__ª°ri˘
 
__íd±r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

175 
	$°πﬁd
 (c⁄° *
__ª°ri˘
 
__≈å
,

176 **
__ª°ri˘
 
__íd±r
)

177 
__THROW
 
	`__n⁄nuŒ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$°πﬁ
 (c⁄° *
__ª°ri˘
 
__≈å
,

184 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

185 
__THROW
 
	`__n⁄nuŒ
 ((1));

187 
	$°πoul
 (c⁄° *
__ª°ri˘
 
__≈å
,

188 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

189 
__THROW
 
	`__n⁄nuŒ
 ((1));

190 
__END_NAMESPACE_STD


192 #ifde‡
__USE_BSD


194 
__exãnsi⁄__


195 
	$°πoq
 (c⁄° *
__ª°ri˘
 
__≈å
,

196 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

197 
__THROW
 
	`__n⁄nuŒ
 ((1));

199 
__exãnsi⁄__


200 
	$°πouq
 (c⁄° *
__ª°ri˘
 
__≈å
,

201 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

202 
__THROW
 
	`__n⁄nuŒ
 ((1));

205 #i‡
deföed
 
__USE_ISOC99
 || deföed 
__USE_MISC


206 
__BEGIN_NAMESPACE_C99


208 
__exãnsi⁄__


209 
	$°πﬁl
 (c⁄° *
__ª°ri˘
 
__≈å
,

210 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

211 
__THROW
 
	`__n⁄nuŒ
 ((1));

213 
__exãnsi⁄__


214 
	$°πouŒ
 (c⁄° *
__ª°ri˘
 
__≈å
,

215 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

216 
__THROW
 
	`__n⁄nuŒ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifde‡
__USE_GNU


235 
	~<xloˇÀ.h
>

239 
	$°πﬁ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

240 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

241 
__loˇÀ_t
 
__loc
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

243 
	$°πoul_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

244 **
__ª°ri˘
 
__íd±r
,

245 
__ba£
, 
__loˇÀ_t
 
__loc
)

246 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

248 
__exãnsi⁄__


249 
	$°πﬁl_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

250 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

251 
__loˇÀ_t
 
__loc
)

252 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

254 
__exãnsi⁄__


255 
	$°πouŒ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

256 **
__ª°ri˘
 
__íd±r
,

257 
__ba£
, 
__loˇÀ_t
 
__loc
)

258 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

260 
	$°πod_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

261 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

262 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

264 
	$°πof_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

265 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

266 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

268 
	$°πﬁd_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

269 **
__ª°ri˘
 
__íd±r
,

270 
__loˇÀ_t
 
__loc
)

271 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

275 #ifde‡
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__exã∫_ölöe
 

278 
	`__NTH
 (
	$©oi
 (c⁄° *
__≈å
))

280  (Ë
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

281 
	}
}

282 
__exã∫_ölöe
 

283 
__NTH
 (
	$©ﬁ
 (c⁄° *
__≈å
))

285  
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__exãnsi⁄__
 
__exã∫_ölöe
 

292 
__NTH
 (
	$©ﬁl
 (c⁄° *
__≈å
))

294  
	`°πﬁl
 (
__≈å
, (**Ë
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
Ë
__THROW
 
__wur
;

308 
	$a64l
 (c⁄° *
__s
)

309 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

313 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_BSD


314 
	~<sys/ty≥s.h
>

321 
	$øndom
 (Ë
__THROW
;

324 
	$§™dom
 (
__£ed
Ë
__THROW
;

330 *
	$öô°©e
 (
__£ed
, *
__°©ebuf
,

331 
size_t
 
__°©ñí
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

335 *
	$£t°©e
 (*
__°©ebuf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

338 #ifde‡
__USE_MISC


343 
	søndom_d©a


345 
öt32_t
 *
Âå
;

346 
öt32_t
 *
Ωå
;

347 
öt32_t
 *
°©e
;

348 
ønd_ty≥
;

349 
ønd_deg
;

350 
ønd_£p
;

351 
öt32_t
 *
íd_±r
;

354 
	$øndom_r
 (
øndom_d©a
 *
__ª°ri˘
 
__buf
,

355 
öt32_t
 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

357 
	$§™dom_r
 (
__£ed
, 
øndom_d©a
 *
__buf
)

358 
__THROW
 
	`__n⁄nuŒ
 ((2));

360 
	$öô°©e_r
 (
__£ed
, *
__ª°ri˘
 
__°©ebuf
,

361 
size_t
 
__°©ñí
,

362 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

363 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

365 
	$£t°©e_r
 (*
__ª°ri˘
 
__°©ebuf
,

366 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

367 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$ønd
 (Ë
__THROW
;

376 
	$§™d
 (
__£ed
Ë
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifde‡
__USE_POSIX


381 
	$ønd_r
 (*
__£ed
Ë
__THROW
;

385 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


389 
	$dønd48
 (Ë
__THROW
;

390 
	$î™d48
 (
__xsubi
[3]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

393 
	$Ã™d48
 (Ë
__THROW
;

394 
	$ƒ™d48
 (
__xsubi
[3])

395 
__THROW
 
	`__n⁄nuŒ
 ((1));

398 
	$mønd48
 (Ë
__THROW
;

399 
	$jønd48
 (
__xsubi
[3])

400 
__THROW
 
	`__n⁄nuŒ
 ((1));

403 
	$§™d48
 (
__£edvÆ
Ë
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__n⁄nuŒ
 ((1));

406 
	$lc⁄g48
 (
__∑øm
[7]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

408 #ifde‡
__USE_MISC


412 
	sdønd48_d©a


414 
__x
[3];

415 
__ﬁd_x
[3];

416 
__c
;

417 
__öô
;

418 
__exãnsi⁄__
 
__a
;

423 
	$dønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

424 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

425 
	$î™d48_r
 (
__xsubi
[3],

426 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

427 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

430 
	$Ã™d48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

431 *
__ª°ri˘
 
__ªsu…
)

432 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

433 
	$ƒ™d48_r
 (
__xsubi
[3],

434 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

435 *
__ª°ri˘
 
__ªsu…
)

436 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

439 
	$mønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

440 *
__ª°ri˘
 
__ªsu…
)

441 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

442 
	$jønd48_r
 (
__xsubi
[3],

443 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

444 *
__ª°ri˘
 
__ªsu…
)

445 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

448 
	$§™d48_r
 (
__£edvÆ
, 
dønd48_d©a
 *
__buf„r
)

449 
__THROW
 
	`__n⁄nuŒ
 ((2));

451 
	$£ed48_r
 (
__£ed16v
[3],

452 
dønd48_d©a
 *
__buf„r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

454 
	$lc⁄g48_r
 (
__∑øm
[7],

455 
dønd48_d©a
 *
__buf„r
)

456 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

462 #i‚de‡
__mÆloc_™d_ˇŒoc_deföed


463 
	#__mÆloc_™d_ˇŒoc_deföed


	)

464 
__BEGIN_NAMESPACE_STD


466 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

468 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

469 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

470 
__END_NAMESPACE_STD


473 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


474 
__BEGIN_NAMESPACE_STD


480 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

481 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

483 
	$‰ì
 (*
__±r
Ë
__THROW
;

484 
__END_NAMESPACE_STD


486 #ifdef 
__USE_MISC


488 
	$c‰ì
 (*
__±r
Ë
__THROW
;

491 #i‡
deföed
 
__USE_GNU
 || deföed 
__USE_BSD
 || deföed 
__USE_MISC


492 
	~<Æloˇ.h
>

495 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

496 || 
deföed
 
__USE_BSD


498 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

501 #ifde‡
__USE_XOPEN2K


503 
	$posix_memÆign
 (**
__mem±r
, 
size_t
 
__Æignmít
, size_à
__size
)

504 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

507 #ifde‡
__USE_ISOC11


509 *
	$Æig√d_Æloc
 (
size_t
 
__Æignmít
, size_à
__size
)

510 
__THROW
 
__©åibuã_mÆloc__
 
	`__©åibuã_Æloc_size__
 ((2)Ë
__wur
;

513 
__BEGIN_NAMESPACE_STD


515 
	$ab‹t
 (Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

519 
	`©exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

521 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


523 #ifde‡
__˝lu•lus


524 "C++" 
	`©_quick_exô
 ((*
__func
) ())

525 
__THROW
 
	`__asm
 ("©_quick_exô"Ë
	`__n⁄nuŒ
 ((1));

527 
	`©_quick_exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

530 
__END_NAMESPACE_STD


532 #ifdef 
__USE_MISC


535 
	`⁄_exô
 ((*
__func
Ë(
__°©us
, *
__¨g
), *__arg)

536 
__THROW
 
	`__n⁄nuŒ
 ((1));

539 
__BEGIN_NAMESPACE_STD


543 
	$exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

545 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


549 
	$quick_exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

551 
__END_NAMESPACE_STD


553 #ifde‡
__USE_ISOC99


554 
__BEGIN_NAMESPACE_C99


557 
	$_Exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

558 
__END_NAMESPACE_C99


562 
__BEGIN_NAMESPACE_STD


564 *
	$gëív
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

565 
__END_NAMESPACE_STD


567 #ifde‡
__USE_GNU


570 *
	$£cuª_gëív
 (c⁄° *
__«me
)

571 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

574 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


578 
	$puãnv
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

581 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


584 
	$£ãnv
 (c⁄° *
__«me
, c⁄° *
__vÆue
, 
__ª∂a˚
)

585 
__THROW
 
	`__n⁄nuŒ
 ((2));

588 
	$un£ãnv
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

591 #ifdef 
__USE_MISC


595 
	$˛óªnv
 (Ë
__THROW
;

599 #i‡
deföed
 
__USE_MISC
 \

600 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
)

606 *
	$mkãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

609 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 \

610 || 
deföed
 
__USE_XOPEN2K8


619 #i‚de‡
__USE_FILE_OFFSET64


620 
	$mk°emp
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

622 #ifde‡
__REDIRECT


623 
	`__REDIRECT
 (
mk°emp
, (*
__ãm∂©e
), 
mk°emp64
)

624 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

626 
	#mk°emp
 
mk°emp64


	)

629 #ifde‡
__USE_LARGEFILE64


630 
	$mk°emp64
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

634 #ifde‡
__USE_MISC


641 #i‚de‡
__USE_FILE_OFFSET64


642 
	$mk°emps
 (*
__ãm∂©e
, 
__suffixÀn
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

644 #ifde‡
__REDIRECT


645 
	`__REDIRECT
 (
mk°emps
, (*
__ãm∂©e
, 
__suffixÀn
),

646 
mk°emps64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

648 
	#mk°emps
 
mk°emps64


	)

651 #ifde‡
__USE_LARGEFILE64


652 
	$mk°emps64
 (*
__ãm∂©e
, 
__suffixÀn
)

653 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

657 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K8


663 *
	$mkdãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

666 #ifde‡
__USE_GNU


673 #i‚de‡
__USE_FILE_OFFSET64


674 
	$mko°emp
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

676 #ifde‡
__REDIRECT


677 
	`__REDIRECT
 (
mko°emp
, (*
__ãm∂©e
, 
__Êags
), 
mko°emp64
)

678 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

680 
	#mko°emp
 
mko°emp64


	)

683 #ifde‡
__USE_LARGEFILE64


684 
	$mko°emp64
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

693 #i‚de‡
__USE_FILE_OFFSET64


694 
	$mko°emps
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

695 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

697 #ifde‡
__REDIRECT


698 
	`__REDIRECT
 (
mko°emps
, (*
__ãm∂©e
, 
__suffixÀn
,

699 
__Êags
), 
mko°emps64
)

700 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

702 
	#mko°emps
 
mko°emps64


	)

705 #ifde‡
__USE_LARGEFILE64


706 
	$mko°emps64
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

707 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

712 
__BEGIN_NAMESPACE_STD


717 
	$sy°em
 (c⁄° *
__comm™d
Ë
__wur
;

718 
__END_NAMESPACE_STD


721 #ifdef 
__USE_GNU


724 *
	$ˇn⁄iˇlize_fûe_«me
 (c⁄° *
__«me
)

725 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

728 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


734 *
	$ªÆ∑th
 (c⁄° *
__ª°ri˘
 
__«me
,

735 *
__ª°ri˘
 
__ªsﬁved
Ë
__THROW
 
__wur
;

740 #i‚de‡
__COMPAR_FN_T


741 
	#__COMPAR_FN_T


	)

742 (*
	t__com∑r_‚_t
) (const *, const *);

744 #ifdef 
__USE_GNU


745 
__com∑r_‚_t
 
	tcom∑ris⁄_‚_t
;

748 #ifde‡
__USE_GNU


749 (*
	t__com∑r_d_‚_t
) (const *, const *, *);

752 
__BEGIN_NAMESPACE_STD


755 *
	$b£¨ch
 (c⁄° *
__key
, c⁄° *
__ba£
,

756 
size_t
 
__nmemb
, size_à
__size
, 
__com∑r_‚_t
 
__com∑r
)

757 
	`__n⁄nuŒ
 ((1, 2, 5)Ë
__wur
;

759 #ifde‡
__USE_EXTERN_INLINES


760 
	~<bôs/°dlib-b£¨ch.h
>

765 
	$qs‹t
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

766 
__com∑r_‚_t
 
__com∑r
Ë
	`__n⁄nuŒ
 ((1, 4));

767 #ifde‡
__USE_GNU


768 
	$qs‹t_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

769 
__com∑r_d_‚_t
 
__com∑r
, *
__¨g
)

770 
	`__n⁄nuŒ
 ((1, 4));

775 
	$abs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

776 
	$œbs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

777 
__END_NAMESPACE_STD


779 #ifde‡
__USE_ISOC99


780 
__exãnsi⁄__
 
	$Œabs
 (
__x
)

781 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

785 
__BEGIN_NAMESPACE_STD


789 
div_t
 
	$div
 (
__numî
, 
__díom
)

790 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

791 
ldiv_t
 
	$ldiv
 (
__numî
, 
__díom
)

792 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

793 
__END_NAMESPACE_STD


795 #ifde‡
__USE_ISOC99


796 
__BEGIN_NAMESPACE_C99


797 
__exãnsi⁄__
 
Œdiv_t
 
	$Œdiv
 (
__numî
,

798 
__díom
)

799 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

800 
__END_NAMESPACE_C99


804 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

805 || 
deföed
 
__USE_SVID


812 *
	$ecvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

813 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

818 *
	$fcvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

819 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

824 *
	$gcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

825 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

828 #ifde‡
__USE_MISC


830 *
	$qecvt
 (
__vÆue
, 
__ndigô
,

831 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

832 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

833 *
	$qfcvt
 (
__vÆue
, 
__ndigô
,

834 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

835 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

836 *
	$qgcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

837 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

842 
	$ecvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

843 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

844 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

845 
	$fcvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

846 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

847 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

849 
	$qecvt_r
 (
__vÆue
, 
__ndigô
,

850 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

851 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

852 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

853 
	$qfcvt_r
 (
__vÆue
, 
__ndigô
,

854 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

855 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

856 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

860 
__BEGIN_NAMESPACE_STD


863 
	$mbÀn
 (c⁄° *
__s
, 
size_t
 
__n
Ë
__THROW
;

866 
	$mbtowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

867 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

870 
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
Ë
__THROW
;

874 
size_t
 
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__pwcs
,

875 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

877 
size_t
 
	$wc°ombs
 (*
__ª°ri˘
 
__s
,

878 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__pwcs
, 
size_t
 
__n
)

879 
__THROW
;

880 
__END_NAMESPACE_STD


883 #ifde‡
__USE_SVID


888 
	$Ωm©ch
 (c⁄° *
__ª•⁄£
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

892 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


899 
	$gësub›t
 (**
__ª°ri˘
 
__›ti⁄p
,

900 *c⁄° *
__ª°ri˘
 
__tokís
,

901 **
__ª°ri˘
 
__vÆuï
)

902 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3)Ë
__wur
;

906 #ifde‡
__USE_XOPEN


908 
	$£tkey
 (c⁄° *
__key
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

914 #ifde‡
__USE_XOPEN2KXSI


916 
	$posix_›í±
 (
__oÊag
Ë
__wur
;

919 #ifde‡
__USE_XOPEN


924 
	$gø¡±
 (
__fd
Ë
__THROW
;

928 
	$u∆ock±
 (
__fd
Ë
__THROW
;

933 *
	$±¢ame
 (
__fd
Ë
__THROW
 
__wur
;

936 #ifde‡
__USE_GNU


940 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

941 
__THROW
 
	`__n⁄nuŒ
 ((2));

944 
	`gë±
 ();

947 #ifde‡
__USE_BSD


951 
	$gëlﬂdavg
 (
__lﬂdavg
[], 
__√Àm
)

952 
__THROW
 
	`__n⁄nuŒ
 ((1));

955 
	~<bôs/°dlib-Êﬂt.h
>

958 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


959 
	~<bôs/°dlib.h
>

961 #ifde‡
__LDBL_COMPAT


962 
	~<bôs/°dlib-ldbl.h
>

966 #unde‡
__√ed_mÆloc_™d_ˇŒoc


968 
__END_DECLS


	@/usr/include/string.h

22 #i‚def 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


30 
	#__√ed_size_t


	)

31 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

39 #i‡
deföed
 
__˝lu•lus
 && (__˝lu•lu†>199711L || 
__GNUC_PREREQ
 (4, 4))

40 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

44 
__BEGIN_NAMESPACE_STD


46 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

47 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

50 *
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

51 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

52 
__END_NAMESPACE_STD


57 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN


58 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

59 
__c
, 
size_t
 
__n
)

60 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

64 
__BEGIN_NAMESPACE_STD


66 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

69 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

70 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

73 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


76 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

77 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

78 c⁄° *
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

79 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

81 #ifde‡
__OPTIMIZE__


82 
__exã∫_Æways_ölöe
 *

83 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


85  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

88 
__exã∫_Æways_ölöe
 const *

89 
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


91  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

94 
	}
}

96 *
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

97 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

99 
__END_NAMESPACE_STD


101 #ifde‡
__USE_GNU


104 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


105 "C++" *
	$øwmemchr
 (*
__s
, 
__c
)

106 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

107 "C++" c⁄° *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

108 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

110 *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

111 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

115 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


116 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

117 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

118 "C++" c⁄° *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

119 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

121 *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

122 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

127 
__BEGIN_NAMESPACE_STD


129 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

130 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

132 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

133 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

134 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

137 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

138 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

140 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

141 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

144 
	$°rcmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

145 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

147 
	$°∫cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

151 
	$°rcﬁl
 (c⁄° *
__s1
, c⁄° *
__s2
)

152 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

154 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

155 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

156 
__THROW
 
	`__n⁄nuŒ
 ((2));

157 
__END_NAMESPACE_STD


159 #ifde‡
__USE_XOPEN2K8


163 
	~<xloˇÀ.h
>

166 
	$°rcﬁl_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
__loˇÀ_t
 
__l
)

167 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

169 
size_t
 
	$°rx‰m_l
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

170 
__loˇÀ_t
 
__l
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

173 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 \

174 || 
deföed
 
__USE_XOPEN2K8


176 *
	$°rdup
 (c⁄° *
__s
)

177 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

183 #i‡
deföed
 
__USE_XOPEN2K8


184 *
	$°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

185 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

188 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


190 
	#°rdu∑
(
s
) \

191 (
__exãnsi⁄__
 \

193 c⁄° *
__ﬁd
 = (
s
); \

194 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

195 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

196 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

197 
	}
}))

	)

200 
	#°∫du∑
(
s
, 
n
) \

201 (
__exãnsi⁄__
 \

203 c⁄° *
__ﬁd
 = (
s
); \

204 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

205 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

206 
__√w
[
__Àn
] = '\0'; \

207 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

208 }))

	)

211 
	g__BEGIN_NAMESPACE_STD


213 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


216 *
°rchr
 (*
__s
, 
__c
)

217 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

218 c⁄° *
°rchr
 (c⁄° *
__s
, 
__c
)

219 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

221 #ifde‡
__OPTIMIZE__


222 
__exã∫_Æways_ölöe
 *

223 
°rchr
 (*
__s
, 
__c
Ë
	g__THROW


225  
__buûtö_°rchr
 (
__s
, 
__c
);

228 
__exã∫_Æways_ölöe
 const *

229 
°rchr
 (c⁄° *
__s
, 
__c
Ë
	g__THROW


231  
__buûtö_°rchr
 (
__s
, 
__c
);

236 *
	$°rchr
 (c⁄° *
__s
, 
__c
)

237 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

240 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


243 *
	`°ºchr
 (*
__s
, 
__c
)

244 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

245 c⁄° *
	`°ºchr
 (c⁄° *
__s
, 
__c
)

246 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

248 #ifde‡
__OPTIMIZE__


249 
__exã∫_Æways_ölöe
 *

250 
	`°ºchr
 (*
__s
, 
__c
Ë
__THROW


252  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

255 
__exã∫_Æways_ölöe
 const *

256 
	`°ºchr
 (c⁄° *
__s
, 
__c
Ë
__THROW


258  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

261 
	}
}

263 *
	$°ºchr
 (c⁄° *
__s
, 
__c
)

264 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

266 
__END_NAMESPACE_STD


268 #ifde‡
__USE_GNU


271 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


272 "C++" *
	$°rch∫ul
 (*
__s
, 
__c
)

273 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

274 "C++" c⁄° *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

275 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

277 *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

278 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

282 
__BEGIN_NAMESPACE_STD


285 
size_t
 
	$°rc•n
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

286 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

289 
size_t
 
	$°r•n
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

290 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

292 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


295 *
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
)

296 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

297 c⁄° *
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

298 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

300 #ifde‡
__OPTIMIZE__


301 
__exã∫_Æways_ölöe
 *

302 
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
Ë
__THROW


304  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

307 
__exã∫_Æways_ölöe
 const *

308 
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
Ë
__THROW


310  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

313 
	}
}

315 *
	$°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

316 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

319 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


322 *
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

323 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

324 c⁄° *
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

325 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

327 #ifde‡
__OPTIMIZE__


328 
__exã∫_Æways_ölöe
 *

329 
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


331  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

334 
__exã∫_Æways_ölöe
 const *

335 
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


337  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

340 
	}
}

342 *
	$°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

343 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

348 *
	$°πok
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
)

349 
__THROW
 
	`__n⁄nuŒ
 ((2));

350 
__END_NAMESPACE_STD


354 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

355 c⁄° *
__ª°ri˘
 
__dñim
,

356 **
__ª°ri˘
 
__ßve_±r
)

357 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

358 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


359 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
,

360 **
__ª°ri˘
 
__ßve_±r
)

361 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

364 #ifde‡
__USE_GNU


366 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


367 "C++" *
	$°rˇ£°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

368 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

369 "C++" c⁄° *
	$°rˇ£°r
 (c⁄° *
__hay°ack
,

370 c⁄° *
__√edÀ
)

371 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

373 *
	$°rˇ£°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

374 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

378 #ifde‡
__USE_GNU


382 *
	$memmem
 (c⁄° *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

383 c⁄° *
__√edÀ
, 
size_t
 
__√edÀÀn
)

384 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 3));

388 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

389 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

390 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

391 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

392 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

393 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

397 
__BEGIN_NAMESPACE_STD


399 
size_t
 
	$°æí
 (c⁄° *
__s
)

400 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

401 
__END_NAMESPACE_STD


403 #ifdef 
__USE_XOPEN2K8


406 
size_t
 
	$°∫Àn
 (c⁄° *
__°rög
, 
size_t
 
__maxÀn
)

407 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

411 
__BEGIN_NAMESPACE_STD


413 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

414 
__END_NAMESPACE_STD


415 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_MISC


423 #i‡
deföed
 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


426 #ifde‡
__REDIRECT_NTH


427 
	`__REDIRECT_NTH
 (
°ªº‹_r
,

428 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
),

429 
__xpg_°ªº‹_r
Ë
	`__n⁄nuŒ
 ((2));

431 
	$__xpg_°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

432 
__THROW
 
	`__n⁄nuŒ
 ((2));

433 
	#°ªº‹_r
 
__xpg_°ªº‹_r


	)

438 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

439 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

443 #ifde‡
__USE_XOPEN2K8


445 *
	$°ªº‹_l
 (
__î∫um
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

451 
	$__bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

453 #ifde‡
__USE_BSD


455 
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__n
)

456 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

459 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

462 
	$bcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

463 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

466 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


469 *
	`ödex
 (*
__s
, 
__c
)

470 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

471 c⁄° *
	`ödex
 (c⁄° *
__s
, 
__c
)

472 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

474 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


475 
__exã∫_Æways_ölöe
 *

476 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


478  
	`__buûtö_ödex
 (
__s
, 
__c
);

481 
__exã∫_Æways_ölöe
 const *

482 
	`ödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


484  
	`__buûtö_ödex
 (
__s
, 
__c
);

487 
	}
}

489 *
	$ödex
 (c⁄° *
__s
, 
__c
)

490 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

494 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


497 *
	`rödex
 (*
__s
, 
__c
)

498 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

499 c⁄° *
	`rödex
 (c⁄° *
__s
, 
__c
)

500 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

502 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


503 
__exã∫_Æways_ölöe
 *

504 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


506  
	`__buûtö_rödex
 (
__s
, 
__c
);

509 
__exã∫_Æways_ölöe
 const *

510 
	`rödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


512  
	`__buûtö_rödex
 (
__s
, 
__c
);

515 
	}
}

517 *
	$rödex
 (c⁄° *
__s
, 
__c
)

518 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

523 
	$ffs
 (
__i
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

527 #ifdef 
__USE_GNU


528 
	$ff¶
 (
__l
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

529 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

530 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

534 
	$°rˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

535 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

538 
	$°∫ˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

539 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

542 #ifdef 
__USE_GNU


545 
	$°rˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

546 
__loˇÀ_t
 
__loc
)

547 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

549 
	$°∫ˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

550 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
)

551 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

554 #ifdef 
__USE_BSD


557 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

558 c⁄° *
__ª°ri˘
 
__dñim
)

559 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

562 #ifdef 
__USE_XOPEN2K8


564 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

567 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

568 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

569 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

570 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

574 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

575 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

576 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

577 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

578 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

579 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

582 #ifdef 
__USE_GNU


584 
	$°rvîscmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

585 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

588 *
	$°r‰y
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

591 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

593 #i‚de‡
ba£«me


598 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


599 "C++" *
	$ba£«me
 (*
__fûíame
)

600 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

601 "C++" c⁄° *
	$ba£«me
 (c⁄° *
__fûíame
)

602 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

604 *
	$ba£«me
 (c⁄° *
__fûíame
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

610 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

611 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__OPTIMIZE_SIZE__
 \

612 && !
deföed
 
__NO_INLINE__
 && !deföed 
__˝lu•lus


632 
	~<bôs/°rög.h
>

635 
	~<bôs/°rög2.h
>

638 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


640 
	~<bôs/°rög3.h
>

644 
__END_DECLS


	@/usr/include/time.h

22 #i‚def 
_TIME_H


24 #i‡(! 
deföed
 
__√ed_time_t
 && !deföed 
__√ed_˛ock_t
 && \

25 ! 
deföed
 
	g__√ed_time•ec
)

26 
	#_TIME_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__√ed_size_t


	)

36 
	#__√ed_NULL


	)

37 
	~<°ddef.h
>

41 
	~<bôs/time.h
>

44 #i‡!
deföed
 
__STRICT_ANSI__
 && !deföed 
__USE_XOPEN2K


45 #i‚de‡
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #i‡!
deföed
 
__˛ock_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_˛ock_t
)

53 
	#__˛ock_t_deföed
 1

	)

55 
	~<bôs/ty≥s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__˛ock_t
 
	t˛ock_t
;

60 
	g__END_NAMESPACE_STD


61 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


62 
	$__USING_NAMESPACE_STD
(
˛ock_t
)

66 #unde‡
__√ed_˛ock_t


68 #i‡!
deföed
 
__time_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_time_t
)

69 
	#__time_t_deföed
 1

	)

71 
	~<bôs/ty≥s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC
 || deföed 
__USE_SVID


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #unde‡
__√ed_time_t


84 #i‡!
deföed
 
__˛ockid_t_deföed
 && \

85 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_˛ockid_t
)

86 
	#__˛ockid_t_deföed
 1

	)

88 
	~<bôs/ty≥s.h
>

91 
__˛ockid_t
 
	t˛ockid_t
;

94 #unde‡
__˛ockid_time_t


96 #i‡!
deföed
 
__timî_t_deföed
 && \

97 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_timî_t
)

98 
	#__timî_t_deföed
 1

	)

100 
	~<bôs/ty≥s.h
>

103 
__timî_t
 
	ttimî_t
;

106 #unde‡
__√ed_timî_t


109 #i‡(!
deföed
 
__time•ec_deföed
 \

110 && ((
deföed
 
_TIME_H
 \

111 && (
deföed
 
__USE_POSIX199309
 || deföed 
__USE_MISC
 \

112 || 
deföed
 
__USE_ISOC11
)) \

113 || 
deföed
 
__√ed_time•ec
))

114 
	#__time•ec_deföed
 1

	)

116 
	~<bôs/ty≥s.h
>

120 
	stime•ec


122 
__time_t
 
tv_£c
;

123 
__sysˇŒ_¶⁄g_t
 
tv_n£c
;

127 #unde‡
__√ed_time•ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mö
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_m⁄
;

140 
tm_yór
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd°
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 c⁄° *
tm_z⁄e
;

149 
__tm_gmtoff
;

150 c⁄° *
__tm_z⁄e
;

153 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifde‡
__USE_POSIX199309


161 
	sôimî•ec


163 
time•ec
 
ô_öãrvÆ
;

164 
time•ec
 
ô_vÆue
;

168 
sigevít
;

172 #ifde‡
__USE_XOPEN2K


173 #i‚de‡
__pid_t_deföed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_deföed


	)

180 #ifde‡
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
˛ock_t
 
	$˛ock
 (Ë
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__timî
Ë
__THROW
;

195 
	$dif·ime
 (
time_t
 
__time1
,Åime_à
__time0
)

196 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

199 
time_t
 
	$mktime
 (
tm
 *
__ç
Ë
__THROW
;

205 
size_t
 
	$°r·ime
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

206 c⁄° *
__ª°ri˘
 
__f‹m©
,

207 c⁄° 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifde‡
__USE_XOPEN


213 *
	$°Ωtime
 (c⁄° *
__ª°ri˘
 
__s
,

214 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
)

215 
__THROW
;

218 #ifde‡
__USE_XOPEN2K8


221 
	~<xloˇÀ.h
>

223 
size_t
 
	$°r·ime_l
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

224 c⁄° *
__ª°ri˘
 
__f‹m©
,

225 c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

226 
__loˇÀ_t
 
__loc
Ë
__THROW
;

229 #ifde‡
__USE_GNU


230 *
	$°Ωtime_l
 (c⁄° *
__ª°ri˘
 
__s
,

231 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
,

232 
__loˇÀ_t
 
__loc
Ë
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

243 
tm
 *
	$loˇ…ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

244 
__END_NAMESPACE_STD


246 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


249 
tm
 *
	$gmtime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

250 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

254 
tm
 *
	$loˇ…ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

255 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$as˘ime
 (c⁄° 
tm
 *
__ç
Ë
__THROW
;

264 *
	$˘ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

265 
__END_NAMESPACE_STD


267 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


272 *
	$as˘ime_r
 (c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

273 *
__ª°ri˘
 
__buf
Ë
__THROW
;

276 *
	$˘ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

277 *
__ª°ri˘
 
__buf
Ë
__THROW
;

282 *
__tz«me
[2];

283 
__daylight
;

284 
__timez⁄e
;

287 #ifdef 
__USE_POSIX


289 *
tz«me
[2];

293 
	$tz£t
 (Ë
__THROW
;

296 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


297 
daylight
;

298 
timez⁄e
;

301 #ifde‡
__USE_SVID


304 
	$°ime
 (c⁄° 
time_t
 *
__whí
Ë
__THROW
;

310 
	#__i¶óp
(
yór
) \

311 ((
yór
Ë% 4 =0 && ((yórË% 100 !0 || (yórË% 400 =0))

	)

314 #ifde‡
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__ç
Ë
__THROW
;

322 
time_t
 
	$timñoˇl
 (
tm
 *
__ç
Ë
__THROW
;

325 
	$dysize
 (
__yór
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

329 #ifde‡
__USE_POSIX199309


334 
	`«no¶ìp
 (c⁄° 
time•ec
 *
__ªque°ed_time
,

335 
time•ec
 *
__ªmaöög
);

339 
	$˛ock_gëªs
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ªs
Ë
__THROW
;

342 
	$˛ock_gëtime
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ç
Ë
__THROW
;

345 
	$˛ock_£âime
 (
˛ockid_t
 
__˛ock_id
, c⁄° 
time•ec
 *
__ç
)

346 
__THROW
;

348 #ifde‡
__USE_XOPEN2K


353 
	`˛ock_«no¶ìp
 (
˛ockid_t
 
__˛ock_id
, 
__Êags
,

354 c⁄° 
time•ec
 *
__ªq
,

355 
time•ec
 *
__ªm
);

358 
	$˛ock_gë˝u˛ockid
 (
pid_t
 
__pid
, 
˛ockid_t
 *
__˛ock_id
Ë
__THROW
;

363 
	$timî_¸óã
 (
˛ockid_t
 
__˛ock_id
,

364 
sigevít
 *
__ª°ri˘
 
__evp
,

365 
timî_t
 *
__ª°ri˘
 
__timîid
Ë
__THROW
;

368 
	$timî_dñëe
 (
timî_t
 
__timîid
Ë
__THROW
;

371 
	$timî_£âime
 (
timî_t
 
__timîid
, 
__Êags
,

372 c⁄° 
ôimî•ec
 *
__ª°ri˘
 
__vÆue
,

373 
ôimî•ec
 *
__ª°ri˘
 
__ovÆue
Ë
__THROW
;

376 
	$timî_gëtime
 (
timî_t
 
__timîid
, 
ôimî•ec
 *
__vÆue
)

377 
__THROW
;

380 
	$timî_gëovîrun
 (
timî_t
 
__timîid
Ë
__THROW
;

384 #ifde‡
__USE_ISOC11


386 
	$time•ec_gë
 (
time•ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__n⁄nuŒ
 ((1));

391 #ifde‡
__USE_XOPEN_EXTENDED


403 
gëd©e_îr
;

412 
tm
 *
	`gëd©e
 (c⁄° *
__°rög
);

415 #ifde‡
__USE_GNU


426 
	`gëd©e_r
 (c⁄° *
__ª°ri˘
 
__°rög
,

427 
tm
 *
__ª°ri˘
 
__ªsbuÂ
);

430 
__END_DECLS


	@avlTree.h

1 #i‚de‡
AVLTREE_H


2 
	#AVLTREE_H
 10000

	)

4 
	~<°rög.h
>

5 
	~<mÆloc.h
>

6 
	~<°dlib.h
>

8 
	#AVL_NULL
 (
TREE_NODE
 *)0

	)

10 
	#EH_FACTOR
 0

	)

11 
	#LH_FACTOR
 1

	)

12 
	#RH_FACTOR
 -1

	)

13 
	#LEFT_MINUS
 0

	)

14 
	#RIGHT_MINUS
 1

	)

17 
	#ORDER_LIST_WANTED


	)

19 
	#INSERT_PREV
 0

	)

20 
	#INSERT_NEXT
 1

	)

22 
	s_AVL_TREE_NODE
 {

23 #ifde‡
ORDER_LIST_WANTED


24 
_AVL_TREE_NODE
 *
	m¥ev
;

25 
_AVL_TREE_NODE
 *
	m√xt
;

27 
_AVL_TREE_NODE
 *
	måì_roŸ
;

28 
_AVL_TREE_NODE
 *
	mÀ·_chûd
;

29 
_AVL_TREE_NODE
 *
	mright_chûd
;

30 
	mbf
;

31 } 
	tTREE_NODE
;

33 
	sbuf„r_öfo
 {

34 
	mªad_hô
;

35 
	mªad_miss_hô
;

36 
	mwrôe_hô
;

37 
	mwrôe_miss_hô
;

38 
buf„r_group
 *
	mbuf„r_hód
;

39 
buf„r_group
 *
	mbuf„r_èû
;

41 
TREE_NODE
 *
	mpTªeHódî
;

43 
	mmax_buf„r_£˘‹
;

44 
	mbuf„r_£˘‹_cou¡
;

46 #ifde‡
ORDER_LIST_WANTED


47 
TREE_NODE
 *
	mpLi°Hódî
;

48 
TREE_NODE
 *
	mpLi°Taû
;

50 
	mcou¡
;

51 (*
	mkeyCom∑ª
)(
	mTREE_NODE
 *, TREE_NODE *);

53 (*
	m‰ì
)(
	mTREE_NODE
 *);

54 } 
	ttAVLTªe
;

57 
	sbuf„r_öfo_f‹_DFTL
 {

58 
	mªad_hô
;

59 
	mªad_miss_hô
;

60 
	mwrôe_hô
;

61 
	mwrôe_miss_hô
;

62 
buf„r_group_f‹_DFTL
 *
	mbuf„r_hód
;

63 
buf„r_group_f‹_DFTL
 *
	mbuf„r_èû
;

65 
TREE_NODE
 *
	mpTªeHódî
;

67 
	mmax_buf„r_size
;

68 
	mbuf„r_cuºít_size
;

70 #ifde‡
ORDER_LIST_WANTED


71 
TREE_NODE
 *
	mpLi°Hódî
;

72 
TREE_NODE
 *
	mpLi°Taû
;

74 
	mcou¡
;

75 (*
	mkeyCom∑ª
)(
	mTREE_NODE
 *, TREE_NODE *);

77 (*
	m‰ì
)(
	mTREE_NODE
 *);

78 } 
	ttAVLTªe_f‹_DFTL
;

85 
avlTªeHigh
(
TREE_NODE
 *);

87 
avlTªeCheck
(
tAVLTªe
 *, 
TREE_NODE
 *);

89 
R_RŸ©e
(
TREE_NODE
 **);

91 
L_RŸ©e
(
TREE_NODE
 **);

93 
Le·BÆ™˚
(
TREE_NODE
 **);

95 
RightBÆ™˚
(
TREE_NODE
 **);

97 
avlDñBÆ™˚
(
tAVLTªe
 *, 
TREE_NODE
 *, );

99 
AVL_TREE_LOCK
(
tAVLTªe
 *, );

101 
AVL_TREE_UNLOCK
(
tAVLTªe
 *);

103 
AVL_TREENODE_FREE
(
tAVLTªe
 *, 
TREE_NODE
 *);

105 #ifde‡
ORDER_LIST_WANTED


107 
‹dîLi°In£π
(
tAVLTªe
 *, 
TREE_NODE
 *, TREE_NODE *, );

109 
‹dîLi°Remove
(
tAVLTªe
 *, 
TREE_NODE
 *);

111 
TREE_NODE
 *
avlTªeFú°
(
tAVLTªe
 *);

113 
TREE_NODE
 *
avlTªeLa°
(
tAVLTªe
 *);

115 
TREE_NODE
 *
avlTªeNext
(TREE_NODE *
pNode
);

117 
TREE_NODE
 *
avlTªePªv
(TREE_NODE *
pNode
);

121 
avlTªeIn£π
(
tAVLTªe
 *, 
TREE_NODE
 **, TREE_NODE *, *);

123 
avlTªeRemove
(
tAVLTªe
 *, 
TREE_NODE
 *);

125 
TREE_NODE
 *
avlTªeLookup
(
tAVLTªe
 *, TREE_NODE *, TREE_NODE *);

127 
tAVLTªe
 *
avlTªeCª©e
(*, *);

129 
avlTªeDe°roy
(
tAVLTªe
 *);

131 
avlTªeFlush
(
tAVLTªe
 *);

133 
avlTªeAdd
(
tAVLTªe
 *, 
TREE_NODE
 *);

135 
avlTªeDñ
(
tAVLTªe
 *, 
TREE_NODE
 *);

137 
TREE_NODE
 *
avlTªeFöd
(
tAVLTªe
 *, TREE_NODE *);

139 
avlTªeCou¡
(
tAVLTªe
 *);

	@bi_list.h

1 #i‚de‡ 
_BI_LIST_H


2 
	#_BI_LIST_H


	)

5 
	~<°dio.h
>

6 
	~<°dlib.h
>

8 
	s_bi_node
 {

9 
_bi_node
* 
	m¥evNode
;

10 
_bi_node
* 
	m√xtNode
;

11 
	mÕn_™d_°©e
[2];

13 }
	tbi_node
;

16 
_bi_node
* 
¸óã_™d_öô_bi_node
(
Õn
, 
°©e
);

18 
dñ_bi_node
(
_bi_node
* 
node
);

21 
	s_bi_li°
{

22 
_bi_node
* 
	mnode_hód
;

23 
_bi_node
* 
	mnode_èû
;

24 
	mÀn
;

26 }
	tbi_li°
;

28 
_bi_li°
* 
¸óã_™d_öô_bi_li°
();

33 
Õush
(
_bi_li°
* 
li°
, 
Õn
, 
°©e
);

39 
dñ_bi_li°
(
_bi_li°
* 
li°
);

	@debug.h

1 #i‚de‡
_SSDSIM_DEBUG_H


2 
	#_SSDSIM_DEBUG_H


	)

4 
	~<°dio.h
>

6 
	#com¥essi⁄_ªÀv™t


	)

7 
	#CONFIG_TRACE_WRITE_PROCESS


	)

8 
	#CONFIG_TRACE_READ_PROCESS


	)

9 
	#CONFIG_BUFFER_MONITOR_ENTRY


	)

10 
	#CONFIG_BUFFER_MONITOR_TRANS


	)

11 
	#CONFIG_BUFFER_MONITOR_COMPRESSION_TRANS


	)

18 
	#CONFIG_ENABLE_MSG


	)

19 
	#CONFIG_WRONG_PROCESS_DEBUG_ENABLE_MSG


	)

21 #ifde‡
CONFIG_ENABLE_MSG


22 
	#ssdsim_msg
(
fmt
, ...) \

24 
	`¥ötf
("ssdsim:" 
fmt
 "\n", ##
__VA_ARGS__
);\

25 }0);

	)

29 
	#ssdsim_msg
(
fmt
, ...)

	)

36 #ifde‡
CONFIG_WRONG_PROCESS_DEBUG_ENABLE_MSG


37 
	#åa˚Eº‹_msg
(
fmt
, ...) \

39 
	`¥ötf
("simuœt‹Åø˚:" 
fmt
 "\n", ##
__VA_ARGS__
);\

40 }0);

	)

44 
	#åa˚Eº‹_msg
(
fmt
, ...)

	)

49 #ifde‡
CONFIG_TRACE_READ_PROCESS


50 
	#åa˚Ród_msg
(
fmt
, ...) \

52 
	`¥ötf
("simuœt‹Åø˚Ñód:" 
fmt
 "\n", ##
__VA_ARGS__
);\

53 }0);

	)

57 
	#åa˚Ród_msg
(
fmt
, ...)

	)

61 #ifde‡
CONFIG_TRACE_WRITE_PROCESS


62 
	#åa˚Wrôe_msg
(
fmt
, ...) \

64 
	`¥ötf
("simuœt‹Åø˚ wrôe:" 
fmt
 "\n", ##
__VA_ARGS__
);\

65 }0);

	)

69 
	#åa˚Wrôe_msg
(
fmt
, ...)

	)

74 #ifde‡
CONFIG_BUFFER_MONITOR_ENTRY


75 
	#åa˚E¡rybuf„r_msg
(
fmt
, ...) \

77 
	`¥ötf
("simuœt‹Åø˚ buf„∏íåy:" 
fmt
 "\n", ##
__VA_ARGS__
);\

78 }0);

	)

82 
	#åa˚E¡rybuf„r_msg
(
fmt
, ...)

	)

90 #ifde‡
CONFIG_BUFFER_MONITOR_TRANS


91 
	#åa˚Tøn¶©i⁄buf„r_msg
(
fmt
, ...) \

93 
	`¥ötf
("simuœt‹Åø˚ buf„∏å™¶©i⁄Öages:" 
fmt
 "\n", ##
__VA_ARGS__
);\

94 }0);

	)

98 
	#åa˚Tøn¶©i⁄buf„r_msg
(
fmt
, ...)

	)

106 #ifde‡
CONFIG_BUFFER_MONITOR_COMPRESSION_TRANS


107 
	#åa˚CompTøn¶©i⁄buf„r_msg
(
fmt
, ...) \

109 
	`¥ötf
("simuœt‹Åø˚ buf„∏com¥essi⁄Åøn¶©i⁄Öages:" 
fmt
 "\n", ##
__VA_ARGS__
);\

110 }0);

	)

114 
	#åa˚CompTøn¶©i⁄buf„r_msg
(
fmt
, ...)

	)

	@dictionary.h

1 #i‚de‡
_DICTIONARY_H


2 
	#_DICTIONARY_H


	)

4 
	~"js_li°.h
"

6 
	#DICTIONARY_SIZE
 255

	)

7 
	#LOG_DICTIONARY_SIZE
 8

	)

9 
	#DICTIONARY
 
jsLi°


	)

10 
	#DIC_ENTRY
 
nodeJSLi°


	)

12 
DIC_ENTRY
* 
¸óãE¡ry
(
vÆue
);

13 
DICTIONARY
* 
¸óãDi˘i⁄¨y
();

14 
de°royDi˘i⁄¨y
(
DICTIONARY
* 
di˘i⁄¨y
);

15 
numE¡ry
(
DICTIONARY
* 
di˘i⁄¨y
);

16 
gëVÆueOfE¡ry
(
DIC_ENTRY
* 
íåy
);

17 
DIC_ENTRY
* 
gëNextE¡ry
(DIC_ENTRY* 
íåy
);

18 
DIC_ENTRY
* 
gëPªvE¡ry
(DIC_ENTRY* 
íåy
);

19 
DIC_ENTRY
* 
gëE¡ry
(
ödex
, 
DICTIONARY
* 
di˘i⁄¨y
);

20 
moveFr⁄t
(
DIC_ENTRY
* 
íåy
, 
DICTIONARY
* 
di˘i⁄¨y
);

21 
ö£πE¡ry
(
ödex
, 
DIC_ENTRY
* 
íåy
, 
DICTIONARY
* 
di˘i⁄¨y
);

	@diffXmatch.h

1 
	~"xm©chPro.h
"

3 
	#CHUNKSIZE
 4096

	)

5 
diffcom¥ess
(* 
ªf
, * 
§c
, * 
de°
);

6 
diffdecom¥ess
(* 
ªf
, * 
§c
, * 
de°
, 
öputSize
);

	@flash.h

19 #i‚de‡
FLASH_H


20 
	#FLASH_H
 100000

	)

22 
	~<°dlib.h
>

23 
	~"∑gem≠.h
"

25 
ssd_öfo
 *
¥o˚ss
(ssd_info *);

27 
ssd_öfo
 *
ö£π2buf„r
(ssd_öfÿ*, , , 
sub_ªque°
 *, 
ªque°
 *);

29 
ssd_öfo
 *

30 
Êash_∑ge_°©e_modify
(
ssd_öfo
 *, 
sub_ªque°
 *, , , , ,

33 
ssd_öfo
 *

34 
make_ßme_Àvñ
(
ssd_öfo
 *, , , , , , );

36 
föd_Àvñ_∑ge
(
ssd_öfo
 *, , , , 
sub_ªque°
 *,

37 
sub_ªque°
 *);

39 
make_Àvñ_∑ge
(
ssd_öfo
 *
ssd
, 
sub_ªque°
 *
sub0
, sub_ªque° *
sub1
);

40 
ssd_öfo
 *
compuã_£rve_time
(ssd_öfÿ*
ssd
, 
ch™√l
, 
chù
, 
dõ
,

41 
sub_ªque°
 **
subs
, 
subs_cou¡
, 
comm™d
);

44 
gë_µn_f‹_adv™˚d_comm™ds
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
sub_ªque°
 **
subs
,

45 
subs_cou¡
, 
comm™d
);

47 
gë_µn_f‹_n‹mÆ_comm™d
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
sub_ªque°
 *
sub
);

49 
ssd_öfo
 *
dy«mic_adv™˚d_¥o˚ss
(ssd_öfÿ*
ssd
, 
ch™√l
, 
chù
);

51 
sub_ªque°
 *
föd_two_∂™e_∑ge
(
ssd_öfo
 *, sub_request *);

53 
sub_ªque°
 *
föd_öãæóve_ªad_∑ge
(
ssd_öfo
 *, sub_request *);

55 
föd_tw›œ√_wrôe_sub_ªque°
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
sub_ªque°
 *
sub_tw›œ√_⁄e
,

56 
sub_ªque°
 *
sub_tw›œ√_two
);

58 
föd_öãæóve_sub_ªque°
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
sub_ªque°
 *
sub_öãæóve_⁄e
,

59 
sub_ªque°
 *
sub_öãæóve_two
);

61 
sub_ªque°
 *

62 
föd_ªad_sub_ªque°
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
);

64 
sub_ªque°
 *
föd_wrôe_sub_ªque°
(
ssd_öfo
 *
ssd
, 
ch™√l
);

66 
sub_ªque°
 *

67 
¸ót_sub_ªque°
(
ssd_öfo
 *
ssd
, 
Õn
, 
size
, 
°©e
, 
ªque°
 *
ªq
,

68 
›î©i⁄
);

70 
sub_ªque°
 *

71 
föd_öãæóve_tw›œ√_∑ge
(
ssd_öfo
 *
ssd
, 
sub_ªque°
 *
⁄ïage
, 
comm™d
);

74 
föd_öãæóve_tw›œ√_sub_ªque°
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
sub_ªque°
 *
sub_ªque°_⁄e
,

75 
sub_ªque°
 *
sub_ªque°_two
, 
comm™d
);

77 
ssd_öfo
 *
dñëe_‰om_ch™√l
(ssd_öfÿ*
ssd
, 
ch™√l
, 
sub_ªque°
 *
sub_ªq
);

79 
ssd_öfo
 *

80 
un_gªed_öãæóve_c›yback
(
ssd_öfo
 *, , , , 
sub_ªque°
 *,

81 
sub_ªque°
 *);

83 
ssd_öfo
 *
un_gªed_c›yback
(ssd_öfÿ*, , , , 
sub_ªque°
 *);

86 
föd_a˘ive_block
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
);

88 
wrôe_∑ge
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
,

89 
a˘ive_block
, *
µn
);

91 
Æloˇã_loˇti⁄
(
ssd_öfo
 *
ssd
, 
sub_ªque°
 *
sub_ªq
);

94 
go_⁄e_°ï
(
ssd_öfo
 *
ssd
, 
sub_ªque°
 *
sub1
, sub_ªque° *
sub2
, 
aim_°©e
,

95 
comm™d
);

97 
£rvi˚s_2_r_cmd_å™s_™d_com∂ëe
(
ssd_öfo
 *
ssd
);

99 
£rvi˚s_2_r_waô
(
ssd_öfo
 *
ssd
, 
ch™√l
, *
ch™√l_busy_Êag
,

100 *
ch™ge_cuºít_time_Êag
);

102 
£rvi˚s_2_r_d©a_å™s
(
ssd_öfo
 *
ssd
, 
ch™√l
, *
ch™√l_busy_Êag
,

103 *
ch™ge_cuºít_time_Êag
);

105 
£rvi˚s_2_wrôe
(
ssd_öfo
 *
ssd
, 
ch™√l
, *
ch™√l_busy_Êag
,

106 *
ch™ge_cuºít_time_Êag
);

109 
£rvi˚s_2_wrôe
(
ssd_öfo
 *
ssd
, 
ch™√l
, *
ch™√l_busy_Êag
, *
ch™ge_cuºít_time_Êag
);

110 
£rvi˚s_2_wrôe_busy_ö_chù
(
ssd_öfo
 *
ssd
);

111 
£rvi˚s_2_gc_busy_ö_chù
(
ssd_öfo
 *
ssd
);

112 
gc_åy_to_su•íd_fun˘i⁄
(
ssd_öfo
 *
ssd
, 
gc_›î©i⁄
 *
gc_node
, 
ch™√l
, 
chù
, 
cuºít_°©e
, 
√xt_°©e
, 
time
);

113 
åy_to_ª°‹e_gc_fun˘i⁄
(
ssd_öfo
 *
ssd
, 
gc_›î©i⁄
 *
gc_node
, 
ch™√l
, 
chù
);

115 
åy_to_ª°‹e_wrôe_fun˘i⁄
(
ssd_öfo
 *
ssd
);

117 
√w_£rvi˚s_2_wrôe
(
ssd_öfo
 *
ssd
, 
ch™√l
, *
ch™√l_busy_Êag
,*
ch™ge_cuºít_time_Êag
);

121 
judge_wrôe_exi°ög_ö_chù
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
);

125 
dñëe_w_sub_ªque°
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
sub_ªque°
 *
sub
);

127 
c›y_back
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
sub_ªque°
 *
sub
);

130 
°©ic_wrôe
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
sub_ªque°
 *
sub
);

134 
¨ønge_the_loˇti⁄_by_Õn
(
ssd_öfo
* 
ssd
, 
sub_ªque°
* 
sub_ªq
);

135 
assign_rightvÆue_f‹_com∂ëed_m≠pögªœãd_subªque°
(
sub_ªque°
* 
sub
);

137 
ªad_ã°_dñëi⁄_f‹_subªque°
(
ssd_öfo
 *
ssd
);

138 
wrôe_ã°_dñëi⁄_f‹_subªque°
(
ssd_öfo
 *
ssd
);

	@initialize.h

18 #i‚de‡
INITIALIZE_H


19 
	#INITIALIZE_H


	)

21 
	~<°dio.h
>

22 
	~<°rög.h
>

23 
	~<°dlib.h
>

24 
	~<time.h
>

25 
	~<˘y≥.h
>

26 
	~<sys/ty≥s.h
>

27 
	~"avlTªe.h
"

29 
	#SECTOR
 512

	)

30 
	#BUFSIZE
 200

	)

32 
	#DYNAMIC_ALLOCATION
 0

	)

33 
	#STATIC_ALLOCATION
 1

	)

35 
	#INTERLEAVE
 0

	)

36 
	#TWO_PLANE
 1

	)

38 
	#NORMAL
 2

	)

39 
	#INTERLEAVE_TWO_PLANE
 3

	)

40 
	#COPY_BACK
 4

	)

42 
	#AD_RANDOM
 1

	)

43 
	#AD_COPYBACK
 2

	)

44 
	#AD_TWOPLANE
 4

	)

45 
	#AD_INTERLEAVE
 8

	)

46 
	#AD_TWOPLANE_READ
 16

	)

48 
	#READ
 1

	)

49 
	#WRITE
 0

	)

51 
	#MAPPINGTABLE_READ
 2

	)

52 
	#MAPPINGTABLE_WRITE
 3

	)

57 
	#NUM_ENTRIES_PER_DIR
 512

	)

58 
	#MAX_CACHED_DIR_SLOTS_SIZE
 10485760

59 
	#MAX_CACHED_ENTRIES_SIZE
 10485760

60 

	)

68 
	#CHANNEL_IDLE
 000

	)

69 
	#CHANNEL_C_A_TRANSFER
 3

	)

70 
	#CHANNEL_GC
 4

	)

72 
	#CHANNEL_GC_ERASE
 5

	)

75 
	#CHANNEL_DATA_TRANSFER
 7

	)

76 
	#CHANNEL_TRANSFER
 8

	)

77 
	#CHANNEL_UNKNOWN
 9

	)

79 
	#CHIP_IDLE
 100

	)

80 
	#CHIP_WRITE_BUSY
 101

	)

81 
	#CHIP_READ_BUSY
 102

	)

82 
	#CHIP_C_A_TRANSFER
 103

	)

84 
	#CHIP_WRITE_DATA_CMD_BUSY
 104

	)

85 
	#CHIP_GC_RW_BUSY
 105

	)

87 
	#CHIP_DATA_TRANSFER
 107

	)

88 
	#CHIP_WAIT
 108

	)

89 
	#CHIP_ERASE_BUSY
 109

90 
	#CHIP_COPYBACK_BUSY
 110

	)

91 
	#UNKNOWN
 111

	)

93 
	#SR_WAIT
 200

	)

94 
	#SR_R_C_A_TRANSFER
 201

	)

95 
	#SR_R_READ
 202

	)

96 
	#SR_R_DATA_TRANSFER
 203

	)

97 
	#SR_W_C_A_DATA_TRANSFER
 204

	)

98 
	#SR_W_DATA_TRANSFER_ONE_PROG_OF_ITERATIONS
 205

	)

99 
	#SR_W_DATA_TRANSFER_ONE_VERIFY_OF_ITERATIONS
 207

	)

100 
	#SR_W_TRANSFER
 206

	)

103 
	#SR_W_DATA_TRANSFER
 208

104 

	)

105 
	#SR_COMPLETE
 299

	)

107 
	#REQUEST_IN
 300

108 
	#OUTPUT
 301

109 

	)

110 
	#GC_WAIT
 400

	)

111 
	#GC_ERASE_C_A
 401

	)

112 
	#GC_COPY_BACK
 402

	)

113 
	#GC_COMPLETE
 403

	)

114 
	#GC_INTERRUPT
 0

	)

115 
	#GC_UNINTERRUPT
 1

	)

117 
	#CHANNEL
(
l¢
Ë÷¢&0x0000)>>16

	)

118 
	#chù
(
l¢
Ë÷¢&0x0000)>>16

	)

119 
	#dõ
(
l¢
Ë÷¢&0x0000)>>16

	)

120 
	#PLANE
(
l¢
Ë÷¢&0x0000)>>16

	)

121 
	#BLOKC
(
l¢
Ë÷¢&0x0000)>>16

	)

122 
	#PAGE
(
l¢
Ë÷¢&0x0000)>>16

	)

123 
	#SUBPAGE
(
l¢
Ë÷¢&0x0000)>>16

	)

125 
	#PG_SUB
 0xffffffff

	)

131 
	#TRUE
 1

	)

132 
	#FALSE
 0

	)

133 
	#SUCCESS
 1

	)

134 
	#FAILURE
 0

	)

135 
	#ERROR
 -1

	)

136 
	#INFEASIBLE
 -2

	)

137 
	#OVERFLOW
 -3

	)

138 
	tSètus
;

140 
	sac_time_ch¨a˘îi°ics
 {

141 
	mtPROG
;

143 
	mtPROG_r_phy
;

145 
	mtPROG_w_tŸÆ
;

146 
	mtPROG_Nw_cy˛e
;

147 
	mtPROG_Tw_cy˛e
;

148 
	mtPROG_w_¥ogam
;

149 
	mtPROG_w_vîify
;

150 
	mtPROG_buf„r
;

154 
	mtDBSY
;

155 
	mtBERS
;

156 
	mtCLS
;

157 
	mtCLH
;

158 
	mtCS
;

159 
	mtCH
;

160 
	mtWP
;

161 
	mtALS
;

162 
	mtALH
;

163 
	mtDS
;

164 
	mtDH
;

165 
	mtWC
;

166 
	mtWH
;

167 
	mtADL
;

168 
	mtR
;

169 
	mtAR
;

170 
	mtCLR
;

171 
	mtRR
;

172 
	mtRP
;

173 
	mtWB
;

174 
	mtRC
;

175 
	mtREA
;

176 
	mtCEA
;

177 
	mtRHZ
;

178 
	mtCHZ
;

179 
	mtRHOH
;

180 
	mtRLOH
;

181 
	mtCOH
;

182 
	mtREH
;

183 
	mtIR
;

184 
	mtRHW
;

185 
	mtWHR
;

186 
	mtRST
;

187 } 
	gac_timög
;

190 
	sssd_öfo
 {

192 
	mdebug_sign
;

193 
	mgc_su•íd_times
;

194 
	mwrôe_su•íd_times
;

195 
	mgc_su•íd_doög
;

196 
	mwrôe_su•íd_doög
;

197 
	m‹igöÆ_tŸÆ_∑ges_numbî
;

198 
	ma·î_¥e_¥o˚ss_∑ges_numbî
;

199 
	ma·î_¥e_¥o˚s£_™d_aged_∑ges_numbî
;

200 
	mœ°_tŸÆ_avaûabÀ_∑ges_numbî
;

203 
	mdiff_bëwìn_FCFS_RF
;

206 
	mîa£_ôî©i⁄s
;

207 
	möãr„ªn˚_°uf„d_Àngth
;

208 
	möãr„ªn˚_°uf„d_Àngth_durög_gc
;

209 
öt64_t
 
	mãmp_lba
;

214 
	mmissög_m≠pög_™d_ˇ¬Ÿ_gë_åa˚löe
;

218 
	mssd_íîgy
;

219 
öt64_t
 
	mcuºít_time
;

220 
öt64_t
 
	m√xt_ªque°_time
;

221 
	mªÆ_time_subªq
;

222 
	mÊag
;

223 
	ma˘ive_Êag
;

224 
	m∑ge
;

226 
	mtokí
;

227 
	mgc_ªque°
;

229 
	mwrôe_ªque°_cou¡
;

230 
	mªad_ªque°_cou¡
;

231 
öt64_t
 
	mwrôe_avg
;

232 
öt64_t
 
	mªad_avg
;

234 
	mmö_l¢
;

235 
	mmax_l¢
;

236 
	mªad_cou¡
;

237 
	m¥ogøm_cou¡
;

238 
	mîa£_cou¡
;

239 
	mdúe˘_îa£_cou¡
;

240 
	mc›y_back_cou¡
;

241 
	mm_∂™e_ªad_cou¡
;

242 
	mm_∂™e_¥og_cou¡
;

243 
	möãæóve_cou¡
;

244 
	möãæóve_ªad_cou¡
;

245 
	möãr_m∂™e_cou¡
;

246 
	möãr_m∂™e_¥og_cou¡
;

247 
	möãæóve_îa£_cou¡
;

248 
	mm∂™e_îa£_c⁄ut
;

249 
	möãæóve_m∂™e_îa£_cou¡
;

250 
	mgc_c›y_back
;

251 
	mwrôe_Êash_cou¡
;

252 
	mwa°e_∑ge_cou¡
;

253 
	mave_ªad_size
;

254 
	mave_wrôe_size
;

255 
	mªque°_queue_Àngth
;

256 
	mupd©e_ªad_cou¡
;

258 
	m∑ømëîfûíame
[30];

259 
	mÂ_numbî_subªque°s_txt_«me
[30];

260 
	måa˚fûíame
[30];

261 
	mouçutfûíame
[30];

262 
	m°©i°icfûíame
[30];

263 
	m°©i°icfûíame2
[30];

265 
FILE
 *
	mouçutfûe
;

266 
FILE
 *
	måa˚fûe
;

267 
FILE
 *
	m°©i°icfûe
;

268 
FILE
 *
	m°©i°icfûe2
;

269 
FILE
 * 
	mÂ_numbî_subªque°s_txt
;

271 
∑ømëî_vÆue
 *
	m∑ømëî
;

272 
døm_öfo
 *
	mdøm
;

273 
ªque°
 *
	mªque°_queue
;

274 
ªque°
 *
	mªque°_èû
;

275 
sub_ªque°
 *
	msubs_w_hód
;

276 
sub_ªque°
 *
	msubs_w_èû
;

277 
evít_node
 *
	mevít
;

278 
ch™√l_öfo
 *
	mch™√l_hód
;

282 
	sch™√l_öfo
 {

283 
	mchù
;

284 
	mªad_cou¡
;

285 
	m¥ogøm_cou¡
;

286 
	mîa£_cou¡
;

287 
	mtokí
;

289 
	mcuºít_°©e
;

290 
	m√xt_°©e
;

291 
öt64_t
 
	mcuºít_time
;

292 
öt64_t
 
	m√xt_°©e_¥edi˘_time
;

294 
evít_node
 *
	mevít
;

295 
sub_ªque°
 *
	msubs_r_hód
;

296 
sub_ªque°
 *
	msubs_r_èû
;

297 
sub_ªque°
 *
	msubs_w_hód
;

298 
sub_ªque°
 *
	msubs_w_èû
;

299 
gc_›î©i⁄
 *
	mgc_comm™d
;

300 
chù_öfo
 *
	mchù_hód
;

308 
	schù_öfo
 {

309 
	mdõ_num
;

310 
	m∂™e_num_dõ
;

311 
	mblock_num_∂™e
;

312 
	m∑ge_num_block
;

313 
	msub∑ge_num_∑ge
;

314 
	mîs_limô
;

315 
	mtokí
;

317 
	mcuºít_°©e
;

318 
	m√xt_°©e
;

319 
öt64_t
 
	mcuºít_time
;

320 
öt64_t
 
	m√xt_°©e_¥edi˘_time
;

322 
	mªad_cou¡
;

323 
	m¥ogøm_cou¡
;

324 
	mîa£_cou¡
;

326 
ac_time_ch¨a˘îi°ics
 
	mac_timög
;

327 
dõ_öfo
 *
	mdõ_hód
;

329 
	mwrôe_¥ìm±ive_sign
;

330 
	mnum_w_cy˛e
;

334 
	mchù_°©us
;

335 
	mchù_°©us_time
;

336 
	mchù_ªad_queue_Àngth
;

337 
	mchù_wrôe_queue_Àngth
;

339 
sub_ªque°
 *
	m°‹edsub
;

344 
	mchù_wrôe_ªc‹d_begö
;

345 
	mchù_wrôe_ªc‹d_íd
;

346 
	mchù_ªad_°›
;

347 
	mchù_ªad_ªÆ_°›
;

352 
	sdõ_öfo
 {

354 
	mtokí
;

355 
∂™e_öfo
 *
	m∂™e_hód
;

360 
	s∂™e_öfo
 {

361 
	madd_ªg_µn
;

368 
	m‰ì_∑ge
;

369 
	mîs_övÆid
;

370 
	ma˘ive_block
;

371 
	mˇn_îa£_block
;

372 
dúe˘_îa£
 *
	mîa£_node
;

373 
blk_öfo
 *
	mblk_hód
;

377 
	sblk_öfo
 {

378 
	mîa£_cou¡
;

379 
	m‰ì_∑ge_num
;

380 
	mövÆid_∑ge_num
;

381 
	mœ°_wrôe_∑ge
;

382 
∑ge_öfo
 *
	m∑ge_hód
;

386 
	s∑ge_öfo
 {

387 
	mvÆid_°©e
;

388 
	m‰ì_°©e
;

389 
	mÕn
;

390 
	mwrôãn_cou¡
;

394 
	sloˇl
 {

395 
	mch™√l
;

396 
	mchù
;

397 
	mdõ
;

398 
	m∂™e
;

399 
	mblock
;

400 
	m∑ge
;

401 
	msub_∑ge
;

411 
	mDFTL_DIR_EMPTY
 = 0,

412 
	mDFTL_DIR_FLASH
 = 0x100,

413 
	mDFTL_DIR_DRAM
 = 0x200,

414 
	mDFTL_DIR_CLEAN
 = 
DFTL_DIR_DRAM
 | 0x1,

415 
	mDFTL_DIR_DIRTY
 = 
DFTL_DIR_DRAM
 | 0x2,

416 }
	tdú_°©
;

418 
	eBDBM_DFTL_PAGE_STATUS
{

419 
	mDFTL_PAGE_NOT_EXIST
 = 0,

420 
	mDFTL_PAGE_NOT_MAPPED
,

421 
	mDFTL_PAGE_VALID
,

422 
	mDFTL_PAGE_INVALID
,

423 
	mDFTL_PAGE_INVALID_ADDR
 = -1,

427 
	m°©us
;

428 
loˇl
 
	mphyaddr
;

430 }
	tm≠pög_íåy_t
;

434 
	mid
;

435 
dú_°©
 
	m°©us
;

436 
loˇl
 
	mphyaddr
;

437 
m≠pög_íåy_t
 * 
	mme
;

438 
	mis_undî_lﬂd
;

439 }
	tdúe˘‹y_¶Ÿ_t
;

446 
buf„r_öfo
 *
	mbuf„r_DFTL
;

447 
buf„r_öfo
 *
	mbuf„r_DFTL_UNCOM
;

449 
	mm≠pög_íåy_size
;

450 
	mƒ_íåõs_≥r_dú_¶Ÿ
;

451 
	mƒ_tŸÆ_dú_¶Ÿs
;

452 
	mmax_ˇched_dú_¶Ÿs_sizeö_byã
;

453 
	mnow_ˇched_dú_¶Ÿs_sizeö_byã
;

455 
	mmax_ˇched_íåõs_sizeö_byã
;

456 
	mnow_ˇched_íåõs_sizeö_byã
;

460 
	muncom¥essi⁄_max_ˇched_dú_¶Ÿs_sizeö_byã
;

461 
	muncom¥essi⁄_now_ˇched_dú_¶Ÿs_sizeö_byã
;

463 
dúe˘‹y_¶Ÿ_t
* 
	mdú
;

466 * 
	mcom¥essi⁄_size
;

467 * 
	mcom¥essi⁄_°©e
;

468 * 
	mcom¥essi⁄_dúty
;

471 }
	td·l_m≠pög_èbÀ_t
;

474 
	sdøm_öfo
 {

475 
	mdøm_ˇ∑côy
;

476 
öt64_t
 
	mcuºít_time
;

478 
døm_∑ømëî
 *
	mdøm_∑ømãrs
;

479 
m≠_öfo
 *
	mm≠
;

480 
buf„r_öfo
 *
	mbuf„r
;

484 
d·l_m≠pög_èbÀ_t
* 
	mmt
;

501 
	sbuf„r_group
 {

502 
TREE_NODE
 
	mnode
;

503 
buf„r_group
 *
	mLRU_lök_√xt
;

504 
buf„r_group
 *
	mLRU_lök_¥e
;

506 
	mgroup
;

507 
	m°‹ed
;

508 
	mdúty_˛ón
;

509 
	mÊag
;

510 } 
	tbuf_node
;

514 
	sbuf„r_group_f‹_DFTL
 {

515 
TREE_NODE
 
	mnode
;

516 
buf„r_group
 *
	mLRU_lök_√xt
;

517 
buf„r_group
 *
	mLRU_lök_¥e
;

519 
	mgroup
;

520 * 
	m°‹ed
;

521 
	mthis_node_c⁄ã¡_size
;

522 
	mdúty_˛ón
;

523 
	mÊag
;

524 } 
	tbuf_node_f‹_DFTL
;

532 
	sdøm_∑ømëî
 {

533 
	ma˘ive_cuºít
;

534 
	m¶ìp_cuºít
;

535 
	mvﬁège
;

536 
	m˛ock_time
;

540 
	sm≠_öfo
 {

541 
íåy
 *
	mm≠_íåy
;

542 
buf„r_öfo
 *
	m©èch_öfo
;

546 
	sc⁄åﬁÀr_öfo
 {

547 
	m‰equícy
;

548 
öt64_t
 
	m˛ock_time
;

549 
	mpowî
;

553 
	sªque°
 {

554 
öt64_t
 
	mtime
;

555 
	ml¢
;

556 
	msize
;

557 
	m›î©i⁄
;

559 *
	m√ed_di°r_Êag
;

560 
	mcom∂ëe_l¢_cou¡
;

562 
	mdi°ri_Êag
;

564 
öt64_t
 
	mbegö_time
;

565 
öt64_t
 
	mª•⁄£_time
;

566 
	míîgy_c⁄sum±i⁄
;

568 
sub_ªque°
 *
	msubs
;

569 
ªque°
 *
	m√xt_node
;

572 
sub_ªque°
 * 
	mevi˘_sub_ªque°
;

573 
sub_ªque°
 * 
	m„tch_sub_ªque°
;

576 
_bi_li°
* 
	mshould_evi˘_Õn_d©a
;

577 
_bi_li°
* 
	mmissög_ö_d©a_buf„r_Õn_d©a
;

578 
_bi_li°
* 
	mmissög_ö_DFTL_buf„r_Õn_d©a
;

582 
	mtŸÆ_waô_evi˘
;

583 
	mtŸÆ_waô_„tch_m≠pögèbÀ
;

584 
	m¸óã_‹_nŸyë_evi˘_subªque°s
;

585 
	m¸óã_‹_nŸyë_„tch_subªque°s
;

586 
	m¸óã_‹_nŸyë_n‹mÆ_subªque°s
;

591 
	mhô_ö_uncom¥essi⁄_buf„r_numbî
;

592 
_bi_li°
* 
	mcom¥essi⁄_to_uncom¥essi⁄
;

593 
	mif_√ed_movemít_bëwìn_com_™d_uncom_Êag_™d_∑ge_numbîs
;

594 
	mthe_numbî_of_evi˘ög_‰om_uncom_to_com
;

599 
	ssub_ªque°
 {

600 
	mÕn
;

602 
	mµn
;

603 
	m›î©i⁄
;

604 
	msize
;

607 
	mcuºít_°©e
;

608 
öt64_t
 
	mcuºít_time
;

609 
	m√xt_°©e
;

610 
öt64_t
 
	m√xt_°©e_¥edi˘_time
;

611 
	m°©e
;

614 
öt64_t
 
	mbegö_time
;

615 
öt64_t
 
	mcom∂ëe_time
;

617 
loˇl
 *
	mloˇti⁄
;

618 
sub_ªque°
 *
	m√xt_subs
;

619 
sub_ªque°
 *
	m√xt_node
;

620 
sub_ªque°
 *
	mupd©e
;

624 
öt64_t
 
	m£rvi˚d_time
;

625 
öt64_t
 
	m¶ack_time
;

626 
	mœ°_sign
;

630 
	mwaô_evi˘_sign
;

631 
	mwaô_„tch_m≠pögèbÀ_sign
;

632 
	mwaô_evi˘_sign_föished
;

633 
	mwaô_„tch_m≠pögèbÀ_sign_föished
;

636 
	mcom¥essi⁄_co°_add_Êag
;

644 
	sevít_node
 {

645 
	mty≥
;

646 
öt64_t
 
	m¥edi˘_time
;

647 
evít_node
 *
	m√xt_node
;

648 
evít_node
 *
	m¥e_node
;

651 
	s∑ømëî_vÆue
 {

652 
	mchù_num
;

653 
	mdøm_ˇ∑côy
;

654 
	m˝u_sdøm
;

656 
	mch™√l_numbî
;

657 
	mchù_ch™√l
[100];

659 
	mdõ_chù
;

660 
	m∂™e_dõ
;

661 
	mblock_∂™e
;

662 
	m∑ge_block
;

663 
	msub∑ge_∑ge
;

665 
	m∑ge_ˇ∑côy
;

666 
	msub∑ge_ˇ∑côy
;

669 
	mîs_limô
;

670 
	maddªss_m≠pög
;

671 
	mwór_Àvñög
;

672 
	mgc
;

673 
	m˛ón_ö_background
;

674 
	mÆloc_poﬁ
;

675 
	movî¥ovide
;

676 
	mgc_thªshﬁd
;

678 
	m›î©ög_cuºít
;

679 
	msuµly_vﬁège
;

680 
	mdøm_a˘ive_cuºít
;

681 
	mdøm_°™dby_cuºít
;

682 
	mdøm_ª‰esh_cuºít
;

683 
	mdøm_vﬁège
;

685 
	mbuf„r_m™agemít
;

686 
	mschedulög_Æg‹ôhm
;

687 
	mquick_ødio
;

688 
	mªœãd_m≠pög
;

690 
	mtime_°ï
;

691 
	msmÆl_œrge_wrôe
;

693 
	m°rùög
;

694 
	möãæóvög
;

695 
	mpùñöög
;

696 
	mthªshﬁd_fixed_adju°
;

697 
	mthªshﬁd_vÆue
;

698 
	ma˘ive_wrôe
;

699 
	mgc_h¨d_thªshﬁd
;

700 
	mÆloˇti⁄_scheme
;

701 
	m°©ic_Æloˇti⁄
;

702 
	mdy«mic_Æloˇti⁄
;

703 
	madv™˚d_comm™ds
;

704 
	mad_¥i‹ôy
;

705 
	mad_¥i‹ôy2
;

706 
	mgªed_CB_ad
;

707 
	mgªed_MPW_ad
;

708 
	maged
;

709 
	maged_øtio
;

710 
	mqueue_Àngth
;

712 
ac_time_ch¨a˘îi°ics
 
	mtime_ch¨a˘îi°ics
;

718 
	síåy
 {

719 
	m≤
;

720 
	m°©e
;

725 
	sgc_öfo
 {

726 
öt64_t
 
	mbegö_time
;

727 
	mc›y_back_cou¡
;

728 
	mîa£_cou¡
;

729 
öt64_t
 
	m¥o˚ss_time
;

730 
	míîgy_c⁄sum±i⁄
;

734 
	sdúe˘_îa£
 {

735 
	mblock
;

736 
dúe˘_îa£
 *
	m√xt_node
;

743 
	sgc_›î©i⁄
 {

744 
	mchù
;

745 
	mdõ
;

746 
	m∂™e
;

747 
	mblock
;

748 
	m∑ge
;

749 
	m°©e
;

750 
	m¥i‹ôy
;

751 
gc_›î©i⁄
 *
	m√xt_node
;

753 
	mc›y_∑ge_numbî
;

754 
	mc›y_vÆid_numbî
;

755 
	mpos_ö_c›y
;

756 
	mªad
;

757 
	mwrôe
;

758 
	mîa£
;

759 
	mvi˘im_block_numbî
;

761 
	mgc_ªad_ö√r
;

762 
	mgc_wrôe_ö√r
;

763 
	mªad_wrôe_íd
;

764 
	mœ°_∑ge_ö_vi˘im_dól
;

766 
	mvi˘im_block_‰ì∑ge_°©i°ic
;

767 
	mchù_°©us
;

768 
	mchù_√xt_°©us
;

769 
	msign_f‹_¥ìm±ive
;

770 
	mchù_√xt_¥edi˘_time_diff
;

777 
	sDøm_wrôe_m≠
 {

778 
	m°©e
;

779 } 
	tDøm_wrôe_m≠
;

782 
ssd_öfo
 *
öôüti⁄
(ssd_info *);

784 
∑ømëî_vÆue
 *
lﬂd_∑ømëîs
(
∑ømëî_fûe
[30]);

786 
∑ge_öfo
 *
öôülize_∑ge
(∑ge_öfÿ*
p_∑ge
);

788 
blk_öfo
 *
öôülize_block
(blk_öfÿ*
p_block
, 
∑ømëî_vÆue
 *
∑ømëî
);

790 
∂™e_öfo
 *
öôülize_∂™e
(∂™e_öfÿ*
p_∂™e
, 
∑ømëî_vÆue
 *
∑ømëî
);

792 
dõ_öfo
 *
öôülize_dõ
(dõ_öfÿ*
p_dõ
, 
∑ømëî_vÆue
 *
∑ømëî
, 
cuºít_time
);

794 
chù_öfo
 *
öôülize_chù
(chù_öfÿ*
p_chù
, 
∑ømëî_vÆue
 *
∑ømëî
, 
cuºít_time
);

796 
ssd_öfo
 *
öôülize_ch™√ls
(ssd_öfÿ*
ssd
);

798 
døm_öfo
 *
öôülize_døm
(
ssd_öfo
 *
ssd
);

801 
d·l_m≠pög_èbÀ_t
* 
d·l_¸óã_m≠pög_èbÀ
 (
ssd_öfo
 *
ssd
);

	@js_list.h

1 #i‚de‡
_JS_LIST_H


2 
	#_JS_LIST_H


	)

4 
	#TYPE
 

	)

6 
	snodeJSLi°


8 
nodeJSLi°
* 
	m¥evNode
;

9 
nodeJSLi°
* 
	m√xtNode
;

10 
TYPE
 
	mvÆue
;

13 
	sjsLi°


15 
	mnumNode
;

16 
nodeJSLi°
* 
	mhód
;

17 
nodeJSLi°
* 
	mèû
;

20 
nodeJSLi°
* 
¸óãNode
(
TYPE
 
√wVÆue
);

21 
öôLi°
(
jsLi°
* 
li°
);

22 
nodeJSLi°
* 
gëNode
(
ödex
, 
jsLi°
* 
li°
);

23 
ö£πNode
(
ödex
, 
nodeJSLi°
* 
√wNode
, 
jsLi°
* 
li°
);

24 
dñëeNode
(
nodeJSLi°
* 
dñëedNode
, 
jsLi°
* 
li°
);

	@pagemap.h

18 #i‚de‡
PAGEMAP_H


19 
	#PAGEMAP_H
 10000

	)

21 
	~<sys/ty≥s.h
>

22 
	~"öôülize.h
"

24 
	#MAX_INT64
 0x7ffffffffffffffÊl

	)

26 
fûe_as£π
(
îr‹
, *
s
);

28 
Æloc_as£π
(*
p
, *
s
);

30 
åa˚_as£π
(
öt64_t
 
time_t
, 
devi˚
, 
l¢
, 
size
, 
›e
);

32 
loˇl
 *
föd_loˇti⁄
(
ssd_öfo
 *
ssd
, 
µn
);

35 
föd_µn
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
,

36 
block
, 
∑ge
);

38 
ssd_öfo
 *
¥e_¥o˚ss_∑ge
(ssd_öfÿ*
ssd
);

40 
gë_µn_f‹_¥e_¥o˚ss
(
ssd_öfo
 *
ssd
, 
l¢
);

42 
ssd_öfo
 *

43 
gë_µn
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
,

44 
sub_ªque°
 *
sub
);

46 
gc
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
Êag
);

49 
gc_dúe˘_îa£
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
);

51 
unöãºu±_gc
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
);

53 
öãºu±_gc
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
,

54 
gc_›î©i⁄
 *
gc_node
);

56 
decide_gc_övoke
(
ssd_öfo
 *
ssd
, 
ch™√l
);

58 
£t_íåy_°©e
(
ssd_öfo
 *
ssd
, 
l¢
, 
size
);

61 
gë_µn_f‹_gc
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
);

63 
îa£_›î©i⁄
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ
, 
∂™e
,

64 
block
);

66 
îa£_∂™es
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
chù
, 
dõ1
, 
∂™e1
,

67 
comm™d
);

69 
move_∑ge
(
ssd_öfo
 *
ssd
, 
loˇl
 *
loˇti⁄
, *
å™s„r_size
);

71 
gc_f‹_ch™√l
(
ssd_öfo
 *
ssd
, 
ch™√l
);

73 
dñëe_gc_node
(
ssd_öfo
 *
ssd
, 
ch™√l
, 
gc_›î©i⁄
 *
gc_node
);

77 
gë_µn_ö_dif„ª¡_ˇ£
(
ssd_öfo
* 
ssd
, 
ch™√l
, 
chù
,
dõ
,
∂™e
,
block
,
∑ge
);

	@ssd.h

18 
	~<°dlib.h
>

19 
	~<°dio.h
>

20 
	~<time.h
>

21 
	~<°rög.h
>

22 
	~<sys/ty≥s.h
>

23 
	~"öôülize.h
"

24 
	~"Êash.h
"

25 
	~"∑gem≠.h
"

27 
	~"debug.h
"

28 
	~"bi_li°.h
"

29 
	~"di˘i⁄¨y.h
"

30 
	~"diffXm©ch.h
"

31 
	~"js_li°.h
"

32 
	~"xm©chPro.h
"

34 
	#COMPRESSION_COST_TIME_ONE_PAGE
 100

35 
	#DFTL


38 
	#TRANSLATION_PAGE_UNIT


39 
	#COMP_VS_UNCOMP_IN_DFTL_BUFFER
 0.1

40 
	#COMP_PAGE_NUMBER_ONCE
 4

	)

41 
	#SET_INTO_LIMITTED_BUFFER


42 
	#MAX_INT64
 0x7ffffffffffffffÊl

	)

51 
¥ötfsub_ªque°_°©us
(
ssd_öfo
 *
ssd
);

52 
¥ötf_ssd_ªque°_queue
(
ssd_öfo
 *
ssd
);

54 
¥ötf_ssd_gc_node
(
ssd_öfo
 *
ssd
);

56 
judgög_ªad_ö_gc_chù
(
ssd_öfo
 *
ssd
, 
ch™√l
);

57 
¥ötf_evîy_chù_ªad_subªque°
(
ssd_öfo
 *
ssd
);

58 
¥ötf_evîy_chù_°©ic_subªque°
(
ssd_öfo
 *
ssd
);

60 
ˇlc_ªq_¶ack_time
(
ªque°
 * 
ªq
);

62 
¥ötf_gc_node_öf‹m©i⁄
(
gc_›î©i⁄
* 
gc_node
);

67 
°©i°ic_wrôe_ªque°_numbî
(
ssd_öfo
 *
ssd
);

68 
no_gªedy_RF_su•ísi⁄
(
ssd_öfo
 *
ssd
);

71 
Êush_m≠pögèbÀ_öto_fûes
(
ssd_öfo
 *
ssd
, * 
fûíame
);

72 
ssd_öfo
 *
simuœã
(ssd_info *);

74 
gë_ªque°s
(
ssd_öfo
 *);

76 
ssd_öfo
 *
buf„r_m™agemít
(ssd_info *);

80 
ssd_öfo
 *
DFTL_buf„r_m™agemít
(ssd_öfÿ* 
ssd
);

85 
Õn2µn
(
ssd_öfo
 *, 
l¢
);

87 
ssd_öfo
 *
di°ribuã
(ssd_info *);

89 
dñëe_evi˘_subªque°_‰om_this_ªq
(
ssd_öfo
* 
ssd
);

90 
pﬁlög_whëhî_föish_evi˘_subªque°s
(
ssd_öfo
* 
ssd
);

91 
ssd_öfo
* 
¸óã_evi˘_m≠pögèbÀ_subªque°s
(ssd_öfo* 
ssd
);

92 
dñëe_subs_ö_this_ªq
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

93 
dñëe_subs_bûi°_ö_this_ªq
(
ªque°
* 
ªq
, 
_bi_li°
* 
should_evi˘_Õn_d©a
);

94 
P›_DFTL_buf„r
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

95 
ssd_öfo
* 
¸óã_„tch_m≠pögèbÀ_subªque°s
(ssd_öfo* 
ssd
);

96 
pﬁlög_whëhî_föish_„tch_subªque°s
(
ssd_öfo
* 
ssd
);

97 
dñëe_„tch_subªque°_‰om_this_ªq
(
ssd_öfo
* 
ssd
);

98 
ö£π2DFTL_buf„r
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

99 
gë_ªÆsize_öbyã_byposôi⁄_ö_mt
(
ssd_öfo
* 
ssd
, 
Õn
);

100 
dñëe_ªque°_wôhout_subs
(
ªque°
* 
ªq
);

102 
If_hôInBUf„r_move_theNode_ahód_ö_ªadªque°
(
ssd_öfo
* 
ssd
, 
buf„r_öfo
* 
buf„r
, 
buf„r_group
* 
buf„r_node
);

103 
If_hôInBUf„r_move_theNode_ahód_ö_wrôîeque°
(
ssd_öfo
* 
ssd
, 
buf„r_öfo
* 
buf„r
, 
buf„r_group
* 
buf„r_node
);

105 
ssd_öfo
* 
COMPRESSION_DFTL_dól_ö_di°ributög_subªque°s
(ssd_öfo* 
ssd
);

106 
ssd_öfo
* 
DFTL_dól_ö_di°ributög_subªque°s
(ssd_öfo* 
ssd
);

107 
ssd_öfo
 *
DFTL_di°ribuã
(ssd_info *);

109 
≠≥nd_⁄_ªque°_com¥essi⁄_to_uncom¥essi⁄_Õn_d©a
(
ªque°
* 
ªq
, 
Õn
, 
°©e
);

110 
≠≥nd_⁄_ªque°_missög_ö_d©a_buf„r_Õn_d©a
(
ªque°
* 
ªq
, 
Õn
, 
°©e
);

111 
≠≥nd_⁄_ªque°_missög_ö_DFTL_buf„r_Õn_d©a
(
ªque°
* 
ªq
, 
Õn
, 
°©e
);

112 
ssd_öfo
* 
wrôe_ªque°_gë_missög_ö_d©abuf„r
(ssd_öfo* 
ssd
, 
Õn
, 
°©e
, 
ªque°
* 
ªq
);

114 
ssd_öfo
* 
vÆue_ªque°_DFTL_∑ømëîs_f‹_di°ribuã_subªque°s
(ssd_öfo* 
ssd
);

115 
ªad_vÆue_ªque°_DFTL_∑ømëîs
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

116 
wrôe_vÆue_ªque°_DFTL_∑ømëîs
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

117 
gë_å™¶©i⁄_numbî_by_d©a_Õn
(
d©a_Õn
);

118 
buf„r_group
* 
node_i¢Ÿ_ö_DFTL_buf„r
(
ssd_öfo
* 
ssd
, 
Õn
);

120 
≠≥nd_⁄_ªque°_evi˘_ö_DFTL_buf„r_Õn_d©a
(
ªque°
* 
ªq
, 
Õn
, 
°©e
);

123 
com∑ª_DFTL_buf„r_ªmaödî_•a˚_wôh_missög_ö_DFTL_buf„r
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñequest);

126 
buf„r_group
* 
node_i¢Ÿ_ö_two_DIFF_DFTL_buf„r
(
ssd_öfo
* 
ssd
, 
Õn
, * 
sign
);

127 
COMPRESSION_wrôe_vÆue_ªque°_DFTL_∑ømëîs
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

128 
COMPRESSION_ªad_vÆue_ªque°_DFTL_∑ømëîs
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

129 
com¥essi⁄_com∑ª_DFTL_buf„r_ªmaödî_•a˚_wôh_com¥essi⁄_¨ó_comög
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñequest);

130 
gë_com¥essi⁄_å™¶©i⁄_∑ge_size
(
ssd_öfo
* 
ssd
);

131 
gë_size_‰om_com¥essi⁄_to_uncom¥essi⁄
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñequest);

132 
make_ªÆ_evi˘_∑ges_f‹_com¥essi⁄_∑π
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñeque°, 
should_evi˘_size
);

133 
gë_uncom¥essi⁄_èû_∑ge_com¥es£d_size
(
ssd_öfo
* 
ssd
, 
off_£t
);

134 
move_∑ges_‰om_uncom¥essi⁄_to_com¥essi⁄
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñequest);

135 
ö£π2DFTL_UNCOM_buf„r
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

136 
¥ötf_ªad_ªque°_√ed_di°r_Êag_vÆue_™d_ûlu°i⁄
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

137 
¥ötf_wrôe_ªque°_√ed_di°r_Êag_vÆue_™d_ûlu°i⁄
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

138 
¥ötf_ªque°s_basic_∑ømãrs_vÆue
 (
ssd_öfo
* 
ssd
,
ªque°
* 
√w_ªque°
);

139 
¥ötf_m≠pögèbÀ_ªÀv™t_subªque°_ö_dif„ª¡_¥o˚ss
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
);

140 
¥ötf_⁄e_ªque°_subªque°s
(
ssd_öfo
* 
ssd
, 
ªque°
*Ñequest);

141 
ã°_föish_dñëi⁄
(
ssd_öfo
* 
ssd
);

142 
gë_no_ª≥©_∑ges_numbî_‰om_Õns
(
ssd_öfo
* 
ssd
, 
ªque°
* 
ªq
,
_bi_li°
* 
ãmp_bûi°
, * 
öput
);

148 
åa˚_ouçut
(
ssd_öfo
 *);

150 
°©i°ic_ouçut
(
ssd_öfo
 *);

152 
size
();

154 
å™s„r_size
(
ssd_öfo
 *, , , 
ªque°
 *);

156 
öt64_t
 
föd_√¨e°_evít
(
ssd_öfo
 *);

158 
‰ì_Æl_node
(
ssd_öfo
 *);

160 
ssd_öfo
 *
make_aged
(ssd_info *);

162 
ssd_öfo
 *
no_buf„r_di°ribuã
(ssd_info *);

	@xmatchPro.h

1 #i‚de‡
_XMATCHPRO_H_


2 
	#_XMATCHPRO_H_


	)

5 
	~"di˘i⁄¨y.h
"

6 
	~"diffXm©ch.h
"

7 
	~"js_li°.h
"

9 
	#HEADER_LENGTH
 1

	)

11 
	#COMPLETE_MATCHED
 0

	)

12 
	#UNMATCHED
 15

	)

14 
	#MATCHED_HEADER
 1

	)

15 
	#UNMATCHED_HEADER
 0

	)

17 
	#NUM_BYTES_PER_TOKEN
 4

	)

18 
	#MATCHE_TYPE_LENGTH
 
NUM_BYTES_PER_TOKEN


	)

19 
	#NUM_BITS_PER_TOKEN
 
NUM_BYTES_PER_TOKEN
*8

	)

22 
	sxm©chC⁄ãxt


25 * 
	möput
;

26 * 
	mouçut
;

28 
	möputSize
;

30 
	mªadC¡
;

31 
	mwrôeC¡
;

33 
DICTIONARY
* 
	mdi˘i⁄¨y
;

35 
	mbôBuf„r
;

36 
	mnumVÆidBô
;

38 
	mª≥tôiveC¡
;

42 
xm©chCom¥ess
(* 
öput
, 
size
, * 
ouçut
);

43 
xm©chDecom¥ess
(* 
öput
, 
size
, * 
ouçut
);

44 
¸óãXm©chC⁄ãxt
–
xm©chC⁄ãxt
* 
compC⁄ãxt
,

45 * 
öput
,

46 
size
,

47 * 
ouçut
);

48 
de°royXm©chC⁄ãxt
–
xm©chC⁄ãxt
* xmatchContext);

49 
numM©ch
(
m©chTy≥
);

50 
com∑ª
(
vÆueA
, 
vÆueB
);

51 
upd©eDi˘i⁄¨y
–
öput
,

52 * 
ödex
,

53 
xm©chC⁄ãxt
* 
compC⁄ãxt
);

54 
ª°D©a
(
m©chTy≥
, 
√wE¡ry
);

55 
xm©chEncode
(
xm©chC⁄ãxt
* 
compC⁄ãxt
);

56 
wrôeToOuçut
–
numVÆidBôInD©a
,

57 
ícodedD©a
,

58 
xm©chC⁄ãxt
* 
compC⁄ãxt
);

60 
xm©chDecode
(
xm©chC⁄ãxt
* 
decompC⁄ãxt
, 
‹gSize
);

61 
ªadI≈ut
(
numBôsToRód
, 
xm©chC⁄ãxt
* 
decompC⁄ãxt
);

62 
gëOrgD©a
(
m©chTy≥
, 
ªfVÆue
, 
uniqueVÆue
);

63 
ªbuûdDi˘i⁄¨y
(
‹gD©a
, 
ödex
, 
m©chTy≥
, 
DICTIONARY
* 
di˘i⁄¨y
);

64 
¥ötfBö¨y
(
öput
);

	@/usr/include/alloca.h

18 #i‚def 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<„©uªs.h
>

23 
	#__√ed_size_t


	)

24 
	~<°ddef.h
>

26 
	g__BEGIN_DECLS


29 #unde‡
Æloˇ


32 *
	$Æloˇ
 (
size_t
 
__size
Ë
__THROW
;

34 #ifdef 
__GNUC__


35 
	#Æloˇ
(
size
Ë
	`__buûtö_Æloˇ
 (size)

	)

38 
__END_DECLS


	@/usr/include/endian.h

18 #i‚def 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<„©uªs.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<bôs/ídün.h
>

40 #i‚de‡
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_BSD


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËLO, 
	)
HI

53 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËHI, 
	)
LO

58 #i‡
deföed
 
__USE_BSD
 && !deföed 
__ASSEMBLER__


60 
	~<bôs/byãsw≠.h
>

62 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


63 
	#htobe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

64 
	#htﬁe16
(
x
Ë(x)

	)

65 
	#be16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

66 
	#À16toh
(
x
Ë(x)

	)

68 
	#htobe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

69 
	#htﬁe32
(
x
Ë(x)

	)

70 
	#be32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

71 
	#À32toh
(
x
Ë(x)

	)

73 
	#htobe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

74 
	#htﬁe64
(
x
Ë(x)

	)

75 
	#be64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

76 
	#À64toh
(
x
Ë(x)

	)

79 
	#htobe16
(
x
Ë(x)

	)

80 
	#htﬁe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

81 
	#be16toh
(
x
Ë(x)

	)

82 
	#À16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

84 
	#htobe32
(
x
Ë(x)

	)

85 
	#htﬁe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

86 
	#be32toh
(
x
Ë(x)

	)

87 
	#À32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

89 
	#htobe64
(
x
Ë(x)

	)

90 
	#htﬁe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

91 
	#be64toh
(
x
Ë(x)

	)

92 
	#À64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

	@/usr/include/features.h

18 #i‚def 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

101 #unde‡
__USE_ISOC11


102 #unde‡
__USE_ISOC99


103 #unde‡
__USE_ISOC95


104 #unde‡
__USE_ISOCXX11


105 #unde‡
__USE_POSIX


106 #unde‡
__USE_POSIX2


107 #unde‡
__USE_POSIX199309


108 #unde‡
__USE_POSIX199506


109 #unde‡
__USE_XOPEN


110 #unde‡
__USE_XOPEN_EXTENDED


111 #unde‡
__USE_UNIX98


112 #unde‡
__USE_XOPEN2K


113 #unde‡
__USE_XOPEN2KXSI


114 #unde‡
__USE_XOPEN2K8


115 #unde‡
__USE_XOPEN2K8XSI


116 #unde‡
__USE_LARGEFILE


117 #unde‡
__USE_LARGEFILE64


118 #unde‡
__USE_FILE_OFFSET64


119 #unde‡
__USE_BSD


120 #unde‡
__USE_SVID


121 #unde‡
__USE_MISC


122 #unde‡
__USE_ATFILE


123 #unde‡
__USE_GNU


124 #unde‡
__USE_REENTRANT


125 #unde‡
__USE_FORTIFY_LEVEL


126 #unde‡
__KERNEL_STRICT_NAMES


130 #i‚de‡
_LOOSE_KERNEL_NAMES


131 
	#__KERNEL_STRICT_NAMES


	)

141 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


142 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

143 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

145 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

150 #ifde‡
_GNU_SOURCE


151 #unde‡
_ISOC95_SOURCE


152 
	#_ISOC95_SOURCE
 1

	)

153 #unde‡
_ISOC99_SOURCE


154 
	#_ISOC99_SOURCE
 1

	)

155 #unde‡
_ISOC11_SOURCE


156 
	#_ISOC11_SOURCE
 1

	)

157 #unde‡
_POSIX_SOURCE


158 
	#_POSIX_SOURCE
 1

	)

159 #unde‡
_POSIX_C_SOURCE


160 
	#_POSIX_C_SOURCE
 200809L

	)

161 #unde‡
_XOPEN_SOURCE


162 
	#_XOPEN_SOURCE
 700

	)

163 #unde‡
_XOPEN_SOURCE_EXTENDED


164 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

165 #unde‡
_LARGEFILE64_SOURCE


166 
	#_LARGEFILE64_SOURCE
 1

	)

167 #unde‡
_DEFAULT_SOURCE


168 
	#_DEFAULT_SOURCE
 1

	)

169 #unde‡
_BSD_SOURCE


170 
	#_BSD_SOURCE
 1

	)

171 #unde‡
_SVID_SOURCE


172 
	#_SVID_SOURCE
 1

	)

173 #unde‡
_ATFILE_SOURCE


174 
	#_ATFILE_SOURCE
 1

	)

179 #i‡(
deföed
 
_DEFAULT_SOURCE
 \

180 || (!
deföed
 
	g__STRICT_ANSI__
 \

181 && !
deföed
 
	g_ISOC99_SOURCE
 \

182 && !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 \

183 && !
deföed
 
	g_XOPEN_SOURCE
 \

184 && !
deföed
 
	g_BSD_SOURCE
 && !deföed 
	g_SVID_SOURCE
))

185 #unde‡
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

187 #unde‡
_BSD_SOURCE


188 
	#_BSD_SOURCE
 1

	)

189 #unde‡
_SVID_SOURCE


190 
	#_SVID_SOURCE
 1

	)

194 #i‡(
deföed
 
_ISOC11_SOURCE
 \

195 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

196 
	#__USE_ISOC11
 1

	)

200 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

201 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

202 
	#__USE_ISOC99
 1

	)

206 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

207 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

208 
	#__USE_ISOC95
 1

	)

215 #i‡((
deföed
 
__˝lu•lus
 && __cplusplus >= 201103L) \

216 || 
deföed
 
__GXX_EXPERIMENTAL_CXX0X__
)

217 
	#__USE_ISOCXX11
 1

	)

223 #ifde‡
_DEFAULT_SOURCE


224 #i‡!
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE


225 
	#__USE_POSIX_IMPLICITLY
 1

	)

227 #unde‡
_POSIX_SOURCE


228 
	#_POSIX_SOURCE
 1

	)

229 #unde‡
_POSIX_C_SOURCE


230 
	#_POSIX_C_SOURCE
 200809L

	)

232 #i‡((!
deföed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

233 !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

234 
	#_POSIX_SOURCE
 1

	)

235 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

236 
	#_POSIX_C_SOURCE
 2

	)

237 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

238 
	#_POSIX_C_SOURCE
 199506L

	)

239 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

240 
	#_POSIX_C_SOURCE
 200112L

	)

242 
	#_POSIX_C_SOURCE
 200809L

	)

244 
	#__USE_POSIX_IMPLICITLY
 1

	)

247 #i‡
deföed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >1 || deföed 
_XOPEN_SOURCE


248 
	#__USE_POSIX
 1

	)

251 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


252 
	#__USE_POSIX2
 1

	)

255 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199309L

256 
	#__USE_POSIX199309
 1

	)

259 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199506L

260 
	#__USE_POSIX199506
 1

	)

263 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200112L

264 
	#__USE_XOPEN2K
 1

	)

265 #unde‡
__USE_ISOC95


266 
	#__USE_ISOC95
 1

	)

267 #unde‡
__USE_ISOC99


268 
	#__USE_ISOC99
 1

	)

271 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200809L

272 
	#__USE_XOPEN2K8
 1

	)

273 #unde‡
_ATFILE_SOURCE


274 
	#_ATFILE_SOURCE
 1

	)

277 #ifdef 
_XOPEN_SOURCE


278 
	#__USE_XOPEN
 1

	)

279 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

280 
	#__USE_XOPEN_EXTENDED
 1

	)

281 
	#__USE_UNIX98
 1

	)

282 #unde‡
_LARGEFILE_SOURCE


283 
	#_LARGEFILE_SOURCE
 1

	)

284 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

285 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

286 
	#__USE_XOPEN2K8
 1

	)

287 
	#__USE_XOPEN2K8XSI
 1

	)

289 
	#__USE_XOPEN2K
 1

	)

290 
	#__USE_XOPEN2KXSI
 1

	)

291 #unde‡
__USE_ISOC95


292 
	#__USE_ISOC95
 1

	)

293 #unde‡
__USE_ISOC99


294 
	#__USE_ISOC99
 1

	)

297 #ifde‡
_XOPEN_SOURCE_EXTENDED


298 
	#__USE_XOPEN_EXTENDED
 1

	)

303 #ifde‡
_LARGEFILE_SOURCE


304 
	#__USE_LARGEFILE
 1

	)

307 #ifde‡
_LARGEFILE64_SOURCE


308 
	#__USE_LARGEFILE64
 1

	)

311 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

312 
	#__USE_FILE_OFFSET64
 1

	)

315 #i‡
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE


316 
	#__USE_MISC
 1

	)

319 #ifdef 
_BSD_SOURCE


320 
	#__USE_BSD
 1

	)

323 #ifdef 
_SVID_SOURCE


324 
	#__USE_SVID
 1

	)

327 #ifdef 
_ATFILE_SOURCE


328 
	#__USE_ATFILE
 1

	)

331 #ifdef 
_GNU_SOURCE


332 
	#__USE_GNU
 1

	)

335 #i‡
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE


336 
	#__USE_REENTRANT
 1

	)

339 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

340 && 
__GNUC_PREREQ
 (4, 1Ë&& 
deföed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

341 #i‡
_FORTIFY_SOURCE
 > 1

342 
	#__USE_FORTIFY_LEVEL
 2

	)

344 
	#__USE_FORTIFY_LEVEL
 1

	)

347 
	#__USE_FORTIFY_LEVEL
 0

	)

352 
	~<°dc-¥edef.h
>

360 #unde‡
__GNU_LIBRARY__


361 
	#__GNU_LIBRARY__
 6

	)

365 
	#__GLIBC__
 2

	)

366 
	#__GLIBC_MINOR__
 19

	)

368 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

369 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

372 #i‚de‡
__ASSEMBLER__


373 #i‚de‡
_SYS_CDEFS_H


374 
	~<sys/cdefs.h
>

379 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


380 
	#__USE_LARGEFILE
 1

	)

381 
	#__USE_LARGEFILE64
 1

	)

387 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

388 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

389 && 
deföed
 
	g__exã∫_ölöe


390 
	#__USE_EXTERN_INLINES
 1

	)

398 
	~<gnu/°ubs.h
>

	@/usr/include/getopt.h

19 #i‚de‡
_GETOPT_H


21 #i‚de‡
__√ed_gë›t


22 
	#_GETOPT_H
 1

	)

32 #i‡!
deföed
 
__GNU_LIBRARY__


33 
	~<˘y≥.h
>

36 #i‚de‡
__THROW


37 #i‚de‡
__GNUC_PREREQ


38 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë(0)

	)

40 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

41 
	#__THROW
 
	`throw
 ()

	)

43 
	#__THROW


	)

47 #ifdef 
__˝lu•lus


57 *
›èrg
;

71 
›töd
;

76 
›ãº
;

80 
›t›t
;

82 #i‚de‡
__√ed_gë›t


104 
	s›ti⁄


106 c⁄° *
	g«me
;

109 
	ghas_¨g
;

110 *
	gÊag
;

111 
	gvÆ
;

116 
	#no_¨gumít
 0

	)

117 
	#ªquúed_¨gumít
 1

	)

118 
	#›ti⁄Æ_¨gumít
 2

	)

146 #ifde‡
__GNU_LIBRARY__


150 
gë›t
 (
___¨gc
, *c⁄° *
___¨gv
, c⁄° *
__sh‹t›ts
)

151 
__THROW
;

153 #i‡
deföed
 
__√ed_gë›t
 && deföed 
__USE_POSIX2
 \

154 && !
deföed
 
	g__USE_POSIX_IMPLICITLY
 && !deföed 
	g__USE_GNU


158 #ifde‡
__REDIRECT


159 
__REDIRECT_NTH
 (
gë›t
, (
___¨gc
, *c⁄° *
___¨gv
,

160 c⁄° *
__sh‹t›ts
),

161 
__posix_gë›t
);

163 
__posix_gë›t
 (
___¨gc
, *c⁄° *
___¨gv
,

164 c⁄° *
__sh‹t›ts
Ë
__THROW
;

165 
	#gë›t
 
__posix_gë›t


	)

169 
gë›t
 ();

172 #i‚de‡
__√ed_gë›t


173 
gë›t_l⁄g
 (
___¨gc
, *c⁄° *
___¨gv
,

174 c⁄° *
__sh‹t›ts
,

175 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

176 
__THROW
;

177 
gë›t_l⁄g_⁄ly
 (
___¨gc
, *c⁄° *
___¨gv
,

178 c⁄° *
__sh‹t›ts
,

179 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

180 
__THROW
;

184 #ifdef 
__˝lu•lus


189 #unde‡
__√ed_gë›t


	@/usr/include/libio.h

28 #i‚de‡
_IO_STDIO_H


29 
	#_IO_STDIO_H


	)

31 
	~<_G_c⁄fig.h
>

33 
	#_IO_Âos_t
 
_G_Âos_t


	)

34 
	#_IO_Âos64_t
 
_G_Âos64_t


	)

35 
	#_IO_size_t
 
size_t


	)

36 
	#_IO_ssize_t
 
__ssize_t


	)

37 
	#_IO_off_t
 
__off_t


	)

38 
	#_IO_off64_t
 
__off64_t


	)

39 
	#_IO_pid_t
 
__pid_t


	)

40 
	#_IO_uid_t
 
__uid_t


	)

41 
	#_IO_ic⁄v_t
 
_G_ic⁄v_t


	)

42 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

43 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

44 
	#_IO_va_li°
 
_G_va_li°


	)

45 
	#_IO_wöt_t
 
wöt_t


	)

48 
	#__√ed___va_li°


	)

49 
	~<°d¨g.h
>

50 #ifde‡
__GNUC_VA_LIST


51 #unde‡
_IO_va_li°


52 
	#_IO_va_li°
 
__gnuc_va_li°


	)

55 #i‚de‡
__P


56 
	~<sys/cdefs.h
>

59 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

61 #i‚de‡
EOF


62 
	#EOF
 (-1)

	)

64 #i‚de‡
NULL


65 #i‡
deföed
 
__GNUG__
 && \

66 (
	g__GNUC__
 > 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 >= 8))

67 
	#NULL
 (
__nuŒ
)

	)

69 #i‡!
deföed
(
__˝lu•lus
)

70 
	#NULL
 ((*)0)

	)

72 
	#NULL
 (0)

	)

77 
	#_IOS_INPUT
 1

	)

78 
	#_IOS_OUTPUT
 2

	)

79 
	#_IOS_ATEND
 4

	)

80 
	#_IOS_APPEND
 8

	)

81 
	#_IOS_TRUNC
 16

	)

82 
	#_IOS_NOCREATE
 32

	)

83 
	#_IOS_NOREPLACE
 64

	)

84 
	#_IOS_BIN
 128

	)

92 
	#_IO_MAGIC
 0xFBAD0000

	)

93 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

94 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

95 
	#_IO_USER_BUF
 1

	)

96 
	#_IO_UNBUFFERED
 2

	)

97 
	#_IO_NO_READS
 4

	)

98 
	#_IO_NO_WRITES
 8

	)

99 
	#_IO_EOF_SEEN
 0x10

	)

100 
	#_IO_ERR_SEEN
 0x20

	)

101 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

102 
	#_IO_LINKED
 0x80

	)

103 
	#_IO_IN_BACKUP
 0x100

	)

104 
	#_IO_LINE_BUF
 0x200

	)

105 
	#_IO_TIED_PUT_GET
 0x400

	)

106 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

107 
	#_IO_IS_APPENDING
 0x1000

	)

108 
	#_IO_IS_FILEBUF
 0x2000

	)

109 
	#_IO_BAD_SEEN
 0x4000

	)

110 
	#_IO_USER_LOCK
 0x8000

	)

112 
	#_IO_FLAGS2_MMAP
 1

	)

113 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

114 #ifde‡
_LIBC


115 
	#_IO_FLAGS2_FORTIFY
 4

	)

117 
	#_IO_FLAGS2_USER_WBUF
 8

	)

118 #ifde‡
_LIBC


119 
	#_IO_FLAGS2_SCANF_STD
 16

	)

120 
	#_IO_FLAGS2_NOCLOSE
 32

	)

121 
	#_IO_FLAGS2_CLOEXEC
 64

	)

125 
	#_IO_SKIPWS
 01

	)

126 
	#_IO_LEFT
 02

	)

127 
	#_IO_RIGHT
 04

	)

128 
	#_IO_INTERNAL
 010

	)

129 
	#_IO_DEC
 020

	)

130 
	#_IO_OCT
 040

	)

131 
	#_IO_HEX
 0100

	)

132 
	#_IO_SHOWBASE
 0200

	)

133 
	#_IO_SHOWPOINT
 0400

	)

134 
	#_IO_UPPERCASE
 01000

	)

135 
	#_IO_SHOWPOS
 02000

	)

136 
	#_IO_SCIENTIFIC
 04000

	)

137 
	#_IO_FIXED
 010000

	)

138 
	#_IO_UNITBUF
 020000

	)

139 
	#_IO_STDIO
 040000

	)

140 
	#_IO_DONT_CLOSE
 0100000

	)

141 
	#_IO_BOOLALPHA
 0200000

	)

144 
_IO_jump_t
; 
	g_IO_FILE
;

147 #ifde‡
_IO_MTSAFE_IO


148 #i‡
deföed
 
__GLIBC__
 && __GLIBC__ >= 2

149 
	~<bôs/°dio-lock.h
>

154 
	t_IO_lock_t
;

160 
	s_IO_m¨kî
 {

161 
_IO_m¨kî
 *
	m_√xt
;

162 
_IO_FILE
 *
	m_sbuf
;

166 
	m_pos
;

168 
£t_°ªampos
(
°ªampos
 
•
Ë{ 
	m_•os
 = sp; }

169 
£t_off£t
(
off£t
Ë{ 
	m_pos
 = off£t; 
	m_•os
 = (
°ªampos
)(-2); }

170 
	mpublic
:

171 
°ªamm¨kî
(
°ªambuf
 *
sb
);

172 ~
°ªamm¨kî
();

173 
ßvög
(Ë{  
	m_•os
 == -2; }

174 
dñè
(
°ªamm¨kî
&);

175 
dñè
();

180 
	e__codecvt_ªsu…


182 
	m__codecvt_ok
,

183 
	m__codecvt_∑πül
,

184 
	m__codecvt_îr‹
,

185 
	m__codecvt_noc⁄v


188 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


191 
	s_IO_codecvt


193 (*
	m__codecvt_de°r
Ë(
	m_IO_codecvt
 *);

194 
__codecvt_ªsu…
 (*
__codecvt_do_out
Ë(
	m_IO_codecvt
 *,

195 
	m__mb°©e_t
 *,

196 c⁄° 
	mwch¨_t
 *,

197 c⁄° 
	mwch¨_t
 *,

198 c⁄° 
	mwch¨_t
 **, *,

200 
__codecvt_ªsu…
 (*
__codecvt_do_unshi·
Ë(
	m_IO_codecvt
 *,

201 
	m__mb°©e_t
 *, *,

203 
__codecvt_ªsu…
 (*
__codecvt_do_ö
Ë(
	m_IO_codecvt
 *,

204 
	m__mb°©e_t
 *,

206 c⁄° **, 
	mwch¨_t
 *,

207 
	mwch¨_t
 *, wchar_t **);

208 (*
	m__codecvt_do_ícodög
Ë(
	m_IO_codecvt
 *);

209 (*
	m__codecvt_do_Æways_noc⁄v
Ë(
	m_IO_codecvt
 *);

210 (*
	m__codecvt_do_Àngth
Ë(
	m_IO_codecvt
 *, 
	m__mb°©e_t
 *,

211 c⁄° *, c⁄° *, 
	m_IO_size_t
);

212 (*
	m__codecvt_do_max_Àngth
Ë(
	m_IO_codecvt
 *);

214 
_IO_ic⁄v_t
 
	m__cd_ö
;

215 
_IO_ic⁄v_t
 
	m__cd_out
;

219 
	s_IO_wide_d©a


221 
wch¨_t
 *
	m_IO_ªad_±r
;

222 
wch¨_t
 *
	m_IO_ªad_íd
;

223 
wch¨_t
 *
	m_IO_ªad_ba£
;

224 
wch¨_t
 *
	m_IO_wrôe_ba£
;

225 
wch¨_t
 *
	m_IO_wrôe_±r
;

226 
wch¨_t
 *
	m_IO_wrôe_íd
;

227 
wch¨_t
 *
	m_IO_buf_ba£
;

228 
wch¨_t
 *
	m_IO_buf_íd
;

230 
wch¨_t
 *
	m_IO_ßve_ba£
;

231 
wch¨_t
 *
	m_IO_backup_ba£
;

233 
wch¨_t
 *
	m_IO_ßve_íd
;

235 
__mb°©e_t
 
	m_IO_°©e
;

236 
__mb°©e_t
 
	m_IO_œ°_°©e
;

237 
_IO_codecvt
 
	m_codecvt
;

239 
wch¨_t
 
	m_sh‹tbuf
[1];

241 c⁄° 
_IO_jump_t
 *
	m_wide_vèbÀ
;

245 
	s_IO_FILE
 {

246 
	m_Êags
;

247 
	#_IO_fûe_Êags
 
_Êags


	)

251 * 
	m_IO_ªad_±r
;

252 * 
	m_IO_ªad_íd
;

253 * 
	m_IO_ªad_ba£
;

254 * 
	m_IO_wrôe_ba£
;

255 * 
	m_IO_wrôe_±r
;

256 * 
	m_IO_wrôe_íd
;

257 * 
	m_IO_buf_ba£
;

258 * 
	m_IO_buf_íd
;

260 *
	m_IO_ßve_ba£
;

261 *
	m_IO_backup_ba£
;

262 *
	m_IO_ßve_íd
;

264 
_IO_m¨kî
 *
	m_m¨kîs
;

266 
_IO_FILE
 *
	m_chaö
;

268 
	m_fûío
;

270 
	m_blksize
;

272 
	m_Êags2
;

274 
_IO_off_t
 
	m_ﬁd_off£t
;

276 
	#__HAVE_COLUMN


	)

278 
	m_cur_cﬁumn
;

279 sig√d 
	m_vèbÀ_off£t
;

280 
	m_sh‹tbuf
[1];

284 
_IO_lock_t
 *
	m_lock
;

285 #ifde‡
_IO_USE_OLD_IO_FILE


288 
	s_IO_FILE_com∂ëe


290 
_IO_FILE
 
	m_fûe
;

292 #i‡
deföed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

293 
_IO_off64_t
 
	m_off£t
;

294 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


296 
_IO_codecvt
 *
	m_codecvt
;

297 
_IO_wide_d©a
 *
	m_wide_d©a
;

298 
_IO_FILE
 *
	m_‰ìªs_li°
;

299 *
	m_‰ìªs_buf
;

300 
size_t
 
	m_‰ìªs_size
;

302 *
	m__∑d1
;

303 *
	m__∑d2
;

304 *
	m__∑d3
;

305 *
	m__∑d4
;

306 
size_t
 
	m__∑d5
;

308 
	m_mode
;

310 
	m_unu£d2
[15 *  (Ë- 4 *  (*Ë-  (
size_t
)];

314 #i‚de‡
__˝lu•lus


315 
_IO_FILE
 
	t_IO_FILE
;

318 
	g_IO_FILE_∂us
;

320 
_IO_FILE_∂us
 
_IO_2_1_°dö_
;

321 
_IO_FILE_∂us
 
_IO_2_1_°dout_
;

322 
_IO_FILE_∂us
 
_IO_2_1_°dîr_
;

323 #i‚de‡
_LIBC


324 
	#_IO_°dö
 ((
_IO_FILE
*)(&
_IO_2_1_°dö_
))

	)

325 
	#_IO_°dout
 ((
_IO_FILE
*)(&
_IO_2_1_°dout_
))

	)

326 
	#_IO_°dîr
 ((
_IO_FILE
*)(&
_IO_2_1_°dîr_
))

	)

328 
_IO_FILE
 *
_IO_°dö
 
©åibuã_hiddí
;

329 
_IO_FILE
 *
_IO_°dout
 
©åibuã_hiddí
;

330 
_IO_FILE
 *
_IO_°dîr
 
©åibuã_hiddí
;

338 
__ssize_t
 
	t__io_ªad_‚
 (*
	t__cookõ
, *
	t__buf
, 
	tsize_t
 
	t__nbyãs
);

346 
__ssize_t
 
	t__io_wrôe_‚
 (*
	t__cookõ
, c⁄° *
	t__buf
,

347 
	tsize_t
 
	t__n
);

355 
	t__io_£ek_‚
 (*
	t__cookõ
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

358 
	t__io_˛o£_‚
 (*
	t__cookõ
);

361 #ifde‡
_GNU_SOURCE


363 
__io_ªad_‚
 
	tcookõ_ªad_fun˘i⁄_t
;

364 
__io_wrôe_‚
 
	tcookõ_wrôe_fun˘i⁄_t
;

365 
__io_£ek_‚
 
	tcookõ_£ek_fun˘i⁄_t
;

366 
__io_˛o£_‚
 
	tcookõ_˛o£_fun˘i⁄_t
;

371 
__io_ªad_‚
 *
	mªad
;

372 
__io_wrôe_‚
 *
	mwrôe
;

373 
__io_£ek_‚
 *
	m£ek
;

374 
__io_˛o£_‚
 *
	m˛o£
;

375 } 
	t_IO_cookõ_io_fun˘i⁄s_t
;

376 
_IO_cookõ_io_fun˘i⁄s_t
 
	tcookõ_io_fun˘i⁄s_t
;

378 
	g_IO_cookõ_fûe
;

381 
_IO_cookõ_öô
 (
_IO_cookõ_fûe
 *
__cfûe
, 
__ªad_wrôe
,

382 *
__cookõ
, 
_IO_cookõ_io_fun˘i⁄s_t
 
__‚s
);

386 #ifde‡
__˝lu•lus


390 
__undîÊow
 (
_IO_FILE
 *);

391 
__uÊow
 (
_IO_FILE
 *);

392 
__ovîÊow
 (
_IO_FILE
 *, );

393 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


394 
_IO_wöt_t
 
__wundîÊow
 (
_IO_FILE
 *);

395 
_IO_wöt_t
 
__wuÊow
 (
_IO_FILE
 *);

396 
_IO_wöt_t
 
__wovîÊow
 (
_IO_FILE
 *, _IO_wint_t);

399 #i‡ 
__GNUC__
 >= 3

400 
	#_IO_BE
(
ex¥
, 
ªs
Ë
	`__buûtö_ex≥˘
 (”x¥),Ñes)

	)

402 
	#_IO_BE
(
ex¥
, 
ªs
Ë”x¥)

	)

405 
	#_IO_gëc_u∆ocked
(
_Â
) \

406 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

407 ? 
	`__uÊow
 (
_Â
Ë: *(*Ë(_Â)->
_IO_ªad_±r
++)

	)

408 
	#_IO_≥ekc_u∆ocked
(
_Â
) \

409 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

410 && 
	`__undîÊow
 (
_Â
Ë=
EOF
 ? EOF \

411 : *(*Ë(
_Â
)->
_IO_ªad_±r
)

	)

412 
	#_IO_putc_u∆ocked
(
_ch
, 
_Â
) \

413 (
	`_IO_BE
 ((
_Â
)->
_IO_wrôe_±r
 >(_Â)->
_IO_wrôe_íd
, 0) \

414 ? 
	`__ovîÊow
 (
_Â
, (Ë(
_ch
)) \

415 : (Ë(*(
_Â
)->
_IO_wrôe_±r
++ = (
_ch
)))

	)

417 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


418 
	#_IO_gëwc_u∆ocked
(
_Â
) \

419 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

420 || ((
_Â
)->
_wide_d©a
->
_IO_ªad_±r
 \

421 >(
_Â
)->
_wide_d©a
->
_IO_ªad_íd
), 0) \

422 ? 
	`__wuÊow
 (
_Â
Ë: (
_IO_wöt_t
Ë*(_Â)->
_wide_d©a
->
_IO_ªad_±r
++)

	)

423 
	#_IO_putwc_u∆ocked
(
_wch
, 
_Â
) \

424 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

425 || ((
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
 \

426 >(
_Â
)->
_wide_d©a
->
_IO_wrôe_íd
), 0) \

427 ? 
	`__wovîÊow
 (
_Â
, 
_wch
) \

428 : (
_IO_wöt_t
Ë(*(
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
++ = (
_wch
)))

	)

431 
	#_IO_„of_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_EOF_SEEN
Ë!0)

	)

432 
	#_IO_„º‹_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_ERR_SEEN
Ë!0)

	)

434 
_IO_gëc
 (
_IO_FILE
 *
__Â
);

435 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__Â
);

436 
_IO_„of
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

437 
_IO_„º‹
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

439 
_IO_≥ekc_locked
 (
_IO_FILE
 *
__Â
);

442 
	#_IO_PENDING_OUTPUT_COUNT
(
_Â
) \

443 ((
_Â
)->
_IO_wrôe_±r
 - (_Â)->
_IO_wrôe_ba£
)

	)

445 
_IO_Êockfûe
 (
_IO_FILE
 *Ë
__THROW
;

446 
_IO_fu∆ockfûe
 (
_IO_FILE
 *Ë
__THROW
;

447 
_IO_·rylockfûe
 (
_IO_FILE
 *Ë
__THROW
;

449 #ifde‡
_IO_MTSAFE_IO


450 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_locked
 (_Â)

	)

451 
	#_IO_Êockfûe
(
_Â
) \

452 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_Êockfûe
 (_Â)

	)

453 
	#_IO_fu∆ockfûe
(
_Â
) \

454 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_fu∆ockfûe
 (_Â)

	)

456 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_u∆ocked
 (_Â)

	)

457 
	#_IO_Êockfûe
(
_Â
Ë

	)

458 
	#_IO_fu∆ockfûe
(
_Â
Ë

	)

459 
	#_IO_·rylockfûe
(
_Â
Ë

	)

460 
	#_IO_˛ónup_ªgi⁄_°¨t
(
_f˘
, 
_Â
Ë

	)

461 
	#_IO_˛ónup_ªgi⁄_íd
(
_Doô
Ë

	)

464 
_IO_vfsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, const * __restrict,

465 
_IO_va_li°
, *
__ª°ri˘
);

466 
_IO_vÂrötf
 (
_IO_FILE
 *
__ª°ri˘
, const *__restrict,

467 
_IO_va_li°
);

468 
_IO_ssize_t
 
_IO_∑dn
 (
_IO_FILE
 *, , _IO_ssize_t);

469 
_IO_size_t
 
_IO_sgën
 (
_IO_FILE
 *, *, _IO_size_t);

471 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

472 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

474 
_IO_‰ì_backup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

476 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


477 
_IO_wöt_t
 
_IO_gëwc
 (
_IO_FILE
 *
__Â
);

478 
_IO_wöt_t
 
_IO_putwc
 (
wch¨_t
 
__wc
, 
_IO_FILE
 *
__Â
);

479 
_IO_fwide
 (
_IO_FILE
 *
__Â
, 
__mode
Ë
__THROW
;

480 #i‡
__GNUC__
 >= 2

483 #i‡
deföed
 
_LIBC
 && deföed 
SHARED


484 
	~<shlib-com∑t.h
>

485 #i‡
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

486 
	#_IO_fwide_maybe_öcom∑tibÀ
 \

487 (
	`__buûtö_ex≥˘
 (&
_IO_°dö_u£d
 =
NULL
, 0))

	)

488 c⁄° 
_IO_°dö_u£d
;

489 
wók_exã∫
 (
_IO_°dö_u£d
);

492 #i‚de‡
_IO_fwide_maybe_öcom∑tibÀ


493 
	#_IO_fwide_maybe_öcom∑tibÀ
 (0)

	)

497 
	#_IO_fwide
(
__Â
, 
__mode
) \

498 ({ 
__ªsu…
 = (
__mode
); \

499 i‡(
__ªsu…
 < 0 && ! 
_IO_fwide_maybe_öcom∑tibÀ
) \

501 i‡((
__Â
)->
_mode
 == 0) \

503 (
__Â
)->
_mode
 = -1; \

504 
__ªsu…
 = (
__Â
)->
_mode
; \

506 i‡(
	`__buûtö_c⁄°™t_p
 (
__mode
) && (__mode) == 0) \

507 
__ªsu…
 = 
_IO_fwide_maybe_öcom∑tibÀ
 ? -1 : (
__Â
)->
_mode
; \

509 
__ªsu…
 = 
	`_IO_fwide
 (
__Â
, __result); \

510 
__ªsu…
; })

	)

513 
_IO_vfwsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, c⁄° 
wch¨_t
 * __restrict,

514 
_IO_va_li°
, *
__ª°ri˘
);

515 
_IO_vfw¥ötf
 (
_IO_FILE
 *
__ª°ri˘
, c⁄° 
wch¨_t
 *__restrict,

516 
_IO_va_li°
);

517 
_IO_ssize_t
 
_IO_w∑dn
 (
_IO_FILE
 *, 
wöt_t
, _IO_ssize_t);

518 
_IO_‰ì_wbackup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

521 #ifde‡
__LDBL_COMPAT


522 
	~<bôs/libio-ldbl.h
>

525 #ifde‡
__˝lu•lus


	@/usr/include/xlocale.h

20 #i‚de‡
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loˇÀ_°ru˘


30 
__loˇÀ_d©a
 *
	m__loˇÀs
[13];

33 c⁄° *
	m__˘y≥_b
;

34 c⁄° *
	m__˘y≥_tﬁowî
;

35 c⁄° *
	m__˘y≥_touµî
;

38 c⁄° *
	m__«mes
[13];

39 } *
	t__loˇÀ_t
;

42 
__loˇÀ_t
 
	tloˇÀ_t
;

	@/usr/include/_G_config.h

4 #i‚de‡
_G_c⁄fig_h


5 
	#_G_c⁄fig_h
 1

	)

9 
	~<bôs/ty≥s.h
>

10 
	#__√ed_size_t


	)

11 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


12 
	#__√ed_wch¨_t


	)

14 
	#__√ed_NULL


	)

15 
	~<°ddef.h
>

16 
	#__√ed_mb°©e_t


	)

17 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


18 
	#__√ed_wöt_t


	)

20 
	~<wch¨.h
>

23 
__off_t
 
	m__pos
;

24 
__mb°©e_t
 
	m__°©e
;

25 } 
	t_G_Âos_t
;

28 
__off64_t
 
	m__pos
;

29 
__mb°©e_t
 
	m__°©e
;

30 } 
	t_G_Âos64_t
;

31 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


32 
	~<gc⁄v.h
>

35 
__gc⁄v_öfo
 
	m__cd
;

38 
__gc⁄v_öfo
 
	m__cd
;

39 
__gc⁄v_°ï_d©a
 
	m__d©a
;

40 } 
	m__comböed
;

41 } 
	t_G_ic⁄v_t
;

46 
	#_G_va_li°
 
__gnuc_va_li°


	)

48 
	#_G_HAVE_MMAP
 1

	)

49 
	#_G_HAVE_MREMAP
 1

	)

51 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

54 
	#_G_HAVE_ST_BLKSIZE
 
	`deföed
 (
_STATBUF_ST_BLKSIZE
)

	)

56 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/stdc-predef.h

18 #i‚def 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifde‡
__GCC_IEC_559


37 #i‡
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifde‡
__GCC_IEC_559_COMPLEX


45 #i‡
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

54 
	#__STDC_ISO_10646__
 201103L

	)

57 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/gconv.h

22 #i‚de‡
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<„©uªs.h
>

26 
	#__√ed_mb°©e_t


	)

27 
	#__√ed_wöt_t


	)

28 
	~<wch¨.h
>

29 
	#__√ed_size_t


	)

30 
	#__√ed_wch¨_t


	)

31 
	~<°ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¨_t
Ë0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004

64 
	g__gc⁄v_°ï
;

65 
	g__gc⁄v_°ï_d©a
;

66 
	g__gc⁄v_lﬂded_obje˘
;

67 
	g__gc⁄v_å™s_d©a
;

71 (*
	t__gc⁄v_f˘
Ë(
	t__gc⁄v_°ï
 *, 
	t__gc⁄v_°ï_d©a
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wöt_t
 (*
	t__gc⁄v_btowc_f˘
Ë(
	t__gc⁄v_°ï
 *, );

79 (*
	t__gc⁄v_öô_f˘
Ë(
	t__gc⁄v_°ï
 *);

80 (*
	t__gc⁄v_íd_f˘
Ë(
	t__gc⁄v_°ï
 *);

84 (*
	t__gc⁄v_å™s_f˘
Ë(
	t__gc⁄v_°ï
 *,

85 
	t__gc⁄v_°ï_d©a
 *, *,

89 
	tsize_t
 *);

92 (*
	t__gc⁄v_å™s_c⁄ãxt_f˘
) (*, const *,

97 (*
	t__gc⁄v_å™s_quîy_f˘
) (const *, const ***,

98 
	tsize_t
 *);

101 (*
	t__gc⁄v_å™s_öô_f˘
) (**, const *);

102 (*
	t__gc⁄v_å™s_íd_f˘
) (*);

104 
	s__gc⁄v_å™s_d©a


107 
__gc⁄v_å™s_f˘
 
__å™s_f˘
;

108 
__gc⁄v_å™s_c⁄ãxt_f˘
 
__å™s_c⁄ãxt_f˘
;

109 
__gc⁄v_å™s_íd_f˘
 
__å™s_íd_f˘
;

110 *
__d©a
;

111 
__gc⁄v_å™s_d©a
 *
__√xt
;

116 
	s__gc⁄v_°ï


118 
__gc⁄v_lﬂded_obje˘
 *
__shlib_h™dÀ
;

119 c⁄° *
__mod«me
;

121 
__cou¡î
;

123 *
__‰om_«me
;

124 *
__to_«me
;

126 
__gc⁄v_f˘
 
__f˘
;

127 
__gc⁄v_btowc_f˘
 
__btowc_f˘
;

128 
__gc⁄v_öô_f˘
 
__öô_f˘
;

129 
__gc⁄v_íd_f˘
 
__íd_f˘
;

133 
__mö_√eded_‰om
;

134 
__max_√eded_‰om
;

135 
__mö_√eded_to
;

136 
__max_√eded_to
;

139 
__°©eful
;

141 *
__d©a
;

146 
	s__gc⁄v_°ï_d©a


148 *
__outbuf
;

149 *
__outbu„nd
;

153 
__Êags
;

157 
__övoˇti⁄_cou¡î
;

161 
__öã∫Æ_u£
;

163 
__mb°©e_t
 *
__°©ï
;

164 
__mb°©e_t
 
__°©e
;

168 
__gc⁄v_å™s_d©a
 *
__å™s
;

173 
	s__gc⁄v_öfo


175 
size_t
 
__n°ïs
;

176 
__gc⁄v_°ï
 *
__°ïs
;

177 
__exãnsi⁄__
 
__gc⁄v_°ï_d©a
 
__d©a
 
__Êex¨r
;

178 } *
	t__gc⁄v_t
;

	@/usr/include/wchar.h

23 #i‚de‡
_WCHAR_H


25 #i‡!
deföed
 
__√ed_mb°©e_t
 && !deföed 
__√ed_wöt_t


26 
	#_WCHAR_H
 1

	)

27 
	~<„©uªs.h
>

30 #ifde‡
_WCHAR_H


32 
	#__√ed___FILE


	)

33 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


34 
	#__√ed_FILE


	)

36 
	~<°dio.h
>

38 
	#__√ed___va_li°


	)

39 
	~<°d¨g.h
>

41 
	~<bôs/wch¨.h
>

44 
	#__√ed_size_t


	)

45 
	#__√ed_wch¨_t


	)

46 
	#__√ed_NULL


	)

48 #i‡
deföed
 
_WCHAR_H
 || deföed 
__√ed_wöt_t
 || !deföed 
__WINT_TYPE__


49 #unde‡
__√ed_wöt_t


50 
	#__√ed_wöt_t


	)

51 
	~<°ddef.h
>

55 #i‚de‡
_WINT_T


60 
	#_WINT_T


	)

61 
	twöt_t
;

65 #i‡
deföed
 
__˝lu•lus
 && deföed 
_GLIBCPP_USE_NAMESPACES
 \

66 && 
deföed
 
__WINT_TYPE__


67 
__BEGIN_NAMESPACE_STD


68 
__WINT_TYPE__
 
	twöt_t
;

69 
	g__END_NAMESPACE_STD


74 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

75 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

79 #i‡(
deföed
 
_WCHAR_H
 || deföed 
__√ed_mb°©e_t
Ë&& !deföed 
____mb°©e_t_deföed


80 
	#____mb°©e_t_deföed
 1

	)

84 
	m__cou¡
;

87 #ifde‡
__WINT_TYPE__


88 
__WINT_TYPE__
 
	m__wch
;

90 
wöt_t
 
	m__wch
;

92 
	m__wchb
[4];

93 } 
	m__vÆue
;

94 } 
	t__mb°©e_t
;

96 #unde‡
__√ed_mb°©e_t


101 #ifde‡
_WCHAR_H


103 #i‚de‡
__mb°©e_t_deföed


104 
__BEGIN_NAMESPACE_C99


106 
__mb°©e_t
 
	tmb°©e_t
;

107 
	g__END_NAMESPACE_C99


108 
	#__mb°©e_t_deföed
 1

	)

111 #ifde‡
__USE_GNU


112 
	$__USING_NAMESPACE_C99
(
mb°©e_t
)

115 #i‚de‡
WCHAR_MIN


117 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

118 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

121 #i‚de‡
WEOF


122 
	#WEOF
 (0xffffffffu)

	)

127 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_UNIX98


128 
	~<w˘y≥.h
>

132 
__BEGIN_DECLS


134 
__BEGIN_NAMESPACE_STD


137 
tm
;

138 
__END_NAMESPACE_STD


142 
	$__USING_NAMESPACE_STD
(
tm
)

145 
__BEGIN_NAMESPACE_STD


147 
wch¨_t
 *
	$wcs˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

148 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

150 
wch¨_t
 *
	$wc¢˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

151 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

152 
__THROW
;

155 
wch¨_t
 *
	$wcsˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

156 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

158 
wch¨_t
 *
	$wc¢ˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

159 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

160 
__THROW
;

163 
	$wcscmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
)

164 
__THROW
 
__©åibuã_puª__
;

166 
	$wc¢cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

167 
__THROW
 
__©åibuã_puª__
;

168 
__END_NAMESPACE_STD


170 #ifde‡
__USE_XOPEN2K8


172 
	$wcsˇ£cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
Ë
__THROW
;

175 
	$wc¢ˇ£cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

176 
size_t
 
__n
Ë
__THROW
;

180 
	~<xloˇÀ.h
>

182 
	$wcsˇ£cmp_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

183 
__loˇÀ_t
 
__loc
Ë
__THROW
;

185 
	$wc¢ˇ£cmp_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

186 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

189 
__BEGIN_NAMESPACE_STD


192 
	$wcscﬁl
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
Ë
__THROW
;

196 
size_t
 
	$wcsx‰m
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

197 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

198 
__END_NAMESPACE_STD


200 #ifde‡
__USE_XOPEN2K8


206 
	$wcscﬁl_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

207 
__loˇÀ_t
 
__loc
Ë
__THROW
;

212 
size_t
 
	$wcsx‰m_l
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

213 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

216 
wch¨_t
 *
	$wcsdup
 (c⁄° 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_mÆloc__
;

219 
__BEGIN_NAMESPACE_STD


221 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


222 "C++" 
wch¨_t
 *
	$wcschr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

223 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

224 "C++" c⁄° 
wch¨_t
 *
	$wcschr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

225 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

227 
wch¨_t
 *
	$wcschr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

228 
__THROW
 
__©åibuã_puª__
;

231 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


232 "C++" 
wch¨_t
 *
	$wc§chr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

233 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

234 "C++" c⁄° 
wch¨_t
 *
	$wc§chr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

235 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

237 
wch¨_t
 *
	$wc§chr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

238 
__THROW
 
__©åibuã_puª__
;

240 
__END_NAMESPACE_STD


242 #ifde‡
__USE_GNU


245 
wch¨_t
 *
	$wcsch∫ul
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__wc
)

246 
__THROW
 
__©åibuã_puª__
;

249 
__BEGIN_NAMESPACE_STD


252 
size_t
 
	$wcsc•n
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ªje˘
)

253 
__THROW
 
__©åibuã_puª__
;

256 
size_t
 
	$wcs•n
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

257 
__THROW
 
__©åibuã_puª__
;

259 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


260 "C++" 
wch¨_t
 *
	$wc•brk
 (
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

261 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

262 "C++" c⁄° 
wch¨_t
 *
	$wc•brk
 (c⁄° 
wch¨_t
 *
__wcs
,

263 c⁄° 
wch¨_t
 *
__ac˚±
)

264 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

266 
wch¨_t
 *
	$wc•brk
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

267 
__THROW
 
__©åibuã_puª__
;

270 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


271 "C++" 
wch¨_t
 *
	$wcs°r
 (
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

272 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

273 "C++" c⁄° 
wch¨_t
 *
	$wcs°r
 (c⁄° 
wch¨_t
 *
__hay°ack
,

274 c⁄° 
wch¨_t
 *
__√edÀ
)

275 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

277 
wch¨_t
 *
	$wcs°r
 (c⁄° 
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

278 
__THROW
 
__©åibuã_puª__
;

282 
wch¨_t
 *
	$wc°ok
 (
wch¨_t
 *
__ª°ri˘
 
__s
,

283 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__dñim
,

284 
wch¨_t
 **
__ª°ri˘
 
__±r
Ë
__THROW
;

287 
size_t
 
	$wc¶í
 (c⁄° 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_puª__
;

288 
__END_NAMESPACE_STD


290 #ifde‡
__USE_XOPEN


292 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


293 "C++" 
wch¨_t
 *
	$wcswcs
 (
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

294 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

295 "C++" c⁄° 
wch¨_t
 *
	$wcswcs
 (c⁄° 
wch¨_t
 *
__hay°ack
,

296 c⁄° 
wch¨_t
 *
__√edÀ
)

297 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

299 
wch¨_t
 *
	$wcswcs
 (c⁄° 
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

300 
__THROW
 
__©åibuã_puª__
;

304 #ifde‡
__USE_XOPEN2K8


306 
size_t
 
	$wc¢Àn
 (c⁄° 
wch¨_t
 *
__s
, 
size_t
 
__maxÀn
)

307 
__THROW
 
__©åibuã_puª__
;

311 
__BEGIN_NAMESPACE_STD


313 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


314 "C++" 
wch¨_t
 *
	$wmemchr
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

316 "C++" c⁄° 
wch¨_t
 *
	$wmemchr
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__c
,

317 
size_t
 
__n
)

318 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

320 
wch¨_t
 *
	$wmemchr
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

321 
__THROW
 
__©åibuã_puª__
;

325 
	$wmemcmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

326 
__THROW
 
__©åibuã_puª__
;

329 
wch¨_t
 *
	$wmem˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

330 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

334 
wch¨_t
 *
	$wmemmove
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

335 
__THROW
;

338 
wch¨_t
 *
	$wmem£t
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
Ë
__THROW
;

339 
__END_NAMESPACE_STD


341 #ifde‡
__USE_GNU


344 
wch¨_t
 *
	$wmemp˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

345 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
)

346 
__THROW
;

350 
__BEGIN_NAMESPACE_STD


353 
wöt_t
 
	$btowc
 (
__c
Ë
__THROW
;

357 
	$w˘ob
 (
wöt_t
 
__c
Ë
__THROW
;

361 
	$mbsöô
 (c⁄° 
mb°©e_t
 *
__ps
Ë
__THROW
 
__©åibuã_puª__
;

365 
size_t
 
	$mbπowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

366 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

367 
mb°©e_t
 *
__ª°ri˘
 
__p
Ë
__THROW
;

370 
size_t
 
	$w¸tomb
 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wc
,

371 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

374 
size_t
 
	$__mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

375 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

376 
size_t
 
	$mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

377 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

378 
__END_NAMESPACE_STD


380 #ifde‡
__USE_EXTERN_INLINES


386 
wöt_t
 
	$__btowc_Æüs
 (
__c
Ë
	`__asm
 ("btowc");

387 
__exã∫_ölöe
 
wöt_t


388 
	`__NTH
 (
	$btowc
 (
__c
))

389 {  (
	`__buûtö_c⁄°™t_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

390 ? (
wöt_t
Ë
__c
 : 
	`__btowc_Æüs
 (__c)); 
	}
}

392 
	$__w˘ob_Æüs
 (
wöt_t
 
__c
Ë
	`__asm
 ("wctob");

393 
__exã∫_ölöe
 

394 
	`__NTH
 (
	$w˘ob
 (
wöt_t
 
__wc
))

395 {  (
	`__buûtö_c⁄°™t_p
 (
__wc
Ë&& __w¯>
L
'\0' && __wc <= L'\x7f'

396 ? (Ë
__wc
 : 
	`__w˘ob_Æüs
 (__wc)); 
	}
}

398 
__exã∫_ölöe
 
size_t


399 
__NTH
 (
	$mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

400 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

401 {  (
__ps
 !
NULL


402 ? 
	`mbπowc
 (
NULL
, 
__s
, 
__n
, 
__ps
Ë: 
	`__mbæí
 (__s, __n, NULL)); 
	}
}

405 
__BEGIN_NAMESPACE_STD


408 
size_t
 
	$mb§towcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

409 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

410 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

414 
size_t
 
	$wc§tombs
 (*
__ª°ri˘
 
__d°
,

415 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

416 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

417 
__END_NAMESPACE_STD


420 #ifdef 
__USE_XOPEN2K8


423 
size_t
 
	$mb¢πowcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

424 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

425 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

429 
size_t
 
	$wc¢πombs
 (*
__ª°ri˘
 
__d°
,

430 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

431 
size_t
 
__nwc
, size_à
__Àn
,

432 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

437 #ifde‡
__USE_XOPEN


439 
	$wcwidth
 (
wch¨_t
 
__c
Ë
__THROW
;

443 
	$wcswidth
 (c⁄° 
wch¨_t
 *
__s
, 
size_t
 
__n
Ë
__THROW
;

447 
__BEGIN_NAMESPACE_STD


450 
	$wc°od
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

451 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

452 
__END_NAMESPACE_STD


454 #ifde‡
__USE_ISOC99


455 
__BEGIN_NAMESPACE_C99


457 
	$wc°of
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

458 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

459 
	$wc°ﬁd
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

460 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

461 
__END_NAMESPACE_C99


465 
__BEGIN_NAMESPACE_STD


468 
	$wc°ﬁ
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

469 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

473 
	$wc°oul
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

474 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

475 
__THROW
;

476 
__END_NAMESPACE_STD


478 #ifde‡
__USE_ISOC99


479 
__BEGIN_NAMESPACE_C99


482 
__exãnsi⁄__


483 
	$wc°ﬁl
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

484 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

485 
__THROW
;

489 
__exãnsi⁄__


490 
	$wc°ouŒ
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

491 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

492 
__ba£
Ë
__THROW
;

493 
__END_NAMESPACE_C99


496 #ifde‡
__USE_GNU


499 
__exãnsi⁄__


500 
	$wc°oq
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

501 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

502 
__THROW
;

506 
__exãnsi⁄__


507 
	$wc°ouq
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

508 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

509 
__ba£
Ë
__THROW
;

512 #ifde‡
__USE_GNU


526 
	~<xloˇÀ.h
>

530 
	$wc°ﬁ_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

531 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

532 
__loˇÀ_t
 
__loc
Ë
__THROW
;

534 
	$wc°oul_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

535 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

536 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

538 
__exãnsi⁄__


539 
	$wc°ﬁl_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

540 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

541 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

543 
__exãnsi⁄__


544 
	$wc°ouŒ_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

545 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

546 
__ba£
, 
__loˇÀ_t
 
__loc
)

547 
__THROW
;

549 
	$wc°od_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

550 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

551 
__THROW
;

553 
	$wc°of_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

554 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

555 
__THROW
;

557 
	$wc°ﬁd_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

558 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

559 
__loˇÀ_t
 
__loc
Ë
__THROW
;

563 #ifde‡
__USE_XOPEN2K8


566 
wch¨_t
 *
	$w˝˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

567 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

571 
wch¨_t
 *
	$w˝n˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

572 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

573 
__THROW
;

580 
__FILE
 *
	$›í_wmem°ªam
 (
wch¨_t
 **
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
;

583 #i‡
deföed
 
__USE_ISOC95
 || deföed 
__USE_UNIX98


584 
__BEGIN_NAMESPACE_STD


587 
	$fwide
 (
__FILE
 *
__Â
, 
__mode
Ë
__THROW
;

594 
	`fw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

595 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

601 
	`w¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

604 
	$sw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

605 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

606 
__THROW
 ;

612 
	`vfw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__s
,

613 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

614 
__gnuc_va_li°
 
__¨g
)

620 
	`vw¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

621 
__gnuc_va_li°
 
__¨g
)

625 
	$vsw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

626 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

627 
__gnuc_va_li°
 
__¨g
)

628 
__THROW
 ;

635 
	`fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

636 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

642 
	`wsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

645 
	$swsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

646 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

647 
__THROW
 ;

649 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

650 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

651 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

652 #ifde‡
__REDIRECT


656 
	`__REDIRECT
 (
fwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__°ªam
,

657 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

658 
__isoc99_fwsˇnf
)

660 
	`__REDIRECT
 (
wsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

661 
__isoc99_wsˇnf
)

663 
	`__REDIRECT_NTH
 (
swsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

664 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

665 ...), 
__isoc99_swsˇnf
)

668 
	`__isoc99_fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

669 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

670 
	`__isoc99_wsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

671 
	$__isoc99_swsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

672 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

673 
__THROW
;

674 
	#fwsˇnf
 
__isoc99_fwsˇnf


	)

675 
	#wsˇnf
 
__isoc99_wsˇnf


	)

676 
	#swsˇnf
 
__isoc99_swsˇnf


	)

680 
__END_NAMESPACE_STD


683 #ifde‡
__USE_ISOC99


684 
__BEGIN_NAMESPACE_C99


689 
	`vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

690 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

691 
__gnuc_va_li°
 
__¨g
)

697 
	`vwsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

698 
__gnuc_va_li°
 
__¨g
)

701 
	$vswsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

702 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

703 
__gnuc_va_li°
 
__¨g
)

704 
__THROW
 ;

706 #i‡!
deföed
 
__USE_GNU
 \

707 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

708 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

709 #ifde‡
__REDIRECT


710 
	`__REDIRECT
 (
vfwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__s
,

711 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

712 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vfwsˇnf
)

714 
	`__REDIRECT
 (
vwsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

715 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vwsˇnf
)

717 
	`__REDIRECT_NTH
 (
vswsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

718 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

719 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vswsˇnf
)

722 
	`__isoc99_vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

723 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

724 
__gnuc_va_li°
 
__¨g
);

725 
	`__isoc99_vwsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

726 
__gnuc_va_li°
 
__¨g
);

727 
	$__isoc99_vswsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

728 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

729 
__gnuc_va_li°
 
__¨g
Ë
__THROW
;

730 
	#vfwsˇnf
 
__isoc99_vfwsˇnf


	)

731 
	#vwsˇnf
 
__isoc99_vwsˇnf


	)

732 
	#vswsˇnf
 
__isoc99_vswsˇnf


	)

736 
__END_NAMESPACE_C99


740 
__BEGIN_NAMESPACE_STD


745 
wöt_t
 
	`fgëwc
 (
__FILE
 *
__°ªam
);

746 
wöt_t
 
	`gëwc
 (
__FILE
 *
__°ªam
);

752 
wöt_t
 
	`gëwch¨
 ();

759 
wöt_t
 
	`Âutwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

760 
wöt_t
 
	`putwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

766 
wöt_t
 
	`putwch¨
 (
wch¨_t
 
__wc
);

774 
wch¨_t
 *
	`fgëws
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

775 
__FILE
 *
__ª°ri˘
 
__°ªam
);

781 
	`Âutws
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__ws
,

782 
__FILE
 *
__ª°ri˘
 
__°ªam
);

789 
wöt_t
 
	`ungëwc
 (wöt_à
__wc
, 
__FILE
 *
__°ªam
);

790 
__END_NAMESPACE_STD


793 #ifde‡
__USE_GNU


801 
wöt_t
 
	`gëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

802 
wöt_t
 
	`gëwch¨_u∆ocked
 ();

810 
wöt_t
 
	`fgëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

818 
wöt_t
 
	`Âutwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

827 
wöt_t
 
	`putwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

828 
wöt_t
 
	`putwch¨_u∆ocked
 (
wch¨_t
 
__wc
);

837 
wch¨_t
 *
	`fgëws_u∆ocked
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

838 
__FILE
 *
__ª°ri˘
 
__°ªam
);

846 
	`Âutws_u∆ocked
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__ws
,

847 
__FILE
 *
__ª°ri˘
 
__°ªam
);

851 
__BEGIN_NAMESPACE_C99


855 
size_t
 
	$wcs·ime
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

856 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

857 c⁄° 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

858 
__END_NAMESPACE_C99


860 #ifde‡
__USE_GNU


861 
	~<xloˇÀ.h
>

865 
size_t
 
	$wcs·ime_l
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

866 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

867 c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

868 
__loˇÀ_t
 
__loc
Ë
__THROW
;

877 #i‡
deföed
 
__USE_UNIX98
 && !deföed 
__USE_GNU


878 
	#__√ed_iswxxx


	)

879 
	~<w˘y≥.h
>

883 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


884 
	~<bôs/wch¨2.h
>

887 #ifde‡
__LDBL_COMPAT


888 
	~<bôs/wch¨-ldbl.h
>

891 
__END_DECLS


899 #unde‡
__√ed_mb°©e_t


900 #unde‡
__√ed_wöt_t


	@/usr/include/wctype.h

23 #i‚de‡
_WCTYPE_H


25 
	~<„©uªs.h
>

26 
	~<bôs/ty≥s.h
>

28 #i‚de‡
__√ed_iswxxx


29 
	#_WCTYPE_H
 1

	)

32 
	#__√ed_wöt_t


	)

33 
	~<wch¨.h
>

37 #i‚de‡
WEOF


38 
	#WEOF
 (0xffffffffu)

	)

41 #unde‡
__√ed_iswxxx


46 #i‚de‡
__iswxxx_deföed


47 
	#__iswxxx_deföed
 1

	)

49 
__BEGIN_NAMESPACE_C99


52 
	tw˘y≥_t
;

53 
	g__END_NAMESPACE_C99


55 #i‚de‡
_ISwbô


60 
	~<ídün.h
>

61 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


62 
	#_ISwbô
(
bô
Ë(1 << (bô))

	)

64 
	#_ISwbô
(
bô
) \

65 ((
bô
) < 8 ? () ((1UL << (bit)) << 24) \

66 : ((
bô
) < 16 ? () ((1UL << (bit)) << 8) \

67 : ((
bô
) < 24 ? () ((1UL << (bit)) >> 8) \

68 : (Ë((1UL << (
bô
)Ë>> 24))))

	)

73 
	m__ISwuµî
 = 0,

74 
	m__ISwlowî
 = 1,

75 
	m__ISwÆpha
 = 2,

76 
	m__ISwdigô
 = 3,

77 
	m__ISwxdigô
 = 4,

78 
	m__ISw•a˚
 = 5,

79 
	m__ISw¥öt
 = 6,

80 
	m__ISwgøph
 = 7,

81 
	m__ISwbœnk
 = 8,

82 
	m__ISw˙ål
 = 9,

83 
	m__ISwpun˘
 = 10,

84 
	m__ISwÆnum
 = 11,

86 
	m_ISwuµî
 = 
_ISwbô
 (
__ISwuµî
),

87 
	m_ISwlowî
 = 
_ISwbô
 (
__ISwlowî
),

88 
	m_ISwÆpha
 = 
_ISwbô
 (
__ISwÆpha
),

89 
	m_ISwdigô
 = 
_ISwbô
 (
__ISwdigô
),

90 
	m_ISwxdigô
 = 
_ISwbô
 (
__ISwxdigô
),

91 
	m_ISw•a˚
 = 
_ISwbô
 (
__ISw•a˚
),

92 
	m_ISw¥öt
 = 
_ISwbô
 (
__ISw¥öt
),

93 
	m_ISwgøph
 = 
_ISwbô
 (
__ISwgøph
),

94 
	m_ISwbœnk
 = 
_ISwbô
 (
__ISwbœnk
),

95 
	m_ISw˙ål
 = 
_ISwbô
 (
__ISw˙ål
),

96 
	m_ISwpun˘
 = 
_ISwbô
 (
__ISwpun˘
),

97 
	m_ISwÆnum
 = 
_ISwbô
 (
__ISwÆnum
)

102 
__BEGIN_DECLS


104 
__BEGIN_NAMESPACE_C99


111 
	$iswÆnum
 (
wöt_t
 
__wc
Ë
__THROW
;

117 
	$iswÆpha
 (
wöt_t
 
__wc
Ë
__THROW
;

120 
	$isw˙ål
 (
wöt_t
 
__wc
Ë
__THROW
;

124 
	$iswdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

128 
	$iswgøph
 (
wöt_t
 
__wc
Ë
__THROW
;

133 
	$iswlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

136 
	$isw¥öt
 (
wöt_t
 
__wc
Ë
__THROW
;

141 
	$iswpun˘
 (
wöt_t
 
__wc
Ë
__THROW
;

146 
	$isw•a˚
 (
wöt_t
 
__wc
Ë
__THROW
;

151 
	$iswuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

156 
	$iswxdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

161 #ifde‡
__USE_ISOC99


162 
	$iswbœnk
 (
wöt_t
 
__wc
Ë
__THROW
;

171 
w˘y≥_t
 
	$w˘y≥
 (c⁄° *
__¥›îty
Ë
__THROW
;

175 
	$isw˘y≥
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
Ë
__THROW
;

176 
__END_NAMESPACE_C99


183 
__BEGIN_NAMESPACE_C99


186 c⁄° 
	t__öt32_t
 *
	tw˘øns_t
;

187 
__END_NAMESPACE_C99


188 #ifde‡
__USE_GNU


189 
	$__USING_NAMESPACE_C99
(
w˘øns_t
)

192 
__BEGIN_NAMESPACE_C99


194 
wöt_t
 
	$towlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

197 
wöt_t
 
	$towuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

198 
__END_NAMESPACE_C99


200 
__END_DECLS


207 #ifde‡
_WCTYPE_H


213 
__BEGIN_DECLS


215 
__BEGIN_NAMESPACE_C99


218 
w˘øns_t
 
	$w˘øns
 (c⁄° *
__¥›îty
Ë
__THROW
;

221 
wöt_t
 
	$tow˘øns
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
Ë
__THROW
;

222 
__END_NAMESPACE_C99


224 #ifde‡
__USE_XOPEN2K8


226 
	~<xloˇÀ.h
>

230 
	$iswÆnum_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

236 
	$iswÆpha_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

239 
	$isw˙ål_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

243 
	$iswdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

247 
	$iswgøph_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

252 
	$iswlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

255 
	$isw¥öt_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

260 
	$iswpun˘_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

265 
	$isw•a˚_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

270 
	$iswuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

275 
	$iswxdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

280 
	$iswbœnk_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

284 
w˘y≥_t
 
	$w˘y≥_l
 (c⁄° *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

285 
__THROW
;

289 
	$isw˘y≥_l
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
, 
__loˇÀ_t
 
__loˇÀ
)

290 
__THROW
;

298 
wöt_t
 
	$towlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

301 
wöt_t
 
	$towuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

305 
w˘øns_t
 
	$w˘øns_l
 (c⁄° *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

306 
__THROW
;

309 
wöt_t
 
	$tow˘øns_l
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
,

310 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

314 
__END_DECLS


	@
1
.
1
/usr/include
49
2011
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/avlTree.c
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/avlTree.h
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/bi_list.c
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/bi_list.h
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/debug.h
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/dictionary.c
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/dictionary.h
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/diffXmatch.c
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/diffXmatch.h
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/flash.c
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/flash.h
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/initialize.c
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/initialize.h
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/js_list.c
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/js_list.h
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/pagemap.c
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/pagemap.h
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/ssd.c
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/ssd.h
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/xmatchPro.c
/home/lxc/ssdsimnew/compressed_Mapping_table/compressed-table/xmatchPro.h
/usr/include/ctype.h
/usr/include/malloc.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/time.h
avlTree.h
bi_list.h
debug.h
dictionary.h
diffXmatch.h
flash.h
initialize.h
js_list.h
pagemap.h
ssd.h
xmatchPro.h
/usr/include/alloca.h
/usr/include/endian.h
/usr/include/features.h
/usr/include/getopt.h
/usr/include/libio.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/stdc-predef.h
/usr/include/gconv.h
/usr/include/wchar.h
/usr/include/wctype.h
